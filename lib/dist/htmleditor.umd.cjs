(function(z,h){typeof exports=="object"&&typeof module<"u"?h(exports,require("react"),require("uuid"),require("react-dom")):typeof define=="function"&&define.amd?define(["exports","react","uuid","react-dom"],h):(z=typeof globalThis<"u"?globalThis:z||self,h(z.HTMLEditor={},z.React,z.uuid,z.ReactDOM))})(this,(function(z,h,Ye,wn){"use strict";function Cn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ne={exports:{}},ve={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vt;function On(){if(vt)return ve;vt=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(n,s,a){var o=null;if(a!==void 0&&(o=""+a),s.key!==void 0&&(o=""+s.key),"key"in s){a={};for(var i in s)i!=="key"&&(a[i]=s[i])}else a=s;return s=a.ref,{$$typeof:e,type:n,key:o,ref:s!==void 0?s:null,props:a}}return ve.Fragment=t,ve.jsx=r,ve.jsxs=r,ve}var xe={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xt;function Nn(){return xt||(xt=1,process.env.NODE_ENV!=="production"&&(function(){function e(c){if(c==null)return null;if(typeof c=="function")return c.$$typeof===j?null:c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case R:return"Fragment";case S:return"Profiler";case v:return"StrictMode";case y:return"Suspense";case g:return"SuspenseList";case G:return"Activity"}if(typeof c=="object")switch(typeof c.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),c.$$typeof){case x:return"Portal";case k:return c.displayName||"Context";case O:return(c._context.displayName||"Context")+".Consumer";case u:var C=c.render;return c=c.displayName,c||(c=C.displayName||C.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case T:return C=c.displayName||null,C!==null?C:e(c.type)||"Memo";case I:C=c._payload,c=c._init;try{return e(c(C))}catch{}}return null}function t(c){return""+c}function r(c){try{t(c);var C=!1}catch{C=!0}if(C){C=console;var M=C.error,L=typeof Symbol=="function"&&Symbol.toStringTag&&c[Symbol.toStringTag]||c.constructor.name||"Object";return M.call(C,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",L),t(c)}}function n(c){if(c===R)return"<>";if(typeof c=="object"&&c!==null&&c.$$typeof===I)return"<...>";try{var C=e(c);return C?"<"+C+">":"<...>"}catch{return"<...>"}}function s(){var c=$.A;return c===null?null:c.getOwner()}function a(){return Error("react-stack-top-frame")}function o(c){if(Z.call(c,"key")){var C=Object.getOwnPropertyDescriptor(c,"key").get;if(C&&C.isReactWarning)return!1}return c.key!==void 0}function i(c,C){function M(){ne||(ne=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",C))}M.isReactWarning=!0,Object.defineProperty(c,"key",{get:M,configurable:!0})}function m(){var c=e(this.type);return Y[c]||(Y[c]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),c=this.props.ref,c!==void 0?c:null}function l(c,C,M,L,V,W){var H=M.ref;return c={$$typeof:P,type:c,key:C,props:M,_owner:L},(H!==void 0?H:null)!==null?Object.defineProperty(c,"ref",{enumerable:!1,get:m}):Object.defineProperty(c,"ref",{enumerable:!1,value:null}),c._store={},Object.defineProperty(c._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(c,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(c,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:V}),Object.defineProperty(c,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:W}),Object.freeze&&(Object.freeze(c.props),Object.freeze(c)),c}function f(c,C,M,L,V,W){var H=C.children;if(H!==void 0)if(L)if(B(H)){for(L=0;L<H.length;L++)p(H[L]);Object.freeze&&Object.freeze(H)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else p(H);if(Z.call(C,"key")){H=e(c);var U=Object.keys(C).filter(function(X){return X!=="key"});L=0<U.length?"{key: someKey, "+U.join(": ..., ")+": ...}":"{key: someKey}",E[H+L]||(U=0<U.length?"{"+U.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,L,H,U,H),E[H+L]=!0)}if(H=null,M!==void 0&&(r(M),H=""+M),o(C)&&(r(C.key),H=""+C.key),"key"in C){M={};for(var K in C)K!=="key"&&(M[K]=C[K])}else M=C;return H&&i(M,typeof c=="function"?c.displayName||c.name||"Unknown":c),l(c,H,M,s(),V,W)}function p(c){d(c)?c._store&&(c._store.validated=1):typeof c=="object"&&c!==null&&c.$$typeof===I&&(c._payload.status==="fulfilled"?d(c._payload.value)&&c._payload.value._store&&(c._payload.value._store.validated=1):c._store&&(c._store.validated=1))}function d(c){return typeof c=="object"&&c!==null&&c.$$typeof===P}var _=h,P=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),O=Symbol.for("react.consumer"),k=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),g=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),G=Symbol.for("react.activity"),j=Symbol.for("react.client.reference"),$=_.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z=Object.prototype.hasOwnProperty,B=Array.isArray,oe=console.createTask?console.createTask:function(){return null};_={react_stack_bottom_frame:function(c){return c()}};var ne,Y={},q=_.react_stack_bottom_frame.bind(_,a)(),ae=oe(n(a)),E={};xe.Fragment=R,xe.jsx=function(c,C,M){var L=1e4>$.recentlyCreatedOwnerStacks++;return f(c,C,M,!1,L?Error("react-stack-top-frame"):q,L?oe(n(c)):ae)},xe.jsxs=function(c,C,M){var L=1e4>$.recentlyCreatedOwnerStacks++;return f(c,C,M,!0,L?Error("react-stack-top-frame"):q,L?oe(n(c)):ae)}})()),xe}var At;function Mn(){return At||(At=1,process.env.NODE_ENV==="production"?Ne.exports=On():Ne.exports=Nn()),Ne.exports}var b=Mn();const Ve=100,Ke=50,Xe=200,_t=5,Je=e=>e<Xe,Qe=e=>e>Ke,Rn=96,Me=e=>Math.round(e*Rn),Re={NORMAL:{name:"Normal",label:'Normal (1")',top:1,bottom:1,left:1,right:1},NARROW:{name:"Narrow",label:'Narrow (0.5")',top:.5,bottom:.5,left:.5,right:.5},MODERATE:{name:"Moderate",label:'Moderate (1" / 0.75")',top:1,bottom:1,left:.75,right:.75},WIDE:{name:"Wide",label:'Wide (1" / 2")',top:1,bottom:1,left:2,right:2},OFFICE_2003:{name:"Office 2003",label:'Office 2003 (1" / 1.25")',top:1,bottom:1,left:1.25,right:1.25}},pe="NORMAL",Pt=(e=pe)=>{const t=Re[e]||Re[pe];return{top:Me(t.top),bottom:Me(t.bottom),left:Me(t.left),right:Me(t.right)}},In=(e=pe)=>{const t=Pt(e);return t.top+t.bottom},Ln=()=>Object.keys(Re),Dn=e=>{const t=Re[e];return t?t.label:"Unknown"},ce={A4:{name:"A4",width:794,height:1123,widthMm:210,heightMm:297,widthIn:8.27,heightIn:11.69},Letter:{name:"Letter",width:816,height:1056,widthMm:216,heightMm:279,widthIn:8.5,heightIn:11},Legal:{name:"Legal",width:816,height:1344,widthMm:216,heightMm:356,widthIn:8.5,heightIn:14}},et="A4",Ie=e=>{const t=ce[e]||ce[et];return{width:t.width,height:t.height}},jn=e=>Object.keys(ce).includes(e),Hn=()=>Object.keys(ce),Ae=et,me="<p><br></p>",Bn="continuous",_e=(e,t=Ae)=>({id:Ye.v4(),index:e,size:t,content:me,images:[],isBreakPoint:!1}),Le=e=>typeof e!="string"||e.trim()===""?me:e,kt=(e,t=Ae)=>(e.length>0?e:[_e(0,t)]).map((n,s)=>({id:n.id||Ye.v4(),index:s,size:n.size||t,content:Le(n.content),images:n.images||[],isBreakPoint:!!n.isBreakPoint})),$n=(e=Ae)=>[{id:"page-0",pageNumber:1,top:0,height:Ie(e).height}],tt=(e={})=>{const t=new Date().toISOString(),r=e.pageSize||Ae,n=kt(e.pages||[_e(0,r)],r);return{id:Ye.v4(),title:e.title||"Untitled Document",createdAt:t,updatedAt:t,pageSize:r,pages:n,activePage:e.activePage&&e.activePage<n.length?e.activePage:0,pageBreaks:e.pageBreaks||[],totalPages:n.length,editorMode:e.editorMode||Bn,continuousContent:e.continuousContent||me,pageBoundaries:e.pageBoundaries||$n(r),zoomLevel:e.zoomLevel||Ve,pageMargins:e.pageMargins||pe,undoStack:[],redoStack:[],canUndo:!1,canRedo:!1}},F={INITIALIZE_DOCUMENT:"INITIALIZE_DOCUMENT",UPDATE_TITLE:"UPDATE_TITLE",UPDATE_PAGE_CONTENT:"UPDATE_PAGE_CONTENT",UPDATE_PAGES:"UPDATE_PAGES",ADD_PAGE:"ADD_PAGE",DELETE_PAGE:"DELETE_PAGE",SET_ACTIVE_PAGE:"SET_ACTIVE_PAGE",UPDATE_PAGE_SIZE:"UPDATE_PAGE_SIZE",RESET_DOCUMENT:"RESET_DOCUMENT",UPDATE_CONTINUOUS_CONTENT:"UPDATE_CONTINUOUS_CONTENT",UPDATE_PAGE_BOUNDARIES:"UPDATE_PAGE_BOUNDARIES",ADD_PAGE_BREAK:"ADD_PAGE_BREAK",REMOVE_PAGE_BREAK:"REMOVE_PAGE_BREAK",SET_EDITOR_MODE:"SET_EDITOR_MODE",INSERT_PAGE_AT:"INSERT_PAGE_AT",MOVE_PAGE_TO:"MOVE_PAGE_TO",DUPLICATE_PAGE:"DUPLICATE_PAGE",SET_ZOOM_LEVEL:"SET_ZOOM_LEVEL",ZOOM_IN:"ZOOM_IN",ZOOM_OUT:"ZOOM_OUT",RESET_ZOOM:"RESET_ZOOM",UPDATE_PAGE_MARGINS:"UPDATE_PAGE_MARGINS",RECORD_OPERATION:"RECORD_OPERATION",UNDO:"UNDO",REDO:"REDO",CLEAR_UNDO_REDO:"CLEAR_UNDO_REDO"},nt=(e,t)=>{const r=new Date().toISOString();switch(t.type){case F.INITIALIZE_DOCUMENT:{const{initialContent:n=me,pageSize:s=Ae}=t.payload||{},a={..._e(0,s),content:Le(n)};return tt({title:e.title,pageSize:s,pages:[a]})}case F.UPDATE_TITLE:return{...e,title:t.payload,updatedAt:r};case F.UPDATE_PAGE_CONTENT:{const{pageIndex:n,content:s}=t.payload;if(n<0||n>=e.pages.length)return e;const a=[...e.pages];return a[n]={...a[n],content:Le(s)},{...e,pages:a,updatedAt:r}}case F.UPDATE_PAGES:{const n=Array.isArray(t.payload)?{pages:t.payload}:t.payload||{},s=kt(n.pages||[],e.pageSize),a=Array.isArray(n.pageBreaks)?n.pageBreaks:s.slice(0,-1).map((o,i)=>({id:`auto-break-${i}`,pageNumber:i+1}));return{...e,pages:s,activePage:Math.min(e.activePage,s.length-1),pageBreaks:a,totalPages:s.length,updatedAt:r}}case F.ADD_PAGE:{const n=typeof t.payload?.index=="number"?Math.min(Math.max(t.payload.index,0),e.pages.length):e.pages.length,s=[...e.pages];s.splice(n,0,_e(n,e.pageSize));const a=s.map((i,m)=>({...i,index:m,size:e.pageSize})),o=a.slice(0,-1).map((i,m)=>({id:`auto-break-${m}`,pageNumber:m+1}));return{...e,pages:a,activePage:n,pageBreaks:o,totalPages:a.length,updatedAt:r}}case F.DELETE_PAGE:{const n=t.payload;if(e.pages.length<=1)return e;const s=[...e.pages];s.splice(n,1);const a=s.map((m,l)=>({...m,index:l,size:e.pageSize}));let o=e.activePage;o>=a.length?o=a.length-1:n<=o&&o>0&&(o-=1);const i=a.slice(0,-1).map((m,l)=>({id:`auto-break-${l}`,pageNumber:l+1}));return{...e,pages:a,activePage:o,pageBreaks:i,totalPages:a.length,updatedAt:r}}case F.SET_ACTIVE_PAGE:{const n=t.payload;if(n===e.activePage)return e;const s=e.editorMode==="continuous"?e.pageBoundaries.length:e.pages.length;return n<0||n>=s?e:{...e,activePage:n,updatedAt:r}}case F.UPDATE_PAGE_SIZE:{const n=t.payload;if(n===e.pageSize)return e;try{Ie(n)}catch{return console.warn(`Invalid page size: ${n}`),e}const s=e.pages.map((o,i)=>({...o,index:i,size:n})),a=s.slice(0,-1).map((o,i)=>({id:`auto-break-${i}`,pageNumber:i+1}));return{...e,pageSize:n,pages:s,pageBreaks:a,updatedAt:r}}case F.RESET_DOCUMENT:return tt();case F.UPDATE_CONTINUOUS_CONTENT:{const n=Le(t.payload);return n===e.continuousContent?e:{...e,continuousContent:n,updatedAt:r}}case F.UPDATE_PAGE_BOUNDARIES:{const n=Array.isArray(t.payload)?t.payload:[];if(n.length===e.pageBoundaries.length&&n.length>0&&n[0].id===e.pageBoundaries[0]?.id&&n[n.length-1].id===e.pageBoundaries[n.length-1]?.id)return e;const s=e.activePage>=n.length?Math.max(0,n.length-1):e.activePage;return{...e,pageBoundaries:n,totalPages:n.length,activePage:s,updatedAt:r}}case F.ADD_PAGE_BREAK:{const{position:n="end",pageIndex:s}=t.payload||{},a='<page-break data-page-break="true" style="display: block; height: 20px; border-top: 2px dashed #ccc; margin: 20px 0; page-break-after: always;"></page-break>';let o=e.continuousContent;if(n==="end")o=o+a+"<p><br></p>";else if(typeof n=="number"){const i=o.substring(0,n),m=o.substring(n);o=i+a+m}else if(typeof s=="number"&&typeof document<"u"){const i=document.createElement("div");i.innerHTML=o;const m=i.querySelectorAll('page-break, [data-page-break="true"]');if(s===0&&m.length===0)o=o+a+"<p><br></p>";else if(s<m.length){const l=m[s],f=document.createElement("page-break");f.setAttribute("data-page-break","true"),f.setAttribute("style","display: block; height: 20px; border-top: 2px dashed #ccc; margin: 20px 0; page-break-after: always;");const p=document.createElement("p");p.innerHTML="<br>",l.parentNode.insertBefore(f,l.nextSibling),f.parentNode.insertBefore(p,f.nextSibling),o=i.innerHTML}else o=o+a+"<p><br></p>"}return{...e,continuousContent:o,updatedAt:r}}case F.REMOVE_PAGE_BREAK:{const{pageIndex:n}=t.payload||{};if(typeof n!="number"||typeof document>"u")return e;const s=document.createElement("div");s.innerHTML=e.continuousContent;const a=s.querySelectorAll('page-break, [data-page-break="true"]');return a[n]&&a[n].remove(),s.querySelectorAll('page-break, [data-page-break="true"]').forEach((i,m)=>{i.setAttribute("data-page-number",String(m+2))}),{...e,continuousContent:s.innerHTML,updatedAt:r}}case F.SET_EDITOR_MODE:{const n=t.payload;if(n===e.editorMode)return e;let s=e.continuousContent,a=e.pages;return n==="continuous"?s=e.pages.map(i=>i.content).filter(i=>i&&i!==me).join(`
`)||me:e.continuousContent&&e.continuousContent!==me&&(a=[{..._e(0,e.pageSize),content:e.continuousContent}]),{...e,editorMode:n,continuousContent:s,pages:a,updatedAt:r}}case F.SET_ZOOM_LEVEL:{const n=t.payload;return n<Ke||n>Xe?(console.warn(`Invalid zoom level: ${n}. Must be between ${Ke} and ${Xe}.`),e):n===e.zoomLevel?e:{...e,zoomLevel:n,updatedAt:r}}case F.ZOOM_IN:{if(!Je(e.zoomLevel))return e;const n=e.zoomLevel+_t;return{...e,zoomLevel:n,updatedAt:r}}case F.ZOOM_OUT:{if(!Qe(e.zoomLevel))return e;const n=e.zoomLevel-_t;return{...e,zoomLevel:n,updatedAt:r}}case F.RESET_ZOOM:return e.zoomLevel===Ve?e:{...e,zoomLevel:Ve,updatedAt:r};case F.UPDATE_PAGE_MARGINS:{const n=t.payload;return n===e.pageMargins?e:{...e,pageMargins:n,updatedAt:r}}case F.RECORD_OPERATION:{const{operation:n,inverseOperation:s}=t.payload;return{...e,undoStack:[...e.undoStack,{operation:n,inverseOperation:s}],redoStack:[],canUndo:!0,canRedo:!1,updatedAt:r}}case F.UNDO:{if(e.undoStack.length===0)return e;const n=e.undoStack[e.undoStack.length-1],s=e.undoStack.slice(0,-1);let a=e;return n.inverseOperation&&(a=nt(e,n.inverseOperation)),{...a,undoStack:s,redoStack:[...e.redoStack,n],canUndo:s.length>0,canRedo:!0,updatedAt:r}}case F.REDO:{if(e.redoStack.length===0)return e;const n=e.redoStack[e.redoStack.length-1],s=e.redoStack.slice(0,-1);let a=e;return n.operation&&(a=nt(e,n.operation)),{...a,undoStack:[...e.undoStack,n],redoStack:s,canUndo:!0,canRedo:s.length>0,updatedAt:r}}case F.CLEAR_UNDO_REDO:return{...e,undoStack:[],redoStack:[],canUndo:!1,canRedo:!1,updatedAt:r};case"IMAGE_ALIGN":{const{element:n,state:s}=t.payload;return n&&s&&(n.style.float=s.float,n.style.margin=s.margin,n.style.display=s.display,s.width&&(n.style.width=s.width),s.height&&(n.style.height=s.height)),e}case"IMAGE_DELETE":{const{element:n}=t.payload;return n&&n.parentNode&&n.parentNode.removeChild(n),e}case"IMAGE_REINSERT":{const{state:n}=t.payload;return n&&n.parent&&n.element&&(n.nextSibling?n.parent.insertBefore(n.element,n.nextSibling):n.parent.appendChild(n.element)),e}case"IMAGE_ASPECT_RATIO":return e;case"IMAGE_RESIZE":{const{element:n,state:s}=t.payload;return n&&s&&(s.width&&(n.style.width=s.width),s.height&&(n.style.height=s.height)),e}default:return e}},St=h.createContext(null),zn=({children:e,initialState:t={}})=>{const[r,n]=h.useReducer(nt,tt(t)),s=h.useMemo(()=>({initializeDocument:o=>n({type:F.INITIALIZE_DOCUMENT,payload:o}),updateTitle:o=>n({type:F.UPDATE_TITLE,payload:o}),updatePageContent:o=>n({type:F.UPDATE_PAGE_CONTENT,payload:o}),updatePages:o=>n({type:F.UPDATE_PAGES,payload:o}),addPage:o=>n({type:F.ADD_PAGE,payload:o}),deletePage:o=>n({type:F.DELETE_PAGE,payload:o}),setActivePage:o=>n({type:F.SET_ACTIVE_PAGE,payload:o}),updatePageSize:o=>n({type:F.UPDATE_PAGE_SIZE,payload:o}),resetDocument:()=>n({type:F.RESET_DOCUMENT}),updateContinuousContent:o=>n({type:F.UPDATE_CONTINUOUS_CONTENT,payload:o}),updatePageBoundaries:o=>n({type:F.UPDATE_PAGE_BOUNDARIES,payload:o}),addPageBreak:o=>n({type:F.ADD_PAGE_BREAK,payload:o}),removePageBreak:o=>n({type:F.REMOVE_PAGE_BREAK,payload:o}),setEditorMode:o=>n({type:F.SET_EDITOR_MODE,payload:o}),insertPageAt:o=>n({type:F.INSERT_PAGE_AT,payload:o}),movePageTo:o=>n({type:F.MOVE_PAGE_TO,payload:o}),duplicatePage:o=>n({type:F.DUPLICATE_PAGE,payload:o}),setZoomLevel:o=>n({type:F.SET_ZOOM_LEVEL,payload:o}),zoomIn:()=>n({type:F.ZOOM_IN}),zoomOut:()=>n({type:F.ZOOM_OUT}),resetZoom:()=>n({type:F.RESET_ZOOM}),updatePageMargins:o=>n({type:F.UPDATE_PAGE_MARGINS,payload:o}),recordOperation:(o,i)=>n({type:F.RECORD_OPERATION,payload:{operation:o,inverseOperation:i}}),undo:()=>n({type:F.UNDO}),redo:()=>n({type:F.REDO}),clearUndoRedo:()=>n({type:F.CLEAR_UNDO_REDO})}),[]),a=h.useMemo(()=>({state:r,actions:s,dispatch:n}),[r,s]);return b.jsx(St.Provider,{value:a,children:e})},rt=()=>{const e=h.useContext(St);if(!e)throw new Error("useDocument must be used within a DocumentProvider");return e},ot=()=>{const{state:e}=rt();return e},Ee=()=>{const{actions:e}=rt();return e};var De={exports:{}},je={exports:{}},ee={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wt;function Fn(){if(wt)return ee;wt=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,r=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,s=e?Symbol.for("react.strict_mode"):60108,a=e?Symbol.for("react.profiler"):60114,o=e?Symbol.for("react.provider"):60109,i=e?Symbol.for("react.context"):60110,m=e?Symbol.for("react.async_mode"):60111,l=e?Symbol.for("react.concurrent_mode"):60111,f=e?Symbol.for("react.forward_ref"):60112,p=e?Symbol.for("react.suspense"):60113,d=e?Symbol.for("react.suspense_list"):60120,_=e?Symbol.for("react.memo"):60115,P=e?Symbol.for("react.lazy"):60116,x=e?Symbol.for("react.block"):60121,R=e?Symbol.for("react.fundamental"):60117,v=e?Symbol.for("react.responder"):60118,S=e?Symbol.for("react.scope"):60119;function O(u){if(typeof u=="object"&&u!==null){var y=u.$$typeof;switch(y){case t:switch(u=u.type,u){case m:case l:case n:case a:case s:case p:return u;default:switch(u=u&&u.$$typeof,u){case i:case f:case P:case _:case o:return u;default:return y}}case r:return y}}}function k(u){return O(u)===l}return ee.AsyncMode=m,ee.ConcurrentMode=l,ee.ContextConsumer=i,ee.ContextProvider=o,ee.Element=t,ee.ForwardRef=f,ee.Fragment=n,ee.Lazy=P,ee.Memo=_,ee.Portal=r,ee.Profiler=a,ee.StrictMode=s,ee.Suspense=p,ee.isAsyncMode=function(u){return k(u)||O(u)===m},ee.isConcurrentMode=k,ee.isContextConsumer=function(u){return O(u)===i},ee.isContextProvider=function(u){return O(u)===o},ee.isElement=function(u){return typeof u=="object"&&u!==null&&u.$$typeof===t},ee.isForwardRef=function(u){return O(u)===f},ee.isFragment=function(u){return O(u)===n},ee.isLazy=function(u){return O(u)===P},ee.isMemo=function(u){return O(u)===_},ee.isPortal=function(u){return O(u)===r},ee.isProfiler=function(u){return O(u)===a},ee.isStrictMode=function(u){return O(u)===s},ee.isSuspense=function(u){return O(u)===p},ee.isValidElementType=function(u){return typeof u=="string"||typeof u=="function"||u===n||u===l||u===a||u===s||u===p||u===d||typeof u=="object"&&u!==null&&(u.$$typeof===P||u.$$typeof===_||u.$$typeof===o||u.$$typeof===i||u.$$typeof===f||u.$$typeof===R||u.$$typeof===v||u.$$typeof===S||u.$$typeof===x)},ee.typeOf=O,ee}var te={};/** @license React v16.13.1
 * react-is.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ct;function Un(){return Ct||(Ct=1,process.env.NODE_ENV!=="production"&&(function(){var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,r=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,s=e?Symbol.for("react.strict_mode"):60108,a=e?Symbol.for("react.profiler"):60114,o=e?Symbol.for("react.provider"):60109,i=e?Symbol.for("react.context"):60110,m=e?Symbol.for("react.async_mode"):60111,l=e?Symbol.for("react.concurrent_mode"):60111,f=e?Symbol.for("react.forward_ref"):60112,p=e?Symbol.for("react.suspense"):60113,d=e?Symbol.for("react.suspense_list"):60120,_=e?Symbol.for("react.memo"):60115,P=e?Symbol.for("react.lazy"):60116,x=e?Symbol.for("react.block"):60121,R=e?Symbol.for("react.fundamental"):60117,v=e?Symbol.for("react.responder"):60118,S=e?Symbol.for("react.scope"):60119;function O(N){return typeof N=="string"||typeof N=="function"||N===n||N===l||N===a||N===s||N===p||N===d||typeof N=="object"&&N!==null&&(N.$$typeof===P||N.$$typeof===_||N.$$typeof===o||N.$$typeof===i||N.$$typeof===f||N.$$typeof===R||N.$$typeof===v||N.$$typeof===S||N.$$typeof===x)}function k(N){if(typeof N=="object"&&N!==null){var ie=N.$$typeof;switch(ie){case t:var Te=N.type;switch(Te){case m:case l:case n:case a:case s:case p:return Te;default:var Ce=Te&&Te.$$typeof;switch(Ce){case i:case f:case P:case _:case o:return Ce;default:return ie}}case r:return ie}}}var u=m,y=l,g=i,T=o,I=t,G=f,j=n,$=P,Z=_,B=r,oe=a,ne=s,Y=p,q=!1;function ae(N){return q||(q=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),E(N)||k(N)===m}function E(N){return k(N)===l}function c(N){return k(N)===i}function C(N){return k(N)===o}function M(N){return typeof N=="object"&&N!==null&&N.$$typeof===t}function L(N){return k(N)===f}function V(N){return k(N)===n}function W(N){return k(N)===P}function H(N){return k(N)===_}function U(N){return k(N)===r}function K(N){return k(N)===a}function X(N){return k(N)===s}function se(N){return k(N)===p}te.AsyncMode=u,te.ConcurrentMode=y,te.ContextConsumer=g,te.ContextProvider=T,te.Element=I,te.ForwardRef=G,te.Fragment=j,te.Lazy=$,te.Memo=Z,te.Portal=B,te.Profiler=oe,te.StrictMode=ne,te.Suspense=Y,te.isAsyncMode=ae,te.isConcurrentMode=E,te.isContextConsumer=c,te.isContextProvider=C,te.isElement=M,te.isForwardRef=L,te.isFragment=V,te.isLazy=W,te.isMemo=H,te.isPortal=U,te.isProfiler=K,te.isStrictMode=X,te.isSuspense=se,te.isValidElementType=O,te.typeOf=k})()),te}var Ot;function Nt(){return Ot||(Ot=1,process.env.NODE_ENV==="production"?je.exports=Fn():je.exports=Un()),je.exports}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var at,Mt;function Gn(){if(Mt)return at;Mt=1;var e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function n(a){if(a==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(a)}function s(){try{if(!Object.assign)return!1;var a=new String("abc");if(a[5]="de",Object.getOwnPropertyNames(a)[0]==="5")return!1;for(var o={},i=0;i<10;i++)o["_"+String.fromCharCode(i)]=i;var m=Object.getOwnPropertyNames(o).map(function(f){return o[f]});if(m.join("")!=="0123456789")return!1;var l={};return"abcdefghijklmnopqrst".split("").forEach(function(f){l[f]=f}),Object.keys(Object.assign({},l)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}return at=s()?Object.assign:function(a,o){for(var i,m=n(a),l,f=1;f<arguments.length;f++){i=Object(arguments[f]);for(var p in i)t.call(i,p)&&(m[p]=i[p]);if(e){l=e(i);for(var d=0;d<l.length;d++)r.call(i,l[d])&&(m[l[d]]=i[l[d]])}}return m},at}var st,Rt;function it(){if(Rt)return st;Rt=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return st=e,st}var ct,It;function Lt(){return It||(It=1,ct=Function.call.bind(Object.prototype.hasOwnProperty)),ct}var lt,Dt;function qn(){if(Dt)return lt;Dt=1;var e=function(){};if(process.env.NODE_ENV!=="production"){var t=it(),r={},n=Lt();e=function(a){var o="Warning: "+a;typeof console<"u"&&console.error(o);try{throw new Error(o)}catch{}}}function s(a,o,i,m,l){if(process.env.NODE_ENV!=="production"){for(var f in a)if(n(a,f)){var p;try{if(typeof a[f]!="function"){var d=Error((m||"React class")+": "+i+" type `"+f+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof a[f]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw d.name="Invariant Violation",d}p=a[f](o,f,m,i,null,t)}catch(P){p=P}if(p&&!(p instanceof Error)&&e((m||"React class")+": type specification of "+i+" `"+f+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof p+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),p instanceof Error&&!(p.message in r)){r[p.message]=!0;var _=l?l():"";e("Failed "+i+" type: "+p.message+(_??""))}}}}return s.resetWarningCache=function(){process.env.NODE_ENV!=="production"&&(r={})},lt=s,lt}var ut,jt;function Wn(){if(jt)return ut;jt=1;var e=Nt(),t=Gn(),r=it(),n=Lt(),s=qn(),a=function(){};process.env.NODE_ENV!=="production"&&(a=function(i){var m="Warning: "+i;typeof console<"u"&&console.error(m);try{throw new Error(m)}catch{}});function o(){return null}return ut=function(i,m){var l=typeof Symbol=="function"&&Symbol.iterator,f="@@iterator";function p(E){var c=E&&(l&&E[l]||E[f]);if(typeof c=="function")return c}var d="<<anonymous>>",_={array:v("array"),bigint:v("bigint"),bool:v("boolean"),func:v("function"),number:v("number"),object:v("object"),string:v("string"),symbol:v("symbol"),any:S(),arrayOf:O,element:k(),elementType:u(),instanceOf:y,node:G(),objectOf:T,oneOf:g,oneOfType:I,shape:$,exact:Z};function P(E,c){return E===c?E!==0||1/E===1/c:E!==E&&c!==c}function x(E,c){this.message=E,this.data=c&&typeof c=="object"?c:{},this.stack=""}x.prototype=Error.prototype;function R(E){if(process.env.NODE_ENV!=="production")var c={},C=0;function M(V,W,H,U,K,X,se){if(U=U||d,X=X||H,se!==r){if(m){var N=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw N.name="Invariant Violation",N}else if(process.env.NODE_ENV!=="production"&&typeof console<"u"){var ie=U+":"+H;!c[ie]&&C<3&&(a("You are manually calling a React.PropTypes validation function for the `"+X+"` prop on `"+U+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),c[ie]=!0,C++)}}return W[H]==null?V?W[H]===null?new x("The "+K+" `"+X+"` is marked as required "+("in `"+U+"`, but its value is `null`.")):new x("The "+K+" `"+X+"` is marked as required in "+("`"+U+"`, but its value is `undefined`.")):null:E(W,H,U,K,X)}var L=M.bind(null,!1);return L.isRequired=M.bind(null,!0),L}function v(E){function c(C,M,L,V,W,H){var U=C[M],K=ne(U);if(K!==E){var X=Y(U);return new x("Invalid "+V+" `"+W+"` of type "+("`"+X+"` supplied to `"+L+"`, expected ")+("`"+E+"`."),{expectedType:E})}return null}return R(c)}function S(){return R(o)}function O(E){function c(C,M,L,V,W){if(typeof E!="function")return new x("Property `"+W+"` of component `"+L+"` has invalid PropType notation inside arrayOf.");var H=C[M];if(!Array.isArray(H)){var U=ne(H);return new x("Invalid "+V+" `"+W+"` of type "+("`"+U+"` supplied to `"+L+"`, expected an array."))}for(var K=0;K<H.length;K++){var X=E(H,K,L,V,W+"["+K+"]",r);if(X instanceof Error)return X}return null}return R(c)}function k(){function E(c,C,M,L,V){var W=c[C];if(!i(W)){var H=ne(W);return new x("Invalid "+L+" `"+V+"` of type "+("`"+H+"` supplied to `"+M+"`, expected a single ReactElement."))}return null}return R(E)}function u(){function E(c,C,M,L,V){var W=c[C];if(!e.isValidElementType(W)){var H=ne(W);return new x("Invalid "+L+" `"+V+"` of type "+("`"+H+"` supplied to `"+M+"`, expected a single ReactElement type."))}return null}return R(E)}function y(E){function c(C,M,L,V,W){if(!(C[M]instanceof E)){var H=E.name||d,U=ae(C[M]);return new x("Invalid "+V+" `"+W+"` of type "+("`"+U+"` supplied to `"+L+"`, expected ")+("instance of `"+H+"`."))}return null}return R(c)}function g(E){if(!Array.isArray(E))return process.env.NODE_ENV!=="production"&&(arguments.length>1?a("Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z])."):a("Invalid argument supplied to oneOf, expected an array.")),o;function c(C,M,L,V,W){for(var H=C[M],U=0;U<E.length;U++)if(P(H,E[U]))return null;var K=JSON.stringify(E,function(se,N){var ie=Y(N);return ie==="symbol"?String(N):N});return new x("Invalid "+V+" `"+W+"` of value `"+String(H)+"` "+("supplied to `"+L+"`, expected one of "+K+"."))}return R(c)}function T(E){function c(C,M,L,V,W){if(typeof E!="function")return new x("Property `"+W+"` of component `"+L+"` has invalid PropType notation inside objectOf.");var H=C[M],U=ne(H);if(U!=="object")return new x("Invalid "+V+" `"+W+"` of type "+("`"+U+"` supplied to `"+L+"`, expected an object."));for(var K in H)if(n(H,K)){var X=E(H,K,L,V,W+"."+K,r);if(X instanceof Error)return X}return null}return R(c)}function I(E){if(!Array.isArray(E))return process.env.NODE_ENV!=="production"&&a("Invalid argument supplied to oneOfType, expected an instance of array."),o;for(var c=0;c<E.length;c++){var C=E[c];if(typeof C!="function")return a("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+q(C)+" at index "+c+"."),o}function M(L,V,W,H,U){for(var K=[],X=0;X<E.length;X++){var se=E[X],N=se(L,V,W,H,U,r);if(N==null)return null;N.data&&n(N.data,"expectedType")&&K.push(N.data.expectedType)}var ie=K.length>0?", expected one of type ["+K.join(", ")+"]":"";return new x("Invalid "+H+" `"+U+"` supplied to "+("`"+W+"`"+ie+"."))}return R(M)}function G(){function E(c,C,M,L,V){return B(c[C])?null:new x("Invalid "+L+" `"+V+"` supplied to "+("`"+M+"`, expected a ReactNode."))}return R(E)}function j(E,c,C,M,L){return new x((E||"React class")+": "+c+" type `"+C+"."+M+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+L+"`.")}function $(E){function c(C,M,L,V,W){var H=C[M],U=ne(H);if(U!=="object")return new x("Invalid "+V+" `"+W+"` of type `"+U+"` "+("supplied to `"+L+"`, expected `object`."));for(var K in E){var X=E[K];if(typeof X!="function")return j(L,V,W,K,Y(X));var se=X(H,K,L,V,W+"."+K,r);if(se)return se}return null}return R(c)}function Z(E){function c(C,M,L,V,W){var H=C[M],U=ne(H);if(U!=="object")return new x("Invalid "+V+" `"+W+"` of type `"+U+"` "+("supplied to `"+L+"`, expected `object`."));var K=t({},C[M],E);for(var X in K){var se=E[X];if(n(E,X)&&typeof se!="function")return j(L,V,W,X,Y(se));if(!se)return new x("Invalid "+V+" `"+W+"` key `"+X+"` supplied to `"+L+"`.\nBad object: "+JSON.stringify(C[M],null,"  ")+`
Valid keys: `+JSON.stringify(Object.keys(E),null,"  "));var N=se(H,X,L,V,W+"."+X,r);if(N)return N}return null}return R(c)}function B(E){switch(typeof E){case"number":case"string":case"undefined":return!0;case"boolean":return!E;case"object":if(Array.isArray(E))return E.every(B);if(E===null||i(E))return!0;var c=p(E);if(c){var C=c.call(E),M;if(c!==E.entries){for(;!(M=C.next()).done;)if(!B(M.value))return!1}else for(;!(M=C.next()).done;){var L=M.value;if(L&&!B(L[1]))return!1}}else return!1;return!0;default:return!1}}function oe(E,c){return E==="symbol"?!0:c?c["@@toStringTag"]==="Symbol"||typeof Symbol=="function"&&c instanceof Symbol:!1}function ne(E){var c=typeof E;return Array.isArray(E)?"array":E instanceof RegExp?"object":oe(c,E)?"symbol":c}function Y(E){if(typeof E>"u"||E===null)return""+E;var c=ne(E);if(c==="object"){if(E instanceof Date)return"date";if(E instanceof RegExp)return"regexp"}return c}function q(E){var c=Y(E);switch(c){case"array":case"object":return"an "+c;case"boolean":case"date":case"regexp":return"a "+c;default:return c}}function ae(E){return!E.constructor||!E.constructor.name?d:E.constructor.name}return _.checkPropTypes=s,_.resetWarningCache=s.resetWarningCache,_.PropTypes=_,_},ut}var dt,Ht;function Zn(){if(Ht)return dt;Ht=1;var e=it();function t(){}function r(){}return r.resetWarningCache=t,dt=function(){function n(o,i,m,l,f,p){if(p!==e){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}n.isRequired=n;function s(){return n}var a={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:s,element:n,elementType:n,instanceOf:s,node:n,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:r,resetWarningCache:t};return a.PropTypes=a,a},dt}var Bt;function Yn(){if(Bt)return De.exports;if(Bt=1,process.env.NODE_ENV!=="production"){var e=Nt(),t=!0;De.exports=Wn()(e.isElement,t)}else De.exports=Zn()();return De.exports}var Vn=Yn();const A=Cn(Vn),ft={"7.5pt":{pt:7.5,px:10,label:"7.5"},"9pt":{pt:9,px:12,label:"9"},"10pt":{pt:10,px:13,label:"10"},"11pt":{pt:11,px:15,label:"11"},"12pt":{pt:12,px:16,label:"12"},"14pt":{pt:14,px:19,label:"14"},"16pt":{pt:16,px:21,label:"16"},"18pt":{pt:18,px:24,label:"18"},"20pt":{pt:20,px:27,label:"20"},"22pt":{pt:22,px:29,label:"22"},"24pt":{pt:24,px:32,label:"24"},"26pt":{pt:26,px:35,label:"26"},"28pt":{pt:28,px:37,label:"28"},"36pt":{pt:36,px:48,label:"36"},"48pt":{pt:48,px:64,label:"48"},"72pt":{pt:72,px:96,label:"72"}},$t=[{value:"10px",label:"7.5",pt:7.5},{value:"12px",label:"9",pt:9},{value:"13px",label:"10",pt:10},{value:"15px",label:"11",pt:11},{value:"16px",label:"12",pt:12},{value:"19px",label:"14",pt:14},{value:"21px",label:"16",pt:16},{value:"24px",label:"18",pt:18},{value:"27px",label:"20",pt:20},{value:"32px",label:"24",pt:24},{value:"37px",label:"28",pt:28},{value:"48px",label:"36",pt:36},{value:"64px",label:"48",pt:48},{value:"96px",label:"72",pt:72}],Pe="16px",zt=e=>Math.round(e*96/72),Ft=e=>Math.round(e*72/96*2)/2,Kn=e=>{const t=Object.values(ft).find(r=>r.pt===e);return t?`${t.px}px`:`${zt(e)}px`},Xn=e=>{const t=parseInt(e),r=Object.values(ft).find(n=>n.px===t);return r?r.pt:Ft(t)},Jn=e=>{if(!e)return!1;if(e.endsWith("px")){const t=parseInt(e);return t>=8&&t<=144}if(e.endsWith("pt")){const t=parseFloat(e);return t>=6&&t<=108}return!1},fe={minWidth:50,minHeight:50,maxWidth:800,maxHeight:600,aspectRatio:!0,preserveAspectRatio:!0,defaultWidth:300,defaultHeight:200},w={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP:"top",BOTTOM:"bottom",LEFT:"left",RIGHT:"right"};function Qn({handler:e,startX:t,startY:r,currentX:n,currentY:s,startWidth:a,startHeight:o,options:i=fe}){const m=n-t,l=s-r;let f=a,p=o;switch(e){case w.TOP_LEFT:f=Math.max(i.minWidth,a-m),p=Math.max(i.minHeight,o-l);break;case w.TOP_RIGHT:f=Math.max(i.minWidth,a+m),p=Math.max(i.minHeight,o-l);break;case w.BOTTOM_LEFT:f=Math.max(i.minWidth,a-m),p=Math.max(i.minHeight,o+l);break;case w.BOTTOM_RIGHT:f=Math.max(i.minWidth,a+m),p=Math.max(i.minHeight,o+l);break;case w.TOP:p=Math.max(i.minHeight,o-l);break;case w.BOTTOM:p=Math.max(i.minHeight,o+l);break;case w.LEFT:f=Math.max(i.minWidth,a-m);break;case w.RIGHT:f=Math.max(i.minWidth,a+m);break;default:return{width:f,height:p}}if(i.preserveAspectRatio&&i.aspectRatio){const d=a/o;[w.TOP_LEFT,w.TOP_RIGHT,w.BOTTOM_LEFT,w.BOTTOM_RIGHT].includes(e)?f/d>p?p=Math.max(i.minHeight,f/d):f=Math.max(i.minWidth,p*d):[w.TOP,w.BOTTOM].includes(e)?f=p*d:[w.LEFT,w.RIGHT].includes(e)&&(p=f/d)}return i.maxWidth&&f>i.maxWidth&&(f=i.maxWidth,i.preserveAspectRatio&&i.aspectRatio&&(p=f/(a/o))),i.maxHeight&&p>i.maxHeight&&(p=i.maxHeight,i.preserveAspectRatio&&i.aspectRatio&&(f=p*(a/o))),f=Math.max(i.minWidth,f),p=Math.max(i.minHeight,p),{width:Math.round(f),height:Math.round(p)}}function de(e){return e?!!(e.tagName==="IMG"||e.tagName==="DIV"&&e.style.backgroundImage&&e.style.backgroundImage!=="none"):!1}function er(e){return de(e)?{width:e.offsetWidth,height:e.offsetHeight}:{width:0,height:0}}function tr(e,{width:t,height:r}){de(e)&&(e.tagName==="IMG"?(e.style.width=`${t}px`,e.style.height=`${r}px`,e.width=t,e.height=r):e.tagName==="DIV"&&(e.style.width=`${t}px`,e.style.height=`${r}px`))}function pt(e,t=fe){if(!de(e))return null;const r=document.createElement("div");r.className="image-resize-overlay",r.style.position="fixed",r.style.zIndex="1000",r.style.pointerEvents="none";const n=e.getBoundingClientRect();return r.style.top=`${n.top}px`,r.style.left=`${n.left}px`,r.style.width=`${n.width}px`,r.style.height=`${n.height}px`,Object.values(w).forEach(a=>{const o=document.createElement("div");o.className=`resize-handler resize-handler-${a}`,o.dataset.handler=a,o.style.position="absolute",o.style.width="10px",o.style.height="10px",o.style.backgroundColor="#007bff",o.style.border="2px solid white",o.style.borderRadius="50%",o.style.boxShadow="0 0 3px rgba(0,0,0,0.3)",o.style.cursor=nr(a),o.style.pointerEvents="all",Ut(o,a,n.width,n.height),r.appendChild(o)}),r}function nr(e){switch(e){case w.TOP_LEFT:case w.BOTTOM_RIGHT:return"nwse-resize";case w.TOP_RIGHT:case w.BOTTOM_LEFT:return"nesw-resize";case w.TOP:case w.BOTTOM:return"ns-resize";case w.LEFT:case w.RIGHT:return"ew-resize";default:return"default"}}function Ut(e,t,r,n){switch(t){case w.TOP_LEFT:e.style.top="-5px",e.style.left="-5px";break;case w.TOP_RIGHT:e.style.top="-5px",e.style.right="-5px";break;case w.BOTTOM_LEFT:e.style.bottom="-5px",e.style.left="-5px";break;case w.BOTTOM_RIGHT:e.style.bottom="-5px",e.style.right="-5px";break;case w.TOP:e.style.top="-5px",e.style.left=`${r/2+-5}px`;break;case w.BOTTOM:e.style.bottom="-5px",e.style.left=`${r/2+-5}px`;break;case w.LEFT:e.style.top=`${n/2+-5}px`,e.style.left="-5px";break;case w.RIGHT:e.style.top=`${n/2+-5}px`,e.style.right="-5px";break}}function ke(e,t){if(!e||!t)return;const r=t.getBoundingClientRect();e.style.top=`${r.top}px`,e.style.left=`${r.left}px`,e.style.width=`${r.width}px`,e.style.height=`${r.height}px`,e.querySelectorAll(".resize-handler").forEach(s=>{const a=s.dataset.handler;Ut(s,a,r.width,r.height)})}function ye(e){e&&e.parentNode&&e.parentNode.removeChild(e)}const rr={"10px":"1","12px":"2","13px":"2","15px":"3","16px":"3","19px":"4","21px":"4","24px":"5","27px":"5","32px":"6","37px":"6","48px":"6","64px":"7","96px":"7"},Gt={bold:!1,italic:!1,underline:!1,strikethrough:!1,alignLeft:!1,alignCenter:!1,alignRight:!1,alignJustify:!1,fontFamily:"Arial",fontSize:Pe,headingLevel:"p",imageSelected:!1,imageResizeOptions:fe,preserveAspectRatio:!0},qt=()=>{const[e,t]=h.useState(Gt),r=Ee(),n=h.useCallback(v=>{try{const S=window.getSelection();if(!S||S.rangeCount===0)return!1;const O=S.getRangeAt(0);if(!O.toString())return t(u=>({...u,fontFamily:v})),!1;try{const u=document.createElement("span");u.style.fontFamily=v;const y=O.extractContents();return u.appendChild(y),O.insertNode(u),O.selectNodeContents(u),S.removeAllRanges(),S.addRange(O),t(g=>({...g,fontFamily:v})),!0}catch{return document.execCommand("fontName",!1,v),t(y=>({...y,fontFamily:v})),!0}}catch(S){return console.warn("[useFormatting] Font family change failed:",S),!1}},[]),s=h.useCallback(v=>{try{const S=window.getSelection();if(!S||S.rangeCount===0)return!1;const O=S.getRangeAt(0);if(!O.toString())return t(u=>({...u,fontSize:v})),!1;try{const u=document.createElement("span");u.style.fontSize=v;const y=O.extractContents();return u.appendChild(y),O.insertNode(u),O.selectNodeContents(u),S.removeAllRanges(),S.addRange(O),t(g=>({...g,fontSize:v})),!0}catch{const y=rr[v]||"3";return document.execCommand("fontSize",!1,y),t(g=>({...g,fontSize:v})),!0}}catch(S){return console.warn("[useFormatting] Font size change failed:",S),!1}},[]),a=h.useCallback(v=>{try{const S=window.getSelection();if(!S||S.rangeCount===0)return!1;const O=S.getRangeAt(0),k=O.toString(),y={justifyLeft:"left",justifyCenter:"center",justifyRight:"right",justifyFull:"justify"}[v];if(!y)return!1;if(!k){const T=O.startContainer,I=T.nodeType===Node.TEXT_NODE?T.parentElement:T,G=He(I)||ar();return G&&(G.style.textAlign=y,o(y)),!0}const g=or(O);if(g.length===0){const T=document.createElement("p");T.style.textAlign=y;const I=O.extractContents();T.appendChild(I),O.insertNode(T),O.selectNodeContents(T),S.removeAllRanges(),S.addRange(O)}else g.forEach(T=>{T.style.textAlign=y});return o(y),!0}catch(S){return console.warn("[useFormatting] Text alignment failed:",S),!1}},[]),o=h.useCallback(v=>{t(S=>({...S,alignLeft:v==="left",alignCenter:v==="center",alignRight:v==="right",alignJustify:v==="justify"}))},[]),i=h.useCallback((v,S=null)=>{try{if(v==="undo"){r.undo();return}if(v==="redo"){r.redo();return}if(typeof document.execCommand!="function"){console.warn("[useFormatting] execCommand not supported");return}if(v==="fontSize"){s(S);return}if(v==="fontName"){n(S);return}if(["justifyLeft","justifyCenter","justifyRight","justifyFull"].includes(v)){a(v);return}switch(document.execCommand(v,!1,S)||console.warn(`[useFormatting] Command "${v}" failed`),v){case"bold":case"italic":case"underline":case"strikethrough":case"justifyLeft":case"justifyCenter":case"justifyRight":case"justifyFull":case"fontName":break;case"formatBlock":t(k=>({...k,headingLevel:S}));break;default:break}}catch(O){console.warn(`[useFormatting] Error executing command "${v}":`,O)}},[s,n,r]),m=h.useRef(null),l=h.useRef(null),f=h.useRef(null),p=h.useRef(null),d=h.useRef(fe);h.useCallback(v=>{if(!de(v))return;m.current&&(ye(m.current),m.current=null),v.classList.add("selected");const S=pt(v);S&&(m.current=S,l.current=v,document.body.appendChild(S),t(O=>({...O,imageSelected:!0,preserveAspectRatio:d.current.preserveAspectRatio})))},[]);const _=h.useCallback(()=>{l.current&&(l.current.classList.remove("selected"),l.current=null),m.current&&(ye(m.current),m.current=null),f.current=null,p.current=null,t(v=>({...v,imageSelected:!1}))},[]),P=h.useCallback(()=>{const v=!d.current.preserveAspectRatio;d.current={...d.current,preserveAspectRatio:v,aspectRatio:v},t(S=>({...S,preserveAspectRatio:v}))},[]);h.useCallback((v,S,O)=>{l.current&&(f.current={x:S,y:O,width:l.current.offsetWidth,height:l.current.offsetHeight},p.current=v,document.body.classList.add("resize-in-progress"),document.body.style.cursor=sr(v))},[]),h.useCallback((v,S)=>{if(!l.current||!f.current||!p.current)return;const{x:O,y:k,width:u,height:y}=f.current,g=p.current,T=ir({handler:g,startX:O,startY:k,currentX:v,currentY:S,startWidth:u,startHeight:y,options:d.current});cr(l.current,T),m.current&&ke(m.current,l.current)},[]),h.useCallback(()=>{if(f.current=null,p.current=null,document.body.classList.remove("resize-in-progress"),document.body.style.cursor="",l.current){const v=new Event("input",{bubbles:!0,cancelable:!0});l.current.dispatchEvent(v)}},[]);const x=h.useCallback(()=>{try{const v=window.getSelection();if(!v||v.rangeCount===0)return;const S=v.getRangeAt(0),O=S.toString();let k=Pe,u="Arial",y="p",g="left";if(O){const I=S.startContainer,G=I.nodeType===Node.TEXT_NODE?I.parentElement:I;if(G){const j=window.getComputedStyle(G),$=j.fontSize,Z=j.fontFamily;$&&$.endsWith("px")&&(k=$),Z&&Z!=="serif"&&(u=Z.split(",")[0].replace(/['"]/g,"").trim());const B=He(G);if(B){const oe=B.tagName?.toLowerCase();["h1","h2","h3","h4","h5","h6","p"].includes(oe)&&(y=oe);const Y=window.getComputedStyle(B).textAlign;["left","center","right","justify"].includes(Y)&&(g=Y)}}}const T={bold:document.queryCommandState("bold"),italic:document.queryCommandState("italic"),underline:document.queryCommandState("underline"),strikethrough:document.queryCommandState("strikethrough"),alignLeft:g==="left",alignCenter:g==="center",alignRight:g==="right",alignJustify:g==="justify",fontFamily:u,fontSize:k,headingLevel:y};t(I=>({...I,...T}))}catch(v){console.warn("[useFormatting] Error updating format from selection:",v)}},[]),R=h.useCallback(()=>{_(),t(Gt)},[_]);return h.useEffect(()=>()=>{m.current&&ye(m.current)},[]),{currentFormat:e,formatText:i,resetFormat:R,updateCurrentFormatFromSelection:x,toggleAspectRatio:P}};function He(e){let t=e;for(;t&&t!==document.body;){const r=t.tagName?.toLowerCase();if(["h1","h2","h3","h4","h5","h6","p"].includes(r))return t;if(t.contentEditable==="true"||t.contentEditable==="")break;t=t.parentElement}return null}function or(e){const t=[],r=e.startContainer,n=e.endContainer,s=He(r.nodeType===Node.TEXT_NODE?r.parentElement:r),a=He(n.nodeType===Node.TEXT_NODE?n.parentElement:n);if(s===a&&s)return[s];const o=document.createTreeWalker(e.commonAncestorContainer,NodeFilter.SHOW_ELEMENT,{acceptNode:m=>{const l=m.tagName?.toLowerCase();return["h1","h2","h3","h4","h5","h6","p"].includes(l)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});let i=o.nextNode();for(;i;)e.intersectsNode(i)&&t.push(i),i=o.nextNode();return t}function ar(){try{const e=window.getSelection();if(!e||e.rangeCount===0)return null;const t=e.getRangeAt(0),r=document.createElement("p");return r.innerHTML="<br>",t.insertNode(r),t.selectNodeContents(r),t.collapse(!0),e.removeAllRanges(),e.addRange(t),r}catch(e){return console.warn("[useFormatting] Failed to create paragraph at cursor:",e),null}}function sr(e){switch(e){case w.TOP_LEFT:case w.BOTTOM_RIGHT:return"nwse-resize";case w.TOP_RIGHT:case w.BOTTOM_LEFT:return"nesw-resize";case RESIZE_HANDLRES.TOP:case w.BOTTOM:return"ns-resize";case w.LEFT:case w.RIGHT:return"ew-resize";default:return"default"}}function ir({handler:e,startX:t,startY:r,currentX:n,currentY:s,startWidth:a,startHeight:o,options:i=fe}){const m=n-t,l=s-r;let f=a,p=o;switch(e){case w.TOP_LEFT:f=Math.max(i.minWidth,a-m),p=Math.max(i.minHeight,o-l);break;case w.TOP_RIGHT:f=Math.max(i.minWidth,a+m),p=Math.max(i.minHeight,o-l);break;case w.BOTTOM_LEFT:f=Math.max(i.minWidth,a-m),p=Math.max(i.minHeight,o+l);break;case w.BOTTOM_RIGHT:f=Math.max(i.minWidth,a+m),p=Math.max(i.minHeight,o+l);break;case w.TOP:p=Math.max(i.minHeight,o-l);break;case w.BOTTOM:p=Math.max(i.minHeight,o+l);break;case w.LEFT:f=Math.max(i.minWidth,a-m);break;case w.RIGHT:f=Math.max(i.minWidth,a+m);break;default:return{width:f,height:p}}if(i.preserveAspectRatio&&i.aspectRatio){const d=a/o;[w.TOP_LEFT,w.TOP_RIGHT,w.BOTTOM_LEFT,w.BOTTOM_RIGHT].includes(e)?f/d>p?p=Math.max(i.minHeight,f/d):f=Math.max(i.minWidth,p*d):[w.TOP,w.BOTTOM].includes(e)?f=p*d:[w.LEFT,w.RIGHT].includes(e)&&(p=f/d)}return i.maxWidth&&f>i.maxWidth&&(f=i.maxWidth,i.preserveAspectRatio&&i.aspectRatio&&(p=f/(a/o))),i.maxHeight&&p>i.maxHeight&&(p=i.maxHeight,i.preserveAspectRatio&&i.aspectRatio&&(f=p*(a/o))),f=Math.max(i.minWidth,f),p=Math.max(i.minHeight,p),{width:Math.round(f),height:Math.round(p)}}function cr(e,{width:t,height:r}){de(e)&&(e.tagName==="IMG"?(e.style.width=`${t}px`,e.style.height=`${r}px`,e.width=t,e.height=r):e.tagName==="DIV"&&(e.style.width=`${t}px`,e.style.height=`${r}px`))}const ge='page-break, [data-page-break="true"]',Wt=e=>ce[e]||ce.A4,lr=(e,t={})=>{if(!e||typeof document>"u")return[];const r=t.pageSize||"A4",n=Wt(r),s=e.querySelectorAll(ge),a=[];a.push({id:"page-0",pageNumber:1,top:0,height:n.height});const o=e.getBoundingClientRect(),i=e.scrollTop;return s.forEach((m,l)=>{const p=m.getBoundingClientRect().top-o.top+i;a.push({id:`page-${l+1}`,pageNumber:l+2,top:p,height:n.height})}),a},Zt=(e,t=100,r=pe)=>{const n=Wt(e),s=In(r),a=n.height-s,o=t/100;return a/o},ur=(e,t)=>{if(!e||!t)return 0;try{const r=t.querySelectorAll(ge);if(r.length===0)return 0;const n=e.getBoundingClientRect(),s=n.top+n.height/2;for(let a=r.length-1;a>=0;a--)if(r[a].getBoundingClientRect().top<s)return a+1;return 0}catch(r){return console.warn("[getCurrentPage] Failed to calculate page:",r),0}},Yt=e=>{if(!e)return[];const t=Array.from(e.children);if(t.length===0)return[];let r=[],n=[];for(const s of t)s.tagName==="PAGE-BREAK"||s.getAttribute("data-page-break")==="true"?n.length>0&&(r.push(n),n=[]):n.push(s);return n.length>0&&r.push(n),r.length===0&&t.length>0&&r.push(t.filter(s=>!(s.tagName==="PAGE-BREAK"||s.getAttribute("data-page-break")==="true"))),r},dr=e=>{if(!e||!e.getBoundingClientRect)return 0;const t=e.getBoundingClientRect();if(e.tagName==="P"){const r=e.querySelectorAll("img"),n=e.textContent.trim();if(r.length===1&&!n){const a=r[0].getBoundingClientRect(),i=window.getComputedStyle(e).textAlign;if(i==="center"||i==="-webkit-center")return a.height+16}return t.height+16}return e.tagName==="H1"||e.tagName==="H2"||e.tagName==="H3"||e.tagName==="H4"||e.tagName==="H5"||e.tagName==="H6"?t.height+20:e.tagName==="UL"||e.tagName==="OL"?t.height+16:t.height},fr=(e,t)=>{if(!e)return!1;try{const r=document.createElement("page-break");return r.setAttribute("data-page-break","true"),r.setAttribute("contenteditable","false"),r.setAttribute("data-page-number",t||"2"),e.parentNode.insertBefore(r,e),!0}catch(r){return console.warn("[insertPageBreakBefore] Failed to insert page break:",r),!1}},pr=(e,t,r,n,s,a,o)=>{if(!e)return!1;try{const m=Zt(r,n,s)*(t-1),l=Array.from(e.children);let f=0,p=null;for(let d=0;d<l.length;d++){const _=l[d];if(_.tagName==="PAGE-BREAK"||_.getAttribute("data-page-break")==="true")continue;const P=dr(_);if(f+P>m){p=_;break}f+=P}if(p){const d=document.createElement("page-break");if(d.setAttribute("data-page-break","true"),d.setAttribute("contenteditable","false"),d.setAttribute("data-page-number",String(t)),p.parentNode.insertBefore(d,p),a){const _=e.innerHTML;a(_)}return o&&setTimeout(()=>{o()},50),!0}else{const d=document.createElement("page-break");d.setAttribute("data-page-break","true"),d.setAttribute("contenteditable","false"),d.setAttribute("data-page-number",String(t)),e.appendChild(d);const _=document.createElement("p");if(_.innerHTML="<br>",e.appendChild(_),a){const P=e.innerHTML;a(P)}return o&&setTimeout(()=>{o()},50),!0}}catch(i){return console.error("[insertPageBreakAtBoundary] Failed to insert page break:",i),!1}},gr=(e,t,r,n,s,a,o)=>{if(!e)return!1;if(r().length<=1)return console.warn("[removePageAndContent] Cannot delete the only page"),!1;try{const m=Array.from(e.querySelectorAll(ge));if(t>m.length)return console.warn("[removePageAndContent] Invalid page index"),!1;const l=window.getSelection();let f=!1,p=[],d=null;if(t===0){const P=m[0];if(!P)return console.warn("[removePageAndContent] No page break found for first page"),!1;let x=e.firstChild;for(;x&&x!==P;)p.push(x),x=x.nextSibling;d=P}else{const P=m[t-1];if(!P)return console.warn("[removePageAndContent] Page break not found"),!1;const x=m[t];let R=P.nextSibling;for(;R&&R!==x;)p.push(R),R=R.nextSibling;d=P}if(l&&l.rangeCount>0){const x=l.getRangeAt(0).startContainer;for(const R of p)if(R.contains(x)||R===x){f=!0;break}}if(d&&d.parentNode&&d.remove(),p.forEach(P=>{P.parentNode&&P.remove()}),e.querySelectorAll(ge).forEach((P,x)=>{P.setAttribute("data-page-number",String(x+2))}),f&&a&&setTimeout(()=>{a(0)},50),n){const P=e.innerHTML;n(P)}return s&&setTimeout(()=>{s(),o&&setTimeout(()=>{o()},150)},100),!0}catch(m){return console.error("[removePageAndContent] Failed to remove page:",m),!1}},hr=e=>{if(e)try{e.querySelectorAll(ge).forEach((r,n)=>{r.setAttribute("data-page-number",String(n+2))})}catch(t){console.error("[renumberPageBreaks] Failed to renumber page breaks:",t)}},mr=(e,t,r,n,s)=>{if(!e||!t)return!1;try{if(e.remove(),hr(t),r){const a=t.innerHTML;r(a)}return n&&setTimeout(()=>{n(),s&&setTimeout(()=>{s()},100)},50),!0}catch(a){return console.error("[removePageBreak] Failed to remove page break:",a),!1}},yr=200,br=50,Vt=3,Er=20,Kt=e=>{if(!e||!e.getBoundingClientRect)return 0;const t=e.getBoundingClientRect();if(e.tagName==="P"){const r=e.querySelectorAll("img"),n=e.textContent.trim();if(r.length===1&&!n){const a=r[0].getBoundingClientRect(),i=window.getComputedStyle(e).textAlign;if(i==="center"||i==="-webkit-center")return a.height+16}return t.height+16}return e.tagName==="H1"||e.tagName==="H2"||e.tagName==="H3"||e.tagName==="H4"||e.tagName==="H5"||e.tagName==="H6"?t.height+20:e.tagName==="UL"||e.tagName==="OL"?t.height+16:t.height},Tr=(e,t)=>{if(!e||e.length===0)return null;let r=0,n=null;for(let s=0;s<e.length;s++){const a=e[s];if(!a||!a.getBoundingClientRect)continue;const o=Kt(a);if(o<1)continue;if(r+o>t)return n===null?s>0?{overflowIndex:s,overflowElement:a,accumulatedHeight:r}:null:{overflowIndex:s,overflowElement:a,accumulatedHeight:r};r+=o,n=a}return null},vr=(e,t,r,n,s,a,o,i)=>{if(!e||o.current)return!1;try{o.current=!0;const m=Zt(t,r,n);let l=Yt(e),f=!1,p=0;for(let d=0;d<l.length&&p<Vt;d++){const _=l[d],P=Tr(_,m);if(P&&P.overflowIndex>0){let x=0;for(let O=0;O<_.length;O++){const k=_[O];k&&k.getBoundingClientRect&&(x+=Kt(k))}if(x-m<Er)continue;const v=d+2;fr(P.overflowElement,v)&&(f=!0,p++,l=Yt(e))}}if(f){if(s){const d=e.innerHTML;s(d)}setTimeout(()=>{a&&a(),p>=Vt&&i&&setTimeout(()=>{o.current||i()},100)},br)}return f}catch(m){return console.warn("[checkAndReflow] Reflow failed:",m),!1}finally{o.current=!1}},xr=(e,t,r=yr)=>{t.current&&clearTimeout(t.current),t.current=setTimeout(()=>{t.current=null,e()},r)},Ar=400,Xt=(e,t)=>{if(e){e.focus();try{let r=null,n=0;if(t===0)r=e.firstChild,n=0;else{const a=e.querySelectorAll(ge)[t-1];a&&a.nextSibling&&(r=a.nextSibling,n=0)}if(r){const s=document.createRange(),a=window.getSelection();r.nodeType===Node.TEXT_NODE?s.setStart(r,n):s.setStart(r,0),s.collapse(!0),a.removeAllRanges(),a.addRange(s)}}catch(r){console.warn("[positionCursorAtPage] Failed to position cursor:",r)}}},_r=(e,t,r,n)=>{if(!e||!t){console.warn("[scrollToPage] Missing refs");return}try{let s=null;if(r===0)s=t;else{const o=t.querySelectorAll(ge)[r-1];if(o)s=o;else{console.warn("[scrollToPage] Page break not found for page",r);return}}if(s){const a=s.getBoundingClientRect(),o=e.getBoundingClientRect(),i=e.scrollTop+(a.top-o.top);e.scrollTo({top:i,behavior:"smooth"}),setTimeout(()=>{n?n(r):Xt(t,r)},Ar)}}catch(s){console.error("[scrollToPage] Error:",s)}},Pr=(e,t,r={},n=300)=>{t.current&&clearTimeout(t.current),t.current=setTimeout(()=>{t.current=null,e(r)},Math.max(0,n))},kr=e=>{if(!e)return null;const t=window.getSelection();if(t.rangeCount===0)return null;const r=t.getRangeAt(0);if(!e.contains(r.commonAncestorContainer))return null;let n=1;const s=e.querySelectorAll(ge);for(const f of s)if(r.comparePoint(f,0)>0)n++;else break;const a=document.createRange();a.setStart(e,0),a.setEnd(r.startContainer,r.startOffset);const i=a.toString().replace(/<[^>]*>/g," ").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/\s+/g," ").trim(),m=i.length,l=(i.match(/\n/g)||[]).length+1;return{page:n,line:l,charOffset:m}},Sr=300,Jt=(e,t,r=100,n="NARROW")=>{const s=Ee(),a=h.useRef(null),o=h.useRef(null),i=h.useRef(e),m=h.useRef(r),l=h.useRef(n),f=h.useRef(!1);h.useEffect(()=>{i.current=e},[e]),h.useEffect(()=>{m.current=r},[r]),h.useEffect(()=>{l.current=n},[n]),h.useEffect(()=>()=>{a.current&&clearTimeout(a.current),o.current&&clearTimeout(o.current)},[]);const p=h.useCallback((y={})=>t?.current?lr(t.current,y):[],[t]),d=h.useCallback((y={})=>{const g=p(y);return s.updatePageBoundaries(g),g},[p,s]),_=h.useCallback(async y=>{if(!t?.current)return!1;const g=i.current||"A4",T=m.current||100,I=l.current||"NARROW";return pr(t.current,y,g,T,I,s.updateContinuousContent,d)},[t,s,d]),P=h.useCallback(()=>{if(!t?.current)return;const y=i.current||"A4",g=m.current||100,T=l.current||"NARROW";vr(t.current,y,g,T,s.updateContinuousContent,d,f,P)},[t,s,d]),x=h.useCallback(y=>{xr(P,o,y)},[P]),R=h.useCallback((y={})=>{const g=typeof y.delay=="number"?y.delay:Sr;Pr(d,a,y,g)},[d]),v=h.useCallback(y=>!y?.current||!t?.current?0:ur(y.current,t.current),[t]),S=h.useCallback(y=>{t?.current&&Xt(t.current,y)},[t]),O=h.useCallback((y,g)=>{if(!g?.current||!t?.current){console.warn("[scrollToPage] Missing refs");return}_r(g.current,t.current,y,S)},[t,S]),k=h.useCallback(y=>t?.current?gr(t.current,y,p,s.updateContinuousContent,d,S,P):!1,[t,p,s,d,S,P]),u=h.useCallback(y=>t?.current?mr(y,t.current,s.updateContinuousContent,d,P):!1,[t,s,d,P]);return{calculatePageBoundaries:p,checkAndUpdateBoundaries:R,updateBoundaries:d,getCurrentPage:v,scrollToPage:O,positionCursorAtPage:S,checkAndReflow:P,triggerAutoReflow:x,removePageAndContent:k,removePageBreak:u,insertPageBreakAtBoundary:_,boundaryTimeoutRef:a,reflowTimeoutRef:o}},wr="html-editor-storage",Cr=1,le="images";function Or(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function Se(){return new Promise((e,t)=>{const r=indexedDB.open(wr,Cr);r.onerror=()=>{t(new Error("Failed to open IndexedDB database"))},r.onsuccess=()=>{e(r.result)},r.onupgradeneeded=n=>{const s=n.target.result;s.objectStoreNames.contains(le)||s.createObjectStore(le,{keyPath:"key"}).createIndex("timestamp","timestamp",{unique:!1})}})}function Qt(e){return new Promise((t,r)=>{if(!["image/png","image/jpeg","image/gif","image/webp"].includes(e.type)){r(new Error("Invalid image format. Supported formats: png, jpeg, gif, webp"));return}if(e.size>5*1024*1024){r(new Error("Image exceeds maximum size of 5MB"));return}const s=new FileReader;s.onload=async a=>{const o=a.target.result,m=o.split(",")[1].length*3/4;if(m>5*1024*1024){r(new Error("Image exceeds maximum size of 5MB"));return}try{const l=await Se(),f=`editor-image-${Or()}`,d=l.transaction([le],"readwrite").objectStore(le),_={key:f,dataUrl:o,size:m,type:e.type,timestamp:Date.now()},P=d.add(_);P.onsuccess=()=>{l.close(),t(f)},P.onerror=()=>{l.close(),r(new Error("Failed to save image to IndexedDB"))}}catch(l){r(l)}},s.onerror=()=>{r(new Error("Error reading image file"))},s.readAsDataURL(e)})}async function en(e){try{const t=await Se();return new Promise((r,n)=>{const o=t.transaction([le],"readonly").objectStore(le).get(e);o.onsuccess=()=>{t.close();const i=o.result;r(i?i.dataUrl:null)},o.onerror=()=>{t.close(),n(new Error("Failed to retrieve image from IndexedDB"))}})}catch(t){return console.error("Error getting image:",t),null}}async function tn(e){try{const t=await Se();return new Promise((r,n)=>{const o=t.transaction([le],"readwrite").objectStore(le).delete(e);o.onsuccess=()=>{t.close(),r()},o.onerror=()=>{t.close(),n(new Error("Failed to delete image from IndexedDB"))}})}catch(t){console.error("Error deleting image:",t)}}async function Nr(){try{const e=await Se();return new Promise((t,r)=>{const a=e.transaction([le],"readwrite").objectStore(le).clear();a.onsuccess=()=>{e.close(),t()},a.onerror=()=>{e.close(),r(new Error("Failed to clear images from IndexedDB"))}})}catch(e){console.error("Error clearing images:",e)}}async function Mr(){try{const e=await Se();return new Promise((t,r)=>{const a=e.transaction([le],"readonly").objectStore(le).getAllKeys();a.onsuccess=()=>{e.close(),t(a.result||[])},a.onerror=()=>{e.close(),r(new Error("Failed to get image keys from IndexedDB"))}})}catch(e){return console.error("Error getting image keys:",e),[]}}const Rr=["SPAN","STRONG","EM","B","I","U","S","STRIKE","DEL","INS","SUB","SUP","MARK","SMALL","CODE","KBD","SAMP","VAR","A","ABBR","CITE","DFN","TIME"],Ir=["BR","HR","IMG","INPUT","PAGE-BREAK"];function Lr(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}function nn(e){const t=[];for(let r=0;r<e.attributes.length;r++){const n=e.attributes[r];t.push(` ${n.name}="${n.value}"`)}return t.join("")}function Be(e){if(!e||typeof e!="string")return"<p><br></p>";const t=e.trim();if(!t)return"<p><br></p>";const r=document.createElement("div");return r.innerHTML=t,we(r)||"<p><br></p>"}function Dr(e){const t=e.cloneNode(!0);return t.querySelectorAll(":scope > p").forEach(n=>{for(;n.firstChild;)t.insertBefore(n.firstChild,n);n.remove()}),t.innerHTML}function we(e){const t=[],r=Array.from(e.childNodes);for(let n=0;n<r.length;n++){const s=r[n];if(s.nodeType===Node.TEXT_NODE){const a=s.textContent.trim();a&&t.push(`<p>${Lr(a)}</p>`)}else if(s.nodeType===Node.ELEMENT_NODE){const a=s,o=a.tagName,i=o.toLowerCase(),m=nn(a);if(o==="DIV"){const l=we(a);l.trim()?t.push(l):t.push("<p><br></p>")}else if(o==="P")t.push(a.outerHTML);else if(["H1","H2","H3","H4","H5","H6"].includes(o)){const l=Dr(a);t.push(`<${i}${m}>${l}</${i}>`)}else if(o==="BR")t.push("<p><br></p>");else if(o==="IMG")t.push(a.outerHTML);else if(["UL","OL"].includes(o))t.push(jr(a));else if(o==="LI")t.push(a.outerHTML);else if(o==="TABLE")t.push(Hr(a));else if(["TBODY","THEAD","TFOOT","TR","TD","TH"].includes(o))t.push(a.outerHTML);else if(o==="BLOCKQUOTE"){const l=we(a);t.push(`<blockquote${m}>${l}</blockquote>`)}else if(o==="PRE")t.push(a.outerHTML);else if(Rr.includes(o))t.push(a.outerHTML);else if(o==="PAGE-BREAK"||a.getAttribute("data-page-break")==="true")t.push(a.outerHTML);else if(o==="HR")t.push(a.outerHTML);else if(o==="FIGURE")t.push(a.outerHTML);else if(Ir.includes(o))t.push(a.outerHTML);else{const l=we(a);t.push(`<${i}${m}>${l}</${i}>`)}}}return t.length===0?"":t.join("")}function jr(e){const t=e.tagName.toLowerCase(),r=nn(e),n=[];return Array.from(e.children).forEach(s=>{if(s.tagName==="LI")n.push(s.outerHTML);else{const a=we(s);a.trim()&&n.push(`<li>${a}</li>`)}}),n.length===0?`<${t}${r}><li><br></li></${t}>`:`<${t}${r}>${n.join("")}</${t}>`}function Hr(e){return e.outerHTML}/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Br=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),$r=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),rn=e=>{const t=$r(e);return t.charAt(0).toUpperCase()+t.slice(1)},on=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),zr=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Fr={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ur=h.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:o,...i},m)=>h.createElement("svg",{ref:m,...Fr,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:on("lucide",s),...!a&&!zr(i)&&{"aria-hidden":"true"},...i},[...o.map(([l,f])=>h.createElement(l,f)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=(e,t)=>{const r=h.forwardRef(({className:n,...s},a)=>h.createElement(Ur,{ref:a,iconNode:t,className:on(`lucide-${Br(rn(e))}`,`lucide-${e}`,n),...s}));return r.displayName=rn(e),r};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=J("bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qr=J("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wr=J("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zr=J("file-check",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=J("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yr=J("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vr=J("heading-1",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=J("heading-2",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xr=J("heading-3",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17.5 10.5c1.7-1 3.5 0 3.5 1.5a2 2 0 0 1-2 2",key:"68ncm8"}],["path",{d:"M17 17.5c2 1.5 4 .3 4-1.5a2 2 0 0 0-2-2",key:"1ejuhz"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=J("image-upscale",[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M17 21h2a2 2 0 0 0 2-2",key:"130fy9"}],["path",{d:"M21 12v3",key:"1wzk3p"}],["path",{d:"m21 3-5 5",key:"1g5oa7"}],["path",{d:"M3 7V5a2 2 0 0 1 2-2",key:"kk3yz1"}],["path",{d:"m5 21 4.144-4.144a1.21 1.21 0 0 1 1.712 0L13 19",key:"fyekpt"}],["path",{d:"M9 3h3",key:"d52fa"}],["rect",{x:"3",y:"11",width:"10",height:"10",rx:"1",key:"1wpmix"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qr=J("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eo=J("italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const to=J("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const no=J("list-indent-decrease",[["path",{d:"M21 5H11",key:"us1j55"}],["path",{d:"M21 12H11",key:"wd7e0v"}],["path",{d:"M21 19H11",key:"saa85w"}],["path",{d:"m7 8-4 4 4 4",key:"o5hrat"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=J("list-indent-increase",[["path",{d:"M21 5H11",key:"us1j55"}],["path",{d:"M21 12H11",key:"wd7e0v"}],["path",{d:"M21 19H11",key:"saa85w"}],["path",{d:"m3 8 4 4-4 4",key:"1a3j6y"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oo=J("list-ordered",[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=J("list",[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ao=J("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const so=J("redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const io=J("scaling",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M14 15H9v-5",key:"pi4jk9"}],["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M21 3 9 15",key:"15kdhq"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const co=J("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lo=J("strikethrough",[["path",{d:"M16 4H9a3 3 0 0 0-2.83 4",key:"43sutm"}],["path",{d:"M14 12a4 4 0 0 1 0 8H6",key:"nlfj13"}],["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uo=J("table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=J("text-align-center",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 19H5",key:"vjpgq2"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=J("text-align-end",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 19H7",key:"4cu937"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fo=J("text-align-justify",[["path",{d:"M3 5h18",key:"1u36vt"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 19h18",key:"awlh7x"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=J("text-align-start",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const po=J("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const go=J("underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ho=J("undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mo=J("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yo=J("zoom-in",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bo=J("zoom-out",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),un=(e,t,r="")=>{if(!e)return[];const n=document.createElement("div");n.innerHTML=e;const s=n.querySelectorAll("h1, h2, h3, h4, h5, h6");return Array.from(s).map((a,o)=>{const i=parseInt(a.tagName.charAt(1)),m=a.textContent.trim();return m?{id:`${r}heading-${o}`,level:i,text:m,page:t||1}:null}).filter(Boolean)},Eo=e=>{if(!e)return 0;const t=document.createElement("div");return t.innerHTML=e,(t.textContent||t.innerText||"").trim().split(/\s+/).filter(n=>n.length>0).length},dn=({isCollapsed:e,onToggle:t,wordCount:r,pageCount:n})=>{const s=ot(),{pages:a,activePage:o,continuousContent:i}=s,[m,l]=h.useState(0),[f,p]=h.useState([]);h.useEffect(()=>{if(r!==void 0&&n!==void 0){l(r),p(un(i,1,"continuous-"));return}let _=0;const P=[];a.forEach((x,R)=>{_+=Eo(x.content),P.push(...un(x.content,R+1,`page-${R}-`))}),l(_),p(P)},[a,r,n,i]);const d=n!==void 0?n:a.length;return b.jsxs("aside",{className:`sidebar ${e?"collapsed":""}`,role:"complementary","aria-label":"Document information","data-testid":"sidebar",children:[b.jsxs("div",{className:"sidebar-header",children:[b.jsxs("div",{className:"sidebar-title",children:[b.jsx($e,{size:18}),b.jsx("h2",{children:"Document Info"})]}),b.jsx("button",{className:"sidebar-toggle",onClick:t,"aria-label":e?"Expand sidebar":"Collapse sidebar",title:e?"Expand sidebar":"Collapse sidebar",children:e?b.jsx(Wr,{size:16}):b.jsx(qr,{size:16})})]}),!e&&b.jsxs("div",{className:"sidebar-content",children:[b.jsxs("div",{className:"sidebar-section",children:[b.jsx("h3",{children:"Statistics"}),b.jsxs("div",{className:"stat-item",children:[b.jsxs("div",{className:"stat-label",children:[b.jsx(Zr,{size:14}),b.jsx("span",{children:"Pages:"})]}),b.jsx("span",{className:"stat-value",children:d})]}),b.jsxs("div",{className:"stat-item","data-testid":"word-count",children:[b.jsxs("div",{className:"stat-label",children:[b.jsx(Yr,{size:14}),b.jsx("span",{children:"Words:"})]}),b.jsx("span",{className:"stat-value",children:m.toLocaleString()})]}),b.jsxs("div",{className:"stat-item",children:[b.jsxs("div",{className:"stat-label",children:[b.jsx($e,{size:14}),b.jsx("span",{children:"Active Page:"})]}),b.jsx("span",{className:"stat-value",children:o+1})]})]}),f.length>0&&b.jsxs("div",{className:"sidebar-section",children:[b.jsxs("h3",{children:[b.jsx(an,{size:14,style:{display:"inline-block",marginRight:"6px",verticalAlign:"middle"}}),"Document Outline"]}),b.jsx("div",{className:"document-outline","data-testid":"outline",children:f.map(_=>{const P=_.level===1?Vr:_.level===2?Kr:Xr;return b.jsxs("div",{className:`outline-item outline-level-${_.level}`,style:{marginLeft:`${(_.level-1)*12}px`},children:[b.jsx(P,{size:12,className:"outline-icon"}),b.jsx("span",{className:"outline-text",children:_.text}),b.jsxs("span",{className:"outline-page",children:["p.",_.page]})]},_.id)})})]})]})]})};class fn{constructor(t="Editor"){this.namespace=t}_format(t,r,n){return`[${new Date().toISOString()}] [${this.namespace}] [${t}] ${r}`}info(t,r){}warn(t,r){}error(t,r){}debug(t,r){}}const pn=new fn("Editor"),gn=new Set(["P","DIV","H1","H2","H3","H4","H5","H6","LI","BLOCKQUOTE","PRE","TABLE"]),hn=32;function mn(e,t){if(!e)return;e.dataset||(e.dataset={}),e.style||(e.style={});const r=parseInt(e.dataset.indentLevel||"0",10),n=Math.max(0,t?r-1:r+1);n===0?(e.style.marginLeft="",delete e.dataset.indentLevel):(e.style.marginLeft=`${n*hn}px`,e.dataset.indentLevel=String(n))}function To(e,t){mn(e,t)}function vo(e){let t=e;for(;t;){if(t.nodeType===1&&t.tagName&&gn.has(t.tagName.toUpperCase()))return t;t=t.parentElement||t.parentNode}return null}function xo(){const e=window.getSelection();if(!e||e.rangeCount===0)return[];const t=e.getRangeAt(0),r=new Set;let n=t.commonAncestorContainer;for(n.nodeType===Node.TEXT_NODE&&(n=n.parentElement);n&&n.contentEditable!=="true";)n=n.parentElement;return n?(n.querySelectorAll("p, div, h1, h2, h3, h4, h5, h6, li, blockquote, pre, table").forEach(o=>{document.createRange().selectNodeContents(o),t.intersectsNode(o)&&r.add(o)}),r.size===0&&n.querySelectorAll("img").forEach(i=>{if(document.createRange().selectNode(i),t.intersectsNode(i)){let l=i.parentElement;for(;l&&l!==n;){if(l.tagName&&gn.has(l.tagName.toUpperCase())){r.add(l);break}l=l.parentElement}}}),Array.from(r).filter(o=>{let i=o.parentElement;for(;i;){if(r.has(i))return!1;i=i.parentElement}return!0})):[]}function Ao(e){if(e.style&&e.style.marginLeft&&e.style.marginLeft!==""){const t=parseInt(e.dataset.indentLevel||"0",10),r=Math.max(0,t-1);r===0?(e.style.marginLeft="",delete e.dataset.indentLevel):(e.style.marginLeft=`${r*hn}px`,e.dataset.indentLevel=String(r));return}if(e.innerHTML.startsWith("&nbsp;&nbsp;&nbsp;&nbsp;")){e.innerHTML=e.innerHTML.replace(/^(&nbsp;){4}/,"");return}try{const t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null);let r=t.nextNode();for(;r;){const n=r.textContent;if(n.startsWith("")){r.textContent=n.substring(4);break}r=t.nextNode()}}catch{e.innerHTML=e.innerHTML.replace(/^(&nbsp;){4}/,"")}}function gt(e=!1){const t=window.getSelection();if(!t||t.rangeCount===0)return!1;let r=xo();const n=t.getRangeAt(0);if(r.length===0){const o=vo(n.startContainer);if(!o)return!1;r=[o]}const s=r[0],a=r[r.length-1];r.forEach(o=>{if((o.tagName?o.tagName.toUpperCase():"")==="LI"){To(o,e);return}e?Ao(o):mn(o,!1)});try{const o=document.createRange(),i=p=>p.nodeType===Node.TEXT_NODE?p:document.createTreeWalker(p,NodeFilter.SHOW_TEXT,null).nextNode(),m=p=>{if(p.nodeType===Node.TEXT_NODE)return p;const d=document.createTreeWalker(p,NodeFilter.SHOW_TEXT,null);let _=null,P=d.nextNode();for(;P;)_=P,P=d.nextNode();return _},l=i(s);l?o.setStart(l,0):o.setStart(s,0);const f=m(a);f?o.setEnd(f,f.length):o.setEnd(a,a.childNodes.length),t.removeAllRanges(),t.addRange(o)}catch{try{const i=document.createRange();i.setStartBefore(s),i.setEndAfter(a),t.removeAllRanges(),t.addRange(i)}catch(i){console.warn("Could not restore selection after indentation:",i)}}return!0}function _o(e){if(e.key!=="Tab")return!1;e.preventDefault();const t=e.shiftKey,r=window.getSelection(),n=r&&r.rangeCount>0?r.getRangeAt(0):null;return r&&r.rangeCount>0&&n&&!n.collapsed&&gt(t)||t||document.execCommand("insertHTML",!1,"&nbsp;&nbsp;&nbsp;&nbsp;"),!0}const Po=[{value:"Segoe UI",label:"Segoe UI"},{value:"Arial",label:"Arial"},{value:"Times New Roman",label:"Times New Roman"},{value:"Courier New",label:"Courier New"},{value:"Georgia",label:"Georgia"},{value:"Verdana",label:"Verdana"},{value:"Noto Sans Sinhala",label:"Noto Sans Sinhala"},{value:"Iskoola Pota",label:"Iskoola Pota"},{value:"Noto Sans Tamil",label:"Noto Sans Tamil"},{value:"Noto Sans",label:"Noto Sans"}],ko=[{value:"p",label:"Normal"},{value:"h1",label:"Heading 1"},{value:"h2",label:"Heading 2"},{value:"h3",label:"Heading 3"},{value:"h4",label:"Heading 4"},{value:"h5",label:"Heading 5"},{value:"h6",label:"Heading 6"}],So='<table border="1"><tr><td>Cell 1</td><td>Cell 2</td></tr><tr><td>Cell 3</td><td>Cell 4</td></tr></table>',ze=({currentFormat:e,onFormatText:t,onAddPageBreak:r,canUndo:n=!1,canRedo:s=!1})=>{const a=async l=>{try{if(!["image/png","image/jpeg","image/gif","image/webp"].includes(l.type)){alert("Invalid image format. Supported: PNG, JPEG, GIF, WEBP");return}if(l.size>5242880){alert("Image exceeds maximum size of 5MB");return}const p=await Qt(l),d=await en(p);if(d){const P=`<img src="${d}" data-key="${p}" alt="Inserted image" />`;document.execCommand("insertHTML",!1,P),pn.info("Image inserted",{key:p})}const _=document.getElementById("image-upload");_&&(_.value="")}catch(f){pn.error("Error uploading image",f)}},o=(l,f,p,d)=>b.jsx("button",{onClick:()=>t(l),className:e[f]?"active":"",title:d,children:b.jsx(p,{size:16})},l),i=(l,f,p,d=!1)=>b.jsx("button",{onClick:l,disabled:d,title:p,style:{opacity:d?.5:1},children:b.jsx(f,{size:16})},p),m=()=>b.jsx("div",{className:"toolbar-separator"});return b.jsxs("div",{className:"editor-toolbar",children:[i(()=>t("undo"),ho,"Undo",!n),i(()=>t("redo"),so,"Redo",!s),m(),o("bold","bold",Gr,"Bold"),o("italic","italic",eo,"Italic"),o("underline","underline",go,"Underline"),o("strikethrough","strikethrough",lo,"Strikethrough"),m(),o("justifyLeft","alignLeft",ln,"Align Left"),o("justifyCenter","alignCenter",sn,"Align Center"),o("justifyRight","alignRight",cn,"Align Right"),o("justifyFull","alignJustify",fo,"Justify"),m(),b.jsx("select",{onChange:l=>t("fontName",l.target.value),value:e.fontFamily||"Segoe UI",title:"Font Family",children:Po.map(({value:l,label:f})=>b.jsx("option",{value:l,children:f},l))}),b.jsx("select",{onChange:l=>t("fontSize",l.target.value),value:e.fontSize||Pe,title:"Font Size",children:$t.map(({value:l,label:f})=>b.jsx("option",{value:l,children:f},l))}),b.jsx("select",{onChange:l=>t("formatBlock",l.target.value),value:e.headingLevel||"p",title:"Heading Level",children:ko.map(({value:l,label:f})=>b.jsx("option",{value:l,children:f},l))}),m(),i(()=>t("insertUnorderedList"),an,"Bullet List"),i(()=>t("insertOrderedList"),oo,"Numbered List"),m(),b.jsx("button",{onClick:()=>{gt(!1)||document.execCommand("insertHTML",!1,"&nbsp;&nbsp;&nbsp;&nbsp;")},title:"Increase Indent (Tab)",children:b.jsx(ro,{size:16})}),b.jsx("button",{onClick:()=>{gt(!0)},title:"Decrease Indent (Shift+Tab)",children:b.jsx(no,{size:16})}),m(),b.jsx("button",{onClick:()=>{const l=prompt("Enter URL:");l&&t("createLink",l)},title:"Insert Link",children:b.jsx(to,{size:16})}),i(()=>t("insertHTML",So),uo,"Insert Table"),r&&i(r,$e,"Insert Page Break"),m(),b.jsx("input",{type:"file",accept:"image/*",onChange:l=>l.target.files[0]&&a(l.target.files[0]),style:{display:"none"},id:"image-upload"}),b.jsx("button",{onClick:()=>document.getElementById("image-upload").click(),title:"Insert Image",children:b.jsx(Qr,{size:16})})]})};ze.propTypes={currentFormat:A.shape({bold:A.bool,italic:A.bool,underline:A.bool,strikethrough:A.bool,alignLeft:A.bool,alignCenter:A.bool,alignRight:A.bool,alignJustify:A.bool,fontFamily:A.string,fontSize:A.string,headingLevel:A.string}).isRequired,onFormatText:A.func.isRequired,onAddPageBreak:A.func,canUndo:A.bool,canRedo:A.bool},ze.defaultProps={onAddPageBreak:void 0,canUndo:!1,canRedo:!1};function wo(e){return!e||typeof e!="string"?e:Be(e)}function Co(e){e.preventDefault();const t=e.clipboardData||window.clipboardData;if(!t)return null;let r=t.getData("text/html")||t.getData("text/plain");return r?(t.getData("text/html")?r=wo(r):r=Oo(r),document.execCommand("insertHTML",!1,r),r):null}function Oo(e){if(!e)return"";const t=e.split(/\n\s*\n/).filter(r=>r.trim());return t.length===0?"<p><br></p>":t.map(r=>{const n=r.split(`
`).filter(a=>a.trim());return n.length===0?"<p><br></p>":`<p>${n.map(a=>No(a.trim())).join("<br>")}</p>`}).join("")}function No(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}const be=e=>e?e.nodeType===Node.ELEMENT_NODE?e.tagName==="PAGE-BREAK"||e.getAttribute("data-page-break")==="true":e.parentElement&&be(e.parentElement):!1,ht=({dimensions:e,editorRef:t,onInput:r,onContentChange:n,onKeyDown:s,onClick:a,onScroll:o,onPaste:i,onRemovePageBreak:m,zoomLevel:l=100,pageMargins:f=pe})=>{const p=h.useMemo(()=>Pt(f),[f]),d=l/100,_=h.useCallback((k,u)=>{if(!k)return!1;const y=k.getBoundingClientRect(),g=u-y.top;return g<p.top||g>y.height-p.bottom},[p.top,p.bottom]),P=h.useCallback((k,u)=>{u.preventDefault();const y=k.getBoundingClientRect(),g=u.clientX-y.left,T=u.clientY-y.top,I=y.width-40,G=-12,j=y.width-20;g>=I&&g<=j&&T>=G&&T<=8&&m&&m(k)},[m]),x=h.useCallback(k=>{k.preventDefault();const u=t.current.getBoundingClientRect();if(k.clientY-u.top<p.top){const g=t.current.firstElementChild;if(g&&g.tagName!=="PAGE-BREAK"){const T=document.createRange(),I=window.getSelection();T.setStart(g,0),T.collapse(!0),I.removeAllRanges(),I.addRange(T)}}else{const g=t.current.lastElementChild;if(g&&g.tagName!=="PAGE-BREAK"){const T=document.createRange(),I=window.getSelection();T.selectNodeContents(g),T.collapse(!1),I.removeAllRanges(),I.addRange(T)}}},[t,p.top]),R=h.useCallback(k=>{const u=window.getSelection();if(!u||u.rangeCount===0)return;const y=u.getRangeAt(0),{startContainer:g,endContainer:T}=y;if((be(g)||be(T))&&(k.key.length===1||k.key==="Enter"||k.key===" "))return k.preventDefault(),!1;if(_o(k))return n&&n(),!1;if((k.key==="Backspace"||k.key==="Delete")&&(be(g)||be(T)))return k.preventDefault(),!1;s&&s(k)},[s,n]),v=h.useCallback(k=>{if(!t.current)return;const u=k.target;if(be(u)){P(u,k);return}if(_(t.current,k.clientY)){x(k);return}a&&a(k)},[t,a,P,x,_]),S=h.useCallback(k=>{const u=window.getSelection();if(!u||u.rangeCount===0)return;const y=u.getRangeAt(0),{startContainer:g}=y;if(be(g))return k.preventDefault(),!1},[]),O=h.useCallback(k=>{const u=Co(k);i&&i(k,u)},[i]);return b.jsx("div",{className:"continuous-page-container",style:{position:"relative",width:"100%",maxWidth:`${e.width}px`,margin:"40px auto",backgroundColor:"transparent",minHeight:"100vh",transform:`scale(${d})`,transformOrigin:"top center",transition:"transform 0.2s ease-out"},children:b.jsx("div",{ref:t,contentEditable:!0,suppressContentEditableWarning:!0,className:"continuous-content",style:{position:"relative",zIndex:1,minHeight:`${e.height}px`,width:`${e.width}px`,backgroundColor:"white",padding:`${p.top}px ${p.right}px ${p.bottom}px ${p.left}px`,boxSizing:"border-box",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",outline:"none",cursor:"text",fontFamily:'"Segoe UI", "Noto Sans Sinhala", "Noto Sans", "Malithi Web", "Iskoola Pota", "Kaputa Unicode", "Helvetica Neue", Arial, "Hiragino Sans GB", "WenQuanYi Micro Hei", "Microsoft YaHei", sans-serif',fontSize:Pe,lineHeight:"1.3",color:"#333",wordWrap:"break-word",whiteSpace:"pre-wrap",overflowWrap:"break-word",border:"1px solid #e0e0e0"},onInput:r,onKeyDown:R,onBeforeInput:S,onClick:v,onScroll:o,onPaste:O,"data-testid":"continuous-editor"})})};ht.propTypes={dimensions:A.shape({width:A.number.isRequired,height:A.number.isRequired}).isRequired,editorRef:A.shape({current:A.instanceOf(typeof Element<"u"?Element:Object)}).isRequired,onInput:A.func.isRequired,onContentChange:A.func,onKeyDown:A.func,onClick:A.func,onScroll:A.func,onPaste:A.func,onRemovePageBreak:A.func,zoomLevel:A.number,pageMargins:A.string},ht.defaultProps={onContentChange:void 0,onKeyDown:void 0,onClick:void 0,onScroll:void 0,onPaste:void 0,onRemovePageBreak:void 0,zoomLevel:100,pageMargins:pe};const yn=h.memo(ht),mt=({pageBoundaries:e=[{id:"page-0",pageNumber:1}],activePage:t=0,pageSize:r="A4",pageMargins:n=pe,zoomLevel:s=100,canZoomIn:a=!0,canZoomOut:o=!0,onNavigate:i,onAddPage:m,onDeletePage:l,onPageSizeChange:f,onPageMarginsChange:p,onZoomIn:d,onZoomOut:_,onZoomReset:P}={})=>{const x=Math.max(e?.length||0,1),R=u=>{i&&i(u)},v=()=>{m&&m()},S=u=>{if(x<=1){console.warn("[PageManager] Cannot delete the only page");return}l&&l(u)},O=u=>{f&&f(u)},k=u=>{p&&p(u)};return b.jsxs("div",{className:"page-manager",children:[b.jsxs("div",{className:"page-settings-group",children:[b.jsxs("div",{className:"page-settings-header",children:[b.jsx(co,{size:14,style:{marginRight:"4px",verticalAlign:"middle"}}),"Page Settings"]}),b.jsxs("div",{className:"page-settings-controls",children:[b.jsxs("div",{className:"page-setting-item",children:[b.jsx("label",{htmlFor:"page-size-selector",children:"Size:"}),b.jsxs("select",{id:"page-size-selector",role:"combobox","aria-label":"Page size selector",value:r,onChange:u=>O(u.target.value),children:[b.jsx("option",{value:"A4",children:"A4"}),b.jsx("option",{value:"Letter",children:"Letter"}),b.jsx("option",{value:"Legal",children:"Legal"})]})]}),b.jsxs("div",{className:"page-setting-item",children:[b.jsx("label",{htmlFor:"page-margins-selector",children:"Margins:"}),b.jsx("select",{id:"page-margins-selector",role:"combobox","aria-label":"Page margins selector",value:n,onChange:u=>k(u.target.value),children:Ln().map(u=>b.jsx("option",{value:u,children:Dn(u)},u))})]})]})]}),b.jsxs("div",{className:"zoom-controls-compact",children:[b.jsx("button",{type:"button",className:"zoom-button-compact",onClick:_,disabled:!o,"aria-label":"Zoom out",title:"Zoom out (Ctrl + -)",children:b.jsx(bo,{size:12})}),b.jsxs("span",{className:"zoom-level-display",children:[s,"%"]}),b.jsx("button",{type:"button",className:"zoom-button-compact",onClick:d,disabled:!a,"aria-label":"Zoom in",title:"Zoom in (Ctrl + +)",children:b.jsx(yo,{size:12})}),b.jsx("button",{type:"button",className:"zoom-reset-compact",onClick:P,"aria-label":"Reset zoom",title:"Reset zoom to 100% (Ctrl + 0)",children:"Reset"})]}),b.jsx("div",{className:"page-list",children:(e&&e.length>0?e:[{id:"page-0",pageNumber:1}]).map((u,y)=>b.jsxs("div",{className:"page-item",children:[b.jsxs("button",{type:"button",className:`page-button ${y===t?"active":""}`,onClick:()=>R(y),"aria-label":`Go to page ${y+1}`,"aria-current":y===t?"page":void 0,children:[b.jsx($e,{size:14}),b.jsxs("span",{children:["Page ",y+1]})]}),x>1&&b.jsx("button",{type:"button",className:"delete-page-button",onClick:g=>{g.stopPropagation(),S(y)},"aria-label":`Delete page ${y+1}`,title:"Delete this page and its content",children:b.jsx(mo,{size:14})})]},u.id||`page-${y}`))}),b.jsxs("button",{type:"button",className:"add-page-button",onClick:v,"aria-label":"Add new page",title:"Add new page at end",children:[b.jsx(ao,{size:16}),b.jsx("span",{children:"Add Page"})]})]})};mt.propTypes={pageBoundaries:A.arrayOf(A.shape({id:A.string.isRequired,pageNumber:A.number.isRequired,top:A.number,height:A.number})),activePage:A.number,pageSize:A.oneOf(["A4","Letter","Legal"]),pageMargins:A.string,zoomLevel:A.number,canZoomIn:A.bool,canZoomOut:A.bool,onNavigate:A.func,onAddPage:A.func,onDeletePage:A.func,onPageSizeChange:A.func,onPageMarginsChange:A.func,onZoomIn:A.func,onZoomOut:A.func,onZoomReset:A.func},mt.defaultProps={pageBoundaries:[{id:"page-0",pageNumber:1}],activePage:0,pageSize:"A4",pageMargins:pe,zoomLevel:100,canZoomIn:!0,canZoomOut:!0,onNavigate:void 0,onAddPage:void 0,onDeletePage:void 0,onPageSizeChange:void 0,onPageMarginsChange:void 0,onZoomIn:void 0,onZoomOut:void 0,onZoomReset:void 0};const bn=h.memo(mt),Fe=({editorRef:e,onImageResize:t,onImageSelect:r,onImageDeselect:n,resizeOptions:s=fe})=>{const a=h.useRef(null),o=h.useRef(null),i=h.useRef(null),m=h.useRef(null),l=h.useRef(s),f=h.useRef(!1),p=Ee();h.useEffect(()=>{l.current=s},[s]);const d=h.useCallback(g=>{if(!de(g))return;a.current&&(ye(a.current),a.current=null),g.classList.add("selected");const T=pt(g,l.current);T&&(a.current=T,o.current=g,document.body.appendChild(T),T.querySelectorAll(".resize-handler").forEach(G=>{G.addEventListener("mousedown",P)}),r&&r(g))},[r]),_=h.useCallback(()=>{o.current&&(o.current.classList.remove("selected"),o.current=null),a.current&&(ye(a.current),a.current=null),i.current=null,m.current=null,f.current=!1,n&&n()},[n]),P=h.useCallback(g=>{if(g.preventDefault(),g.stopPropagation(),!o.current)return;const T=g.currentTarget.dataset.handler,I=o.current.getBoundingClientRect(),G=window.pageYOffset||document.documentElement.scrollTop,j=window.pageXOffset||document.documentElement.scrollLeft;i.current={x:g.clientX,y:g.clientY,width:o.current.offsetWidth,height:o.current.offsetHeight,originalWidth:o.current.offsetWidth,originalHeight:o.current.offsetHeight,offsetX:g.clientX-I.left-j,offsetY:g.clientY-I.top-G},m.current=T,f.current=!0,document.body.classList.add("resize-in-progress"),document.body.style.cursor=k(T),document.addEventListener("mousemove",x),document.addEventListener("mouseup",R)},[]),x=h.useCallback(g=>{if(!f.current||!o.current||!i.current||!m.current)return;g.preventDefault(),g.stopPropagation();const{x:T,y:I,width:G,height:j}=i.current,$=m.current,Z=g.clientX,B=g.clientY,oe=u({handler:$,startX:T,startY:I,currentX:Z,currentY:B,startWidth:G,startHeight:j,options:l.current});y(o.current,oe),a.current&&ke(a.current,o.current)},[]),R=h.useCallback(g=>{if(f.current){if(g.preventDefault(),g.stopPropagation(),o.current&&i.current){const T={width:i.current.originalWidth,height:i.current.originalHeight},I={width:o.current.offsetWidth,height:o.current.offsetHeight};(T.width!==I.width||T.height!==I.height)&&p.recordOperation({type:"IMAGE_RESIZE",payload:{element:o.current,state:I}},{type:"IMAGE_RESIZE",payload:{element:o.current,state:T}})}if(i.current=null,m.current=null,f.current=!1,document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",R),document.body.classList.remove("resize-in-progress"),document.body.style.cursor="",o.current){const T=new Event("input",{bubbles:!0,cancelable:!0});o.current.dispatchEvent(T),t&&t(o.current,{width:o.current.offsetWidth,height:o.current.offsetHeight})}}},[t,p]),v=h.useCallback(g=>{a.current&&!a.current.contains(g.target)&&_();const T=g.target;if(de(T)){if(T===o.current)return;d(T)}},[d,_]),S=h.useCallback(g=>{if((g.key==="Delete"||g.key==="Backspace")&&o.current&&!f.current){g.preventDefault();const T=o.current;if(T.parentNode){T.parentNode.removeChild(T),_();const I=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(I)}}if(g.key==="Escape"&&o.current&&_(),o.current&&!f.current){if((g.ctrlKey||g.metaKey)&&g.shiftKey&&g.key===">"){g.preventDefault();const T=o.current.offsetWidth,I=Math.min(l.current.maxWidth||800,T+10);y(o.current,{width:I,height:o.current.offsetHeight});const G=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(G)}if((g.ctrlKey||g.metaKey)&&g.shiftKey&&g.key==="<"){g.preventDefault();const T=o.current.offsetWidth,I=Math.max(l.current.minWidth||50,T-10);y(o.current,{width:I,height:o.current.offsetHeight});const G=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(G)}if((g.ctrlKey||g.metaKey)&&g.shiftKey&&g.key==="+"){g.preventDefault();const T=o.current.offsetHeight,I=Math.min(l.current.maxHeight||600,T+10);y(o.current,{width:o.current.offsetWidth,height:I});const G=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(G)}if((g.ctrlKey||g.metaKey)&&g.shiftKey&&g.key==="-"){g.preventDefault();const T=o.current.offsetHeight,I=Math.max(l.current.minHeight||50,T-10);y(o.current,{width:o.current.offsetWidth,height:I});const G=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(G)}if((g.ctrlKey||g.metaKey)&&g.key==="r"){g.preventDefault(),y(o.current,{width:300,height:200});const T=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(T)}}},[e,_]),O=h.useCallback(()=>{a.current&&o.current&&ke(a.current,o.current)},[]);h.useEffect(()=>{if(!e.current)return;const T=e.current.closest(".editor-viewport");return T&&(T.addEventListener("scroll",O),window.addEventListener("scroll",O)),()=>{T&&T.removeEventListener("scroll",O),window.removeEventListener("scroll",O)}},[e,O]),h.useEffect(()=>{if(!e.current)return;const g=e.current;g.addEventListener("click",v),g.addEventListener("keydown",S);const T=g.closest(".editor-viewport");return T&&T.addEventListener("scroll",O),window.addEventListener("resize",O),()=>{g.removeEventListener("click",v),g.removeEventListener("keydown",S),T&&T.removeEventListener("scroll",O),window.removeEventListener("resize",O),f.current&&(document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",R),document.body.classList.remove("resize-in-progress"),document.body.style.cursor=""),a.current&&ye(a.current)}},[e,v,S,O,x,R]),h.useEffect(()=>{if(!e.current)return;const g=new MutationObserver(T=>{T.forEach(I=>{I.type==="childList"&&(I.removedNodes.length>0&&I.removedNodes.forEach(G=>{G.nodeType===Node.ELEMENT_NODE&&de(G)&&G===o.current&&_()}),I.addedNodes.length>0&&I.addedNodes.forEach(G=>{if(G.nodeType===Node.ELEMENT_NODE)if(de(G))setTimeout(()=>{d(G)},50);else{const j=G.querySelectorAll?G.querySelectorAll("img"):[];j.length>0&&setTimeout(()=>{d(j[0])},50)}}))})});return g.observe(e.current,{childList:!0,subtree:!0}),()=>{g.disconnect()}},[e,_,d]);function k(g){switch(g){case w.TOP_LEFT:case w.BOTTOM_RIGHT:return"nwse-resize";case w.TOP_RIGHT:case w.BOTTOM_LEFT:return"nesw-resize";case w.TOP:case w.BOTTOM:return"ns-resize";case w.LEFT:case w.RIGHT:return"ew-resize";default:return"default"}}function u({handler:g,startX:T,startY:I,currentX:G,currentY:j,startWidth:$,startHeight:Z,options:B=fe}){const oe=G-T,ne=j-I;let Y=$,q=Z;switch(g){case w.TOP_LEFT:Y=Math.max(B.minWidth,$-oe),q=Math.max(B.minHeight,Z-ne);break;case w.TOP_RIGHT:Y=Math.max(B.minWidth,$+oe),q=Math.max(B.minHeight,Z-ne);break;case w.BOTTOM_LEFT:Y=Math.max(B.minWidth,$-oe),q=Math.max(B.minHeight,Z+ne);break;case w.BOTTOM_RIGHT:Y=Math.max(B.minWidth,$+oe),q=Math.max(B.minHeight,Z+ne);break;case w.TOP:q=Math.max(B.minHeight,Z-ne);break;case w.BOTTOM:q=Math.max(B.minHeight,Z+ne);break;case w.LEFT:Y=Math.max(B.minWidth,$-oe);break;case w.RIGHT:Y=Math.max(B.minWidth,$+oe);break;default:return{width:Y,height:q}}if(B.preserveAspectRatio&&B.aspectRatio){const ae=$/Z;[w.TOP_LEFT,w.TOP_RIGHT,w.BOTTOM_LEFT,w.BOTTOM_RIGHT].includes(g)?Y/ae>q?q=Math.max(B.minHeight,Y/ae):Y=Math.max(B.minWidth,q*ae):[w.TOP,w.BOTTOM].includes(g)?Y=q*ae:[w.LEFT,w.RIGHT].includes(g)&&(q=Y/ae)}return B.maxWidth&&Y>B.maxWidth&&(Y=B.maxWidth,B.preserveAspectRatio&&B.aspectRatio&&(q=Y/($/Z))),B.maxHeight&&q>B.maxHeight&&(q=B.maxHeight,B.preserveAspectRatio&&B.aspectRatio&&(Y=q*($/Z))),Y=Math.max(B.minWidth,Y),q=Math.max(B.minHeight,q),{width:Math.round(Y),height:Math.round(q)}}function y(g,{width:T,height:I}){de(g)&&(g.tagName==="IMG"?(g.style.width=`${T}px`,g.style.height=`${I}px`,g.width=T,g.height=I):g.tagName==="DIV"&&(g.style.width=`${T}px`,g.style.height=`${I}px`))}return null};Fe.propTypes={editorRef:A.shape({current:A.instanceOf(typeof Element<"u"?Element:Object)}).isRequired,onImageResize:A.func,onImageSelect:A.func,onImageDeselect:A.func,resizeOptions:A.shape({minWidth:A.number,minHeight:A.number,maxWidth:A.number,maxHeight:A.number,aspectRatio:A.bool,preserveAspectRatio:A.bool,defaultWidth:A.number,defaultHeight:A.number})},Fe.defaultProps={onImageResize:void 0,onImageSelect:void 0,onImageDeselect:void 0,resizeOptions:fe};const yt=({imageElement:e,onAlignChange:t,onAspectRatioToggle:r,onDelete:n,onClose:s,initialPreserveAspectRatio:a=!0})=>{const[o,i]=h.useState({top:0,left:0}),[m,l]=h.useState(!1),[f,p]=h.useState("top"),[d,_]=h.useState(a),P=h.useRef(null),x=h.useRef(null),R=Ee(),v=j=>{if(!j)return;(typeof window<"u"&&typeof window.requestAnimationFrame=="function"?window.requestAnimationFrame:Z=>setTimeout(Z,16))(()=>{const Z=document.querySelector(".image-resize-overlay");Z&&ke(Z,j)})},S=j=>{if(!j)return null;const $=window.getComputedStyle(j);return{float:$.float||"none",margin:j.style.margin||"",display:$.display||"inline",width:j.style.width||j.width||"",height:j.style.height||j.height||"",aspectRatio:d}},O=()=>{if(!e)return"left";const j=window.getComputedStyle(e);return j.float||j.display==="block"?"left":j.display==="flex"&&j.justifyContent==="center"?"center":j.float==="right"?"right":"left"},[k,u]=h.useState(O());h.useEffect(()=>()=>{},[e]),h.useEffect(()=>{if(e){let j=e.closest(".editor-viewport")||e.closest(".continuous-scroll");j&&(x.current=j)}},[e]),h.useLayoutEffect(()=>{if(!e||!P.current)return;const j=()=>{const Z=e.getBoundingClientRect(),B=P.current.getBoundingClientRect();x.current;const oe=window.visualViewport?window.visualViewport:{width:window.innerWidth,height:window.innerHeight},ne=Z.bottom>=0&&Z.top<=oe.height&&Z.right>=0&&Z.left<=oe.width;let Y="top",q=0,ae=0;if(ne){const L=Z.top-B.height-10,V=oe.height-Z.bottom-B.height-10;V>L&&V>0?(Y="bottom",q=Z.bottom+10):(Y="top",q=Z.top-B.height-10)}else Y="top",q=10;ae=Z.left+Z.width/2-B.width/2;const E=window.innerWidth,c=window.innerHeight;let C=ae,M=q;ae<10?C=10:ae+B.width>E-10&&(C=E-B.width-10),q<10?M=10:q+B.height>c-10&&(M=c-B.height-10),i({top:M,left:C}),p(Y),l(!0)};j();const $=()=>{j()};return x.current&&x.current.addEventListener("scroll",$),window.addEventListener("scroll",$),window.addEventListener("resize",$),()=>{x.current&&x.current.removeEventListener("scroll",$),window.removeEventListener("scroll",$),window.removeEventListener("resize",$),l(!1)}},[e]),h.useEffect(()=>{const j=$=>{P.current&&!P.current.contains($.target)&&$.target!==e&&s()};return document.addEventListener("mousedown",j),()=>{document.removeEventListener("mousedown",j)}},[e,s]);const y=()=>{if(e){const j=S(e);e.style.float="left",e.style.margin="0 10px 10px 0",e.style.display="block",u("left"),v(e);const $=S(e);R.recordOperation({type:"IMAGE_ALIGN",payload:{element:e,alignment:"left",state:$}},{type:"IMAGE_ALIGN",payload:{element:e,alignment:O(),state:j}}),t&&t("left")}},g=()=>{if(e){const j=S(e);e.style.float="none",e.style.margin="10px auto",e.style.display="block",u("center"),v(e);const $=S(e);R.recordOperation({type:"IMAGE_ALIGN",payload:{element:e,alignment:"center",state:$}},{type:"IMAGE_ALIGN",payload:{element:e,alignment:O(),state:j}}),t&&t("center")}},T=()=>{if(e){const j=S(e);e.style.float="right",e.style.margin="0 0 10px 10px",e.style.display="block",u("right"),v(e);const $=S(e);R.recordOperation({type:"IMAGE_ALIGN",payload:{element:e,alignment:"right",state:$}},{type:"IMAGE_ALIGN",payload:{element:e,alignment:O(),state:j}}),t&&t("right")}},I=()=>{if(e&&e.parentNode){const j={element:e,parent:e.parentNode,nextSibling:e.nextSibling};R.recordOperation({type:"IMAGE_DELETE",payload:{element:e}},{type:"IMAGE_REINSERT",payload:{state:j}}),e.parentNode.removeChild(e),n&&n(),s()}},G=()=>{const j=d,$=!d;_($),R.recordOperation({type:"IMAGE_ASPECT_RATIO",payload:{element:e,preserveAspectRatio:$}},{type:"IMAGE_ASPECT_RATIO",payload:{element:e,preserveAspectRatio:j}}),r&&r($)};return!e||typeof document>"u"?null:wn.createPortal(b.jsxs("div",{ref:P,className:"image-tooltip-menu","data-menu-position":f,"aria-hidden":!m,style:{position:"fixed",top:`${o.top}px`,left:`${o.left}px`,zIndex:999,background:"#fff",border:"1px solid #ddd",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",padding:"8px",display:"flex",gap:"2px",alignItems:"center",pointerEvents:m?"auto":"none",minWidth:"140px",minHeight:"32px",opacity:m?1:0,visibility:m?"visible":"hidden",transition:"opacity 0.15s ease, visibility 0.15s ease"},children:[b.jsx("button",{className:`tooltip-button aspect-ratio-toggle ${d?"":"active"}`,onClick:G,title:`Toggle aspect ratio preservation (currently ${d?"ON":"OFF"})`,children:d?b.jsx(io,{size:14}):b.jsx(Jr,{size:14})}),b.jsx("button",{className:`tooltip-button ${k==="left"?"active":""}`,onClick:y,title:"Align Left",style:{background:k==="left"?"#007bff":"transparent",color:k==="left"?"#fff":"#333",border:"1px solid #ccc",borderRadius:"4px",padding:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"28px",height:"28px"},children:b.jsx(ln,{size:14})}),b.jsx("button",{className:`tooltip-button ${k==="center"?"active":""}`,onClick:g,title:"Align Center",style:{background:k==="center"?"#007bff":"transparent",color:k==="center"?"#fff":"#333",border:"1px solid #ccc",borderRadius:"4px",padding:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"28px",height:"28px"},children:b.jsx(sn,{size:14})}),b.jsx("button",{className:`tooltip-button ${k==="right"?"active":""}`,onClick:T,title:"Align Right",style:{background:k==="right"?"#007bff":"transparent",color:k==="right"?"#fff":"#333",border:"1px solid #ccc",borderRadius:"4px",padding:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"28px",height:"28px"},children:b.jsx(cn,{size:14})}),b.jsx("button",{className:"tooltip-button delete-button",onClick:I,title:"Delete Image",style:{background:"transparent",color:"#dc3545",border:"1px solid #dc3545",borderRadius:"4px",padding:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"28px",height:"28px"},children:b.jsx(po,{size:14})})]}),document.body)};yt.propTypes={imageElement:A.instanceOf(typeof Element<"u"?Element:Object),onAlignChange:A.func,onAspectRatioToggle:A.func,onDelete:A.func,onClose:A.func.isRequired,initialPreserveAspectRatio:A.bool},yt.defaultProps={imageElement:null,onAlignChange:void 0,onAspectRatioToggle:void 0,onDelete:void 0,initialPreserveAspectRatio:!0};const Mo=50,bt=50,En=50,Ro=100,Io=500,Tn="UPDATE_CONTINUOUS_CONTENT",Ue=h.forwardRef(({pageManagerComponent:e=null,onNavigatePage:t,onAddPage:r,onDeletePage:n,onPageSizeChange:s,onPageMarginsChange:a,onChange:o,showSidebar:i=!0,showToolbar:m=!0,showPageManager:l=!0},f)=>{const p=ot(),d=Ee(),{pageSize:_,pageMargins:P,continuousContent:x,pageBoundaries:R,activePage:v,zoomLevel:S,canUndo:O,canRedo:k}=p,u=h.useRef(null),y=h.useRef(null),{currentFormat:g,formatText:T,updateCurrentFormatFromSelection:I}=qt(),[G,j]=h.useState(!1),[$,Z]=h.useState(null),[B,oe]=h.useState(!0),ne=h.useRef(null),{checkAndUpdateBoundaries:Y,getCurrentPage:q,scrollToPage:ae,updateBoundaries:E,triggerAutoReflow:c,removePageAndContent:C,removePageBreak:M,insertPageBreakAtBoundary:L}=Jt(_,y,S,P),V=h.useMemo(()=>Ie(_),[_]),[W,H]=h.useState(!1),U=h.useRef(null),K=h.useRef(!1),X=h.useRef(!1),se=h.useRef(!1),N=h.useRef(x);h.useEffect(()=>{if(y.current){if(!se.current){y.current.innerHTML=x,se.current=!0,N.current=x;const D=setTimeout(()=>{E()},Mo);return()=>clearTimeout(D)}if(N.current!==x){if(y.current.innerHTML!==x){y.current.innerHTML=x;const Q=setTimeout(()=>{if(E(),K.current){K.current=!1;const re=Math.max(0,R.length-1);d.setActivePage(re),setTimeout(()=>{ae(re,u)},En)}},bt);return N.current=x,()=>clearTimeout(Q)}N.current=x}}},[x,E,R.length,d,ae]),h.useEffect(()=>{o&&se.current&&o(x)},[x,o]),h.useImperativeHandle(f,()=>({getHTMLContent:()=>y.current?y.current.innerHTML:x,getPlainText:()=>(y.current?y.current.innerHTML:x).replace(/<[^>]*>/g," ").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/\s+/g," ").trim(),getCursorPosition:()=>y.current?kr(y.current):null,setContent:D=>{const Q=Be(D);Q!==x&&d.updateContinuousContent(Q),y.current&&y.current.innerHTML!==Q&&(y.current.innerHTML=Q),N.current=Q,y.current&&setTimeout(()=>{E()},bt)},insertContent:D=>{if(!y.current||!D)return;const Q=Be(D),re=window.getSelection();let ue=!1;if(re&&re.rangeCount>0){const Tt=re.getRangeAt(0);y.current.contains(Tt.commonAncestorContainer)&&(ue=!0)}if(!ue&&ne.current)try{re.removeAllRanges(),re.addRange(ne.current)}catch(Tt){console.warn("[insertContent] Failed to restore last cursor position:",Tt);const Oe=y.current.lastChild;if(Oe){const Ze=document.createRange();Oe.nodeType===Node.TEXT_NODE?Ze.setStart(Oe,Oe.textContent.length):Ze.setStartAfter(Oe),Ze.collapse(!0),re.removeAllRanges(),re.addRange(Ze)}}document.execCommand("insertHTML",!1,Q);const he=y.current.innerHTML;d.updateContinuousContent(he),N.current=he,setTimeout(()=>{E(),c(200)},bt)}}),[x,d,E,y,ne,Y]),h.useEffect(()=>{const D=()=>{if(I(),y.current){const re=window.getSelection();if(re.rangeCount>0){const ue=re.getRangeAt(0);ue.collapsed&&y.current.contains(ue.commonAncestorContainer)&&(ne.current=ue.cloneRange())}}};document.addEventListener("selectionchange",D);const Q=()=>{if(setTimeout(I,10),ne.current&&y.current)try{const re=window.getSelection();re.removeAllRanges(),re.addRange(ne.current)}catch(re){console.warn("[handleFocus] Failed to restore cursor:",re)}};return y.current&&y.current.addEventListener("focus",Q),()=>{document.removeEventListener("selectionchange",D),y.current&&y.current.removeEventListener("focus",Q)}},[I]);const ie=h.useCallback(()=>{if(!y.current)return;let D=y.current.innerHTML;D=Be(D),D!==y.current.innerHTML&&(y.current.innerHTML=D);const Q=x;if(Q!==D){const ue={type:Tn,payload:D},he={type:Tn,payload:Q};d.recordOperation(ue,he)}d.updateContinuousContent(D),Y(),c(200);const re=q(u);re!==v&&d.setActivePage(re)},[d,Y,q,v,c,u,y,x]),Te=h.useCallback(D=>{ie()},[ie]),Ce=h.useCallback(D=>{d.updatePageSize(D),E({pageSize:D}),s&&s(D)},[d,E,s]),vn=h.useCallback(D=>{d.updatePageMargins(D),E({pageMargins:D}),a&&a(D)},[d,E,a]),xn=h.useCallback(D=>{D<0||D>=R.length||(X.current=!0,d.setActivePage(D),ae(D,u),setTimeout(()=>{X.current=!1},Io),t&&t(D))},[d,ae,t,R.length]),An=h.useCallback(()=>{const D=R.length+1;L(D)&&(K.current=!0,setTimeout(()=>{if(K.current){K.current=!1;const re=Math.max(0,R.length-1);d.setActivePage(re),setTimeout(()=>{ae(re,u)},En)}},100)),r&&r()},[R.length,L,d,ae,r]),Do=h.useCallback(()=>{const D=window.getSelection();if(D&&D.rangeCount>0){if(!y?.current)return;const ue=`<page-break data-page-break="true" contenteditable="false" data-page-number="${y.current.querySelectorAll('page-break, [data-page-break="true"]').length+2}"></page-break><p><br></p>`;document.execCommand("insertHTML",!1,ue),setTimeout(()=>{E();const he=q(u);d.setActivePage(he)},150)}},[E,q,d,u]),jo=h.useCallback(D=>{if(!D)return;M(D)&&setTimeout(()=>{const re=q(u);d.setActivePage(re)},200)},[M,q,d,u]),_n=h.useCallback(D=>{if(R.length<=1){console.warn("Cannot delete the only page");return}C(D)&&(d.setActivePage(0),n&&n(D))},[R.length,C,d,n]),Ge=h.useCallback(()=>{d.zoomIn()},[d]),qe=h.useCallback(()=>{d.zoomOut()},[d]),We=h.useCallback(()=>{d.resetZoom()},[d]),Pn=h.useCallback(()=>{d.undo()},[d]),kn=h.useCallback(()=>{d.redo()},[d]);h.useEffect(()=>{const D=Q=>{if(Q.ctrlKey||Q.metaKey){["+","=","-","_","0","z","y"].includes(Q.key)&&Q.preventDefault();const re=document.activeElement===y.current,ue=document.activeElement===u.current,he=document.activeElement?.tagName==="INPUT"||document.activeElement?.tagName==="TEXTAREA"||document.activeElement?.isContentEditable===!1;if(re||ue||!he)switch(Q.key){case"+":case"=":Ge();break;case"-":case"_":qe();break;case"0":We();break;case"z":Q.shiftKey||Pn();break;case"y":kn();break}}};return window.addEventListener("keydown",D),()=>{window.removeEventListener("keydown",D)}},[Ge,qe,We,Pn,kn]);const Ho=h.useCallback(()=>{!u.current||!y.current||X.current||(U.current&&clearTimeout(U.current),U.current=setTimeout(()=>{if(X.current){U.current=null;return}const D=q(u);D!==v&&D>=0&&d.setActivePage(D),U.current=null},Ro))},[q,v,d]),Bo=h.useMemo(()=>{if(!x)return 0;const Q=x.replace(/<[^>]*>/g," ").match(new RegExp("\\p{L}+","gu"));return Q?Q.length:0},[x]),$o=R.length||1,zo=h.useCallback(D=>{j(!0),Z(D)},[]),Sn=h.useCallback(()=>{j(!1),Z(null)},[]),Fo=h.useCallback((D,Q)=>{},[]);return h.useEffect(()=>()=>{U.current&&clearTimeout(U.current)},[]),b.jsxs("div",{className:"multi-page-editor",children:[m&&b.jsx(ze,{currentFormat:{...g,imageSelected:G},onFormatText:T,onAddPageBreak:Do,canUndo:O,canRedo:k}),b.jsxs("div",{className:"editor-container",children:[i&&b.jsx(dn,{editorView:null,isCollapsed:W,onToggle:()=>H(D=>!D),wordCount:Bo,pageCount:$o}),b.jsx("div",{className:"editor-viewport continuous-scroll",ref:u,onScroll:Ho,children:b.jsx(yn,{content:x,dimensions:V,pageSize:_,pageMargins:P,pageBoundaries:R,editorRef:y,onInput:Te,onContentChange:ie,onClick:()=>y.current?.focus(),onRemovePageBreak:jo,zoomLevel:S})}),b.jsx(Fe,{editorRef:y,onImageSelect:zo,onImageDeselect:Sn,onImageResize:Fo,resizeOptions:{...fe,preserveAspectRatio:B,aspectRatio:B}}),G&&$&&b.jsx(yt,{imageElement:$,initialPreserveAspectRatio:B,onAlignChange:D=>{},onAspectRatioToggle:D=>{oe(D)},onDelete:()=>{if($){const D=$.getAttribute("data-key");D&&tn(D).catch(Q=>{console.error("Failed to delete image from IndexedDB:",Q)})}},onClose:Sn}),l&&b.jsx("div",{className:"page-manager-sidebar",children:e?h.cloneElement(e,{onNavigate:xn,onAddPage:An,onDeletePage:_n,onPageSizeChange:Ce,onPageMarginsChange:vn,zoomLevel:S,canZoomIn:Je(S),canZoomOut:Qe(S),onZoomIn:Ge,onZoomOut:qe,onZoomReset:We}):b.jsx(bn,{pageBoundaries:R,activePage:v,pageSize:_,pageMargins:P,zoomLevel:S,canZoomIn:Je(S),canZoomOut:Qe(S),onNavigate:xn,onAddPage:An,onDeletePage:_n,onPageSizeChange:Ce,onPageMarginsChange:vn,onZoomIn:Ge,onZoomOut:qe,onZoomReset:We})})]})]})});Ue.displayName="HtmlEditor",Ue.propTypes={pageManagerComponent:A.element,onNavigatePage:A.func,onAddPage:A.func,onDeletePage:A.func,onPageSizeChange:A.func,onPageMarginsChange:A.func,onChange:A.func,showSidebar:A.bool,showToolbar:A.bool,showPageManager:A.bool},Ue.defaultProps={pageManagerComponent:null,onNavigatePage:void 0,onAddPage:void 0,onDeletePage:void 0,onPageSizeChange:void 0,onPageMarginsChange:void 0,onChange:void 0,showSidebar:!0,showToolbar:!0,showPageManager:!0};class Et extends h.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,r){console.error("[ErrorBoundary] Caught error:",t),console.error("[ErrorBoundary] Error info:",r),this.setState({error:t,errorInfo:r}),this.props.onError&&this.props.onError(t,r)}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null}),this.props.onReset&&this.props.onReset()};render(){return this.state.hasError?this.props.fallback?this.props.fallback:b.jsxs("div",{style:{padding:"20px",margin:"20px",border:"2px solid #f44336",borderRadius:"4px",backgroundColor:"#ffebee",color:"#c62828"},children:[b.jsx("h2",{style:{marginTop:0},children:" Something went wrong"}),b.jsx("p",{children:"The editor encountered an unexpected error and couldn't continue."}),this.props.showDetails&&this.state.error&&b.jsxs("details",{style:{marginTop:"10px",padding:"10px",backgroundColor:"white",borderRadius:"4px",fontSize:"12px",fontFamily:"monospace"},children:[b.jsx("summary",{style:{cursor:"pointer",fontWeight:"bold"},children:"Error Details"}),b.jsxs("pre",{style:{marginTop:"10px",overflow:"auto",maxHeight:"200px"},children:[this.state.error.toString(),this.state.errorInfo&&this.state.errorInfo.componentStack]})]}),b.jsx("button",{onClick:this.handleReset,style:{marginTop:"15px",padding:"8px 16px",backgroundColor:"#f44336",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold"},children:"Try Again"})]}):this.props.children}}Et.propTypes={children:A.node.isRequired,fallback:A.node,onError:A.func,onReset:A.func,showDetails:A.bool},Et.defaultProps={fallback:null,onError:void 0,onReset:void 0,showDetails:process.env.NODE_ENV==="development"};const Lo={A4:{width:ce.A4.width,height:ce.A4.height},Letter:{width:ce.Letter.width,height:ce.Letter.height},Legal:{width:ce.Legal.width,height:ce.Legal.height}};z.COMMON_FONT_SIZES=$t,z.DEFAULT_FONT_SIZE=Pe,z.DEFAULT_IMAGE_RESIZE_OPTIONS=fe,z.DEFAULT_PAGE_SIZE=et,z.DocumentProvider=zn,z.EditorToolbar=ze,z.ErrorBoundary=Et,z.FONT_SIZE_MAP=ft,z.HtmlEditor=Ue,z.ImageResizeHandlers=Fe,z.PAGE_DIMENSIONS=Lo,z.PAGE_SIZES=ce,z.PageManager=bn,z.PageView=yn,z.RESIZE_HANDLERS=w,z.Sidebar=dn,z.applyImageDimensions=tr,z.calculateResizeDimensions=Qn,z.clearImages=Nr,z.createResizeOverlay=pt,z.deleteImage=tn,z.getAllImageKeys=Mr,z.getAvailablePageSizes=Hn,z.getImage=en,z.getImageDimensions=er,z.getPageDimensions=Ie,z.getPixelValue=Kn,z.getPointValue=Xn,z.isResizableImage=de,z.isValidFontSize=Jn,z.isValidPageSize=jn,z.logger=fn,z.pixelsToPoints=Ft,z.pointsToPixels=zt,z.removeResizeOverlay=ye,z.saveImage=Qt,z.updateResizeOverlay=ke,z.useContinuousReflow=Jt,z.useDocument=rt,z.useDocumentActions=Ee,z.useDocumentState=ot,z.useFormatting=qt,Object.defineProperty(z,Symbol.toStringTag,{value:"Module"})}));
//# sourceMappingURL=htmleditor.umd.cjs.map
