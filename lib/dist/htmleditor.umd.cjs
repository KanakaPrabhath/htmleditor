(function(I,c){typeof exports=="object"&&typeof module<"u"?c(exports,require("react"),require("uuid"),require("prop-types"),require("react-dom")):typeof define=="function"&&define.amd?define(["exports","react","uuid","prop-types","react-dom"],c):(I=typeof globalThis<"u"?globalThis:I||self,c(I.HTMLEditor={},I.React,I.uuid,I.PropTypes,I.ReactDOM))})(this,(function(I,c,rt,E,Pt){"use strict";var Re={exports:{}},ke={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bt;function tr(){if(Bt)return ke;Bt=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(r,i,o){var s=null;if(o!==void 0&&(s=""+o),i.key!==void 0&&(s=""+i.key),"key"in i){o={};for(var l in i)l!=="key"&&(o[l]=i[l])}else o=i;return i=o.ref,{$$typeof:e,type:r,key:s,ref:i!==void 0?i:null,props:o}}return ke.Fragment=t,ke.jsx=n,ke.jsxs=n,ke}var ve={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ht;function nr(){return Ht||(Ht=1,process.env.NODE_ENV!=="production"&&(function(){function e(w){if(w==null)return null;if(typeof w=="function")return w.$$typeof===L?null:w.displayName||w.name||null;if(typeof w=="string")return w;switch(w){case b:return"Fragment";case _:return"Profiler";case k:return"StrictMode";case x:return"Suspense";case S:return"SuspenseList";case T:return"Activity"}if(typeof w=="object")switch(typeof w.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),w.$$typeof){case y:return"Portal";case v:return w.displayName||"Context";case O:return(w._context.displayName||"Context")+".Consumer";case M:var B=w.render;return w=w.displayName,w||(w=B.displayName||B.name||"",w=w!==""?"ForwardRef("+w+")":"ForwardRef"),w;case C:return B=w.displayName||null,B!==null?B:e(w.type)||"Memo";case N:B=w._payload,w=w._init;try{return e(w(B))}catch{}}return null}function t(w){return""+w}function n(w){try{t(w);var B=!1}catch{B=!0}if(B){B=console;var W=B.error,Z=typeof Symbol=="function"&&Symbol.toStringTag&&w[Symbol.toStringTag]||w.constructor.name||"Object";return W.call(B,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",Z),t(w)}}function r(w){if(w===b)return"<>";if(typeof w=="object"&&w!==null&&w.$$typeof===N)return"<...>";try{var B=e(w);return B?"<"+B+">":"<...>"}catch{return"<...>"}}function i(){var w=D.A;return w===null?null:w.getOwner()}function o(){return Error("react-stack-top-frame")}function s(w){if(R.call(w,"key")){var B=Object.getOwnPropertyDescriptor(w,"key").get;if(B&&B.isReactWarning)return!1}return w.key!==void 0}function l(w,B){function W(){F||(F=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",B))}W.isReactWarning=!0,Object.defineProperty(w,"key",{get:W,configurable:!0})}function d(){var w=e(this.type);return V[w]||(V[w]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),w=this.props.ref,w!==void 0?w:null}function u(w,B,W,Z,K,oe){var z=W.ref;return w={$$typeof:p,type:w,key:B,props:W,_owner:Z},(z!==void 0?z:null)!==null?Object.defineProperty(w,"ref",{enumerable:!1,get:d}):Object.defineProperty(w,"ref",{enumerable:!1,value:null}),w._store={},Object.defineProperty(w._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(w,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(w,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:K}),Object.defineProperty(w,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:oe}),Object.freeze&&(Object.freeze(w.props),Object.freeze(w)),w}function m(w,B,W,Z,K,oe){var z=B.children;if(z!==void 0)if(Z)if(H(z)){for(Z=0;Z<z.length;Z++)f(z[Z]);Object.freeze&&Object.freeze(z)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else f(z);if(R.call(B,"key")){z=e(w);var J=Object.keys(B).filter(function(Je){return Je!=="key"});Z=0<J.length?"{key: someKey, "+J.join(": ..., ")+": ...}":"{key: someKey}",ue[z+Z]||(J=0<J.length?"{"+J.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,Z,z,J,z),ue[z+Z]=!0)}if(z=null,W!==void 0&&(n(W),z=""+W),s(B)&&(n(B.key),z=""+B.key),"key"in B){W={};for(var Te in B)Te!=="key"&&(W[Te]=B[Te])}else W=B;return z&&l(W,typeof w=="function"?w.displayName||w.name||"Unknown":w),u(w,z,W,i(),K,oe)}function f(w){g(w)?w._store&&(w._store.validated=1):typeof w=="object"&&w!==null&&w.$$typeof===N&&(w._payload.status==="fulfilled"?g(w._payload.value)&&w._payload.value._store&&(w._payload.value._store.validated=1):w._store&&(w._store.validated=1))}function g(w){return typeof w=="object"&&w!==null&&w.$$typeof===p}var h=c,p=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),O=Symbol.for("react.consumer"),v=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),S=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),T=Symbol.for("react.activity"),L=Symbol.for("react.client.reference"),D=h.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,R=Object.prototype.hasOwnProperty,H=Array.isArray,U=console.createTask?console.createTask:function(){return null};h={react_stack_bottom_frame:function(w){return w()}};var F,V={},Y=h.react_stack_bottom_frame.bind(h,o)(),ne=U(r(o)),ue={};ve.Fragment=b,ve.jsx=function(w,B,W){var Z=1e4>D.recentlyCreatedOwnerStacks++;return m(w,B,W,!1,Z?Error("react-stack-top-frame"):Y,Z?U(r(w)):ne)},ve.jsxs=function(w,B,W){var Z=1e4>D.recentlyCreatedOwnerStacks++;return m(w,B,W,!0,Z?Error("react-stack-top-frame"):Y,Z?U(r(w)):ne)}})()),ve}var Dt;function rr(){return Dt||(Dt=1,process.env.NODE_ENV==="production"?Re.exports=tr():Re.exports=nr()),Re.exports}var a=rr();const ot=100,st=50,it=200,zt=5,at=e=>e<it,lt=e=>e>st,or=96,se=e=>Math.round(e*or),Ie={NORMAL:{name:"Normal",label:'Normal (1")',top:1,bottom:1,left:1,right:1},NARROW:{name:"Narrow",label:'Narrow (0.5")',top:.5,bottom:.5,left:.5,right:.5},MODERATE:{name:"Moderate",label:'Moderate (1" / 0.75")',top:1,bottom:1,left:.75,right:.75},WIDE:{name:"Wide",label:'Wide (1" / 2")',top:1,bottom:1,left:2,right:2},OFFICE_2003:{name:"Office 2003",label:'Office 2003 (1" / 1.25")',top:1,bottom:1,left:1.25,right:1.25}},ie="NORMAL",$t=(e=ie)=>{if(typeof e=="object"&&e!==null&&typeof e.top=="number"&&typeof e.bottom=="number"&&typeof e.left=="number"&&typeof e.right=="number")return{top:se(e.top),bottom:se(e.bottom),left:se(e.left),right:se(e.right)};const t=Ie[e]||Ie[ie];return{top:se(t.top),bottom:se(t.bottom),left:se(t.left),right:se(t.right)}},sr=(e=ie)=>{const t=$t(e);return t.top+t.bottom},ir=()=>Object.keys(Ie),ar=e=>{if(typeof e=="object"&&e!==null&&typeof e.top=="number"&&typeof e.bottom=="number"&&typeof e.left=="number"&&typeof e.right=="number")return`Custom (${e.top}" / ${e.left}")`;const t=Ie[e];return t?t.label:"Unknown"},Ae={A4:{name:"A4",width:794,height:1123,widthMm:210,heightMm:297,widthIn:8.27,heightIn:11.69},Letter:{name:"Letter",width:816,height:1056,widthMm:216,heightMm:279,widthIn:8.5,heightIn:11},Legal:{name:"Legal",width:816,height:1344,widthMm:216,heightMm:356,widthIn:8.5,heightIn:14}},ct="A4",xe=e=>{const t=Ae[e]||Ae[ct];return{width:t.width,height:t.height}},lr=e=>Object.keys(Ae).includes(e),cr=()=>Object.keys(Ae),Se=ct,de="<p><br></p>",ur="continuous",_e=(e,t=Se)=>({id:rt.v4(),index:e,size:t,content:de,images:[],isBreakPoint:!1}),je=e=>typeof e!="string"||e.trim()===""?de:e,Ft=(e,t=Se)=>(e.length>0?e:[_e(0,t)]).map((r,i)=>({id:r.id||rt.v4(),index:i,size:r.size||t,content:je(r.content),images:r.images||[],isBreakPoint:!!r.isBreakPoint})),dr=(e=Se)=>[{id:"page-0",pageNumber:1,top:0,height:xe(e).height}],Pe=e=>e.slice(0,-1).map((t,n)=>({id:`auto-break-${n}`,pageNumber:n+1})),ut=(e={})=>{const t=new Date().toISOString(),n=e.pageSize||Se,r=Ft(e.pages||[_e(0,n)],n);return{id:rt.v4(),title:e.title||"Untitled Document",createdAt:t,updatedAt:t,pageSize:n,pages:r,activePage:e.activePage&&e.activePage<r.length?e.activePage:0,pageBreaks:e.pageBreaks||[],totalPages:r.length,editorMode:e.editorMode||ur,continuousContent:e.continuousContent||de,pageBoundaries:e.pageBoundaries||dr(n),zoomLevel:e.zoomLevel||ot,pageMargins:e.pageMargins||ie,undoStack:[],redoStack:[],canUndo:!1,canRedo:!1}},P={INITIALIZE_DOCUMENT:"INITIALIZE_DOCUMENT",UPDATE_TITLE:"UPDATE_TITLE",UPDATE_PAGE_CONTENT:"UPDATE_PAGE_CONTENT",UPDATE_PAGES:"UPDATE_PAGES",ADD_PAGE:"ADD_PAGE",DELETE_PAGE:"DELETE_PAGE",SET_ACTIVE_PAGE:"SET_ACTIVE_PAGE",UPDATE_PAGE_SIZE:"UPDATE_PAGE_SIZE",RESET_DOCUMENT:"RESET_DOCUMENT",UPDATE_CONTINUOUS_CONTENT:"UPDATE_CONTINUOUS_CONTENT",UPDATE_PAGE_BOUNDARIES:"UPDATE_PAGE_BOUNDARIES",ADD_PAGE_BREAK:"ADD_PAGE_BREAK",REMOVE_PAGE_BREAK:"REMOVE_PAGE_BREAK",SET_EDITOR_MODE:"SET_EDITOR_MODE",SET_ZOOM_LEVEL:"SET_ZOOM_LEVEL",ZOOM_IN:"ZOOM_IN",ZOOM_OUT:"ZOOM_OUT",RESET_ZOOM:"RESET_ZOOM",UPDATE_PAGE_MARGINS:"UPDATE_PAGE_MARGINS",RECORD_OPERATION:"RECORD_OPERATION",UNDO:"UNDO",REDO:"REDO",CLEAR_UNDO_REDO:"CLEAR_UNDO_REDO"},dt=(e,t)=>{const n=new Date().toISOString();switch(t.type){case P.INITIALIZE_DOCUMENT:{const{initialContent:r=de,pageSize:i=Se}=t.payload||{},o={..._e(0,i),content:je(r)};return ut({title:e.title,pageSize:i,pages:[o]})}case P.UPDATE_TITLE:return{...e,title:t.payload,updatedAt:n};case P.UPDATE_PAGE_CONTENT:{const{pageIndex:r,content:i}=t.payload;if(r<0||r>=e.pages.length)return e;const o=[...e.pages];return o[r]={...o[r],content:je(i)},{...e,pages:o,updatedAt:n}}case P.UPDATE_PAGES:{const r=Array.isArray(t.payload)?{pages:t.payload}:t.payload||{},i=Ft(r.pages||[],e.pageSize),o=Array.isArray(r.pageBreaks)?r.pageBreaks:Pe(i);return{...e,pages:i,activePage:Math.min(e.activePage,i.length-1),pageBreaks:o,totalPages:i.length,updatedAt:n}}case P.ADD_PAGE:{const r=typeof t.payload?.index=="number"?Math.min(Math.max(t.payload.index,0),e.pages.length):e.pages.length,i=[...e.pages];i.splice(r,0,_e(r,e.pageSize));const o=i.map((l,d)=>({...l,index:d,size:e.pageSize})),s=Pe(o);return{...e,pages:o,activePage:r,pageBreaks:s,totalPages:o.length,updatedAt:n}}case P.DELETE_PAGE:{const r=t.payload;if(e.pages.length<=1)return e;const i=[...e.pages];i.splice(r,1);const o=i.map((d,u)=>({...d,index:u,size:e.pageSize}));let s=e.activePage;s>=o.length?s=o.length-1:r<=s&&s>0&&(s-=1);const l=Pe(o);return{...e,pages:o,activePage:s,pageBreaks:l,totalPages:o.length,updatedAt:n}}case P.SET_ACTIVE_PAGE:{const r=t.payload;if(r===e.activePage)return e;const i=e.editorMode==="continuous"?e.pageBoundaries.length:e.pages.length;return r<0||r>=i?e:{...e,activePage:r,updatedAt:n}}case P.UPDATE_PAGE_SIZE:{const r=t.payload;if(r===e.pageSize)return e;try{xe(r)}catch{return console.warn(`Invalid page size: ${r}`),e}const i=e.pages.map((s,l)=>({...s,index:l,size:r})),o=Pe(i);return{...e,pageSize:r,pages:i,pageBreaks:o,updatedAt:n}}case P.RESET_DOCUMENT:return ut();case P.UPDATE_CONTINUOUS_CONTENT:{const r=je(t.payload);return r===e.continuousContent?e:{...e,continuousContent:r,updatedAt:n}}case P.UPDATE_PAGE_BOUNDARIES:{const r=Array.isArray(t.payload)?t.payload:[];if(r.length===e.pageBoundaries.length&&r.length>0&&r[0].id===e.pageBoundaries[0]?.id&&r[r.length-1].id===e.pageBoundaries[r.length-1]?.id)return e;const i=e.activePage>=r.length?Math.max(0,r.length-1):e.activePage;return{...e,pageBoundaries:r,totalPages:r.length,activePage:i,updatedAt:n}}case P.ADD_PAGE_BREAK:{const{position:r="end",pageIndex:i}=t.payload||{},o='<page-break data-page-break="true" style="display: block; height: 20px; border-top: 2px dashed #ccc; margin: 20px 0; page-break-after: always;"></page-break>';let s=e.continuousContent;if(r==="end")s=s+o+"<p><br></p>";else if(typeof r=="number"){const l=s.substring(0,r),d=s.substring(r);s=l+o+d}else if(typeof i=="number"&&typeof document<"u"){const l=document.createElement("div");l.innerHTML=s;const d=l.querySelectorAll('page-break, [data-page-break="true"]');if(i===0&&d.length===0)s=s+o+"<p><br></p>";else if(i<d.length){const u=d[i],m=document.createElement("page-break");m.setAttribute("data-page-break","true"),m.setAttribute("style","display: block; height: 20px; border-top: 2px dashed #ccc; margin: 20px 0; page-break-after: always;");const f=document.createElement("p");f.innerHTML="<br>",u.parentNode.insertBefore(m,u.nextSibling),m.parentNode.insertBefore(f,m.nextSibling),s=l.innerHTML}else s=s+o+"<p><br></p>"}return{...e,continuousContent:s,updatedAt:n}}case P.REMOVE_PAGE_BREAK:{const{pageIndex:r}=t.payload||{};if(typeof r!="number"||typeof document>"u")return e;const i=document.createElement("div");i.innerHTML=e.continuousContent;const o=i.querySelectorAll('page-break, [data-page-break="true"]');return o[r]&&o[r].remove(),i.querySelectorAll('page-break, [data-page-break="true"]').forEach((l,d)=>{l.setAttribute("data-page-number",String(d+2))}),{...e,continuousContent:i.innerHTML,updatedAt:n}}case P.SET_EDITOR_MODE:{const r=t.payload;if(r===e.editorMode)return e;let i=e.continuousContent,o=e.pages;return r==="continuous"?i=e.pages.map(l=>l.content).filter(l=>l&&l!==de).join(`
`)||de:e.continuousContent&&e.continuousContent!==de&&(o=[{..._e(0,e.pageSize),content:e.continuousContent}]),{...e,editorMode:r,continuousContent:i,pages:o,updatedAt:n}}case P.SET_ZOOM_LEVEL:{const r=t.payload;return r<st||r>it?(console.warn(`Invalid zoom level: ${r}. Must be between ${st} and ${it}.`),e):r===e.zoomLevel?e:{...e,zoomLevel:r,updatedAt:n}}case P.ZOOM_IN:{if(!at(e.zoomLevel))return e;const r=e.zoomLevel+zt;return{...e,zoomLevel:r,updatedAt:n}}case P.ZOOM_OUT:{if(!lt(e.zoomLevel))return e;const r=e.zoomLevel-zt;return{...e,zoomLevel:r,updatedAt:n}}case P.RESET_ZOOM:return e.zoomLevel===ot?e:{...e,zoomLevel:ot,updatedAt:n};case P.UPDATE_PAGE_MARGINS:{const r=t.payload;return r===e.pageMargins?e:{...e,pageMargins:r,updatedAt:n}}case P.RECORD_OPERATION:{const{operation:r,inverseOperation:i}=t.payload;return{...e,undoStack:[...e.undoStack,{operation:r,inverseOperation:i}],redoStack:[],canUndo:!0,canRedo:!1,updatedAt:n}}case P.UNDO:{if(e.undoStack.length===0)return e;const r=e.undoStack[e.undoStack.length-1],i=e.undoStack.slice(0,-1);let o=e;return r.inverseOperation&&(o=dt(e,r.inverseOperation)),{...o,undoStack:i,redoStack:[...e.redoStack,r],canUndo:i.length>0,canRedo:!0,updatedAt:n}}case P.REDO:{if(e.redoStack.length===0)return e;const r=e.redoStack[e.redoStack.length-1],i=e.redoStack.slice(0,-1);let o=e;return r.operation&&(o=dt(e,r.operation)),{...o,undoStack:[...e.undoStack,r],redoStack:i,canUndo:!0,canRedo:i.length>0,updatedAt:n}}case P.CLEAR_UNDO_REDO:return{...e,undoStack:[],redoStack:[],canUndo:!1,canRedo:!1,updatedAt:n};default:return e}},Ut=c.createContext(null),fr=({children:e,initialState:t={}})=>{const[n,r]=c.useReducer(dt,ut(t)),i=c.useMemo(()=>({initializeDocument:s=>r({type:P.INITIALIZE_DOCUMENT,payload:s}),updateTitle:s=>r({type:P.UPDATE_TITLE,payload:s}),updatePageContent:s=>r({type:P.UPDATE_PAGE_CONTENT,payload:s}),updatePages:s=>r({type:P.UPDATE_PAGES,payload:s}),addPage:s=>r({type:P.ADD_PAGE,payload:s}),deletePage:s=>r({type:P.DELETE_PAGE,payload:s}),setActivePage:s=>r({type:P.SET_ACTIVE_PAGE,payload:s}),updatePageSize:s=>r({type:P.UPDATE_PAGE_SIZE,payload:s}),resetDocument:()=>r({type:P.RESET_DOCUMENT}),updateContinuousContent:s=>r({type:P.UPDATE_CONTINUOUS_CONTENT,payload:s}),updatePageBoundaries:s=>r({type:P.UPDATE_PAGE_BOUNDARIES,payload:s}),addPageBreak:s=>r({type:P.ADD_PAGE_BREAK,payload:s}),removePageBreak:s=>r({type:P.REMOVE_PAGE_BREAK,payload:s}),setEditorMode:s=>r({type:P.SET_EDITOR_MODE,payload:s}),setZoomLevel:s=>r({type:P.SET_ZOOM_LEVEL,payload:s}),zoomIn:()=>r({type:P.ZOOM_IN}),zoomOut:()=>r({type:P.ZOOM_OUT}),resetZoom:()=>r({type:P.RESET_ZOOM}),updatePageMargins:s=>r({type:P.UPDATE_PAGE_MARGINS,payload:s}),recordOperation:(s,l)=>r({type:P.RECORD_OPERATION,payload:{operation:s,inverseOperation:l}}),undo:()=>r({type:P.UNDO}),redo:()=>r({type:P.REDO}),clearUndoRedo:()=>r({type:P.CLEAR_UNDO_REDO})}),[]),o=c.useMemo(()=>({state:n,actions:i,dispatch:r}),[n,i]);return a.jsx(Ut.Provider,{value:o,children:e})},ft=()=>{const e=c.useContext(Ut);if(!e)throw new Error("useDocument must be used within a DocumentProvider");return e},gt=()=>{const{state:e}=ft();return e},ae=()=>{const{actions:e}=ft();return e},ht={"7.5pt":{pt:7.5,px:10,label:"7.5"},"9pt":{pt:9,px:12,label:"9"},"10pt":{pt:10,px:13,label:"10"},"11pt":{pt:11,px:15,label:"11"},"12pt":{pt:12,px:16,label:"12"},"14pt":{pt:14,px:19,label:"14"},"16pt":{pt:16,px:21,label:"16"},"18pt":{pt:18,px:24,label:"18"},"20pt":{pt:20,px:27,label:"20"},"22pt":{pt:22,px:29,label:"22"},"24pt":{pt:24,px:32,label:"24"},"26pt":{pt:26,px:35,label:"26"},"28pt":{pt:28,px:37,label:"28"},"36pt":{pt:36,px:48,label:"36"},"48pt":{pt:48,px:64,label:"48"},"72pt":{pt:72,px:96,label:"72"}},Wt=[{value:"10px",label:"7.5",pt:7.5},{value:"12px",label:"9",pt:9},{value:"13px",label:"10",pt:10},{value:"15px",label:"11",pt:11},{value:"16px",label:"12",pt:12},{value:"19px",label:"14",pt:14},{value:"21px",label:"16",pt:16},{value:"24px",label:"18",pt:18},{value:"27px",label:"20",pt:20},{value:"32px",label:"24",pt:24},{value:"37px",label:"28",pt:28},{value:"48px",label:"36",pt:36},{value:"64px",label:"48",pt:48},{value:"96px",label:"72",pt:72}],Ne="16px",Gt=e=>Math.round(e*96/72),qt=e=>Math.round(e*72/96*2)/2,gr=e=>{const t=Object.values(ht).find(n=>n.pt===e);return t?`${t.px}px`:`${Gt(e)}px`},hr=e=>{const t=parseInt(e),n=Object.values(ht).find(r=>r.px===t);return n?n.pt:qt(t)},pr=e=>{if(!e)return!1;if(e.endsWith("px")){const t=parseInt(e);return t>=8&&t<=144}if(e.endsWith("pt")){const t=parseFloat(e);return t>=6&&t<=108}return!1},mr={"10px":"1","12px":"2","13px":"2","15px":"3","16px":"3","19px":"4","21px":"4","24px":"5","27px":"5","32px":"6","37px":"6","48px":"6","64px":"7","96px":"7"},Zt={bold:!1,italic:!1,underline:!1,strikethrough:!1,alignLeft:!1,alignCenter:!1,alignRight:!1,alignJustify:!1,fontFamily:"Arial",fontSize:Ne,fontColor:"#000000",headingLevel:"p"},Vt=()=>{const[e,t]=c.useState(Zt),n=ae(),r=c.useCallback((h,p,y=null)=>{try{const b=window.getSelection();if(!b||b.rangeCount===0)return!1;const k=b.getRangeAt(0);if(!k.toString())return t(O=>({...O,[h]:p})),!1;try{const O=document.createElement("span");O.style[h]=p;const v=k.extractContents();return O.appendChild(v),k.insertNode(O),k.selectNodeContents(O),b.removeAllRanges(),b.addRange(k),t(M=>({...M,[h]:p})),!0}catch{if(y){const O=h==="fontSize"?mr[p]||"3":p;return document.execCommand(y,!1,O),t(v=>({...v,[h]:p})),!0}return!1}}catch(b){return console.warn(`[useFormatting] Style application failed for ${h}:`,b),!1}},[]),i=c.useCallback(h=>r("fontFamily",h,"fontName"),[r]),o=c.useCallback(h=>r("fontSize",h,"fontSize"),[r]),s=c.useCallback(h=>r("color",h,"foreColor"),[r]),l=c.useCallback(h=>{t(p=>({...p,alignLeft:h==="left",alignCenter:h==="center",alignRight:h==="right",alignJustify:h==="justify"}))},[]),d=c.useCallback(h=>{try{const p=window.getSelection();if(!p||p.rangeCount===0)return!1;const y=p.getRangeAt(0),b=y.toString(),_={justifyLeft:"left",justifyCenter:"center",justifyRight:"right",justifyFull:"justify"}[h];if(!_)return!1;if(!b){const v=y.startContainer,M=v.nodeType===Node.TEXT_NODE?v.parentElement:v,x=Le(M)||Er();return x&&(x.style.textAlign=_,l(_)),!0}const O=br(y);if(O.length===0){const v=document.createElement("p");v.style.textAlign=_;const M=y.extractContents();v.appendChild(M),y.insertNode(v),y.selectNodeContents(v),p.removeAllRanges(),p.addRange(y)}else O.forEach(v=>{v.style.textAlign=_});return l(_),!0}catch(p){return console.warn("[useFormatting] Text alignment failed:",p),!1}},[l]),u=c.useCallback(h=>{try{const p=window.getSelection();if(!p||p.rangeCount===0)return!1;const y=p.getRangeAt(0),b=document.createElement("div");if(b.innerHTML=h,Array.from(b.children).some(_=>["TABLE","UL","OL","BLOCKQUOTE","PRE","DIV","H1","H2","H3","H4","H5","H6"].includes(_.tagName))){const _=y.startContainer,O=_.nodeType===Node.TEXT_NODE?_.parentElement:_,v=Le(O);if(v&&["P","H1","H2","H3","H4","H5","H6"].includes(v.tagName)){const M=v.tagName.toLowerCase();if(y.startOffset===0&&(_===v||_.nodeType===Node.TEXT_NODE&&_===v.firstChild))v.parentNode.insertBefore(b,v);else if(y.startOffset===_.textContent?.length&&_===v.lastChild&&y.endOffset===_.textContent?.length){const C=v.nextSibling;C?v.parentNode.insertBefore(b,C):v.parentNode.appendChild(b)}else{const C=y.extractContents(),N=document.createTextNode(""),T=document.createElement(M);T.appendChild(N),T.appendChild(C);const L=v.parentNode;L.insertBefore(b,v.nextSibling),L.insertBefore(T,b.nextSibling),!v.textContent.trim()&&v.children.length===0&&L.removeChild(v)}}else y.insertNode(b);y.setStartAfter(b),y.setEndAfter(b),p.removeAllRanges(),p.addRange(y)}else document.execCommand("insertHTML",!1,h);return!0}catch(p){console.warn("[useFormatting] InsertHTML failed:",p);try{return document.execCommand("insertHTML",!1,h),!0}catch(y){return console.warn("[useFormatting] InsertHTML fallback also failed:",y),!1}}},[]),m=c.useCallback((h,p=null)=>{try{if(h==="undo"){n.undo();return}if(h==="redo"){n.redo();return}if(typeof document.execCommand!="function"){console.warn("[useFormatting] execCommand not supported");return}if(h==="insertHTML"&&p){u(p);return}if(h==="fontSize"){o(p);return}if(h==="fontName"){i(p);return}if(h==="foreColor"){s(p);return}if(["justifyLeft","justifyCenter","justifyRight","justifyFull"].includes(h)){d(h);return}switch(document.execCommand(h,!1,p)||console.warn(`[useFormatting] Command "${h}" failed`),h){case"bold":case"italic":case"underline":case"strikethrough":case"justifyLeft":case"justifyCenter":case"justifyRight":case"justifyFull":case"fontName":case"foreColor":break;case"formatBlock":t(b=>({...b,headingLevel:p}));break;default:break}}catch(y){console.warn(`[useFormatting] Error executing command "${h}":`,y)}},[o,i,d,u,n]),f=c.useCallback(()=>{try{const h=window.getSelection();if(!h||h.rangeCount===0)return;const p=h.getRangeAt(0),y=p.toString();let b=Ne,k="Arial",_="#000000",O="p",v="left";if(y){const x=p.startContainer,S=x.nodeType===Node.TEXT_NODE?x.parentElement:x;if(S){const C=window.getComputedStyle(S),N=C.fontSize,T=C.fontFamily;N&&N.endsWith("px")&&(b=N),T&&T!=="serif"&&(k=T.split(",")[0].replace(/['"]/g,"").trim());const L=C.color;L&&L!=="rgb(0, 0, 0)"&&L!=="#000000"&&(L.startsWith("rgb")?_=xr(L):_=L);const D=Le(S);if(D){const R=D.tagName?.toLowerCase();["h1","h2","h3","h4","h5","h6","p"].includes(R)&&(O=R);const U=window.getComputedStyle(D).textAlign;["left","center","right","justify"].includes(U)&&(v=U)}}}const M={bold:document.queryCommandState("bold"),italic:document.queryCommandState("italic"),underline:document.queryCommandState("underline"),strikethrough:document.queryCommandState("strikethrough"),alignLeft:v==="left",alignCenter:v==="center",alignRight:v==="right",alignJustify:v==="justify",fontFamily:k,fontSize:b,fontColor:_,headingLevel:O};t(x=>({...x,...M}))}catch(h){console.warn("[useFormatting] Error updating format from selection:",h)}},[]),g=c.useCallback(()=>{t(Zt)},[]);return{currentFormat:e,formatText:m,resetFormat:g,updateCurrentFormatFromSelection:f}};function xr(e){const t=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);if(!t)return"#000000";const n=parseInt(t[1],10),r=parseInt(t[2],10),i=parseInt(t[3],10);return`#${((1<<24)+(n<<16)+(r<<8)+i).toString(16).slice(1)}`}function Le(e){let t=e;for(;t&&t!==document.body;){const n=t.tagName?.toLowerCase();if(["h1","h2","h3","h4","h5","h6","p"].includes(n))return t;if(t.contentEditable==="true"||t.contentEditable==="")break;t=t.parentElement}return null}function br(e){const t=[],n=e.startContainer,r=e.endContainer,i=Le(n.nodeType===Node.TEXT_NODE?n.parentElement:n),o=Le(r.nodeType===Node.TEXT_NODE?r.parentElement:r);if(i===o&&i)return[i];const s=document.createTreeWalker(e.commonAncestorContainer,NodeFilter.SHOW_ELEMENT,{acceptNode:d=>{const u=d.tagName?.toLowerCase();return["h1","h2","h3","h4","h5","h6","p"].includes(u)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});let l=s.nextNode();for(;l;)e.intersectsNode(l)&&t.push(l),l=s.nextNode();return t}function Er(){try{const e=window.getSelection();if(!e||e.rangeCount===0)return null;const t=e.getRangeAt(0),n=document.createElement("p");return n.innerHTML="<br>",t.insertNode(n),t.selectNodeContents(n),t.collapse(!0),e.removeAllRanges(),e.addRange(t),n}catch(e){return console.warn("[useFormatting] Failed to create paragraph at cursor:",e),null}}const le='page-break, [data-page-break="true"]',yr=(e,t={})=>{if(!e||typeof document>"u")return[];const n=t.pageSize||"A4",r=xe(n),i=e.querySelectorAll(le),o=[];o.push({id:"page-0",pageNumber:1,top:0,height:r.height});const s=e.getBoundingClientRect(),l=e.scrollTop;return i.forEach((d,u)=>{const f=d.getBoundingClientRect().top-s.top+l;o.push({id:`page-${u+1}`,pageNumber:u+2,top:f,height:r.height})}),o},Yt=(e,t=100,n=ie)=>{const r=xe(e),i=sr(n),o=r.height-i,s=t/100;return o/s},Kt=(e,t)=>{if(!e||!t)return 0;try{const n=t.querySelectorAll(le);if(n.length===0)return 0;const r=e.getBoundingClientRect(),i=r.top+r.height/2;for(let o=n.length-1;o>=0;o--)if(n[o].getBoundingClientRect().top<i)return o+1;return 0}catch(n){return console.warn("[getCurrentPage] Failed to calculate page:",n),0}},Xt=e=>{if(!e)return[];const t=Array.from(e.children);if(t.length===0)return[];let n=[],r=[];for(const i of t)i.tagName==="PAGE-BREAK"||i.getAttribute("data-page-break")==="true"?r.length>0&&(n.push(r),r=[]):r.push(i);return r.length>0&&n.push(r),n.length===0&&t.length>0&&n.push(t.filter(i=>!(i.tagName==="PAGE-BREAK"||i.getAttribute("data-page-break")==="true"))),n},wr=e=>{if(!e||!e.getBoundingClientRect)return 0;const t=e.getBoundingClientRect();if(e.tagName==="P"){const n=e.querySelectorAll("img"),r=e.textContent.trim();if(n.length===1&&!r){const o=n[0].getBoundingClientRect(),l=window.getComputedStyle(e).textAlign;if(l==="center"||l==="-webkit-center")return o.height+16}return t.height+16}return e.tagName==="H1"||e.tagName==="H2"||e.tagName==="H3"||e.tagName==="H4"||e.tagName==="H5"||e.tagName==="H6"?t.height+20:e.tagName==="UL"||e.tagName==="OL"?t.height+16:t.height},Tr=(e,t)=>{if(!e)return!1;try{const n=document.createElement("page-break");return n.setAttribute("data-page-break","true"),n.setAttribute("contenteditable","false"),n.setAttribute("data-page-number",t||"2"),e.parentNode.insertBefore(n,e),!0}catch(n){return console.warn("[insertPageBreakBefore] Failed to insert page break:",n),!1}},Jt=(e,t,n,r,i,o,s)=>{if(!e)return!1;try{const d=Yt(n,r,i)*(t-1),u=Array.from(e.children);let m=0,f=null;for(let g=0;g<u.length;g++){const h=u[g];if(h.tagName==="PAGE-BREAK"||h.getAttribute("data-page-break")==="true")continue;const p=wr(h);if(m+p>d){f=h;break}m+=p}if(f){const g=document.createElement("page-break");if(g.setAttribute("data-page-break","true"),g.setAttribute("contenteditable","false"),g.setAttribute("data-page-number",String(t)),f.parentNode.insertBefore(g,f),o){const h=e.innerHTML;o(h)}return s&&setTimeout(()=>{s()},50),!0}else{const g=document.createElement("page-break");g.setAttribute("data-page-break","true"),g.setAttribute("contenteditable","false"),g.setAttribute("data-page-number",String(t)),e.appendChild(g);const h=document.createElement("p");if(h.innerHTML="<br>",e.appendChild(h),o){const p=e.innerHTML;o(p)}return s&&setTimeout(()=>{s()},50),!0}}catch(l){return console.error("[insertPageBreakAtBoundary] Failed to insert page break:",l),!1}},Qt=(e,t,n,r,i,o,s)=>{if(!e)return!1;if(n().length<=1)return console.warn("[removePageAndContent] Cannot delete the only page"),!1;try{const d=Array.from(e.querySelectorAll(le));if(t>d.length)return console.warn("[removePageAndContent] Invalid page index"),!1;const u=window.getSelection();let m=!1,f=[],g=null;if(t===0){const p=d[0];if(!p)return console.warn("[removePageAndContent] No page break found for first page"),!1;let y=e.firstChild;for(;y&&y!==p;)f.push(y),y=y.nextSibling;g=p}else{const p=d[t-1];if(!p)return console.warn("[removePageAndContent] Page break not found"),!1;const y=d[t];let b=p.nextSibling;for(;b&&b!==y;)f.push(b),b=b.nextSibling;g=p}if(u&&u.rangeCount>0){const y=u.getRangeAt(0).startContainer;for(const b of f)if(b.contains(y)||b===y){m=!0;break}}if(g&&g.parentNode&&g.remove(),f.forEach(p=>{p.parentNode&&p.remove()}),e.querySelectorAll(le).forEach((p,y)=>{p.setAttribute("data-page-number",String(y+2))}),m&&o&&setTimeout(()=>{o(0)},50),r){const p=e.innerHTML;r(p)}return i&&setTimeout(()=>{i(),s&&setTimeout(()=>{s()},150)},100),!0}catch(d){return console.error("[removePageAndContent] Failed to remove page:",d),!1}},Cr=e=>{if(e)try{e.querySelectorAll(le).forEach((n,r)=>{n.setAttribute("data-page-number",String(r+2))})}catch(t){console.error("[renumberPageBreaks] Failed to renumber page breaks:",t)}},en=(e,t,n,r,i)=>{if(!e||!t)return!1;try{if(e.remove(),Cr(t),n){const o=t.innerHTML;n(o)}return r&&setTimeout(()=>{r(),i&&setTimeout(()=>{i()},100)},50),!0}catch(o){return console.error("[removePageBreak] Failed to remove page break:",o),!1}},kr=200,vr=50,tn=3,Ar=20,nn=e=>{if(!e||!e.getBoundingClientRect)return 0;const t=e.getBoundingClientRect();if(e.tagName==="P"){const n=e.querySelectorAll("img"),r=e.textContent.trim();if(n.length===1&&!r){const o=n[0].getBoundingClientRect(),l=window.getComputedStyle(e).textAlign;if(l==="center"||l==="-webkit-center")return o.height+16}return t.height+16}return e.tagName==="H1"||e.tagName==="H2"||e.tagName==="H3"||e.tagName==="H4"||e.tagName==="H5"||e.tagName==="H6"?t.height+20:e.tagName==="UL"||e.tagName==="OL"?t.height+16:t.height},Sr=(e,t)=>{if(!e||e.length===0)return null;let n=0,r=null;for(let i=0;i<e.length;i++){const o=e[i];if(!o||!o.getBoundingClientRect)continue;const s=nn(o);if(s<1)continue;if(n+s>t)return r===null?i>0?{overflowIndex:i,overflowElement:o,accumulatedHeight:n}:null:{overflowIndex:i,overflowElement:o,accumulatedHeight:n};n+=s,r=o}return null},rn=(e,t,n,r,i,o,s,l)=>{if(!e||s.current)return!1;try{s.current=!0;const d=Yt(t,n,r);let u=Xt(e),m=!1,f=0;for(let g=0;g<u.length&&f<tn;g++){const h=u[g],p=Sr(h,d);if(p&&p.overflowIndex>0){let y=0;for(let O=0;O<h.length;O++){const v=h[O];v&&v.getBoundingClientRect&&(y+=nn(v))}if(y-d<Ar)continue;const k=g+2;Tr(p.overflowElement,k)&&(m=!0,f++,u=Xt(e))}}if(m){if(i){const g=e.innerHTML;i(g)}setTimeout(()=>{o&&o(),f>=tn&&l&&setTimeout(()=>{s.current||l()},100)},vr)}return m}catch(d){return console.warn("[checkAndReflow] Reflow failed:",d),!1}finally{s.current=!1}},on=(e,t,n=kr)=>{t.current&&clearTimeout(t.current),t.current=setTimeout(()=>{t.current=null,e()},n)},_r=400,pt=(e,t)=>{if(e){e.focus();try{let n=null,r=0;if(t===0)n=e.firstChild,r=0;else{const o=e.querySelectorAll(le)[t-1];o&&o.nextSibling&&(n=o.nextSibling,r=0)}if(n){const i=document.createRange(),o=window.getSelection();n.nodeType===Node.TEXT_NODE?i.setStart(n,r):i.setStart(n,0),i.collapse(!0),o.removeAllRanges(),o.addRange(i)}}catch(n){console.warn("[positionCursorAtPage] Failed to position cursor:",n)}}},sn=(e,t,n,r)=>{if(!e||!t){console.warn("[scrollToPage] Missing refs");return}try{let i=null;if(n===0)i=t;else{const s=t.querySelectorAll(le)[n-1];if(s)i=s;else{console.warn("[scrollToPage] Page break not found for page",n);return}}if(i){const o=i.getBoundingClientRect(),s=e.getBoundingClientRect(),l=e.scrollTop+(o.top-s.top);e.scrollTo({top:l,behavior:"smooth"}),setTimeout(()=>{r?r(n):pt(t,n)},_r)}}catch(i){console.error("[scrollToPage] Error:",i)}},Nr=(e,t,n={},r=300)=>{t.current&&clearTimeout(t.current),t.current=setTimeout(()=>{t.current=null,e(n)},Math.max(0,r))},Lr=e=>{if(!e)return null;const t=window.getSelection();if(t.rangeCount===0)return null;const n=t.getRangeAt(0);if(!e.contains(n.commonAncestorContainer))return null;let r=1;const i=e.querySelectorAll(le);for(const m of i)if(n.comparePoint(m,0)>0)r++;else break;const o=document.createRange();o.setStart(e,0),o.setEnd(n.startContainer,n.startOffset);const l=o.toString().replace(/<[^>]*>/g," ").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/\s+/g," ").trim(),d=l.length,u=(l.match(/\n/g)||[]).length+1;return{page:r,line:u,charOffset:d}},Or=300,an=(e,t,n=100,r="NARROW")=>{const i=ae(),o=c.useRef(null),s=c.useRef(null),l=c.useRef(e),d=c.useRef(n),u=c.useRef(r),m=c.useRef(!1);c.useEffect(()=>{l.current=e},[e]),c.useEffect(()=>{d.current=n},[n]),c.useEffect(()=>{u.current=r},[r]),c.useEffect(()=>()=>{o.current&&clearTimeout(o.current),s.current&&clearTimeout(s.current)},[]);const f=c.useCallback((x={})=>t?.current?yr(t.current,x):[],[t]),g=c.useCallback((x={})=>{const S=f(x);return i.updatePageBoundaries(S),S},[f,i]),h=c.useCallback((x={})=>{const S=typeof x.delay=="number"?x.delay:Or;Nr(g,o,x,S)},[g]),p=c.useCallback(()=>{t?.current&&rn(t.current,l.current,d.current,u.current,i.updateContinuousContent,g,m,p)},[t,i,g]),y=c.useCallback(x=>{on(p,s,x)},[p]),b=c.useCallback(x=>!x?.current||!t?.current?0:Kt(x.current,t.current),[t]),k=c.useCallback(x=>{t?.current&&pt(t.current,x)},[t]),_=c.useCallback((x,S)=>{if(!S?.current||!t?.current){console.warn("[scrollToPage] Missing refs");return}sn(S.current,t.current,x,k)},[t,k]),O=c.useCallback(async x=>t?.current?Jt(t.current,x,l.current,d.current,u.current,i.updateContinuousContent,g):!1,[t,i,g]),v=c.useCallback(x=>t?.current?Qt(t.current,x,f,i.updateContinuousContent,g,k,p):!1,[t,f,i,g,k,p]),M=c.useCallback(x=>t?.current?en(x,t.current,i.updateContinuousContent,g,p):!1,[t,i,g,p]);return c.useEffect(()=>()=>{o.current&&clearTimeout(o.current),s.current&&clearTimeout(s.current)},[]),c.useMemo(()=>({calculatePageBoundaries:f,checkAndUpdateBoundaries:h,updateBoundaries:g,getCurrentPage:b,scrollToPage:_,positionCursorAtPage:k,checkAndReflow:p,triggerAutoReflow:y,removePageAndContent:v,removePageBreak:M,insertPageBreakAtBoundary:O,boundaryTimeoutRef:o,reflowTimeoutRef:s}),[f,h,g,b,_,k,p,y,v,M,O])},fe=c.useCallback(()=>{editorRef?.current&&rn(editorRef.current,latestPageSizeRef.current,latestZoomLevelRef.current,latestPageMarginsRef.current,actions.updateContinuousContent,updateBoundaries,isReflowingRef,fe)},[editorRef,actions,updateBoundaries]);c.useCallback(e=>{on(fe,reflowTimeoutRef,e)},[fe]),c.useCallback(e=>!e?.current||!editorRef?.current?0:Kt(e.current,editorRef.current),[editorRef]);const Be=c.useCallback(e=>{editorRef?.current&&pt(editorRef.current,e)},[editorRef]);c.useCallback((e,t)=>{if(!t?.current||!editorRef?.current){console.warn("[scrollToPage] Missing refs");return}sn(t.current,editorRef.current,e,Be)},[editorRef,Be]),c.useCallback(async e=>editorRef?.current?Jt(editorRef.current,e,latestPageSizeRef.current,latestZoomLevelRef.current,latestPageMarginsRef.current,actions.updateContinuousContent,updateBoundaries):!1,[editorRef,actions,updateBoundaries]),c.useCallback(e=>editorRef?.current?Qt(editorRef.current,e,calculatePageBoundariesCallback,actions.updateContinuousContent,updateBoundaries,Be,fe):!1,[editorRef,calculatePageBoundariesCallback,actions,updateBoundaries,Be,fe]),c.useCallback(e=>editorRef?.current?en(e,editorRef.current,actions.updateContinuousContent,updateBoundaries,fe):!1,[editorRef,actions,updateBoundaries,fe]);const Mr=(e,t)=>{const{handleZoomIn:n,handleZoomOut:r,handleZoomReset:i,handleUndo:o,handleRedo:s}=e,{editorRef:l,containerRef:d}=t;c.useEffect(()=>{const u=m=>{if(m.ctrlKey||m.metaKey){["+","=","-","_","0","z","y"].includes(m.key)&&m.preventDefault();const f=document.activeElement===l.current,g=document.activeElement===d.current,h=document.activeElement?.tagName==="INPUT"||document.activeElement?.tagName==="TEXTAREA"||document.activeElement?.isContentEditable===!1;if(f||g||!h)switch(m.key){case"+":case"=":n();break;case"-":case"_":r();break;case"0":i();break;case"z":m.shiftKey||o();break;case"y":s();break}}};return window.addEventListener("keydown",u),()=>{window.removeEventListener("keydown",u)}},[n,r,i,o,s,l,d])},Rr=({updateCurrentFormatFromSelection:e,editorRef:t})=>{const n=c.useRef(null),r=c.useCallback(()=>{if(!t.current)return;const o=window.getSelection();if(n.current)try{o.removeAllRanges(),o.addRange(n.current);return}catch(l){console.warn("[restoreCursorPosition] Failed to restore cursor:",l)}const s=t.current.lastChild;if(s){const l=document.createRange();s.nodeType===Node.TEXT_NODE?l.setStart(s,s.textContent.length):l.setStartAfter(s),l.collapse(!0),o.removeAllRanges(),o.addRange(l)}},[t]),i=c.useCallback(()=>{if(!t.current)return!1;const o=window.getSelection();if(!o||o.rangeCount===0)return!1;const s=o.getRangeAt(0);return t.current.contains(s.commonAncestorContainer)},[t]);return c.useEffect(()=>{const o=()=>{if(e(),t.current){const l=window.getSelection();if(l.rangeCount>0){const d=l.getRangeAt(0);d.collapsed&&t.current.contains(d.commonAncestorContainer)&&(n.current=d.cloneRange())}}};document.addEventListener("selectionchange",o);const s=()=>{if(setTimeout(e,10),n.current&&t.current)try{const l=window.getSelection();l.removeAllRanges(),l.addRange(n.current)}catch(l){console.warn("[handleFocus] Failed to restore cursor:",l)}};return t.current&&t.current.addEventListener("focus",s),()=>{document.removeEventListener("selectionchange",o),t.current&&t.current.removeEventListener("focus",s)}},[e,t]),{restoreCursorPosition:r,hasActiveCursorSelection:i}},ge={minWidth:50,minHeight:50,maxWidth:800,maxHeight:600,aspectRatio:!0,preserveAspectRatio:!0,defaultWidth:300,defaultHeight:200},j={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP:"top",BOTTOM:"bottom",LEFT:"left",RIGHT:"right"};function Ir({handler:e,startX:t,startY:n,currentX:r,currentY:i,startWidth:o,startHeight:s,options:l=ge}){const d=r-t,u=i-n;let m=o,f=s;switch(e){case j.TOP_LEFT:m=Math.max(l.minWidth,o-d),f=Math.max(l.minHeight,s-u);break;case j.TOP_RIGHT:m=Math.max(l.minWidth,o+d),f=Math.max(l.minHeight,s-u);break;case j.BOTTOM_LEFT:m=Math.max(l.minWidth,o-d),f=Math.max(l.minHeight,s+u);break;case j.BOTTOM_RIGHT:m=Math.max(l.minWidth,o+d),f=Math.max(l.minHeight,s+u);break;case j.TOP:f=Math.max(l.minHeight,s-u);break;case j.BOTTOM:f=Math.max(l.minHeight,s+u);break;case j.LEFT:m=Math.max(l.minWidth,o-d);break;case j.RIGHT:m=Math.max(l.minWidth,o+d);break;default:return{width:m,height:f}}if(l.preserveAspectRatio&&l.aspectRatio){const g=o/s;[j.TOP_LEFT,j.TOP_RIGHT,j.BOTTOM_LEFT,j.BOTTOM_RIGHT].includes(e)?m/g>f?f=Math.max(l.minHeight,m/g):m=Math.max(l.minWidth,f*g):[j.TOP,j.BOTTOM].includes(e)?m=f*g:[j.LEFT,j.RIGHT].includes(e)&&(f=m/g)}return l.maxWidth&&m>l.maxWidth&&(m=l.maxWidth,l.preserveAspectRatio&&l.aspectRatio&&(f=m/(o/s))),l.maxHeight&&f>l.maxHeight&&(f=l.maxHeight,l.preserveAspectRatio&&l.aspectRatio&&(m=f*(o/s))),m=Math.max(l.minWidth,m),f=Math.max(l.minHeight,f),{width:Math.round(m),height:Math.round(f)}}function ce(e){return e?!!(e.tagName==="IMG"||e.tagName==="DIV"&&e.style.backgroundImage&&e.style.backgroundImage!=="none"):!1}function jr(e){return ce(e)?{width:e.offsetWidth,height:e.offsetHeight}:{width:0,height:0}}function Pr(e,{width:t,height:n}){ce(e)&&(e.tagName==="IMG"?(e.style.width=`${t}px`,e.style.height=`${n}px`,e.width=t,e.height=n):e.tagName==="DIV"&&(e.style.width=`${t}px`,e.style.height=`${n}px`))}function ln(e,t=ge){if(!ce(e))return null;const n=document.createElement("div");n.className="image-resize-overlay",n.style.position="fixed",n.style.zIndex="1000",n.style.pointerEvents="none";const r=e.getBoundingClientRect();return n.style.top=`${r.top}px`,n.style.left=`${r.left}px`,n.style.width=`${r.width}px`,n.style.height=`${r.height}px`,Object.values(j).forEach(o=>{const s=document.createElement("div");s.className=`resize-handler resize-handler-${o}`,s.dataset.handler=o,s.style.position="absolute",s.style.width="10px",s.style.height="10px",s.style.backgroundColor="#007bff",s.style.border="2px solid white",s.style.borderRadius="50%",s.style.boxShadow="0 0 3px rgba(0,0,0,0.3)",s.style.cursor=Br(o),s.style.pointerEvents="all",cn(s,o,r.width,r.height),n.appendChild(s)}),n}function Br(e){switch(e){case j.TOP_LEFT:case j.BOTTOM_RIGHT:return"nwse-resize";case j.TOP_RIGHT:case j.BOTTOM_LEFT:return"nesw-resize";case j.TOP:case j.BOTTOM:return"ns-resize";case j.LEFT:case j.RIGHT:return"ew-resize";default:return"default"}}function cn(e,t,n,r){switch(t){case j.TOP_LEFT:e.style.top="-5px",e.style.left="-5px";break;case j.TOP_RIGHT:e.style.top="-5px",e.style.right="-5px";break;case j.BOTTOM_LEFT:e.style.bottom="-5px",e.style.left="-5px";break;case j.BOTTOM_RIGHT:e.style.bottom="-5px",e.style.right="-5px";break;case j.TOP:e.style.top="-5px",e.style.left=`${n/2+-5}px`;break;case j.BOTTOM:e.style.bottom="-5px",e.style.left=`${n/2+-5}px`;break;case j.LEFT:e.style.top=`${r/2+-5}px`,e.style.left="-5px";break;case j.RIGHT:e.style.top=`${r/2+-5}px`,e.style.right="-5px";break}}function He(e,t){if(!e||!t)return;const n=t.getBoundingClientRect();e.style.top=`${n.top}px`,e.style.left=`${n.left}px`,e.style.width=`${n.width}px`,e.style.height=`${n.height}px`,e.querySelectorAll(".resize-handler").forEach(i=>{const o=i.dataset.handler;cn(i,o,n.width,n.height)})}function De(e){e&&e.parentNode&&e.parentNode.removeChild(e)}const Hr="html-editor-storage",Dr=1,X="images";function zr(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function Oe(){return new Promise((e,t)=>{const n=indexedDB.open(Hr,Dr);n.onerror=()=>{t(new Error("Failed to open IndexedDB database"))},n.onsuccess=()=>{e(n.result)},n.onupgradeneeded=r=>{const i=r.target.result;i.objectStoreNames.contains(X)||i.createObjectStore(X,{keyPath:"key"}).createIndex("timestamp","timestamp",{unique:!1})}})}function un(e){return new Promise((t,n)=>{if(!["image/png","image/jpeg","image/gif","image/webp"].includes(e.type)){n(new Error("Invalid image format. Supported formats: png, jpeg, gif, webp"));return}if(e.size>5*1024*1024){n(new Error("Image exceeds maximum size of 5MB"));return}const i=new FileReader;i.onload=async o=>{const s=o.target.result,d=s.split(",")[1].length*3/4;if(d>5*1024*1024){n(new Error("Image exceeds maximum size of 5MB"));return}try{const u=await Oe(),m=`editor-image-${zr()}`,g=u.transaction([X],"readwrite").objectStore(X),h={key:m,dataUrl:s,size:d,type:e.type,timestamp:Date.now()},p=g.add(h);p.onsuccess=()=>{u.close(),t(m)},p.onerror=()=>{u.close(),n(new Error("Failed to save image to IndexedDB"))}}catch(u){n(u)}},i.onerror=()=>{n(new Error("Error reading image file"))},i.readAsDataURL(e)})}async function dn(e){try{const t=await Oe();return new Promise((n,r)=>{const s=t.transaction([X],"readonly").objectStore(X).get(e);s.onsuccess=()=>{t.close();const l=s.result;n(l?l.dataUrl:null)},s.onerror=()=>{t.close(),r(new Error("Failed to retrieve image from IndexedDB"))}})}catch(t){return console.error("Error getting image:",t),null}}async function fn(e){try{const t=await Oe();return new Promise((n,r)=>{const s=t.transaction([X],"readwrite").objectStore(X).delete(e);s.onsuccess=()=>{t.close(),n()},s.onerror=()=>{t.close(),r(new Error("Failed to delete image from IndexedDB"))}})}catch(t){console.error("Error deleting image:",t)}}async function $r(){try{const e=await Oe();return new Promise((t,n)=>{const o=e.transaction([X],"readwrite").objectStore(X).clear();o.onsuccess=()=>{e.close(),t()},o.onerror=()=>{e.close(),n(new Error("Failed to clear images from IndexedDB"))}})}catch(e){console.error("Error clearing images:",e)}}async function Fr(){try{const e=await Oe();return new Promise((t,n)=>{const o=e.transaction([X],"readonly").objectStore(X).getAllKeys();o.onsuccess=()=>{e.close(),t(o.result||[])},o.onerror=()=>{e.close(),n(new Error("Failed to get image keys from IndexedDB"))}})}catch(e){return console.error("Error getting image keys:",e),[]}}const gn=["P","DIV","H1","H2","H3","H4","H5","H6","UL","OL","LI","TABLE","TBODY","TR","TD","TH","THEAD","TFOOT","BLOCKQUOTE","PRE","HR","FIGURE","FIGCAPTION","PAGE-BREAK"],Ur=["SPAN","STRONG","EM","B","I","U","S","STRIKE","DEL","INS","SUB","SUP","MARK","SMALL","CODE","KBD","SAMP","VAR","A","ABBR","CITE","DFN","TIME"],Wr=["BR","HR","IMG","INPUT","PAGE-BREAK"];function Gr(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}function hn(e){const t=[];for(let n=0;n<e.attributes.length;n++){const r=e.attributes[n];t.push(` ${r.name}="${r.value}"`)}return t.join("")}function ze(e){if(!e||typeof e!="string")return"<p><br></p>";const t=e.trim();if(!t)return"<p><br></p>";const n=document.createElement("div");return n.innerHTML=t,Me(n)||"<p><br></p>"}function qr(e){const t=e.cloneNode(!0);return t.querySelectorAll(":scope > p").forEach(r=>{for(;r.firstChild;)t.insertBefore(r.firstChild,r);r.remove()}),t.innerHTML}function Zr(e){const t=Array.from(e.children);return t.length===0?!1:t.every(n=>gn.includes(n.tagName))}function Vr(e){const t=[];let n=!1;return Array.from(e.childNodes).forEach(r=>{if(r.nodeType===Node.TEXT_NODE)r.textContent.trim()&&(n=!0);else if(r.nodeType===Node.ELEMENT_NODE){const i=r;gn.includes(i.tagName)?t.push(i.outerHTML):n=!0}}),n?e.outerHTML:t.join("")}function Me(e){const t=[],n=Array.from(e.childNodes);for(let r=0;r<n.length;r++){const i=n[r];if(i.nodeType===Node.TEXT_NODE){const o=i.textContent.trim();o&&t.push(`<p>${Gr(o)}</p>`)}else if(i.nodeType===Node.ELEMENT_NODE){const o=i,s=o.tagName,l=s.toLowerCase(),d=hn(o);if(s==="DIV"){const u=Me(o);u.trim()?t.push(u):t.push("<p><br></p>")}else if(s==="P")Zr(o)?t.push(Vr(o)):t.push(o.outerHTML);else if(["H1","H2","H3","H4","H5","H6"].includes(s)){const u=qr(o);t.push(`<${l}${d}>${u}</${l}>`)}else if(s==="BR")t.push("<p><br></p>");else if(s==="IMG")t.push(o.outerHTML);else if(["UL","OL"].includes(s))t.push(Yr(o));else if(s==="LI")t.push(o.outerHTML);else if(s==="TABLE")t.push(Kr(o));else if(["TBODY","THEAD","TFOOT","TR","TD","TH"].includes(s))t.push(o.outerHTML);else if(s==="BLOCKQUOTE"){const u=Me(o);t.push(`<blockquote${d}>${u}</blockquote>`)}else if(s==="PRE")t.push(o.outerHTML);else if(Ur.includes(s))t.push(o.outerHTML);else if(s==="PAGE-BREAK"||o.getAttribute("data-page-break")==="true")t.push(o.outerHTML);else if(s==="HR")t.push(o.outerHTML);else if(s==="FIGURE")t.push(o.outerHTML);else if(Wr.includes(s))t.push(o.outerHTML);else{const u=Me(o);t.push(`<${l}${d}>${u}</${l}>`)}}}return t.length===0?"":t.join("")}function Yr(e){const t=e.tagName.toLowerCase(),n=hn(e),r=[];return Array.from(e.children).forEach(i=>{if(i.tagName==="LI")r.push(i.outerHTML);else{const o=Me(i);o.trim()&&r.push(`<li>${o}</li>`)}}),r.length===0?`<${t}${n}><li><br></li></${t}>`:`<${t}${n}>${r.join("")}</${t}>`}function Kr(e){return e.outerHTML}/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xr=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Jr=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,r)=>r?r.toUpperCase():n.toLowerCase()),pn=e=>{const t=Jr(e);return t.charAt(0).toUpperCase()+t.slice(1)},mn=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim(),Qr=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var eo={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const to=c.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:o,iconNode:s,...l},d)=>c.createElement("svg",{ref:d,...eo,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:mn("lucide",i),...!o&&!Qr(l)&&{"aria-hidden":"true"},...l},[...s.map(([u,m])=>c.createElement(u,m)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=(e,t)=>{const n=c.forwardRef(({className:r,...i},o)=>c.createElement(to,{ref:o,iconNode:t,className:mn(`lucide-${Xr(pn(e))}`,`lucide-${e}`,r),...i}));return n.displayName=pn(e),n};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const no=q("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=q("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oo=q("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const so=q("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const io=q("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ao=q("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lo=q("file-check",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=q("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const co=q("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uo=q("heading-1",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fo=q("heading-2",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const go=q("heading-3",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17.5 10.5c1.7-1 3.5 0 3.5 1.5a2 2 0 0 1-2 2",key:"68ncm8"}],["path",{d:"M17 17.5c2 1.5 4 .3 4-1.5a2 2 0 0 0-2-2",key:"1ejuhz"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ho=q("image-upscale",[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M17 21h2a2 2 0 0 0 2-2",key:"130fy9"}],["path",{d:"M21 12v3",key:"1wzk3p"}],["path",{d:"m21 3-5 5",key:"1g5oa7"}],["path",{d:"M3 7V5a2 2 0 0 1 2-2",key:"kk3yz1"}],["path",{d:"m5 21 4.144-4.144a1.21 1.21 0 0 1 1.712 0L13 19",key:"fyekpt"}],["path",{d:"M9 3h3",key:"d52fa"}],["rect",{x:"3",y:"11",width:"10",height:"10",rx:"1",key:"1wpmix"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const po=q("list",[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mo=q("palette",[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xo=q("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bo=q("scaling",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M14 15H9v-5",key:"pi4jk9"}],["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M21 3 9 15",key:"15kdhq"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eo=q("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xn=q("text-align-center",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 19H5",key:"vjpgq2"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bn=q("text-align-end",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 19H7",key:"4cu937"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const En=q("text-align-start",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=q("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yo=q("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wo=q("zoom-in",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const To=q("zoom-out",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),yn=(e,t,n="")=>{if(!e)return[];const r=document.createElement("div");r.innerHTML=e;const i=r.querySelectorAll("h1, h2, h3, h4, h5, h6");return Array.from(i).map((o,s)=>{const l=parseInt(o.tagName.charAt(1)),d=o.textContent.trim();return d?{id:`${n}heading-${s}`,level:l,text:d,page:t||1}:null}).filter(Boolean)},Co=e=>{if(!e)return 0;const t=document.createElement("div");return t.innerHTML=e,(t.textContent||t.innerText||"").trim().split(/\s+/).filter(r=>r.length>0).length},wn=({isCollapsed:e,onToggle:t,wordCount:n,pageCount:r})=>{const i=gt(),{pages:o,activePage:s,continuousContent:l}=i,{wordCount:d,outline:u}=c.useMemo(()=>{if(n!==void 0&&r!==void 0)return{wordCount:n,outline:yn(l,1,"continuous-")};let f=0;const g=[];return o.forEach((h,p)=>{f+=Co(h.content),g.push(...yn(h.content,p+1,`page-${p}-`))}),{wordCount:f,outline:g}},[o,n,r,l]),m=r!==void 0?r:o.length;return a.jsxs("aside",{className:`sidebar ${e?"collapsed":""}`,role:"complementary","aria-label":"Document information","data-testid":"sidebar",children:[a.jsxs("div",{className:"sidebar-header",children:[a.jsxs("div",{className:"sidebar-title",children:[a.jsx(mt,{size:18}),a.jsx("h2",{children:"Document Info"})]}),a.jsx("button",{className:"sidebar-toggle",onClick:t,"aria-label":e?"Expand sidebar":"Collapse sidebar",title:e?"Expand sidebar":"Collapse sidebar",children:e?a.jsx(ao,{size:16}):a.jsx(io,{size:16})})]}),!e&&a.jsxs("div",{className:"sidebar-content",children:[a.jsxs("div",{className:"sidebar-section",children:[a.jsx("h3",{children:"Statistics"}),a.jsxs("div",{className:"stat-item",children:[a.jsxs("div",{className:"stat-label",children:[a.jsx(lo,{size:14}),a.jsx("span",{children:"Pages:"})]}),a.jsx("span",{className:"stat-value",children:m})]}),a.jsxs("div",{className:"stat-item","data-testid":"word-count",children:[a.jsxs("div",{className:"stat-label",children:[a.jsx(co,{size:14}),a.jsx("span",{children:"Words:"})]}),a.jsx("span",{className:"stat-value",children:d.toLocaleString()})]}),a.jsxs("div",{className:"stat-item",children:[a.jsxs("div",{className:"stat-label",children:[a.jsx(mt,{size:14}),a.jsx("span",{children:"Active Page:"})]}),a.jsx("span",{className:"stat-value",children:s+1})]})]}),u.length>0&&a.jsxs("div",{className:"sidebar-section",children:[a.jsxs("h3",{children:[a.jsx(po,{size:14,style:{display:"inline-block",marginRight:"6px",verticalAlign:"middle"}}),"Document Outline"]}),a.jsx("div",{className:"document-outline","data-testid":"outline",children:u.map(f=>{const g=f.level===1?uo:f.level===2?fo:go;return a.jsxs("div",{className:`outline-item outline-level-${f.level}`,style:{marginLeft:`${(f.level-1)*12}px`},children:[a.jsx(g,{size:12,className:"outline-icon"}),a.jsx("span",{className:"outline-text",children:f.text}),a.jsxs("span",{className:"outline-page",children:["p.",f.page]})]},f.id)})})]})]})]})},ko=({size:e=16,...t})=>a.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("path",{d:"M6 4h8a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"}),a.jsx("path",{d:"M6 12h9a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"})]}),vo=({size:e=16,...t})=>a.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("line",{x1:"19",y1:"4",x2:"10",y2:"4"}),a.jsx("line",{x1:"14",y1:"20",x2:"5",y2:"20"}),a.jsx("line",{x1:"15",y1:"4",x2:"9",y2:"20"})]}),Ao=({size:e=16,...t})=>a.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("path",{d:"M6 3v7a6 6 0 0 0 6 6 6 6 0 0 0 6-6V3"}),a.jsx("line",{x1:"4",y1:"21",x2:"20",y2:"21"})]}),So=({size:e=16,...t})=>a.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("path",{d:"M16 4H9a3 3 0 0 0-3 3v10a3 3 0 0 0 3 3h7"}),a.jsx("path",{d:"M14 4H7a3 3 0 0 0-3 3v10a3 3 0 0 0 3 3h7"}),a.jsx("line",{x1:"4",y1:"12",x2:"20",y2:"12"})]}),_o=({size:e=16,...t})=>a.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("line",{x1:"21",y1:"6",x2:"3",y2:"6"}),a.jsx("line",{x1:"15",y1:"12",x2:"3",y2:"12"}),a.jsx("line",{x1:"17",y1:"18",x2:"3",y2:"18"})]}),No=({size:e=16,...t})=>a.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("line",{x1:"21",y1:"6",x2:"3",y2:"6"}),a.jsx("line",{x1:"17",y1:"12",x2:"7",y2:"12"}),a.jsx("line",{x1:"19",y1:"18",x2:"5",y2:"18"})]}),Lo=({size:e=16,...t})=>a.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("line",{x1:"21",y1:"6",x2:"3",y2:"6"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"}),a.jsx("line",{x1:"21",y1:"18",x2:"7",y2:"18"})]}),Oo=({size:e=16,...t})=>a.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("line",{x1:"21",y1:"6",x2:"3",y2:"6"}),a.jsx("line",{x1:"21",y1:"12",x2:"3",y2:"12"}),a.jsx("line",{x1:"21",y1:"18",x2:"3",y2:"18"})]}),Mo=({size:e=16,...t})=>a.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("line",{x1:"8",y1:"6",x2:"21",y2:"6"}),a.jsx("line",{x1:"8",y1:"12",x2:"21",y2:"12"}),a.jsx("line",{x1:"8",y1:"18",x2:"21",y2:"18"}),a.jsx("line",{x1:"3",y1:"6",x2:"3.01",y2:"6"}),a.jsx("line",{x1:"3",y1:"12",x2:"3.01",y2:"12"}),a.jsx("line",{x1:"3",y1:"18",x2:"3.01",y2:"18"})]}),Ro=({size:e=16,...t})=>a.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("line",{x1:"10",y1:"6",x2:"21",y2:"6"}),a.jsx("line",{x1:"10",y1:"12",x2:"21",y2:"12"}),a.jsx("line",{x1:"10",y1:"18",x2:"21",y2:"18"}),a.jsx("path",{d:"M4 6h1.5"}),a.jsx("path",{d:"M4 12h1.5"}),a.jsx("path",{d:"M4 18h1.5"}),a.jsx("path",{d:"M6 6v0"}),a.jsx("path",{d:"M6 12v0"}),a.jsx("path",{d:"M6 18v0"})]}),Io=({size:e=16,...t})=>a.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),a.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]}),jo=({size:e=16,...t})=>a.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M3 10h18"}),a.jsx("path",{d:"M3 14h18"}),a.jsx("path",{d:"M3 18h18"}),a.jsx("path",{d:"M9 6v12"}),a.jsx("path",{d:"M15 6v12"})]}),Po=({size:e=16,...t})=>a.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),a.jsx("polyline",{points:"14,2 14,8 20,8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),a.jsx("line",{x1:"10",y1:"9",x2:"8",y2:"9"})]}),Bo=({size:e=16,...t})=>a.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("path",{d:"M3 7v6h6"}),a.jsx("path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"})]}),Ho=({size:e=16,...t})=>a.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("path",{d:"M21 7v6h-6"}),a.jsx("path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3L21 13"})]}),Do=({size:e=16,...t})=>a.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),a.jsx("circle",{cx:"9",cy:"9",r:"2"}),a.jsx("path",{d:"M21 15l-3.086-3.086a2 2 0 0 0-2.828 0L6 21"})]}),zo=({size:e=16,...t})=>a.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("polyline",{points:"3,8 7,12 3,16"}),a.jsx("line",{x1:"21",y1:"12",x2:"11",y2:"12"}),a.jsx("line",{x1:"21",y1:"6",x2:"11",y2:"6"}),a.jsx("line",{x1:"21",y1:"18",x2:"11",y2:"18"})]}),$o=({size:e=16,...t})=>a.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("polyline",{points:"7,8 3,12 7,16"}),a.jsx("line",{x1:"21",y1:"12",x2:"11",y2:"12"}),a.jsx("line",{x1:"21",y1:"6",x2:"11",y2:"6"}),a.jsx("line",{x1:"21",y1:"18",x2:"11",y2:"18"})]});class Tn{constructor(t="Editor"){this.namespace=t}_format(t,n,r){return`[${new Date().toISOString()}] [${this.namespace}] [${t}] ${n}`}info(t,n){}warn(t,n){}error(t,n){}debug(t,n){}}const Cn=new Tn("Editor"),kn=new Set(["P","DIV","H1","H2","H3","H4","H5","H6","LI","BLOCKQUOTE","PRE","TABLE"]),vn=32;function An(e,t){if(!e)return;e.dataset||(e.dataset={}),e.style||(e.style={});const n=parseInt(e.dataset.indentLevel||"0",10),r=Math.max(0,t?n-1:n+1);r===0?(e.style.marginLeft="",delete e.dataset.indentLevel):(e.style.marginLeft=`${r*vn}px`,e.dataset.indentLevel=String(r))}function Fo(e,t){An(e,t)}function Uo(e){let t=e;for(;t;){if(t.nodeType===1&&t.tagName&&kn.has(t.tagName.toUpperCase()))return t;t=t.parentElement||t.parentNode}return null}function Wo(){const e=window.getSelection();if(!e||e.rangeCount===0)return[];const t=e.getRangeAt(0),n=new Set;let r=t.commonAncestorContainer;for(r.nodeType===Node.TEXT_NODE&&(r=r.parentElement);r&&r.contentEditable!=="true";)r=r.parentElement;return r?(r.querySelectorAll("p, div, h1, h2, h3, h4, h5, h6, li, blockquote, pre, table").forEach(s=>{document.createRange().selectNodeContents(s),t.intersectsNode(s)&&n.add(s)}),n.size===0&&r.querySelectorAll("img").forEach(l=>{if(document.createRange().selectNode(l),t.intersectsNode(l)){let u=l.parentElement;for(;u&&u!==r;){if(u.tagName&&kn.has(u.tagName.toUpperCase())){n.add(u);break}u=u.parentElement}}}),Array.from(n).filter(s=>{let l=s.parentElement;for(;l;){if(n.has(l))return!1;l=l.parentElement}return!0})):[]}function Go(e){if(e.style&&e.style.marginLeft&&e.style.marginLeft!==""){const t=parseInt(e.dataset.indentLevel||"0",10),n=Math.max(0,t-1);n===0?(e.style.marginLeft="",delete e.dataset.indentLevel):(e.style.marginLeft=`${n*vn}px`,e.dataset.indentLevel=String(n));return}if(e.innerHTML.startsWith("&nbsp;&nbsp;&nbsp;&nbsp;")){e.innerHTML=e.innerHTML.replace(/^(&nbsp;){4}/,"");return}try{const t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null);let n=t.nextNode();for(;n;){const r=n.textContent;if(r.startsWith("")){n.textContent=r.substring(4);break}n=t.nextNode()}}catch{e.innerHTML=e.innerHTML.replace(/^(&nbsp;){4}/,"")}}function bt(e=!1){const t=window.getSelection();if(!t||t.rangeCount===0)return!1;let n=Wo();const r=t.getRangeAt(0);if(n.length===0){const s=Uo(r.startContainer);if(!s)return!1;n=[s]}const i=n[0],o=n[n.length-1];n.forEach(s=>{if((s.tagName?s.tagName.toUpperCase():"")==="LI"){Fo(s,e);return}e?Go(s):An(s,!1)});try{const s=document.createRange(),l=f=>f.nodeType===Node.TEXT_NODE?f:document.createTreeWalker(f,NodeFilter.SHOW_TEXT,null).nextNode(),d=f=>{if(f.nodeType===Node.TEXT_NODE)return f;const g=document.createTreeWalker(f,NodeFilter.SHOW_TEXT,null);let h=null,p=g.nextNode();for(;p;)h=p,p=g.nextNode();return h},u=l(i);u?s.setStart(u,0):s.setStart(i,0);const m=d(o);m?s.setEnd(m,m.length):s.setEnd(o,o.childNodes.length),t.removeAllRanges(),t.addRange(s)}catch{try{const l=document.createRange();l.setStartBefore(i),l.setEndAfter(o),t.removeAllRanges(),t.addRange(l)}catch(l){console.warn("Could not restore selection after indentation:",l)}}return!0}function qo(e){if(e.key!=="Tab")return!1;e.preventDefault();const t=e.shiftKey,n=window.getSelection(),r=n&&n.rangeCount>0?n.getRangeAt(0):null;return n&&n.rangeCount>0&&r&&!r.collapsed&&bt(t)||t||document.execCommand("insertHTML",!1,"&nbsp;&nbsp;&nbsp;&nbsp;"),!0}const Et=({currentColor:e,onColorSelect:t,title:n="Font Color"})=>{const[r,i]=c.useState(!1),o=c.useRef(null),s=["#000000","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFA500","#800080","#FFC0CB","#A52A2A","#808080","#FFFFFF"];c.useEffect(()=>{const u=m=>{o.current&&!o.current.contains(m.target)&&i(!1)};return document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}},[]);const l=u=>{t(u),i(!1)},d=u=>{const m=u.target.value;t(m)};return a.jsxs("div",{className:"color-picker-dropdown",ref:o,children:[a.jsx("button",{onClick:()=>i(!r),className:"color-picker-button",title:n,style:{backgroundColor:e||"#000000",border:"1px solid #ccc",borderRadius:"3px",width:"24px",height:"24px",cursor:"pointer",position:"relative"},children:a.jsx(mo,{size:14,style:{color:e==="#FFFFFF"?"#000":"#FFF"}})}),r&&a.jsxs("div",{className:"color-picker-palette",children:[a.jsx("div",{className:"color-grid",children:s.map(u=>a.jsx("button",{onClick:()=>l(u),className:`color-option ${e===u?"selected":""}`,style:{backgroundColor:u,border:e===u?"2px solid #007acc":"1px solid #ccc",width:"24px",height:"24px",margin:"2px",borderRadius:"3px",cursor:"pointer"},title:u},u))}),a.jsxs("div",{className:"custom-color-section",children:[a.jsx("label",{htmlFor:"custom-color-input",style:{fontSize:"12px",marginBottom:"4px",display:"block"},children:"Custom Color:"}),a.jsx("input",{id:"custom-color-input",type:"color",value:e||"#000000",onChange:d,style:{width:"100%",height:"32px",border:"1px solid #ccc",borderRadius:"3px",cursor:"pointer"}})]})]})]})};Et.propTypes={currentColor:E.string,onColorSelect:E.func.isRequired,title:E.string};const Zo=[{value:"Segoe UI",label:"Segoe UI"},{value:"Arial",label:"Arial"},{value:"Times New Roman",label:"Times New Roman"},{value:"Courier New",label:"Courier New"},{value:"Georgia",label:"Georgia"},{value:"Verdana",label:"Verdana"},{value:"Noto Sans Sinhala",label:"Noto Sans Sinhala"},{value:"Iskoola Pota",label:"Iskoola Pota"},{value:"Noto Sans Tamil",label:"Noto Sans Tamil"},{value:"Noto Sans",label:"Noto Sans"}],Vo=[{value:"p",label:"Normal"},{value:"h1",label:"Heading 1"},{value:"h2",label:"Heading 2"},{value:"h3",label:"Heading 3"},{value:"h4",label:"Heading 4"},{value:"h5",label:"Heading 5"},{value:"h6",label:"Heading 6"}],Yo='<table border="1"><tr><th>Header 1</th><th>Header 2</th></tr><tr><td>Cell 3</td><td>Cell 4</td></tr></table>',$e=({currentFormat:e,onFormatText:t,onAddPageBreak:n,onInsertImage:r,canUndo:i=!1,canRedo:o=!1})=>{const s=(h,p,y,b=null,k=!1)=>a.jsx("button",{onClick:h,className:b&&e[b]?"active":"",disabled:k,title:y,style:{opacity:k?.5:1},children:a.jsx(p,{size:16})},y),l=()=>a.jsx("div",{className:"toolbar-separator"}),d=async h=>{try{if(!["image/png","image/jpeg","image/gif","image/webp"].includes(h.type)){alert("Invalid image format. Supported: PNG, JPEG, GIF, WEBP");return}if(h.size>5242880){alert("Image exceeds maximum size of 5MB");return}const y=await un(h),b=await dn(y);if(b&&r){const k=`<img src="${b}" data-key="${y}" alt="Inserted image" />`;r(k)}else Cn.warn("Failed to insert image: missing URL or callback");document.getElementById("image-upload").value=""}catch(p){Cn.error("Error uploading image",p)}},u=()=>{bt(!1)||document.execCommand("insertHTML",!1,"&nbsp;&nbsp;&nbsp;&nbsp;")},m=()=>{bt(!0)},f=()=>{const h=prompt("Enter URL:");h&&t("createLink",h)},g=()=>{document.getElementById("image-upload").click()};return a.jsxs("div",{className:"editor-toolbar",children:[s(()=>t("undo"),Bo,"Undo",null,!i),s(()=>t("redo"),Ho,"Redo",null,!o),l(),s(()=>t("bold"),ko,"Bold","bold"),s(()=>t("italic"),vo,"Italic","italic"),s(()=>t("underline"),Ao,"Underline","underline"),s(()=>t("strikethrough"),So,"Strikethrough","strikethrough"),l(),s(()=>t("justifyLeft"),_o,"Align Left","alignLeft"),s(()=>t("justifyCenter"),No,"Align Center","alignCenter"),s(()=>t("justifyRight"),Lo,"Align Right","alignRight"),s(()=>t("justifyFull"),Oo,"Justify","alignJustify"),l(),a.jsx("select",{onChange:h=>t("fontName",h.target.value),value:e.fontFamily||"Segoe UI",title:"Font Family",children:Zo.map(({value:h,label:p})=>a.jsx("option",{value:h,children:p},h))}),a.jsx("select",{onChange:h=>t("fontSize",h.target.value),value:e.fontSize||Ne,title:"Font Size",children:Wt.map(({value:h,label:p})=>a.jsx("option",{value:h,children:p},h))}),a.jsx(Et,{currentColor:e.fontColor,onColorSelect:h=>t("foreColor",h),title:"Font Color"}),a.jsx("select",{onChange:h=>t("formatBlock",h.target.value),value:e.headingLevel||"p",title:"Heading Level",children:Vo.map(({value:h,label:p})=>a.jsx("option",{value:h,children:p},h))}),l(),s(()=>t("insertUnorderedList"),Mo,"Bullet List"),s(()=>t("insertOrderedList"),Ro,"Numbered List"),l(),a.jsx("button",{onClick:u,title:"Increase Indent (Tab)",children:a.jsx(zo,{size:16})}),a.jsx("button",{onClick:m,title:"Decrease Indent (Shift+Tab)",children:a.jsx($o,{size:16})}),l(),a.jsx("button",{onClick:f,title:"Insert Link",children:a.jsx(Io,{size:16})}),s(()=>t("insertHTML",Yo),jo,"Insert Table"),n&&s(n,Po,"Insert Page Break"),l(),a.jsx("input",{type:"file",accept:"image/*",onChange:h=>h.target.files[0]&&d(h.target.files[0]),style:{display:"none"},id:"image-upload"}),a.jsx("button",{onClick:g,title:"Insert Image",children:a.jsx(Do,{size:16})})]})};$e.propTypes={currentFormat:E.shape({bold:E.bool,italic:E.bool,underline:E.bool,strikethrough:E.bool,alignLeft:E.bool,alignCenter:E.bool,alignRight:E.bool,alignJustify:E.bool,fontFamily:E.string,fontSize:E.string,fontColor:E.string,headingLevel:E.string}).isRequired,onFormatText:E.func.isRequired,onAddPageBreak:E.func,onInsertImage:E.func,canUndo:E.bool,canRedo:E.bool},$e.defaultProps={onAddPageBreak:void 0,onInsertImage:void 0,canUndo:!1,canRedo:!1};function Ko(e){return!e||typeof e!="string"?e:ze(e)}function Xo(e){e.preventDefault();const t=e.clipboardData||window.clipboardData;if(!t)return null;let n=t.getData("text/html")||t.getData("text/plain");return n?(t.getData("text/html")?n=Ko(n):n=Jo(n),document.execCommand("insertHTML",!1,n),n):null}function Jo(e){if(!e)return"";const t=e.split(/\n\s*\n/).filter(n=>n.trim());return t.length===0?"<p><br></p>":t.map(n=>{const r=n.split(`
`).filter(o=>o.trim());return r.length===0?"<p><br></p>":`<p>${r.map(o=>Qo(o.trim())).join("<br>")}</p>`}).join("")}function Qo(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}const es=20,ts=20,Sn=20,_n=-12,ns={position:"relative",width:"100%",maxWidth:"100%",margin:"40px auto",backgroundColor:"transparent",minHeight:"100vh"},rs={position:"relative",zIndex:1,backgroundColor:"white",outline:"none",cursor:"text",fontFamily:'"Segoe UI", "Noto Sans Sinhala", "Noto Sans", "Malithi Web", "Iskoola Pota", "Kaputa Unicode", "Helvetica Neue", Arial, "Hiragino Sans GB", "WenQuanYi Micro Hei", "Microsoft YaHei", sans-serif',fontSize:Ne,lineHeight:"1.4",color:"#333",wordWrap:"break-word",whiteSpace:"pre-wrap",overflowWrap:"break-word",border:"1px solid #e0e0e0",boxSizing:"border-box",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},Nn=(e,t=!0)=>{if(!e)return;const n=document.createRange(),r=window.getSelection();t?(n.setStart(e,0),n.collapse(!0)):(n.selectNodeContents(e),n.collapse(!1)),r.removeAllRanges(),r.addRange(n)},os=(e,t,n)=>!!((he(t)||he(n))&&(e.key.length===1||e.key==="Enter"||e.key===" ")),ss=(e,t,n)=>!!((e.key==="Backspace"||e.key==="Delete")&&(he(t)||he(n))),he=e=>e?e.nodeType===Node.ELEMENT_NODE?e.tagName==="PAGE-BREAK"||e.getAttribute("data-page-break")==="true":e.parentElement&&he(e.parentElement):!1,yt=({dimensions:e,editorRef:t,onInput:n,onContentChange:r,onKeyDown:i,onClick:o,onScroll:s,onPaste:l,onRemovePageBreak:d,zoomLevel:u=100,pageMargins:m=ie})=>{const f=c.useMemo(()=>$t(m),[m]),g=u/100,h=c.useCallback((v,M)=>{if(!v)return!1;const x=v.getBoundingClientRect(),S=M-x.top;return S<f.top||S>x.height-f.bottom},[f.top,f.bottom]),p=c.useCallback((v,M)=>{M.preventDefault();const x=v.getBoundingClientRect(),S=M.clientX-x.left,C=M.clientY-x.top,N=x.width-Sn-es,T=_n,L=x.width-Sn,D=_n+ts;S>=N&&S<=L&&C>=T&&C<=D&&d&&d(v)},[d]),y=c.useCallback(v=>{v.preventDefault();const M=t.current.getBoundingClientRect();if(v.clientY-M.top<f.top){const S=t.current.firstElementChild;S&&S.tagName!=="PAGE-BREAK"&&Nn(S,!0)}else{const S=t.current.lastElementChild;S&&S.tagName!=="PAGE-BREAK"&&Nn(S,!1)}},[t,f.top]),b=c.useCallback(v=>{const M=window.getSelection();if(!M||M.rangeCount===0)return;const x=M.getRangeAt(0),{startContainer:S,endContainer:C}=x;if(os(v,S,C))return v.preventDefault(),!1;if(qo(v))return r&&r(),!1;if(ss(v,S,C))return v.preventDefault(),!1;i&&i(v)},[i,r]),k=c.useCallback(v=>{if(!t.current)return;const M=v.target;if(he(M)){p(M,v);return}if(h(t.current,v.clientY)){y(v);return}o&&o(v)},[t,o,p,y,h]),_=c.useCallback(v=>{const M=window.getSelection();if(!M||M.rangeCount===0)return;const x=M.getRangeAt(0),{startContainer:S}=x;if(he(S))return v.preventDefault(),!1},[]),O=c.useCallback(v=>{const M=Xo(v);l&&l(v,M)},[l]);return a.jsx("div",{className:"continuous-page-container",style:{...ns,maxWidth:`${e.width}px`,transform:`scale(${g})`,transformOrigin:"top center",transition:"transform 0.2s ease-out"},children:a.jsx("div",{ref:t,contentEditable:!0,suppressContentEditableWarning:!0,className:"continuous-content",style:{...rs,minHeight:`${e.height}px`,width:`${e.width}px`,padding:`${f.top}px ${f.right}px ${f.bottom}px ${f.left}px`},onInput:n,onKeyDown:b,onBeforeInput:_,onClick:k,onScroll:s,onPaste:O,"data-testid":"continuous-editor"})})};yt.propTypes={dimensions:E.shape({width:E.number.isRequired,height:E.number.isRequired}).isRequired,editorRef:E.shape({current:E.instanceOf(typeof Element<"u"?Element:Object)}).isRequired,onInput:E.func.isRequired,onContentChange:E.func,onKeyDown:E.func,onClick:E.func,onScroll:E.func,onPaste:E.func,onRemovePageBreak:E.func,zoomLevel:E.number,pageMargins:E.string},yt.defaultProps={zoomLevel:100,pageMargins:ie};const Ln=c.memo(yt),On=({pageBoundaries:e=[{id:"page-0",pageNumber:1}],activePage:t=0,pageSize:n="A4",pageMargins:r=ie,zoomLevel:i=100,canZoomIn:o=!0,canZoomOut:s=!0,onNavigate:l,onAddPage:d,onDeletePage:u,onPageSizeChange:m,onPageMarginsChange:f,onZoomIn:g,onZoomOut:h,onZoomReset:p}={})=>{const y=Math.max(e?.length||0,1),b=k=>{if(y<=1){console.warn("[PageManager] Cannot delete the only page");return}u?.(k)};return a.jsxs("div",{className:"page-manager",children:[a.jsxs("div",{className:"page-settings-group",children:[a.jsxs("div",{className:"page-settings-header",children:[a.jsx(Eo,{size:14,style:{marginRight:"4px",verticalAlign:"middle"}}),"Page Settings"]}),a.jsxs("div",{className:"page-settings-controls",children:[a.jsxs("div",{className:"page-setting-item",children:[a.jsx("label",{htmlFor:"page-size-selector",children:"Size:"}),a.jsxs("select",{id:"page-size-selector",role:"combobox","aria-label":"Page size selector",value:n,onChange:k=>m?.(k.target.value),children:[a.jsx("option",{value:"A4",children:"A4"}),a.jsx("option",{value:"Letter",children:"Letter"}),a.jsx("option",{value:"Legal",children:"Legal"})]})]}),a.jsxs("div",{className:"page-setting-item",children:[a.jsx("label",{htmlFor:"page-margins-selector",children:"Margins:"}),a.jsx("select",{id:"page-margins-selector",role:"combobox","aria-label":"Page margins selector",value:r,onChange:k=>f?.(k.target.value),children:ir().map(k=>a.jsx("option",{value:k,children:ar(k)},k))})]})]})]}),a.jsxs("div",{className:"zoom-controls-compact",children:[a.jsx("button",{type:"button",className:"zoom-button-compact",onClick:h,disabled:!s,"aria-label":"Zoom out",title:"Zoom out (Ctrl + -)",children:a.jsx(To,{size:12})}),a.jsxs("span",{className:"zoom-level-display",children:[i,"%"]}),a.jsx("button",{type:"button",className:"zoom-button-compact",onClick:g,disabled:!o,"aria-label":"Zoom in",title:"Zoom in (Ctrl + +)",children:a.jsx(wo,{size:12})}),a.jsx("button",{type:"button",className:"zoom-reset-compact",onClick:p,"aria-label":"Reset zoom",title:"Reset zoom to 100% (Ctrl + 0)",children:"Reset"})]}),a.jsx("div",{className:"page-list",children:e.map((k,_)=>a.jsxs("div",{className:"page-item",children:[a.jsxs("button",{type:"button",className:`page-button ${_===t?"active":""}`,onClick:()=>l?.(_),"aria-label":`Go to page ${_+1}`,"aria-current":_===t?"page":void 0,children:[a.jsx(mt,{size:14}),a.jsxs("span",{children:["Page ",_+1]})]}),y>1&&a.jsx("button",{type:"button",className:"delete-page-button",onClick:O=>{O.stopPropagation(),b(_)},"aria-label":`Delete page ${_+1}`,title:"Delete this page and its content",children:a.jsx(yo,{size:14})})]},k.id||`page-${_}`))}),a.jsxs("button",{type:"button",className:"add-page-button",onClick:()=>d?.(),"aria-label":"Add new page",title:"Add new page at end",children:[a.jsx(xo,{size:16}),a.jsx("span",{children:"Add Page"})]})]})};On.propTypes={pageBoundaries:E.arrayOf(E.shape({id:E.string.isRequired,pageNumber:E.number.isRequired,top:E.number,height:E.number})),activePage:E.number,pageSize:E.oneOf(["A4","Letter","Legal"]),pageMargins:E.string,zoomLevel:E.number,canZoomIn:E.bool,canZoomOut:E.bool,onNavigate:E.func,onAddPage:E.func,onDeletePage:E.func,onPageSizeChange:E.func,onPageMarginsChange:E.func,onZoomIn:E.func,onZoomOut:E.func,onZoomReset:E.func};const Mn=c.memo(On),Fe=10,is=300,as=200;function ls(e){switch(e){case j.TOP_LEFT:case j.BOTTOM_RIGHT:return"nwse-resize";case j.TOP_RIGHT:case j.BOTTOM_LEFT:return"nesw-resize";case j.TOP:case j.BOTTOM:return"ns-resize";case j.LEFT:case j.RIGHT:return"ew-resize";default:return"default"}}function cs(e,t,n,r,i,o){if(!o.preserveAspectRatio)return{width:e,height:t};const s=n/r;return[j.TOP_LEFT,j.TOP_RIGHT,j.BOTTOM_LEFT,j.BOTTOM_RIGHT].includes(i)?e/s>t?t=e/s:e=t*s:[j.TOP,j.BOTTOM].includes(i)?e=t*s:[j.LEFT,j.RIGHT].includes(i)&&(t=e/s),{width:e,height:t}}function us({handler:e,startX:t,startY:n,currentX:r,currentY:i,startWidth:o,startHeight:s,options:l=ge}){const d=r-t,u=i-n;let m=o,f=s;switch(e){case j.TOP_LEFT:m=o-d,f=s-u;break;case j.TOP_RIGHT:m=o+d,f=s-u;break;case j.BOTTOM_LEFT:m=o-d,f=s+u;break;case j.BOTTOM_RIGHT:m=o+d,f=s+u;break;case j.TOP:f=s-u;break;case j.BOTTOM:f=s+u;break;case j.LEFT:m=o-d;break;case j.RIGHT:m=o+d;break;default:return{width:m,height:f}}return{width:m,height:f}=cs(m,f,o,s,e,l),l.maxWidth&&m>l.maxWidth&&(m=l.maxWidth,l.preserveAspectRatio&&(f=m/(o/s))),l.maxHeight&&f>l.maxHeight&&(f=l.maxHeight,l.preserveAspectRatio&&(m=f*(o/s))),m=Math.max(l.minWidth,Math.min(l.maxWidth||m,m)),f=Math.max(l.minHeight,Math.min(l.maxHeight||f,f)),{width:Math.round(m),height:Math.round(f)}}function Rn(e,{width:t,height:n}){ce(e)&&(e.tagName==="IMG"?(e.style.width=`${t}px`,e.style.height=`${n}px`,e.width=t,e.height=n):e.tagName==="DIV"&&(e.style.width=`${t}px`,e.style.height=`${n}px`))}function ds(e,t,n){Rn(t,n);const r=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(r)}function fs(e,t,n,r){const{ctrlKey:i,metaKey:o,shiftKey:s,key:l}=e,d=i||o,u=n.offsetWidth,m=n.offsetHeight,g={">":d&&s?()=>({width:Math.min(r.maxWidth||800,u+Fe),height:m}):null,"<":d&&s?()=>({width:Math.max(r.minWidth||50,u-Fe),height:m}):null,"+":d&&s?()=>({width:u,height:Math.min(r.maxHeight||600,m+Fe)}):null,"-":d&&s?()=>({width:u,height:Math.max(r.minHeight||50,m-Fe)}):null,r:d&&!s?()=>({width:is,height:as}):null}[l];if(g){e.preventDefault();const h=g();return ds(t,n,h),!0}return!1}const Ue=({editorRef:e,onImageResize:t,onImageSelect:n,onImageDeselect:r,resizeOptions:i=ge})=>{const o=c.useRef({overlay:null,image:null,start:null,handler:null,isResizing:!1}),s=c.useRef(i),l=ae();c.useEffect(()=>{s.current=i},[i]);const d=c.useCallback(b=>{if(!ce(b))return;o.current.overlay&&(De(o.current.overlay),o.current.overlay=null),b.classList.add("selected");const k=ln(b,s.current);k&&(o.current.overlay=k,o.current.image=b,document.body.appendChild(k),k.querySelectorAll(".resize-handler").forEach(O=>{O.addEventListener("mousedown",m)}),n&&n(b))},[n]),u=c.useCallback(()=>{o.current.image&&(o.current.image.classList.remove("selected"),o.current.image=null),o.current.overlay&&(De(o.current.overlay),o.current.overlay=null),o.current.start=null,o.current.handler=null,o.current.isResizing=!1,r&&r()},[r]),m=c.useCallback(b=>{if(b.preventDefault(),b.stopPropagation(),!o.current.image)return;const k=b.currentTarget.dataset.handler,_=o.current.image.getBoundingClientRect(),O=window.pageYOffset||document.documentElement.scrollTop,v=window.pageXOffset||document.documentElement.scrollLeft;o.current.start={x:b.clientX,y:b.clientY,width:o.current.image.offsetWidth,height:o.current.image.offsetHeight,originalWidth:o.current.image.offsetWidth,originalHeight:o.current.image.offsetHeight,offsetX:b.clientX-_.left-v,offsetY:b.clientY-_.top-O},o.current.handler=k,o.current.isResizing=!0,document.body.classList.add("resize-in-progress"),document.body.style.cursor=ls(k),document.addEventListener("mousemove",f),document.addEventListener("mouseup",g)},[]),f=c.useCallback(b=>{if(!o.current.isResizing||!o.current.image||!o.current.start||!o.current.handler)return;b.preventDefault(),b.stopPropagation();const{x:k,y:_,width:O,height:v}=o.current.start,M=o.current.handler,x=b.clientX,S=b.clientY,C=us({handler:M,startX:k,startY:_,currentX:x,currentY:S,startWidth:O,startHeight:v,options:s.current});Rn(o.current.image,C),o.current.overlay&&He(o.current.overlay,o.current.image)},[]),g=c.useCallback(b=>{if(o.current.isResizing){if(b.preventDefault(),b.stopPropagation(),o.current.image&&o.current.start){const k={width:o.current.start.originalWidth,height:o.current.start.originalHeight},_={width:o.current.image.offsetWidth,height:o.current.image.offsetHeight};(k.width!==_.width||k.height!==_.height)&&l.recordOperation({type:"IMAGE_RESIZE",payload:{element:o.current.image,state:_}},{type:"IMAGE_RESIZE",payload:{element:o.current.image,state:k}})}if(o.current.start=null,o.current.handler=null,o.current.isResizing=!1,document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",g),document.body.classList.remove("resize-in-progress"),document.body.style.cursor="",o.current.image){const k=new Event("input",{bubbles:!0,cancelable:!0});o.current.image.dispatchEvent(k),t&&t(o.current.image,{width:o.current.image.offsetWidth,height:o.current.image.offsetHeight})}}},[t,l]),h=c.useCallback(b=>{o.current.overlay&&!o.current.overlay.contains(b.target)&&u();const k=b.target;if(ce(k)){if(k===o.current.image)return;d(k)}},[d,u]),p=c.useCallback(b=>{if((b.key==="Delete"||b.key==="Backspace")&&o.current.image&&!o.current.isResizing){b.preventDefault();const k=o.current.image;if(k.parentNode){k.parentNode.removeChild(k),u();const _=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(_)}}b.key==="Escape"&&o.current.image&&u(),o.current.image&&!o.current.isResizing&&fs(b,e,o.current.image,s.current)},[e,u]),y=c.useCallback(()=>{o.current.overlay&&o.current.image&&He(o.current.overlay,o.current.image)},[]);return c.useEffect(()=>{if(!e.current)return;const k=e.current.closest(".editor-viewport");return k&&(k.addEventListener("scroll",y),window.addEventListener("scroll",y)),()=>{k&&k.removeEventListener("scroll",y),window.removeEventListener("scroll",y)}},[e,y]),c.useEffect(()=>{if(!e.current)return;const b=e.current;return b.addEventListener("click",h),b.addEventListener("keydown",p),window.addEventListener("resize",y),()=>{b.removeEventListener("click",h),b.removeEventListener("keydown",p),window.removeEventListener("resize",y),o.current.isResizing&&(document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",g),document.body.classList.remove("resize-in-progress"),document.body.style.cursor=""),o.current.overlay&&De(o.current.overlay)}},[e,h,p,y,f,g]),c.useEffect(()=>{if(!e.current)return;const b=new MutationObserver(k=>{k.forEach(_=>{_.type==="childList"&&_.removedNodes.forEach(O=>{O.nodeType===Node.ELEMENT_NODE&&ce(O)&&O===o.current.image&&u()})})});return b.observe(e.current,{childList:!0,subtree:!0}),()=>b.disconnect()},[e,u,d]),null};Ue.propTypes={editorRef:E.shape({current:E.instanceOf(typeof Element<"u"?Element:Object)}).isRequired,onImageResize:E.func,onImageSelect:E.func,onImageDeselect:E.func,resizeOptions:E.shape({minWidth:E.number,minHeight:E.number,maxWidth:E.number,maxHeight:E.number,aspectRatio:E.bool,preserveAspectRatio:E.bool,defaultWidth:E.number,defaultHeight:E.number})},Ue.defaultProps={onImageResize:void 0,onImageSelect:void 0,onImageDeselect:void 0,resizeOptions:ge};const In={border:"1px solid #ccc",borderRadius:"4px",padding:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"28px",height:"28px"},gs={...In,background:"transparent",color:"#dc3545",borderColor:"#dc3545"},wt=e=>({...In,background:e?"#007bff":"transparent",color:e?"#fff":"#333"}),Tt=({imageElement:e,onAlignChange:t,onAspectRatioToggle:n,onDelete:r,onClose:i,initialPreserveAspectRatio:o=!0})=>{const[s,l]=c.useState({top:0,left:0}),[d,u]=c.useState(!1),[m,f]=c.useState("top"),[g,h]=c.useState(o),p=c.useRef(null),y=ae(),b=T=>{T&&requestAnimationFrame(()=>{const L=document.querySelector(".image-resize-overlay");L&&He(L,T)})},k=T=>{if(!T)return null;const L=window.getComputedStyle(T);return{float:L.float||"none",margin:T.style.margin||"",display:L.display||"inline",width:T.style.width||T.width||"",height:T.style.height||T.height||"",aspectRatio:g}},_=c.useCallback(()=>{if(!e)return"left";const T=window.getComputedStyle(e);return T.float==="right"?"right":T.float==="left"?"left":T.display==="block"&&T.margin.includes("auto")?"center":"left"},[e]),[O,v]=c.useState("left");c.useEffect(()=>{e&&v(_())},[e,_]);const M=c.useCallback(()=>{if(!e||!p.current)return;const T=e.getBoundingClientRect(),L=p.current.getBoundingClientRect(),D=window.innerWidth,R=window.innerHeight,H=T.bottom>=0&&T.top<=R&&T.right>=0&&T.left<=D;let U="top",F=0,V=0;if(H){const ue=T.top-L.height-10,w=R-T.bottom-L.height-10;w>ue&&w>0?(U="bottom",F=T.bottom+10):(U="top",F=T.top-L.height-10)}else U="top",F=10;V=T.left+T.width/2-L.width/2;let Y=Math.max(10,Math.min(V,D-L.width-10)),ne=Math.max(10,Math.min(F,R-L.height-10));l({top:ne,left:Y}),f(U),u(!0)},[e]);c.useLayoutEffect(()=>{M();const T=()=>{M()};return window.addEventListener("scroll",T),window.addEventListener("resize",T),()=>{window.removeEventListener("scroll",T),window.removeEventListener("resize",T),u(!1)}},[e,M]),c.useEffect(()=>{const T=L=>{p.current&&!p.current.contains(L.target)&&L.target!==e&&i()};return document.addEventListener("mousedown",T),()=>{document.removeEventListener("mousedown",T)}},[e,i]);const x={left:{float:"left",margin:"0 10px 10px 0",display:"block"},center:{float:"none",margin:"10px auto",display:"block"},right:{float:"right",margin:"0 0 10px 10px",display:"block"}},S=T=>{if(e&&x[T]){const L=k(e),D=O,R=x[T];e.style.float=R.float,e.style.margin=R.margin,e.style.display=R.display,v(T),b(e);const H=k(e);y.recordOperation({type:"IMAGE_ALIGN",payload:{element:e,alignment:T,state:H}},{type:"IMAGE_ALIGN",payload:{element:e,alignment:D,state:L}}),t&&t(T)}},C=()=>{if(e&&e.parentNode){const T={element:e,parent:e.parentNode,nextSibling:e.nextSibling};y.recordOperation({type:"IMAGE_DELETE",payload:{element:e}},{type:"IMAGE_REINSERT",payload:{state:T}}),e.parentNode.removeChild(e),r&&r(),i()}},N=()=>{const T=g,L=!g;h(L),y.recordOperation({type:"IMAGE_ASPECT_RATIO",payload:{element:e,preserveAspectRatio:L}},{type:"IMAGE_ASPECT_RATIO",payload:{element:e,preserveAspectRatio:T}}),n&&n(L)};return!e||typeof document>"u"?null:Pt.createPortal(a.jsxs("div",{ref:p,className:"image-tooltip-menu","data-menu-position":m,"aria-hidden":!d,style:{position:"fixed",top:`${s.top}px`,left:`${s.left}px`,zIndex:999,background:"#fff",border:"1px solid #ddd",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",padding:"8px",display:"flex",gap:"2px",alignItems:"center",pointerEvents:d?"auto":"none",minWidth:"140px",minHeight:"32px",opacity:d?1:0,visibility:d?"visible":"hidden",transition:"opacity 0.15s ease, visibility 0.15s ease"},children:[a.jsx("button",{className:`tooltip-button aspect-ratio-toggle ${g?"":"active"}`,onClick:N,title:`Toggle aspect ratio preservation (currently ${g?"ON":"OFF"})`,children:g?a.jsx(bo,{size:14}):a.jsx(ho,{size:14})}),a.jsx("button",{className:`tooltip-button ${O==="left"?"active":""}`,onClick:()=>S("left"),title:"Align Left",style:wt(O==="left"),children:a.jsx(En,{size:14})}),a.jsx("button",{className:`tooltip-button ${O==="center"?"active":""}`,onClick:()=>S("center"),title:"Align Center",style:wt(O==="center"),children:a.jsx(xn,{size:14})}),a.jsx("button",{className:`tooltip-button ${O==="right"?"active":""}`,onClick:()=>S("right"),title:"Align Right",style:wt(O==="right"),children:a.jsx(bn,{size:14})}),a.jsx("button",{className:"tooltip-button delete-button",onClick:C,title:"Delete Image",style:gs,children:a.jsx(xt,{size:14})})]}),document.body)};Tt.propTypes={imageElement:E.instanceOf(typeof Element<"u"?Element:Object),onAlignChange:E.func,onAspectRatioToggle:E.func,onDelete:E.func,onClose:E.func.isRequired,initialPreserveAspectRatio:E.bool},Tt.defaultProps={imageElement:null,onAlignChange:void 0,onAspectRatioToggle:void 0,onDelete:void 0,initialPreserveAspectRatio:!0};const We=e=>{e.preventDefault(),e.stopPropagation()},hs=(e,t)=>{const n=Array.isArray(t)?t:[t];document.querySelectorAll(e).forEach(r=>{n.forEach(i=>{r.classList.remove(i)})})},jn=(e,t)=>!e||!t?!1:e.contains(t),ps=()=>{window.getSelection?window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},Ge={minColumnWidth:10,minRowHeight:8,maxColumnWidth:800,maxRowHeight:600,tableMinWidth:100,tableMinHeight:50,tableMaxWidth:1200,tableMaxHeight:800},$={COLUMN:"column",ROW:"row",TABLE_BOTTOM:"table-bottom",TABLE_RIGHT:"table-right"};function ee(e){return e?e.tagName==="TABLE":!1}function te(e){if(!ee(e))return null;const t=e.getBoundingClientRect(),n=Array.from(e.rows),r=n.length>0?n[0].cells.length:0,i=[],o=e.querySelector("colgroup"),s=o?o.querySelectorAll("col"):[];if(s.length>=r)for(let d=0;d<r;d++){const u=s[d],m=u.style.width?parseInt(u.style.width,10):u.offsetWidth;i.push(m||100)}else if(n.length>0){const d=n[0];for(let u=0;u<d.cells.length;u++){const m=d.cells[u];i.push(m.offsetWidth)}}const l=n.map(d=>(d.style.height?parseInt(d.style.height,10):null)||d.offsetHeight);return{width:t.width,height:t.height,columns:r,rows:n.length,columnWidths:i,rowHeights:l,rect:t}}function Pn({type:e,index:t,delta:n,currentStructure:r,options:i=Ge}){const o={columnWidths:[...r.columnWidths],rowHeights:[...r.rowHeights],tableWidth:r.width,tableHeight:r.height},s=(l,d,u,m,f)=>{d>=0&&d<l.length&&(l[d]=Math.max(m,Math.min(f,l[d]+u)))};switch(e){case $.COLUMN:s(o.columnWidths,t,n,i.minColumnWidth,i.maxColumnWidth),o.tableWidth=r.width;break;case $.ROW:s(o.rowHeights,t,n,i.minRowHeight,i.maxRowHeight),o.tableHeight=r.height;break;case $.TABLE_BOTTOM:s(o.rowHeights,r.rows-1,n,i.minRowHeight,i.maxRowHeight);break;case $.TABLE_RIGHT:s(o.columnWidths,r.columns-1,n,i.minColumnWidth,i.maxColumnWidth);break}return o}function pe(e){if(!ee(e))return;const t=Array.from(e.rows);if(t.length===0)return;const n=t[0].cells.length;let r=e.querySelector("colgroup");r||(r=document.createElement("colgroup"),e.insertBefore(r,e.firstChild));const i=r.querySelectorAll("col"),o=i.length;if(o<n)for(let s=o;s<n;s++){const l=document.createElement("col");r.appendChild(l)}else if(o>n)for(let s=o-1;s>=n;s--)r.removeChild(i[s])}function be(e,t){if(!ee(e))return;pe(e);const{columnWidths:n,rowHeights:r,tableWidth:i,tableHeight:o}=t,s=n?n.reduce((d,u)=>d+u,0):0,l=r?r.reduce((d,u)=>d+u,0):0;if(i!==void 0?e.style.width=`${i}px`:s>0&&(e.style.width=`${s}px`),o!==void 0?e.style.height=`${o}px`:l>0&&(e.style.height=`${l}px`),n&&n.length>0){e.style.tableLayout="fixed";const d=e.querySelector("colgroup");d&&d.querySelectorAll("col").forEach((m,f)=>{f<n.length&&(m.style.width=`${n[f]}px`)}),e.style.width=`${s}px`}r&&r.length>0&&(Array.from(e.rows).forEach((u,m)=>{m<r.length&&(u.style.height=`${r[m]}px`)}),e.style.height=`${l}px`),e.offsetHeight}function Bn(e){if(!ee(e))return null;pe(e);const t=te(e);if(!t)return null;const n=document.createElement("div");n.className="table-resize-overlay",n.style.position="fixed",n.style.zIndex="1000",n.style.pointerEvents="none";const r=e.getBoundingClientRect();n.style.top=`${r.top}px`,n.style.left=`${r.left}px`,n.style.width=`${r.width}px`,n.style.height=`${r.height}px`;for(let s=0;s<t.columns-1;s++){const l=qe($.COLUMN,s,t,r,e);n.appendChild(l)}for(let s=0;s<t.rows-1;s++){const l=qe($.ROW,s,t,r,e);n.appendChild(l)}const i=Ze($.TABLE_BOTTOM,t,r);n.appendChild(i);const o=Ze($.TABLE_RIGHT,t,r);return n.appendChild(o),n}const ms={[$.COLUMN]:{className:"table-resize-handler table-column-resize-handler",cursor:"col-resize",isVertical:!0},[$.ROW]:{className:"table-resize-handler table-row-resize-handler",cursor:"row-resize",isVertical:!1},[$.TABLE_BOTTOM]:{className:"table-resize-handler table-bottom-resize-handler",cursor:"ns-resize",isVertical:!1},[$.TABLE_RIGHT]:{className:"table-resize-handler table-right-resize-handler",cursor:"ew-resize",isVertical:!0}};function Hn(e,t,n){const r=ms[e];if(!r)return console.warn(`createResizeHandler: Unknown handler type ${e}`),null;const i=document.createElement("div");return i.className=r.className,i.dataset.type=e,i.style.position="absolute",i.style.cursor=r.cursor,i.style.pointerEvents="all",r.isVertical?(i.style.width="4px",i.style.height=`${t}px`):(i.style.width=`${t}px`,i.style.height="4px"),n!=null&&(i.dataset.index=n),i}function qe(e,t,n,r,i){const o=e===$.COLUMN?r.height:r.width,s=Hn(e,o,t);return ye(s,e,t,n,r,i),s}function Ze(e,t,n){const r=e===$.TABLE_RIGHT?n.height:n.width,i=Hn(e,r);return ye(i,e,null,t,n,null),i}function Ve(e,t){if(!e||!t)return;pe(t);const n=te(t);if(!n)return;const r=t.getBoundingClientRect();e.style.top=`${r.top}px`,e.style.left=`${r.left}px`,e.style.width=`${r.width}px`,e.style.height=`${r.height}px`;const i=e.querySelectorAll(".table-column-resize-handler"),o=e.querySelectorAll(".table-row-resize-handler"),s=e.querySelector(".table-bottom-resize-handler"),l=e.querySelector(".table-right-resize-handler");if(i.length!==n.columns-1||o.length!==n.rows-1||!s||!l){e.innerHTML="";for(let f=0;f<n.columns-1;f++){const g=qe($.COLUMN,f,n,r,t);e.appendChild(g)}for(let f=0;f<n.rows-1;f++){const g=qe($.ROW,f,n,r,t);e.appendChild(g)}const u=Ze($.TABLE_BOTTOM,n,r);e.appendChild(u);const m=Ze($.TABLE_RIGHT,n,r);e.appendChild(m)}else i.forEach((u,m)=>{ye(u,$.COLUMN,m,n,r,t)}),o.forEach((u,m)=>{ye(u,$.ROW,m,n,r,t)}),s&&ye(s,$.TABLE_BOTTOM,null,n,r,null),l&&ye(l,$.TABLE_RIGHT,null,n,r,null)}function Ee(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function Ct(e,t="Operation"){return ee(e)?!0:(console.warn(`${t}: Invalid table element`),!1)}function xs(e){const t=document.createElement("tr"),n=e.cells.length;for(let r=0;r<n;r++){const i=document.createElement("td");i.innerHTML="&nbsp;",t.appendChild(i)}return t}function Dn(e,t,n=0){if(!Ct(e,"insertRowAtPosition"))return null;const r=n===-1?t:t+1;if(r<0||r>e.rows.length)return console.warn(`insertRowAtPosition: Invalid row index ${r}, table has ${e.rows.length} rows`),null;const i=e.rows[t];if(!i)return console.warn(`insertRowAtPosition: Could not find reference row at index ${t}`),null;try{const o=xs(i);r<e.rows.length?e.rows[r].parentNode.insertBefore(o,e.rows[r]):e.rows[e.rows.length-1].parentNode.appendChild(o),pe(e);const s=te(e);return s&&be(e,{columnWidths:s.columnWidths,rowHeights:s.rowHeights}),o}catch(o){return console.error("insertRowAtPosition: Failed to insert row",o),null}}function bs(e,t){return Dn(e,t,-1)}function Es(e,t){return Dn(e,t,1)}function ys(){const e=document.createElement("td");return e.innerHTML="&nbsp;",e}function zn(e,t,n=0){if(!Ct(e,"insertColumnAtPosition"))return!1;if(t<0)return console.warn(`insertColumnAtPosition: Invalid column index ${t}`),!1;const r=Array.from(e.rows);if(r.length===0)return console.warn("insertColumnAtPosition: Table has no rows"),!1;const i=n===-1?t:t+1;if(i>r[0].cells.length)return console.warn(`insertColumnAtPosition: Column index ${i} out of bounds`),!1;try{for(const s of r){const l=ys();i<s.cells.length?s.insertBefore(l,s.cells[i]):s.appendChild(l)}pe(e);const o=te(e);return o&&be(e,{columnWidths:o.columnWidths,rowHeights:o.rowHeights}),!0}catch(o){return console.error("insertColumnAtPosition: Failed to insert column",o),!1}}function ws(e,t){return zn(e,t,-1)}function Ts(e,t){return zn(e,t,1)}function ye(e,t,n,r,i,o){switch(t){case $.COLUMN:Cs(e,n,r,i,o);break;case $.ROW:ks(e,n,r,i,o);break;case $.TABLE_BOTTOM:vs(e,r,i);break;case $.TABLE_RIGHT:As(e,r,i);break}}function Cs(e,t,n,r,i){if(i?.rows.length>0&&i.rows[0].cells.length>t){const s=i.rows[0].cells[t].getBoundingClientRect(),l=i.getBoundingClientRect();e.style.left=`${s.right-l.left-2}px`,e.style.height=`${r.height}px`;return}let o=0;for(let s=0;s<=t;s++)o+=n.columnWidths[s];e.style.left=`${o-2}px`,e.style.height=`${r.height}px`}function ks(e,t,n,r,i){if(i?.rows.length>t&&i.rows[t].cells.length>0){const s=i.rows[t].cells[0].getBoundingClientRect(),l=i.getBoundingClientRect();e.style.top=`${s.bottom-l.top-2}px`,e.style.width=`${r.width}px`;return}let o=0;for(let s=0;s<=t;s++)o+=n.rowHeights[s];e.style.top=`${o-2}px`,e.style.width=`${r.width}px`}function vs(e,t,n){e.style.bottom="-2px",e.style.left="0px",e.style.width=`${n.width}px`}function As(e,t,n){e.style.right="-2px",e.style.top="0px",e.style.height=`${n.height}px`}function $n(e,t,n){return Ct(e,`delete${n.charAt(0).toUpperCase()+n.slice(1)}`)?n==="row"?Ss(e,t):n==="column"?_s(e,t):!1:!1}function Ss(e,t){if(t<0||t>=e.rows.length)return console.warn(`deleteRow: Invalid row index ${t}, table has ${e.rows.length} rows`),!1;if(e.rows.length<=1)return console.warn("deleteRow: Cannot delete the last row in the table"),!1;try{const n=e.rows[t];n.parentNode.removeChild(n),pe(e);const r=te(e);return r&&be(e,{columnWidths:r.columnWidths,rowHeights:r.rowHeights}),!0}catch(n){return console.error("deleteRow: Failed to delete row",n),!1}}function _s(e,t){if(t<0)return console.warn(`deleteColumn: Invalid column index ${t}`),!1;const n=Array.from(e.rows);if(n.length===0)return console.warn("deleteColumn: Table has no rows"),!1;if(t>=n[0].cells.length)return console.warn(`deleteColumn: Column index ${t} out of bounds`),!1;if(n[0].cells.length<=1)return console.warn("deleteColumn: Cannot delete the last column in the table"),!1;try{for(const i of n)i.cells.length>t&&i.removeChild(i.cells[t]);pe(e);const r=te(e);return r&&be(e,{columnWidths:r.columnWidths,rowHeights:r.rowHeights}),!0}catch(r){return console.error("deleteColumn: Failed to delete column",r),!1}}function Ns(e,t){return $n(e,t,"row")}function Ls(e,t){return $n(e,t,"column")}const Ye=({editorRef:e,onTableResize:t,onTableSelect:n,onTableDeselect:r,resizeOptions:i=Ge})=>{const o=c.useRef(null),s=c.useRef(null),l=c.useRef(null),d=c.useRef(null),u=c.useRef(null),m=c.useRef(i),f=c.useRef(!1),[g,h]=c.useState(null),p=ae();c.useEffect(()=>{m.current=i},[i]);const y=c.useCallback(()=>{s.current&&(s.current.classList.remove("selected"),s.current=null),o.current&&(Ee(o.current),o.current=null),h(null),l.current=null,d.current=null,u.current=null,f.current=!1,r&&r()},[r]),b=c.useCallback(C=>{if(We(C),!s.current)return;const N=C.currentTarget,T=N.dataset.type,L=parseInt(N.dataset.index,10);s.current.getBoundingClientRect(),window.pageYOffset||document.documentElement.scrollTop,window.pageXOffset||document.documentElement.scrollLeft;const D=te(s.current);l.current={x:C.clientX,y:C.clientY,structure:{...D}},d.current=T,u.current=L,f.current=!0,document.body.classList.add("table-resize-in-progress");const H={[$.COLUMN]:"col-resize",[$.ROW]:"row-resize",[$.TABLE_BOTTOM]:"ns-resize",[$.TABLE_RIGHT]:"ew-resize"}[T]||"default";document.body.style.cursor=H,document.addEventListener("mousemove",O),document.addEventListener("mouseup",v)},[]),k=c.useCallback(C=>{const N=Bn(C,m.current);return N&&(o.current=N,s.current=C,document.body.appendChild(N),N.querySelectorAll(".table-resize-handler").forEach(L=>{L.addEventListener("mousedown",b)})),N},[b]),_=c.useCallback(C=>{if(!ee(C))return;o.current&&(Ee(o.current),o.current=null),C.classList.add("selected"),k(C)&&(h(C),n&&n(C))},[n,k]),O=c.useCallback(C=>{if(!f.current||!s.current||!l.current||!d.current)return;We(C);const{x:N,y:T,structure:L}=l.current,D=d.current,R=u.current,H=C.clientX,U=C.clientY;let F=0;switch(D){case $.COLUMN:F=H-N;break;case $.ROW:F=U-T;break;case $.TABLE_BOTTOM:F=U-T;break;case $.TABLE_RIGHT:F=H-N;break}const V=Pn({type:D,index:R,delta:F,currentStructure:L,options:m.current});be(s.current,V),o.current&&Ve(o.current,s.current)},[]),v=c.useCallback(C=>{if(f.current){if(We(C),s.current&&l.current){const N={structure:l.current.structure},T={structure:te(s.current)};(N.structure.width!==T.structure.width||N.structure.height!==T.structure.height||JSON.stringify(N.structure.columnWidths)!==JSON.stringify(T.structure.columnWidths)||JSON.stringify(N.structure.rowHeights)!==JSON.stringify(T.structure.rowHeights))&&p.recordOperation({type:"TABLE_RESIZE",payload:{element:s.current,state:T}},{type:"TABLE_RESIZE",payload:{element:s.current,state:N}})}if(l.current=null,d.current=null,u.current=null,f.current=!1,document.removeEventListener("mousemove",O),document.removeEventListener("mouseup",v),document.body.classList.remove("table-resize-in-progress"),document.body.style.cursor="",s.current){const N=new Event("input",{bubbles:!0,cancelable:!0});s.current.dispatchEvent(N),t&&t(s.current,te(s.current))}}},[t,p]),M=c.useCallback(C=>{o.current&&!o.current.contains(C.target)&&y();const T=C.target.closest("table");if(T&&ee(T)){if(T===s.current)return;_(T)}},[_,y]),x=c.useCallback(C=>{if(C.key==="Delete"&&s.current&&!f.current){C.preventDefault();const N=s.current;if(N.parentNode){N.parentNode.removeChild(N),y();const T=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(T)}}C.key==="Escape"&&s.current&&y()},[e,y]),S=c.useCallback(()=>{o.current&&s.current&&Ve(o.current,s.current)},[]);return c.useEffect(()=>{if(!e.current)return;const N=e.current.closest(".editor-viewport");return N&&(N.addEventListener("scroll",S),window.addEventListener("scroll",S)),()=>{N&&N.removeEventListener("scroll",S),window.removeEventListener("scroll",S)}},[e,S]),c.useEffect(()=>{if(!e.current)return;const C=e.current;return C.addEventListener("click",M),C.addEventListener("keydown",x),window.addEventListener("resize",S),()=>{C.removeEventListener("click",M),C.removeEventListener("keydown",x),window.removeEventListener("resize",S),f.current&&(document.removeEventListener("mousemove",O),document.removeEventListener("mouseup",v),document.body.classList.remove("table-resize-in-progress"),document.body.style.cursor=""),o.current&&Ee(o.current)}},[e,M,x,S,O,v]),c.useEffect(()=>{if(!e.current)return;const C=new MutationObserver(N=>{N.forEach(T=>{T.type==="childList"?(T.removedNodes.forEach(L=>{L.nodeType===Node.ELEMENT_NODE&&ee(L)&&L===g&&y()}),T.addedNodes.forEach(L=>{if(L.nodeType!==Node.ELEMENT_NODE)return;if(ee(L)){setTimeout(()=>_(L),50);return}const D=L.querySelectorAll?.("table")||[];D.length>0&&setTimeout(()=>_(D[0]),50)}),g&&[...T.addedNodes,...T.removedNodes].some(D=>D.nodeType===Node.ELEMENT_NODE&&D.tagName==="TR")&&o.current&&s.current&&(Ee(o.current),o.current=null,k(s.current))):T.type==="attributes"&&["colspan","rowspan"].includes(T.attributeName)&&g&&o.current&&s.current&&(Ee(o.current),o.current=null,k(s.current))})});return C.observe(e.current,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["colspan","rowspan"]}),()=>C.disconnect()},[e,g,y,_,k]),null};Ye.propTypes={editorRef:E.shape({current:E.instanceOf(typeof Element<"u"?Element:Object)}).isRequired,onTableResize:E.func,onTableSelect:E.func,onTableDeselect:E.func,resizeOptions:E.shape({minColumnWidth:E.number,minRowHeight:E.number,maxColumnWidth:E.number,maxRowHeight:E.number,tableMinWidth:E.number,tableMinHeight:E.number,tableMaxWidth:E.number,tableMaxHeight:E.number})},Ye.defaultProps={onTableResize:void 0,onTableSelect:void 0,onTableDeselect:void 0,resizeOptions:Ge};const Ke={border:"1px solid #ccc",borderRadius:"4px",padding:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"28px",height:"28px"},Fn={left:{float:"left",margin:"10px 10px 10px 0",marginLeft:"",marginRight:""},center:{float:"none",margin:"10px auto",marginLeft:"auto",marginRight:"auto"},right:{float:"right",margin:"10px 0 10px 10px",marginLeft:"",marginRight:""}},we={INSERT_ROW_ABOVE:"INSERT_ROW_ABOVE",INSERT_ROW_BELOW:"INSERT_ROW_BELOW",INSERT_COL_LEFT:"INSERT_COL_LEFT",INSERT_COL_RIGHT:"INSERT_COL_RIGHT",DELETE_ROW:"DELETE_ROW",DELETE_COL:"DELETE_COL"},Un=e=>{if(!e)return;const t=n=>{const r=document.querySelector(".table-resize-overlay");r&&Ve(r,n)};typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(()=>t(e)):setTimeout(()=>t(e),16)},Wn=e=>{if(!e)return null;const t=window.getComputedStyle(e);return{float:t.float||"none",margin:e.style.margin||"",marginLeft:e.style.marginLeft||"",marginRight:e.style.marginRight||"",display:t.display||"table"}},kt=({tableElement:e,onAlignChange:t,onClose:n,selectedRowIndex:r,selectedColIndex:i,editorRef:o})=>{const[s,l]=c.useState({top:0,left:0}),[d,u]=c.useState(!1),[m,f]=c.useState("top"),[g,h]=c.useState("left"),p=c.useRef(null),y=ae(),b=c.useCallback(()=>{if(!e)return"left";const R=window.getComputedStyle(e);return R.marginLeft==="auto"&&R.marginRight==="auto"?"center":R.float==="right"?"right":(R.float==="left","left")},[e]);c.useEffect(()=>{e&&h(b())},[e,b]);const k=c.useCallback(()=>{if(!e||!p.current)return;const R=e.getBoundingClientRect(),H=p.current.getBoundingClientRect(),U=window.visualViewport?window.visualViewport:{width:window.innerWidth,height:window.innerHeight},F=R.bottom>=0&&R.top<=U.height&&R.right>=0&&R.left<=U.width;let V="top",Y=0,ne=0;if(F){const Z=R.top-H.height-10,K=U.height-R.bottom-H.height-10;K>Z&&K>0?(V="bottom",Y=R.bottom+10):(V="top",Y=R.top-H.height-10)}else V="top",Y=10;ne=R.left+R.width/2-H.width/2;const ue=window.innerWidth,w=window.innerHeight;let B=Math.max(10,Math.min(ne,ue-H.width-10)),W=Math.max(10,Math.min(Y,w-H.height-10));l({top:W,left:B}),f(V),u(!0)},[e]);c.useLayoutEffect(()=>{k();const R=()=>{k()};return window.addEventListener("scroll",R),window.addEventListener("resize",R),()=>{window.removeEventListener("scroll",R),window.removeEventListener("resize",R),u(!1)}},[e,k]),c.useEffect(()=>{const R=H=>{p.current&&!p.current.contains(H.target)&&H.target!==e&&!e.contains(H.target)&&n()};return document.addEventListener("mousedown",R),()=>{document.removeEventListener("mousedown",R)}},[e,n]);const _=c.useCallback(R=>{if(!e||!Fn[R])return;const H=Wn(e),U=g,F=Fn[R];e.style.float=F.float,e.style.margin=F.margin,e.style.marginLeft=F.marginLeft,e.style.marginRight=F.marginRight,h(R),Un(e);const V=Wn(e);y.recordOperation({type:"TABLE_ALIGN",payload:{element:e,alignment:R,state:V}},{type:"TABLE_ALIGN",payload:{element:e,alignment:U,state:H}}),t?.(R)},[e,g,y,t]),O=c.useCallback((R,H)=>()=>{if(!e)return;const U=R.includes("ROW"),F=U?r:i;if(F==null||!H(e,F))return;o?.current&&y.updateContinuousContent(o.current.innerHTML);const Y=U?{element:e,index:F}:{element:e,index:F};y.recordOperation({type:R,payload:Y},{type:R,payload:Y}),Un(e),requestAnimationFrame(()=>k())},[e,r,i,o,y,k]),v=c.useMemo(()=>O(we.INSERT_ROW_ABOVE,bs),[O]),M=c.useMemo(()=>O(we.INSERT_ROW_BELOW,Es),[O]),x=c.useMemo(()=>O(we.INSERT_COL_LEFT,ws),[O]),S=c.useMemo(()=>O(we.INSERT_COL_RIGHT,Ts),[O]),C=c.useMemo(()=>O(we.DELETE_ROW,Ns),[O]),N=c.useMemo(()=>O(we.DELETE_COL,Ls),[O]),T=R=>({...Ke,background:R?"#007bff":"transparent",color:R?"#fff":"#333"}),L=c.useMemo(()=>({rowAction:{...Ke,background:"#28a745",color:"#fff"},colAction:{...Ke,background:"#0056b3",color:"#fff"},delete:{...Ke,background:"#dc3545",color:"#fff"},divider:{width:"1px",height:"24px",background:"#ddd",margin:"0 4px"}}),[]),D=c.useMemo(()=>({position:"fixed",top:`${s.top}px`,left:`${s.left}px`,zIndex:999,background:"#fff",border:"1px solid #ddd",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",padding:"8px",display:"flex",gap:"2px",alignItems:"center",pointerEvents:d?"auto":"none",minWidth:"100px",minHeight:"32px",opacity:d?1:0,visibility:d?"visible":"hidden",transition:"opacity 0.15s ease, visibility 0.15s ease"}),[s,d]);return!e||typeof document>"u"?null:Pt.createPortal(a.jsxs("div",{ref:p,className:"table-tooltip-menu","data-menu-position":m,"aria-hidden":!d,style:D,children:[a.jsx("button",{className:`tooltip-button ${g==="left"?"active":""}`,onClick:()=>_("left"),title:"Align Left",style:T(g==="left"),children:a.jsx(En,{size:14})}),a.jsx("button",{className:`tooltip-button ${g==="center"?"active":""}`,onClick:()=>_("center"),title:"Align Center",style:T(g==="center"),children:a.jsx(xn,{size:14})}),a.jsx("button",{className:`tooltip-button ${g==="right"?"active":""}`,onClick:()=>_("right"),title:"Align Right",style:T(g==="right"),children:a.jsx(bn,{size:14})}),r!=null&&a.jsxs(a.Fragment,{children:[a.jsx("div",{style:L.divider}),a.jsx("button",{className:"tooltip-button insert-row-above",onClick:v,title:"Insert Row Above",style:L.rowAction,children:a.jsx(so,{size:14})}),a.jsx("button",{className:"tooltip-button insert-row-below",onClick:M,title:"Insert Row Below",style:L.rowAction,children:a.jsx(no,{size:14})}),a.jsx("button",{className:"tooltip-button delete-row",onClick:C,title:"Delete Row",style:L.delete,children:a.jsx(xt,{size:14})})]}),i!=null&&a.jsxs(a.Fragment,{children:[a.jsx("div",{style:L.divider}),a.jsx("button",{className:"tooltip-button insert-column-left",onClick:x,title:"Insert Column Left",style:L.colAction,children:a.jsx(ro,{size:14})}),a.jsx("button",{className:"tooltip-button insert-column-right",onClick:S,title:"Insert Column Right",style:L.colAction,children:a.jsx(oo,{size:14})}),a.jsx("button",{className:"tooltip-button delete-column",onClick:N,title:"Delete Column",style:L.delete,children:a.jsx(xt,{size:14})})]})]}),document.body)};kt.propTypes={tableElement:E.instanceOf(typeof Element<"u"?Element:Object),onAlignChange:E.func,onClose:E.func.isRequired,selectedRowIndex:E.number,selectedColIndex:E.number,editorRef:E.shape({current:E.instanceOf(typeof Element<"u"?Element:Object)})},kt.defaultProps={tableElement:null,onAlignChange:void 0,selectedRowIndex:null,selectedColIndex:null,editorRef:null};const Os=".table-cell-selected, .table-row-selected, .table-col-selected",Gn=()=>{hs(Os,["table-cell-selected","table-row-selected","table-col-selected"])},vt=({editorRef:e,onCellSelectionChange:t})=>{const n=c.useRef({selectedCells:new Set,selectionMode:null,selectedRowIndex:null,selectedColIndex:null,currentTable:null,isSelecting:!1,hasDragged:!1,startCell:null}),[r,i]=c.useState(!1),[o,s]=c.useState(!1),[l,d]=c.useState(null),[u,m]=c.useState(null),f=c.useRef(null),g=c.useCallback(()=>{n.current={selectedCells:new Set,selectionMode:null,selectedRowIndex:null,selectedColIndex:null,currentTable:null,isSelecting:!1,hasDragged:!1,startCell:null},i(!1),s(!1),d(null),m(null)},[]),h=c.useCallback(()=>{g(),Gn(),f.current!==null&&(f.current=null,t&&t(null))},[t,g]),p=c.useCallback(x=>{const S=x.closest("tr"),C=x.closest("table");if(!S||!C)return null;const N=Array.from(C.rows).indexOf(S),T=Array.from(S.cells).indexOf(x);return{rowIndex:N,cellIndex:T,table:C}},[]),y=c.useCallback(x=>{if(x.size===0)return{mode:null,rowIndex:null,colIndex:null};const S=Array.from(x),C=S[0],N=p(C);if(!N)return{mode:null,rowIndex:null,colIndex:null};const{table:T}=N;return S.filter(R=>{const H=p(R);return H&&H.table===T&&H.rowIndex===N.rowIndex}).length>=2?{mode:"row",rowIndex:N.rowIndex,colIndex:null}:S.filter(R=>{const H=p(R);return H&&H.table===T&&H.cellIndex===N.cellIndex}).length>=2?{mode:"column",rowIndex:null,colIndex:N.cellIndex}:{mode:null,rowIndex:null,colIndex:null}},[p]),b=c.useCallback((x,S,C,N,T)=>{if(Gn(),!(!T||!x)){if(x==="row"&&S!==null){const L=T.rows[S];L&&Array.from(L.cells).forEach(D=>{D.classList.add("table-row-selected")})}else x==="column"&&C!==null?Array.from(T.rows).forEach(L=>{const D=L.cells[C];D&&D.classList.add("table-col-selected")}):x==="cells"&&N.forEach(L=>{L.classList.add("table-cell-selected")});ps()}},[]),k=c.useCallback((x,S)=>{const C=y(x);n.current.selectedCells=x,n.current.selectionMode=C.mode,n.current.selectedRowIndex=C.rowIndex,n.current.selectedColIndex=C.colIndex,n.current.currentTable=S,m(S),b(C.mode,C.rowIndex,C.colIndex,x,S);const N=C.mode?{mode:C.mode,cells:x,rowIndex:C.rowIndex,colIndex:C.colIndex,table:S}:null;JSON.stringify(f.current)!==JSON.stringify(N)&&(f.current=N,t&&t(N))},[y,b,t]),_=c.useCallback(x=>{const S=x.target.closest("td, th");if(!S)return;const C=p(S);C&&(i(!0),d(S),m(C.table),s(!1))},[p]),O=c.useCallback(x=>{if(!r||!l)return;const S=x.target.closest("td, th");if(!S||!u||!jn(u,S))return;s(!0),We(x);const C=p(l),N=p(S);if(!C||!N||C.table!==N.table)return;const T=Math.min(C.rowIndex,N.rowIndex),L=Math.max(C.rowIndex,N.rowIndex),D=Math.min(C.cellIndex,N.cellIndex),R=Math.max(C.cellIndex,N.cellIndex),H=new Set;for(let U=T;U<=L;U++){const F=u.rows[U];if(F)for(let V=D;V<=R;V++){const Y=F.cells[V];Y&&H.add(Y)}}k(H,u)},[r,l,u,p,k]),v=c.useCallback(()=>{o||h(),i(!1),d(null)},[o,h]),M=c.useCallback(x=>{const S=x.target.closest("td, th"),C=x.target.closest("table");if(!(S&&u&&jn(u,S))){if(C&&C!==u){h();return}C||h()}},[h,u]);return c.useEffect(()=>{if(!e.current)return;const x=e.current,S=N=>{N.target.closest("td, th")&&_(N)},C=N=>{N.target.closest("td, th")&&O(N)};return x.addEventListener("mousedown",S,!0),x.addEventListener("mouseenter",C,!0),document.addEventListener("mouseup",v),document.addEventListener("click",M),()=>{x.removeEventListener("mousedown",S,!0),x.removeEventListener("mouseenter",C,!0),document.removeEventListener("mouseup",v),document.removeEventListener("click",M)}},[e,_,O,v,M]),c.useEffect(()=>{if(!e.current)return;const x=new MutationObserver(S=>{S.forEach(C=>{C.type==="childList"&&u&&!e.current.contains(u)&&h()})});return x.observe(e.current,{childList:!0,subtree:!0}),()=>x.disconnect()},[e,h,u]),null};vt.propTypes={editorRef:E.shape({current:E.instanceOf(typeof Element<"u"?Element:Object)}).isRequired,onCellSelectionChange:E.func},vt.defaultProps={onCellSelectionChange:void 0};const Ms=50,At=50,Rs=50,Is=100,js=300,Xe=c.forwardRef(({pageManagerComponent:e=null,onNavigatePage:t,onAddPage:n,onDeletePage:r,onPageSizeChange:i,onPageMarginsChange:o,onChange:s,showSidebar:l=!0,showToolbar:d=!0,showPageManager:u=!0},m)=>{const f=gt(),g=ae(),{pageSize:h,pageMargins:p,continuousContent:y,pageBoundaries:b,activePage:k,zoomLevel:_,canUndo:O,canRedo:v}=f,M=c.useRef(null),x=c.useRef(null),{currentFormat:S,formatText:C,updateCurrentFormatFromSelection:N}=Vt(),[T,L]=c.useState(!1),[D,R]=c.useState(null),[H,U]=c.useState(!0),[F,V]=c.useState(!1),[Y,ne]=c.useState(null),[ue,w]=c.useState(null),[B,W]=c.useState(null),{checkAndUpdateBoundaries:Z,getCurrentPage:K,scrollToPage:oe,updateBoundaries:z,triggerAutoReflow:J,removePageAndContent:Te,removePageBreak:Je,insertPageBreakAtBoundary:qn}=an(h,x,_,p),Ps=c.useMemo(()=>xe(h),[h]),[Bs,Hs]=c.useState(!1),me=c.useRef(null),Qe=c.useRef(!1),et=c.useRef(!1),tt=c.useRef(!1),nt=c.useRef(y),_t=c.useCallback(()=>{Qe.current=!1;const A=Math.max(0,b.length-1);g.setActivePage(A),setTimeout(()=>{oe(A,M)},Rs)},[b.length,g,oe]);c.useEffect(()=>{if(!x.current||tt.current)return;x.current.innerHTML=y,tt.current=!0,nt.current=y;const A=setTimeout(()=>{z()},Ms);return()=>clearTimeout(A)},[]),c.useEffect(()=>{if(!x.current||!tt.current)return;if(x.current.innerHTML!==y){x.current.innerHTML=y;const G=setTimeout(()=>{z(),Qe.current&&_t()},At);return nt.current=y,()=>clearTimeout(G)}},[y,z,_t]),c.useEffect(()=>{s&&tt.current&&s(y)},[y,s]);const{restoreCursorPosition:Nt,hasActiveCursorSelection:Lt}=Rr({updateCurrentFormatFromSelection:N,editorRef:x}),Ds=c.useCallback(A=>{A!==y&&g.updateContinuousContent(A),x.current&&x.current.innerHTML!==A&&(x.current.innerHTML=A),nt.current=A,setTimeout(()=>{z()},At)},[y,g,z]),Ot=c.useCallback(A=>{if(!x.current||!A)return;Lt()||Nt(),document.execCommand("insertHTML",!1,A);const G=x.current.innerHTML;g.updateContinuousContent(G),nt.current=G,setTimeout(()=>{z(),J(200)},At)},[Lt,Nt,g,z,J]),Zn=c.useMemo(()=>({getHTMLContent:()=>x.current?x.current.innerHTML:y,getSelectedHTMLContent:()=>{if(!x.current)return"";const A=window.getSelection();if(!A||A.rangeCount===0)return"";const G=A.getRangeAt(0);if(!x.current.contains(G.commonAncestorContainer))return"";if(G.collapsed){const re=G.commonAncestorContainer;return re.nodeType===Node.TEXT_NODE?re.parentElement?re.parentElement.outerHTML:"":re.outerHTML||""}let Q=G.commonAncestorContainer;if(Q.nodeType===Node.TEXT_NODE&&(Q=Q.parentElement),Q===x.current){const re=G.cloneContents(),Ce=document.createElement("div");return Ce.appendChild(re),Ce.innerHTML}return Q?Q.outerHTML:""},getPlainText:()=>(x.current?x.current.innerHTML:y).replace(/<[^>]*>/g," ").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/\s+/g," ").trim(),getCursorPosition:()=>x.current?Lr(x.current):null,setContent:A=>{const G=ze(A);Ds(G)},setPageSize:A=>{g.updatePageSize(A),z({pageSize:A})},setPageMargins:A=>{g.updatePageMargins(A),z({pageMargins:A})},insertContent:A=>{const G=ze(A);Ot(G)}}),[y,g,z,J,Lt,Nt]);c.useImperativeHandle(m,()=>Zn,[Zn]);const Mt=c.useCallback(()=>{if(!x.current)return;let A=x.current.innerHTML;A=ze(A),A!==x.current.innerHTML&&(x.current.innerHTML=A);const G=y;if(G!==A){const re={type:"UPDATE_CONTINUOUS_CONTENT",payload:A},Ce={type:"UPDATE_CONTINUOUS_CONTENT",payload:G};g.recordOperation(re,Ce)}g.updateContinuousContent(A),Z(),J(200);const Q=K(M);Q!==k&&g.setActivePage(Q)},[g,Z,K,k,J,M,x,y]),zs=c.useCallback(A=>{Mt()},[Mt]),Vn=c.useCallback(A=>{g.updatePageSize(A),z({pageSize:A}),i&&i(A)},[g,z,i]),Yn=c.useCallback(A=>{g.updatePageMargins(A),z({pageMargins:A}),o&&o(A)},[g,z,o]),Kn=c.useCallback(A=>{A<0||A>=b.length||(et.current=!0,g.setActivePage(A),oe(A,M),setTimeout(()=>{et.current=!1},js),t&&t(A))},[g,oe,t,b.length]),Xn=c.useCallback(()=>{const A=b.length+1;qn(A)&&(Qe.current=!0,setTimeout(()=>{Qe.current&&_t()},100)),n&&n()},[b.length,qn,g,oe,n]),$s=c.useCallback(()=>{const A=window.getSelection();if(A&&A.rangeCount>0){if(!x?.current)return;const re=`<page-break data-page-break="true" contenteditable="false" data-page-number="${x.current.querySelectorAll('page-break, [data-page-break="true"]').length+2}"></page-break><p><br></p>`;document.execCommand("insertHTML",!1,re),setTimeout(()=>{z();const Ce=K(M);g.setActivePage(Ce)},150)}},[z,K,g,M]),Fs=c.useCallback(A=>{Ot(A)},[Ot]),Us=c.useCallback(A=>{if(!A)return;Je(A)&&setTimeout(()=>{const Q=K(M);g.setActivePage(Q)},200)},[Je,K,g,M]),Jn=c.useCallback(A=>{if(b.length<=1){console.warn("Cannot delete the only page");return}Te(A)&&(g.setActivePage(0),r&&r(A))},[b.length,Te,g,r]),Ws=c.useMemo(()=>({handleZoomIn:()=>g.zoomIn(),handleZoomOut:()=>g.zoomOut(),handleZoomReset:()=>g.resetZoom(),handleUndo:()=>g.undo(),handleRedo:()=>g.redo()}),[g]),{handleZoomIn:Rt,handleZoomOut:It,handleZoomReset:jt,handleUndo:Gs,handleRedo:qs}=Ws;Mr({handleZoomIn:Rt,handleZoomOut:It,handleZoomReset:jt,handleUndo:Gs,handleRedo:qs},{editorRef:x,containerRef:M});const Zs=c.useCallback(()=>{!M.current||!x.current||et.current||(me.current&&clearTimeout(me.current),me.current=setTimeout(()=>{if(et.current){me.current=null;return}const A=K(M);A!==k&&A>=0&&g.setActivePage(A),me.current=null},Is))},[K,k,g]),Vs=c.useMemo(()=>{if(!y)return 0;const G=y.replace(/<[^>]*>/g," ").match(new RegExp("\\p{L}+","gu"));return G?G.length:0},[y]),Ys=b.length||1,Ks=c.useCallback(A=>{L(!0),R(A)},[]),Qn=c.useCallback(()=>{L(!1),R(null)},[]),Xs=c.useCallback((A,G)=>{},[]),Js=c.useCallback(A=>{A&&A.mode==="row"?(w(A.rowIndex),W(null)):A&&A.mode==="column"?(W(A.colIndex),w(null)):(w(null),W(null))},[]),Qs=c.useCallback(A=>{V(!0),ne(A)},[]),er=c.useCallback(()=>{V(!1),ne(null)},[]),ei=c.useCallback((A,G)=>{},[]);return c.useEffect(()=>()=>{me.current&&clearTimeout(me.current)},[]),a.jsxs("div",{className:"multi-page-editor",children:[d&&a.jsx($e,{currentFormat:{...S,imageSelected:T},onFormatText:C,onAddPageBreak:$s,onInsertImage:Fs,canUndo:O,canRedo:v}),a.jsxs("div",{className:"editor-container",children:[l&&a.jsx(wn,{editorView:null,isCollapsed:Bs,onToggle:()=>Hs(A=>!A),wordCount:Vs,pageCount:Ys}),a.jsx("div",{className:"editor-viewport continuous-scroll",ref:M,onScroll:Zs,children:a.jsx(Ln,{content:y,dimensions:Ps,pageSize:h,pageMargins:p,pageBoundaries:b,editorRef:x,onInput:zs,onContentChange:Mt,onClick:()=>x.current?.focus(),onRemovePageBreak:Us,zoomLevel:_})}),a.jsx(Ue,{editorRef:x,onImageSelect:Ks,onImageDeselect:Qn,onImageResize:Xs,resizeOptions:{...ge,preserveAspectRatio:H,aspectRatio:H}}),a.jsx(Ye,{editorRef:x,onTableSelect:Qs,onTableDeselect:er,onTableResize:ei}),a.jsx(vt,{editorRef:x,onCellSelectionChange:Js}),T&&D&&a.jsx(Tt,{imageElement:D,initialPreserveAspectRatio:H,onAlignChange:A=>{},onAspectRatioToggle:A=>{U(A)},onDelete:()=>{if(D){const A=D.getAttribute("data-key");A&&fn(A).catch(G=>{console.error("Failed to delete image from IndexedDB:",G)})}},onClose:Qn}),F&&Y&&a.jsx(kt,{tableElement:Y,onAlignChange:A=>{},onClose:er,selectedRowIndex:ue,selectedColIndex:B,editorRef:x}),u&&a.jsx("div",{className:"page-manager-sidebar",children:e?c.cloneElement(e,{onNavigate:Kn,onAddPage:Xn,onDeletePage:Jn,onPageSizeChange:Vn,onPageMarginsChange:Yn,zoomLevel:_,canZoomIn:at(_),canZoomOut:lt(_),onZoomIn:Rt,onZoomOut:It,onZoomReset:jt}):a.jsx(Mn,{pageBoundaries:b,activePage:k,pageSize:h,pageMargins:p,zoomLevel:_,canZoomIn:at(_),canZoomOut:lt(_),onNavigate:Kn,onAddPage:Xn,onDeletePage:Jn,onPageSizeChange:Vn,onPageMarginsChange:Yn,onZoomIn:Rt,onZoomOut:It,onZoomReset:jt})})]})]})});Xe.displayName="HtmlEditor",Xe.propTypes={pageManagerComponent:E.element,onNavigatePage:E.func,onAddPage:E.func,onDeletePage:E.func,onPageSizeChange:E.func,onPageMarginsChange:E.func,onChange:E.func,showSidebar:E.bool,showToolbar:E.bool,showPageManager:E.bool},Xe.defaultProps={pageManagerComponent:null,onNavigatePage:void 0,onAddPage:void 0,onDeletePage:void 0,onPageSizeChange:void 0,onPageMarginsChange:void 0,onChange:void 0,showSidebar:!0,showToolbar:!0,showPageManager:!0};class St extends c.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,n){console.error("[ErrorBoundary] Caught error:",t),console.error("[ErrorBoundary] Error info:",n),this.setState({error:t,errorInfo:n}),this.props.onError&&this.props.onError(t,n)}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null}),this.props.onReset&&this.props.onReset()};render(){return this.state.hasError?this.props.fallback?this.props.fallback:a.jsxs("div",{style:{padding:"20px",margin:"20px",border:"2px solid #f44336",borderRadius:"4px",backgroundColor:"#ffebee",color:"#c62828"},children:[a.jsx("h2",{style:{marginTop:0},children:" Something went wrong"}),a.jsx("p",{children:"The editor encountered an unexpected error and couldn't continue."}),this.props.showDetails&&this.state.error&&a.jsxs("details",{style:{marginTop:"10px",padding:"10px",backgroundColor:"white",borderRadius:"4px",fontSize:"12px",fontFamily:"monospace"},children:[a.jsx("summary",{style:{cursor:"pointer",fontWeight:"bold"},children:"Error Details"}),a.jsxs("pre",{style:{marginTop:"10px",overflow:"auto",maxHeight:"200px"},children:[this.state.error.toString(),this.state.errorInfo&&this.state.errorInfo.componentStack]})]}),a.jsx("button",{onClick:this.handleReset,style:{marginTop:"15px",padding:"8px 16px",backgroundColor:"#f44336",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold"},children:"Try Again"})]}):this.props.children}}St.propTypes={children:E.node.isRequired,fallback:E.node,onError:E.func,onReset:E.func,showDetails:E.bool},St.defaultProps={fallback:null,onError:void 0,onReset:void 0,showDetails:process.env.NODE_ENV==="development"},I.COMMON_FONT_SIZES=Wt,I.ColorPickerDropdown=Et,I.DEFAULT_FONT_SIZE=Ne,I.DEFAULT_IMAGE_RESIZE_OPTIONS=ge,I.DEFAULT_PAGE_SIZE=ct,I.DEFAULT_TABLE_RESIZE_OPTIONS=Ge,I.DocumentProvider=fr,I.EditorToolbar=$e,I.ErrorBoundary=St,I.FONT_SIZE_MAP=ht,I.HtmlEditor=Xe,I.ImageResizeHandlers=Ue,I.PAGE_SIZES=Ae,I.PageManager=Mn,I.PageView=Ln,I.RESIZE_HANDLERS=j,I.Sidebar=wn,I.TABLE_RESIZE_HANDLERS=$,I.TableResizeHandlers=Ye,I.applyImageDimensions=Pr,I.applyTableDimensions=be,I.calculateResizeDimensions=Ir,I.calculateTableResizeDimensions=Pn,I.clearImages=$r,I.createResizeOverlay=ln,I.createTableResizeOverlay=Bn,I.deleteImage=fn,I.getAllImageKeys=Fr,I.getAvailablePageSizes=cr,I.getImage=dn,I.getImageDimensions=jr,I.getPageDimensions=xe,I.getPixelValue=gr,I.getPointValue=hr,I.getTableStructure=te,I.isResizableImage=ce,I.isResizableTable=ee,I.isValidFontSize=pr,I.isValidPageSize=lr,I.logger=Tn,I.pixelsToPoints=qt,I.pointsToPixels=Gt,I.removeResizeOverlay=De,I.removeTableResizeOverlay=Ee,I.saveImage=un,I.updateResizeOverlay=He,I.updateTableResizeOverlay=Ve,I.useContinuousReflow=an,I.useDocument=ft,I.useDocumentActions=ae,I.useDocumentState=gt,I.useFormatting=Vt,Object.defineProperty(I,Symbol.toStringTag,{value:"Module"})}));
//# sourceMappingURL=htmleditor.umd.cjs.map
