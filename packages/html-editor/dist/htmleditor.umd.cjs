(function(y,h){typeof exports=="object"&&typeof module<"u"?h(exports,require("react"),require("react-redux"),require("@reduxjs/toolkit"),require("uuid")):typeof define=="function"&&define.amd?define(["exports","react","react-redux","@reduxjs/toolkit","uuid"],h):(y=typeof globalThis<"u"?globalThis:y||self,h(y.HTMLEditor={},y.React,y.ReactRedux,y.RTK,y.uuid))})(this,(function(y,h,H,$e,ie){"use strict";var J={exports:{}},G={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ge;function Le(){if(ge)return G;ge=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function a(o,i,s){var l=null;if(s!==void 0&&(l=""+s),i.key!==void 0&&(l=""+i.key),"key"in i){s={};for(var d in i)d!=="key"&&(s[d]=i[d])}else s=i;return i=s.ref,{$$typeof:e,type:o,key:l,ref:i!==void 0?i:null,props:s}}return G.Fragment=n,G.jsx=a,G.jsxs=a,G}var W={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pe;function Ie(){return pe||(pe=1,process.env.NODE_ENV!=="production"&&(function(){function e(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===E?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case B:return"Fragment";case f:return"Profiler";case L:return"StrictMode";case g:return"Suspense";case x:return"SuspenseList";case D:return"Activity"}if(typeof r=="object")switch(typeof r.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),r.$$typeof){case C:return"Portal";case u:return r.displayName||"Context";case m:return(r._context.displayName||"Context")+".Consumer";case c:var k=r.render;return r=r.displayName,r||(r=k.displayName||k.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case S:return k=r.displayName||null,k!==null?k:e(r.type)||"Memo";case N:k=r._payload,r=r._init;try{return e(r(k))}catch{}}return null}function n(r){return""+r}function a(r){try{n(r);var k=!1}catch{k=!0}if(k){k=console;var w=k.error,$=typeof Symbol=="function"&&Symbol.toStringTag&&r[Symbol.toStringTag]||r.constructor.name||"Object";return w.call(k,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",$),n(r)}}function o(r){if(r===B)return"<>";if(typeof r=="object"&&r!==null&&r.$$typeof===N)return"<...>";try{var k=e(r);return k?"<"+k+">":"<...>"}catch{return"<...>"}}function i(){var r=M.A;return r===null?null:r.getOwner()}function s(){return Error("react-stack-top-frame")}function l(r){if(z.call(r,"key")){var k=Object.getOwnPropertyDescriptor(r,"key").get;if(k&&k.isReactWarning)return!1}return r.key!==void 0}function d(r,k){function w(){ee||(ee=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",k))}w.isReactWarning=!0,Object.defineProperty(r,"key",{get:w,configurable:!0})}function p(){var r=e(this.type);return te[r]||(te[r]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),r=this.props.ref,r!==void 0?r:null}function b(r,k,w,$,oe,ue){var I=w.ref;return r={$$typeof:T,type:r,key:k,props:w,_owner:$},(I!==void 0?I:null)!==null?Object.defineProperty(r,"ref",{enumerable:!1,get:p}):Object.defineProperty(r,"ref",{enumerable:!1,value:null}),r._store={},Object.defineProperty(r._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(r,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(r,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:oe}),Object.defineProperty(r,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:ue}),Object.freeze&&(Object.freeze(r.props),Object.freeze(r)),r}function A(r,k,w,$,oe,ue){var I=k.children;if(I!==void 0)if($)if(O(I)){for($=0;$<I.length;$++)v(I[$]);Object.freeze&&Object.freeze(I)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else v(I);if(z.call(k,"key")){I=e(r);var V=Object.keys(k).filter(function(zt){return zt!=="key"});$=0<V.length?"{key: someKey, "+V.join(": ..., ")+": ...}":"{key: someKey}",re[I+$]||(V=0<V.length?"{"+V.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,$,I,V,I),re[I+$]=!0)}if(I=null,w!==void 0&&(a(w),I=""+w),l(k)&&(a(k.key),I=""+k.key),"key"in k){w={};for(var de in k)de!=="key"&&(w[de]=k[de])}else w=k;return I&&d(w,typeof r=="function"?r.displayName||r.name||"Unknown":r),b(r,I,w,i(),oe,ue)}function v(r){_(r)?r._store&&(r._store.validated=1):typeof r=="object"&&r!==null&&r.$$typeof===N&&(r._payload.status==="fulfilled"?_(r._payload.value)&&r._payload.value._store&&(r._payload.value._store.validated=1):r._store&&(r._store.validated=1))}function _(r){return typeof r=="object"&&r!==null&&r.$$typeof===T}var P=h,T=Symbol.for("react.transitional.element"),C=Symbol.for("react.portal"),B=Symbol.for("react.fragment"),L=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),m=Symbol.for("react.consumer"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),x=Symbol.for("react.suspense_list"),S=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),E=Symbol.for("react.client.reference"),M=P.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,z=Object.prototype.hasOwnProperty,O=Array.isArray,U=console.createTask?console.createTask:function(){return null};P={react_stack_bottom_frame:function(r){return r()}};var ee,te={},ne=P.react_stack_bottom_frame.bind(P,s)(),ae=U(o(s)),re={};W.Fragment=B,W.jsx=function(r,k,w){var $=1e4>M.recentlyCreatedOwnerStacks++;return A(r,k,w,!1,$?Error("react-stack-top-frame"):ne,$?U(o(r)):ae)},W.jsxs=function(r,k,w){var $=1e4>M.recentlyCreatedOwnerStacks++;return A(r,k,w,!0,$?Error("react-stack-top-frame"):ne,$?U(o(r)):ae)}})()),W}var fe;function Oe(){return fe||(fe=1,process.env.NODE_ENV==="production"?J.exports=Le():J.exports=Ie()),J.exports}var t=Oe();const F="A4",R="<p><br></p>",Y=(e,n=F)=>({id:ie.v4(),index:e,size:n,content:R,images:[],isBreakPoint:!1}),he=(e,n=F)=>(e.length>0?e:[Y(0,n)]).map((o,i)=>({id:o.id||ie.v4(),index:i,size:o.size||n,content:K(o.content),images:o.images||[],isBreakPoint:!!o.isBreakPoint})),K=e=>typeof e!="string"||e.trim()===""?R:e,se=(e={})=>{const n=new Date().toISOString(),a=e.pageSize||F,o=he(e.pages||[Y(0,a)],a);return{id:ie.v4(),title:e.title||"Untitled Document",createdAt:n,updatedAt:n,pageSize:a,pages:o,activePage:e.activePage&&e.activePage<o.length?e.activePage:0,pageBreaks:e.pageBreaks||[],totalPages:o.length,editorMode:e.editorMode||"continuous",continuousContent:e.continuousContent||R,pageBoundaries:e.pageBoundaries||[]}},De=se(),me=$e.createSlice({name:"document",initialState:De,reducers:{initializeDocument:(e,n)=>{const{initialContent:a=R,pageSize:o=F}=n.payload||{},i={...Y(0,o),content:K(a)};return se({title:e.title,pageSize:o,pages:[i]})},updateTitle:(e,n)=>{e.title=n.payload,e.updatedAt=new Date().toISOString()},updatePageContent:(e,n)=>{const{pageIndex:a,content:o}=n.payload;a<0||a>=e.pages.length||(e.pages[a].content=K(o),e.updatedAt=new Date().toISOString())},updatePages:(e,n)=>{const a=Array.isArray(n.payload)?{pages:n.payload}:n.payload||{},o=he(a.pages||[],e.pageSize);e.pages=o,e.activePage=Math.min(e.activePage,o.length-1),e.pageBreaks=Array.isArray(a.pageBreaks)?a.pageBreaks:o.slice(0,-1).map((i,s)=>({id:`auto-break-${s}`,pageNumber:s+1})),e.totalPages=o.length,e.updatedAt=new Date().toISOString()},addPage:(e,n)=>{const a=typeof n.payload?.index=="number"?Math.min(Math.max(n.payload.index,0),e.pages.length):e.pages.length;e.pages.splice(a,0,Y(a,e.pageSize)),e.pages=e.pages.map((o,i)=>({...o,index:i,size:e.pageSize})),e.activePage=a,e.pageBreaks=e.pages.slice(0,-1).map((o,i)=>({id:`auto-break-${i}`,pageNumber:i+1})),e.totalPages=e.pages.length,e.updatedAt=new Date().toISOString()},deletePage:(e,n)=>{const a=n.payload;e.pages.length<=1||(e.pages.splice(a,1),e.pages=e.pages.map((o,i)=>({...o,index:i,size:e.pageSize})),e.activePage>=e.pages.length?e.activePage=e.pages.length-1:a<=e.activePage&&e.activePage>0&&(e.activePage-=1),e.pageBreaks=e.pages.slice(0,-1).map((o,i)=>({id:`auto-break-${i}`,pageNumber:i+1})),e.totalPages=e.pages.length,e.updatedAt=new Date().toISOString())},setActivePage:(e,n)=>{const a=n.payload;a>=0&&a<e.pages.length&&a!==e.activePage&&(e.activePage=a,e.updatedAt=new Date().toISOString())},updatePageSize:(e,n)=>{const a=n.payload;e.pageSize=a,e.pages=e.pages.map((o,i)=>({...o,index:i,size:a})),e.pageBreaks=e.pages.slice(0,-1).map((o,i)=>({id:`auto-break-${i}`,pageNumber:i+1})),e.updatedAt=new Date().toISOString()},resetDocument:()=>se(),updateContinuousContent:(e,n)=>{e.continuousContent=K(n.payload),e.updatedAt=new Date().toISOString()},updatePageBoundaries:(e,n)=>{e.pageBoundaries=n.payload||[],e.totalPages=e.pageBoundaries.length,e.updatedAt=new Date().toISOString()},addPageBreak:(e,n)=>{const{position:a="end",pageIndex:o}=n.payload||{},i='<page-break data-page-break="true" style="display: block; height: 20px; border-top: 2px dashed #ccc; margin: 20px 0; page-break-after: always;"></page-break>';if(a==="end")e.continuousContent=e.continuousContent+i+"<p><br></p>";else if(typeof a=="number"){const s=e.continuousContent.substring(0,a),l=e.continuousContent.substring(a);e.continuousContent=s+i+l}else if(typeof o=="number"&&typeof document<"u"){const s=document.createElement("div");s.innerHTML=e.continuousContent;const l=s.querySelectorAll('page-break, [data-page-break="true"]');if(o===0&&l.length===0)e.continuousContent=e.continuousContent+i+"<p><br></p>";else if(o<l.length){const d=l[o],p=document.createElement("page-break");p.setAttribute("data-page-break","true"),p.setAttribute("style","display: block; height: 20px; border-top: 2px dashed #ccc; margin: 20px 0; page-break-after: always;");const b=document.createElement("p");b.innerHTML="<br>",d.parentNode.insertBefore(p,d.nextSibling),p.parentNode.insertBefore(b,p.nextSibling),e.continuousContent=s.innerHTML}else e.continuousContent=e.continuousContent+i+"<p><br></p>"}e.updatedAt=new Date().toISOString()},removePageBreak:(e,n)=>{const{pageIndex:a}=n.payload||{};if(typeof a=="number"&&typeof document<"u"){const o=document.createElement("div");o.innerHTML=e.continuousContent;const i=o.querySelectorAll('page-break, [data-page-break="true"]');i[a]&&i[a].remove(),o.querySelectorAll('page-break, [data-page-break="true"]').forEach((l,d)=>{l.setAttribute("data-page-number",String(d+2))}),e.continuousContent=o.innerHTML,e.updatedAt=new Date().toISOString()}},setEditorMode:(e,n)=>{const a=n.payload;if(a!==e.editorMode){if(e.editorMode=a,a==="continuous"){const o=e.pages.map(i=>i.content).filter(i=>i&&i!==R).join(`
`);e.continuousContent=o||R}else e.continuousContent&&e.continuousContent!==R&&(e.pages=[{...Y(0,e.pageSize),content:e.continuousContent}]);e.updatedAt=new Date().toISOString()}},insertPageAt:(e,n)=>{const{pageIndex:a,content:o=R}=n.payload||{};if(!(typeof a!="number"||a<0)){if(e.editorMode==="continuous"&&typeof document<"u"){const i=document.createElement("div");i.innerHTML=e.continuousContent;const s=i.querySelectorAll('page-break, [data-page-break="true"]'),l='<page-break data-page-break="true" style="display: block; height: 20px; border-top: 2px dashed #ccc; margin: 20px 0; page-break-after: always;"></page-break>';if(a===0)e.continuousContent=o+l+e.continuousContent;else if(a>=s.length)e.continuousContent=e.continuousContent+l+o;else{const d=s[a-1],p=document.createElement("div");p.innerHTML=o;const b=document.createElement("page-break");b.setAttribute("data-page-break","true"),b.setAttribute("style","display: block; height: 20px; border-top: 2px dashed #ccc; margin: 20px 0; page-break-after: always;"),d.parentNode.insertBefore(p,d.nextSibling),d.parentNode.insertBefore(b,p.nextSibling),e.continuousContent=i.innerHTML}}e.updatedAt=new Date().toISOString()}},movePageTo:(e,n)=>{const{fromIndex:a,toIndex:o}=n.payload||{};if(!(typeof a!="number"||typeof o!="number")&&!(a<0||o<0||a===o)){if(e.editorMode==="continuous"&&typeof document<"u"){const i=document.createElement("div");i.innerHTML=e.continuousContent,Array.from(i.querySelectorAll('page-break, [data-page-break="true"]'));const s=[];let l=i.firstChild,d=[];for(;l;)l.nodeType===1&&(l.tagName.toLowerCase()==="page-break"||l.getAttribute("data-page-break")==="true")?(s.push(d),d=[]):d.push(l.cloneNode(!0)),l=l.nextSibling;if(d.length>0&&s.push(d),a>=s.length||o>=s.length)return;const[p]=s.splice(a,1);s.splice(o,0,p);const b=[];s.forEach((A,v)=>{A.forEach(_=>b.push(_.outerHTML||_.textContent)),v<s.length-1&&b.push('<page-break data-page-break="true" style="display: block; height: 20px; border-top: 2px dashed #ccc; margin: 20px 0; page-break-after: always;"></page-break>')}),e.continuousContent=b.join("")}e.updatedAt=new Date().toISOString()}},duplicatePage:(e,n)=>{const{pageIndex:a}=n.payload||{};if(!(typeof a!="number"||a<0)){if(e.editorMode==="continuous"&&typeof document<"u"){const o=document.createElement("div");o.innerHTML=e.continuousContent;const i=Array.from(o.querySelectorAll('page-break, [data-page-break="true"]'));let s=[],l=o.firstChild,d=0;for(;l;){if(l.nodeType===1&&(l.tagName.toLowerCase()==="page-break"||l.getAttribute("data-page-break")==="true")){if(d===a)break;d++,s=[]}else d===a&&s.push(l.cloneNode(!0));l=l.nextSibling}if(s.length>0&&a<i.length){const p=i[a],v=s.map(T=>T.outerHTML||T.textContent).join("")+'<page-break data-page-break="true" style="display: block; height: 20px; border-top: 2px dashed #ccc; margin: 20px 0; page-break-after: always;"></page-break>',_=document.createElement("div");_.innerHTML=v;let P=p;Array.from(_.children).forEach(T=>{P.parentNode.insertBefore(T.cloneNode(!0),P.nextSibling),P=P.nextSibling}),e.continuousContent=o.innerHTML}}e.updatedAt=new Date().toISOString()}}}}),{initializeDocument:Re,updateTitle:He,updatePageContent:qe,updatePages:Ue,addPage:Ve,deletePage:Ge,setActivePage:q,updatePageSize:le,resetDocument:We,updateContinuousContent:X,updatePageBoundaries:be,addPageBreak:ce,removePageBreak:ke,setEditorMode:Ye,insertPageAt:Je,movePageTo:Fe,duplicatePage:Ke}=me.actions,Xe=me.reducer,ye=()=>{const[e,n]=h.useState({bold:!1,italic:!1,underline:!1,strikethrough:!1,alignLeft:!1,alignCenter:!1,alignRight:!1,alignJustify:!1,fontFamily:"Arial",fontSize:"12px"}),a=h.useCallback((o,i=null)=>{if(o==="fontSize"){const l={"10px":"1","12px":"2","14px":"3","16px":"4","18px":"5","24px":"6","32px":"7"}[i]||"2";document.execCommand("fontSize",!1,l);const d=window.getSelection();if(d&&d.rangeCount>0){const p=d.getRangeAt(0);if(p.toString()){const A=document.createElement("span");A.style.fontSize=i,p.surroundContents(A)}}}else document.execCommand(o,!1,i);o==="bold"?n(s=>({...s,bold:!s.bold})):o==="italic"?n(s=>({...s,italic:!s.italic})):o==="underline"?n(s=>({...s,underline:!s.underline})):o==="strikethrough"?n(s=>({...s,strikethrough:!s.strikethrough})):o==="justifyLeft"?n(s=>({...s,alignLeft:!0,alignCenter:!1,alignRight:!1,alignJustify:!1})):o==="justifyCenter"?n(s=>({...s,alignLeft:!1,alignCenter:!0,alignRight:!1,alignJustify:!1})):o==="justifyRight"?n(s=>({...s,alignLeft:!1,alignCenter:!1,alignRight:!0,alignJustify:!1})):o==="justifyFull"?n(s=>({...s,alignLeft:!1,alignCenter:!1,alignRight:!1,alignJustify:!0})):o==="fontSize"&&n(s=>({...s,fontSize:i}))},[]);return{currentFormat:e,formatText:a}},Z={A4:{width:794,height:1123},Letter:{width:816,height:1056},Legal:{width:816,height:1344}},xe={top:60,bottom:100,left:72,right:72},ve=(e,n)=>{const a=H.useDispatch(),o=h.useRef(null),i=h.useRef(null),s=h.useRef(e),l=h.useRef(!1);h.useEffect(()=>{s.current=e},[e]),h.useEffect(()=>()=>{o.current&&clearTimeout(o.current),i.current&&clearTimeout(i.current)},[]);const d=h.useCallback((f,m)=>{let u=0;for(let c=0;c<f.length;c++){const g=f[c],x=g.getBoundingClientRect().height;if(u+x>m)return{overflowIndex:c,overflowElement:g,accumulatedHeight:u};u+=x}return null},[]),p=h.useCallback((f,m)=>{if(!f||!n?.current)return!1;try{const u=n.current,c=document.createElement("page-break");return c.setAttribute("data-page-break","true"),c.setAttribute("contenteditable","false"),c.setAttribute("data-page-number",m||"2"),f.parentNode.insertBefore(c,f),!0}catch(u){return console.warn("[insertPageBreakBefore] Failed to insert page break:",u),!1}},[n]),b=h.useCallback(()=>{if(!(!n?.current||l.current))try{l.current=!0;const f=n.current,m=s.current||"A4",c=(Z[m]||Z.A4).height-xe.top-xe.bottom,g=Array.from(f.children),x=g.filter(E=>E.tagName==="PAGE-BREAK"||E.getAttribute("data-page-break")==="true"),S=[];let N=[];for(const E of g)E.tagName==="PAGE-BREAK"||E.getAttribute("data-page-break")==="true"?N.length>0&&(S.push(N),N=[]):N.push(E);N.length>0&&S.push(N),S.length===0&&g.length>0&&S.push(g.filter(E=>!(E.tagName==="PAGE-BREAK"||E.getAttribute("data-page-break")==="true")));let D=!1;for(let E=0;E<S.length;E++){const M=S[E],z=d(M,c);if(z&&z.overflowIndex>0){const O=E+2;if(p(z.overflowElement,O)){D=!0;break}}}if(D){const E=f.innerHTML;a(X(E)),setTimeout(()=>{_()},50)}}catch(f){console.warn("[checkAndReflow] Reflow failed:",f)}finally{l.current=!1}},[n,d,p,a]),A=h.useCallback((f=500)=>{i.current&&clearTimeout(i.current),i.current=setTimeout(()=>{i.current=null,b()},f)},[b]),v=h.useCallback((f={})=>{if(!n?.current||typeof document>"u")return[];const m=f.pageSize||s.current||"A4",u=Z[m]||Z.A4,c=n.current,g=c.querySelectorAll('page-break, [data-page-break="true"]'),x=[];return x.push({id:"page-0",pageNumber:1,top:0,height:u.height}),g.forEach((S,N)=>{const D=S.getBoundingClientRect(),E=c.getBoundingClientRect(),M=D.top-E.top+c.scrollTop;x.push({id:`page-${N+1}`,pageNumber:N+2,top:M,height:u.height})}),x},[n]),_=h.useCallback((f={})=>{const m=v(f);return a(be(m)),m},[v,a]),P=h.useCallback((f={})=>{o.current&&clearTimeout(o.current);const m=typeof f.delay=="number"?f.delay:300;o.current=setTimeout(()=>{o.current=null,_(f)},Math.max(0,m))},[_]),T=h.useCallback(()=>{if(!n?.current)return 0;const f=window.getSelection();if(!f||f.rangeCount===0)return 0;try{const m=f.getRangeAt(0),u=n.current;let c=m.startContainer;const g=Array.from(u.querySelectorAll('page-break, [data-page-break="true"]'));if(g.length===0)return 0;for(;c&&c!==u;){for(let x=g.length-1;x>=0;x--)if(g[x].compareDocumentPosition(c)&Node.DOCUMENT_POSITION_FOLLOWING)return x+1;c=c.parentNode}return 0}catch(m){return console.warn("[getCurrentPage] Failed to calculate page:",m),0}},[n]),C=h.useCallback((f,m)=>{if(!m?.current||!n?.current)return;n.current;const c=v().find(g=>g.pageNumber===f+1);c&&(m.current.scrollTo({top:c.top-40,behavior:"smooth"}),setTimeout(()=>{B(f)},300))},[n]),B=h.useCallback(f=>{if(!n?.current)return;const m=n.current;m.focus();try{let u=null,c=0;if(f===0)u=m.firstChild,c=0;else{const x=m.querySelectorAll('page-break, [data-page-break="true"]')[f-1];x&&x.nextSibling&&(u=x.nextSibling,c=0)}if(u){const g=document.createRange(),x=window.getSelection();u.nodeType===Node.TEXT_NODE?g.setStart(u,c):g.setStart(u,0),g.collapse(!0),x.removeAllRanges(),x.addRange(g)}}catch(u){console.warn("[positionCursorAtPage] Failed to position cursor:",u)}},[n]),L=h.useCallback(f=>{if(!n?.current)return!1;const m=n.current;if(v().length<=1)return console.warn("[removePageAndContent] Cannot delete the only page"),!1;try{const c=Array.from(m.querySelectorAll('page-break, [data-page-break="true"]'));if(f>c.length)return console.warn("[removePageAndContent] Invalid page index"),!1;const g=window.getSelection();let x=!1,S=[],N=null;if(f===0){const M=c[0];if(!M)return console.warn("[removePageAndContent] No page break found for first page"),!1;let z=m.firstChild;for(;z&&z!==M;)S.push(z),z=z.nextSibling;N=M}else{const M=c[f-1];if(!M)return console.warn("[removePageAndContent] Page break not found"),!1;const z=c[f];let O=M.nextSibling;for(;O&&O!==z;)S.push(O),O=O.nextSibling;N=M}if(g&&g.rangeCount>0){const z=g.getRangeAt(0).startContainer;for(const O of S)if(O.contains(z)||O===z){x=!0;break}}N&&N.parentNode&&N.remove(),S.forEach(M=>{M.parentNode&&M.remove()}),m.querySelectorAll('page-break, [data-page-break="true"]').forEach((M,z)=>{M.setAttribute("data-page-number",String(z+2))}),x&&setTimeout(()=>{B(0)},50);const E=m.innerHTML;return a(X(E)),setTimeout(()=>{_()},100),!0}catch(c){return console.error("[removePageAndContent] Failed to remove page:",c),!1}},[n,v,a,_,B]);return{calculatePageBoundaries:v,checkAndUpdateBoundaries:P,updateBoundaries:_,getCurrentPage:T,scrollToPage:C,positionCursorAtPage:B,checkAndReflow:b,triggerAutoReflow:A,removePageAndContent:L,boundaryTimeoutRef:o,reflowTimeoutRef:i}};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Qe=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,a,o)=>o?o.toUpperCase():a.toLowerCase()),Ce=e=>{const n=Qe(e);return n.charAt(0).toUpperCase()+n.slice(1)},Ne=(...e)=>e.filter((n,a,o)=>!!n&&n.trim()!==""&&o.indexOf(n)===a).join(" ").trim(),et=e=>{for(const n in e)if(n.startsWith("aria-")||n==="role"||n==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var tt={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=h.forwardRef(({color:e="currentColor",size:n=24,strokeWidth:a=2,absoluteStrokeWidth:o,className:i="",children:s,iconNode:l,...d},p)=>h.createElement("svg",{ref:p,...tt,width:n,height:n,stroke:e,strokeWidth:o?Number(a)*24/Number(n):a,className:Ne("lucide",i),...!s&&!et(d)&&{"aria-hidden":"true"},...d},[...l.map(([b,A])=>h.createElement(b,A)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j=(e,n)=>{const a=h.forwardRef(({className:o,...i},s)=>h.createElement(nt,{ref:s,iconNode:n,className:Ne(`lucide-${Ze(Ce(e))}`,`lucide-${e}`,o),...i}));return a.displayName=Ce(e),a};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=j("bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=j("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=j("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=j("file-check",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=j("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=j("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=j("heading-1",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=j("heading-2",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=j("heading-3",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17.5 10.5c1.7-1 3.5 0 3.5 1.5a2 2 0 0 1-2 2",key:"68ncm8"}],["path",{d:"M17 17.5c2 1.5 4 .3 4-1.5a2 2 0 0 0-2-2",key:"1ejuhz"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=j("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=j("italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=j("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=j("list-ordered",[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=j("list",[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=j("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=j("redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=j("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=j("square-check-big",[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bt=j("strikethrough",[["path",{d:"M16 4H9a3 3 0 0 0-2.83 4",key:"43sutm"}],["path",{d:"M14 12a4 4 0 0 1 0 8H6",key:"nlfj13"}],["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kt=j("table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=j("text-align-center",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 19H5",key:"vjpgq2"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=j("text-align-end",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 19H7",key:"4cu937"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=j("text-align-justify",[["path",{d:"M3 5h18",key:"1u36vt"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 19h18",key:"awlh7x"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=j("text-align-start",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=j("underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=j("undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const St=j("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),we=({editorView:e,isCollapsed:n,onToggle:a,wordCount:o,pageCount:i})=>{const s=H.useSelector(C=>C.document),{pages:l,activePage:d,continuousContent:p,editorMode:b}=s,[A,v]=h.useState(0),[_,P]=h.useState([]);h.useEffect(()=>{if(o!==void 0&&i!==void 0){if(v(o),p){const L=document.createElement("div");L.innerHTML=p;const f=L.querySelectorAll("h1, h2, h3, h4, h5, h6"),m=Array.from(f).map((u,c)=>{const g=parseInt(u.tagName.charAt(1)),x=u.textContent.trim();return x?{id:`heading-${c}`,level:g,text:x,page:1}:null}).filter(Boolean);P(m)}return}let C=0;const B=[];l.forEach((L,f)=>{if(L.content){const m=document.createElement("div");m.innerHTML=L.content;const c=(m.textContent||m.innerText||"").trim().split(/\s+/).filter(x=>x.length>0);C+=c.length,m.querySelectorAll("h1, h2, h3, h4, h5, h6").forEach((x,S)=>{const N=parseInt(x.tagName.charAt(1)),D=x.textContent.trim();D&&B.push({id:`heading-${f}-${S}`,level:N,text:D,page:f+1})})}}),v(C),P(B)},[l,o,i,p]);const T=i!==void 0?i:l.length;return t.jsxs("aside",{className:`sidebar ${n?"collapsed":""}`,role:"complementary","aria-label":"Document information","data-testid":"sidebar",children:[t.jsxs("div",{className:"sidebar-header",children:[t.jsxs("div",{className:"sidebar-title",children:[t.jsx(Q,{size:18}),t.jsx("h2",{children:"Document Info"})]}),t.jsx("button",{className:"sidebar-toggle",onClick:a,"aria-label":n?"Expand sidebar":"Collapse sidebar",title:n?"Expand sidebar":"Collapse sidebar",children:n?t.jsx(Se,{size:16}):t.jsx(_e,{size:16})})]}),!n&&t.jsxs("div",{className:"sidebar-content",children:[t.jsxs("div",{className:"sidebar-section",children:[t.jsx("h3",{children:"Statistics"}),t.jsxs("div",{className:"stat-item",children:[t.jsxs("div",{className:"stat-label",children:[t.jsx(rt,{size:14}),t.jsx("span",{children:"Pages:"})]}),t.jsx("span",{className:"stat-value",children:T})]}),t.jsxs("div",{className:"stat-item","data-testid":"word-count",children:[t.jsxs("div",{className:"stat-label",children:[t.jsx(ot,{size:14}),t.jsx("span",{children:"Words:"})]}),t.jsx("span",{className:"stat-value",children:A.toLocaleString()})]}),t.jsxs("div",{className:"stat-item",children:[t.jsxs("div",{className:"stat-label",children:[t.jsx(Q,{size:14}),t.jsx("span",{children:"Active Page:"})]}),t.jsx("span",{className:"stat-value",children:d+1})]})]}),_.length>0&&t.jsxs("div",{className:"sidebar-section",children:[t.jsxs("h3",{children:[t.jsx(je,{size:14,style:{display:"inline-block",marginRight:"6px",verticalAlign:"middle"}}),"Document Outline"]}),t.jsx("div",{className:"document-outline","data-testid":"outline",children:_.map(C=>{const B=C.level===1?it:C.level===2?st:lt;return t.jsxs("div",{className:`outline-item outline-level-${C.level}`,style:{marginLeft:`${(C.level-1)*12}px`},children:[t.jsx(B,{size:12,className:"outline-icon"}),t.jsx("span",{className:"outline-text",children:C.text}),t.jsxs("span",{className:"outline-page",children:["p.",C.page]})]},C.id)})})]}),t.jsxs("div",{className:"sidebar-section",children:[t.jsx("h3",{children:"Document"}),t.jsx("p",{children:"HTML Editor"}),t.jsx("p",{children:"Multi-page support"})]})]})]})};function jt(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const n=Math.random()*16|0;return(e==="x"?n:n&3|8).toString(16)})}function Ae(e){return new Promise((n,a)=>{if(!["image/png","image/jpeg","image/gif","image/webp"].includes(e.type)){a(new Error("Invalid image format. Supported formats: png, jpeg, gif, webp"));return}if(e.size>5*1024*1024){a(new Error("Image exceeds maximum size of 5MB"));return}const i=new FileReader;i.onload=s=>{const l=s.target.result;if(l.split(",")[1].length*3/4>5*1024*1024){a(new Error("Image exceeds maximum size of 5MB"));return}try{const b=`editor-image-${jt()}`;localStorage.setItem(b,l),n(b)}catch(b){b.name==="QuotaExceededError"?a(new Error("Storage quota exceeded")):a(b)}},i.onerror=()=>{a(new Error("Error reading image file"))},i.readAsDataURL(e)})}function wt(e){return localStorage.getItem(e)}function At(e){localStorage.removeItem(e)}function Et(){Object.keys(localStorage).forEach(e=>{e.startsWith("editor-image-")&&localStorage.removeItem(e)})}function Pt(){return Object.keys(localStorage).filter(e=>e.startsWith("editor-image-"))}class Ee{constructor(n="Editor"){this.namespace=n}_format(n,a,o){return`[${new Date().toISOString()}] [${this.namespace}] [${n}] ${a}`}info(n,a){}warn(n,a){}error(n,a){}debug(n,a){}}const Pe=new Ee("Editor"),Te=({currentFormat:e,pageSize:n,onFormatText:a,onPageSizeChange:o,onAddPageBreak:i})=>{const s=async l=>{try{if(!["image/png","image/jpeg","image/gif","image/webp"].includes(l.type)){alert("Invalid image format. Supported: PNG, JPEG, GIF, WEBP");return}if(l.size>5242880){alert("Image exceeds maximum size of 5MB");return}const p=await Ae(l),b=localStorage.getItem(p);b&&(document.execCommand("insertImage",!1,b),Pe.info("Image inserted",{key:p}))}catch(d){Pe.error("Error uploading image",d)}};return t.jsxs("div",{className:"editor-toolbar",children:[t.jsx("button",{onClick:()=>a("bold"),className:e.bold?"active":"",title:"Bold",children:t.jsx(at,{size:16})}),t.jsx("button",{onClick:()=>a("italic"),className:e.italic?"active":"",title:"Italic",children:t.jsx(ut,{size:16})}),t.jsx("button",{onClick:()=>a("underline"),className:e.underline?"active":"",title:"Underline",children:t.jsx(Nt,{size:16})}),t.jsx("button",{onClick:()=>a("strikethrough"),className:e.strikethrough?"active":"",title:"Strikethrough",children:t.jsx(bt,{size:16})}),t.jsx("div",{className:"toolbar-separator"}),t.jsx("button",{onClick:()=>a("justifyLeft"),className:e.alignLeft?"active":"",title:"Align Left",children:t.jsx(Ct,{size:16})}),t.jsx("button",{onClick:()=>a("justifyCenter"),className:e.alignCenter?"active":"",title:"Align Center",children:t.jsx(yt,{size:16})}),t.jsx("button",{onClick:()=>a("justifyRight"),className:e.alignRight?"active":"",title:"Align Right",children:t.jsx(xt,{size:16})}),t.jsx("button",{onClick:()=>a("justifyFull"),className:e.alignJustify?"active":"",title:"Justify",children:t.jsx(vt,{size:16})}),t.jsx("div",{className:"toolbar-separator"}),t.jsxs("select",{onChange:l=>a("fontName",l.target.value),defaultValue:"Arial",title:"Font Family",children:[t.jsx("option",{value:"Arial",children:"Arial"}),t.jsx("option",{value:"Times New Roman",children:"Times New Roman"}),t.jsx("option",{value:"Courier New",children:"Courier New"}),t.jsx("option",{value:"Georgia",children:"Georgia"}),t.jsx("option",{value:"Verdana",children:"Verdana"})]}),t.jsxs("select",{onChange:l=>a("fontSize",l.target.value),defaultValue:"12px",title:"Font Size",children:[t.jsx("option",{value:"10px",children:"10"}),t.jsx("option",{value:"12px",children:"12"}),t.jsx("option",{value:"14px",children:"14"}),t.jsx("option",{value:"16px",children:"16"}),t.jsx("option",{value:"18px",children:"18"}),t.jsx("option",{value:"24px",children:"24"}),t.jsx("option",{value:"32px",children:"32"})]}),t.jsx("div",{className:"toolbar-separator"}),t.jsx("button",{onClick:()=>a("insertUnorderedList"),title:"Bullet List",children:t.jsx(je,{size:16})}),t.jsx("button",{onClick:()=>a("insertOrderedList"),title:"Numbered List",children:t.jsx(gt,{size:16})}),t.jsx("button",{onClick:()=>a("insertCheckList"),title:"Checklist",children:t.jsx(mt,{size:16})}),t.jsx("div",{className:"toolbar-separator"}),t.jsx("button",{onClick:()=>{const l=prompt("Enter URL:");l&&a("createLink",l)},title:"Insert Link",children:t.jsx(dt,{size:16})}),t.jsx("button",{onClick:()=>a("insertHTML",'<table border="1"><tr><td>Cell 1</td><td>Cell 2</td></tr><tr><td>Cell 3</td><td>Cell 4</td></tr></table>'),title:"Insert Table",children:t.jsx(kt,{size:16})}),i&&t.jsx("button",{onClick:i,title:"Insert Page Break",children:t.jsx(Q,{size:16})}),t.jsx("div",{className:"toolbar-separator"}),t.jsx("button",{onClick:()=>a("undo"),title:"Undo",children:t.jsx(_t,{size:16})}),t.jsx("button",{onClick:()=>a("redo"),title:"Redo",children:t.jsx(ft,{size:16})}),t.jsx("div",{className:"toolbar-separator"}),t.jsx("input",{type:"file",accept:"image/*",onChange:l=>l.target.files[0]&&s(l.target.files[0]),style:{display:"none"},id:"image-upload"}),t.jsx("button",{onClick:()=>document.getElementById("image-upload").click(),title:"Insert Image",children:t.jsx(ct,{size:16})}),t.jsx("div",{className:"toolbar-separator"}),t.jsxs("select",{value:n,onChange:l=>o(l.target.value),title:"Page Size",children:[t.jsx("option",{value:"A4",children:"A4"}),t.jsx("option",{value:"Letter",children:"Letter"}),t.jsx("option",{value:"Legal",children:"Legal"})]})]})},Me=({content:e,dimensions:n,pageSize:a,pageBoundaries:o=[],editorRef:i,onInput:s,onKeyDown:l,onClick:d,onScroll:p})=>{const b={top:60,bottom:100,left:72,right:72},A=v=>{if(v.key==="Tab")return v.preventDefault(),document.execCommand("insertHTML",!1,"&nbsp;&nbsp;&nbsp;&nbsp;"),!1;const _=window.getSelection();if(!_||_.rangeCount===0)return;const P=_.getRangeAt(0),{startContainer:T,endContainer:C}=P,B=L=>L?L.nodeType===Node.ELEMENT_NODE?L.tagName==="PAGE-BREAK"||L.getAttribute("data-page-break")==="true":L.parentElement&&B(L.parentElement):!1;if((v.key==="Backspace"||v.key==="Delete")&&(B(T)||B(C)))return v.preventDefault(),!1;l&&l(v)};return t.jsx("div",{className:"continuous-page-container",style:{position:"relative",width:"100%",maxWidth:`${n.width}px`,margin:"40px auto",backgroundColor:"transparent",minHeight:"100vh"},children:t.jsx("div",{ref:i,contentEditable:!0,suppressContentEditableWarning:!0,className:"continuous-content",style:{position:"relative",zIndex:1,minHeight:`${n.height}px`,backgroundColor:"white",padding:`${b.top}px ${b.right}px ${b.bottom}px ${b.left}px`,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",outline:"none",cursor:"text",fontFamily:"Arial, sans-serif",fontSize:"12px",lineHeight:"1.15",color:"#333",wordWrap:"break-word",whiteSpace:"pre-wrap",overflowWrap:"break-word",border:"1px solid #e0e0e0"},onInput:s,onKeyDown:A,onClick:d,onScroll:p,"data-testid":"continuous-editor"})})},ze=({onNavigate:e,onAddPage:n,onDeletePage:a,onPageSizeChange:o,scrollContainerRef:i}={})=>{const s=H.useDispatch(),{pageBoundaries:l,activePage:d,pageSize:p}=H.useSelector(u=>u.document),b=h.useRef(null);h.useEffect(()=>()=>{b.current&&clearTimeout(b.current)},[]);const A=l.map((u,c)=>({id:u.id||`page-${c}`,index:c,size:p})),v=A.length||1,_=(u,c)=>{if(!i?.current)return;i.current.scrollTo({top:c.top-40,behavior:"smooth"}),setTimeout(()=>{P(u)},400)},P=u=>{const c=i?.current?.querySelector('[contenteditable="true"]');if(c){c.focus();try{let g=null,x=0;if(u===0)g=c.firstChild,x=0;else{const N=c.querySelectorAll('page-break, [data-page-break="true"]')[u-1];N&&N.nextSibling&&(g=N.nextSibling,x=0)}if(g){const S=document.createRange(),N=window.getSelection();g.nodeType===Node.TEXT_NODE?S.setStart(g,x):g.firstChild?S.setStart(g.firstChild,0):S.setStart(g,0),S.collapse(!0),N.removeAllRanges(),N.addRange(S)}}catch(g){console.warn("[positionCursorAtPage] Failed to position cursor:",g),c.focus()}}},T=u=>{s(q(u)),i?.current&&l[u]&&(b.current&&clearTimeout(b.current),b.current=setTimeout(()=>{_(u,l[u])},50)),e&&e(u)},C=()=>{s(ce({position:"end"})),n&&n()},B=u=>{if(v<=1){console.warn("Cannot delete the only page");return}s(ke({pageIndex:u})),a&&a(u)},L=u=>{s(le(u)),o&&o(u)},f=()=>{d>0&&T(d-1)},m=()=>{d<v-1&&T(d+1)};return h.useEffect(()=>{const u=c=>{c.target.closest(".page-manager")&&(c.ctrlKey||c.metaKey)&&(c.key==="ArrowUp"||c.key==="PageUp"?(c.preventDefault(),f()):(c.key==="ArrowDown"||c.key==="PageDown")&&(c.preventDefault(),m()))};return window.addEventListener("keydown",u),()=>window.removeEventListener("keydown",u)},[d,v]),t.jsxs("div",{className:"page-manager",children:[t.jsxs("div",{className:"page-size-controls",children:[t.jsxs("label",{htmlFor:"page-size-selector",children:[t.jsx(ht,{size:14,style:{marginRight:"4px",verticalAlign:"middle"}}),"Page Size:"]}),t.jsxs("select",{id:"page-size-selector",role:"combobox","aria-label":"Page size selector",value:p,onChange:u=>L(u.target.value),children:[t.jsx("option",{value:"A4",children:"A4"}),t.jsx("option",{value:"Letter",children:"Letter"}),t.jsx("option",{value:"Legal",children:"Legal"})]})]}),t.jsxs("div",{className:"page-navigation-controls",children:[t.jsx("button",{type:"button",className:"nav-button",onClick:f,disabled:d===0,"aria-label":"Previous page",title:"Previous page (Ctrl+↑)",children:t.jsx(_e,{size:16})}),t.jsxs("span",{className:"page-counter","aria-live":"polite",children:["Page ",d+1," of ",v]}),t.jsx("button",{type:"button",className:"nav-button",onClick:m,disabled:d>=v-1,"aria-label":"Next page",title:"Next page (Ctrl+↓)",children:t.jsx(Se,{size:16})})]}),t.jsx("div",{className:"page-list",children:A.map((u,c)=>t.jsxs("div",{className:"page-item",children:[t.jsxs("button",{type:"button",className:`page-button ${c===d?"active":""}`,onClick:()=>T(c),"aria-label":`Go to page ${c+1}`,"aria-current":c===d?"page":void 0,children:[t.jsx(Q,{size:14}),t.jsxs("span",{children:["Page ",c+1]})]}),v>1&&t.jsx("button",{type:"button",className:"delete-page-button",onClick:g=>{g.stopPropagation(),B(c)},"aria-label":`Delete page ${c+1}`,title:"Delete this page and its content",children:t.jsx(St,{size:14})})]},u.id))}),t.jsxs("button",{type:"button",className:"add-page-button",onClick:C,"aria-label":"Add new page",title:"Add new page at end",children:[t.jsx(pt,{size:16}),t.jsx("span",{children:"Add Page"})]})]})},Be={A4:{width:794,height:1123},Letter:{width:816,height:1056},Legal:{width:816,height:1344}},Tt=({pageManagerComponent:e=null,onNavigatePage:n,onAddPage:a,onDeletePage:o,onPageSizeChange:i,showSidebar:s=!0,showToolbar:l=!0,showPageManager:d=!0})=>{const p=H.useDispatch(),b=H.useSelector(r=>r.document),{pageSize:A,continuousContent:v,pageBoundaries:_,activePage:P}=b,T=h.useRef(null),C=h.useRef(null),{currentFormat:B,formatText:L}=ye(),{checkAndUpdateBoundaries:f,getCurrentPage:m,scrollToPage:u,positionCursorAtPage:c,updateBoundaries:g,triggerAutoReflow:x,removePageAndContent:S}=ve(A,C),N=Be[A]||Be.A4,[D,E]=h.useState(!1);h.useEffect(()=>{C.current&&C.current.innerHTML!==v&&(C.current.innerHTML=v,setTimeout(()=>{g()},100))},[v,g]),h.useEffect(()=>{const r=setTimeout(()=>{C.current&&C.current.focus()},200);return()=>clearTimeout(r)},[]);const M=h.useCallback(r=>{const k=r.currentTarget.innerHTML;p(X(k)),f(),x();const w=m();w!==P&&p(q(w))},[f,p,m,P,x]),z=h.useCallback(r=>{p(le(r)),g({pageSize:r}),i&&i(r)},[p,g,i]),O=h.useCallback(r=>{p(q(r)),u(r,T),n&&n(r)},[p,u,n]),U=h.useCallback(()=>{p(ce({position:"end"})),setTimeout(()=>{g()},100),a&&a()},[p,g,a]),ee=h.useCallback(()=>{const r=window.getSelection();if(r&&r.rangeCount>0){if(!C?.current)return;const $=`<page-break data-page-break="true" contenteditable="false" data-page-number="${C.current.querySelectorAll('page-break, [data-page-break="true"]').length+2}"></page-break><p><br></p>`;document.execCommand("insertHTML",!1,$),setTimeout(()=>{g()},100)}},[g,C]),te=h.useCallback(r=>{if(_.length<=1){console.warn("Cannot delete the only page");return}S(r)&&(p(q(0)),o&&o(r))},[_.length,S,p,o]),ne=h.useCallback(()=>{if(!T.current||!C.current)return;const r=m();r!==P&&p(q(r))},[m,P,p]),ae=v?(v.replace(/<[^>]*>/g," ").match(/\b\w+\b/g)||[]).length:0,re=_.length||1;return t.jsxs("div",{className:"multi-page-editor",children:[l&&t.jsx(Te,{currentFormat:B,pageSize:A,onFormatText:L,onPageSizeChange:z,onAddPageBreak:ee}),t.jsxs("div",{className:"editor-container",children:[s&&t.jsx(we,{editorView:null,isCollapsed:D,onToggle:()=>E(r=>!r),wordCount:ae,pageCount:re}),t.jsx("div",{className:"editor-viewport continuous-scroll",ref:T,onScroll:ne,children:t.jsx(Me,{content:v,dimensions:N,pageSize:A,pageBoundaries:_,editorRef:C,onInput:M,onClick:()=>C.current?.focus()})}),d&&t.jsx("div",{className:"page-manager-sidebar",children:e?h.cloneElement(e,{onNavigate:O,onAddPage:U,onDeletePage:te,onPageSizeChange:z,scrollContainerRef:T}):t.jsx(ze,{onNavigate:n,onAddPage:a,onDeletePage:o,onPageSizeChange:i,scrollContainerRef:T})})]})]})},Mt={A4:{width:794,height:1123},Letter:{width:816,height:1056},Legal:{width:816,height:1344}};y.ContentEditableEditor=Tt,y.ContinuousPageView=Me,y.EditorToolbar=Te,y.PAGE_DIMENSIONS=Mt,y.PageManager=ze,y.Sidebar=we,y.addPage=Ve,y.addPageBreak=ce,y.clearImages=Et,y.deleteImage=At,y.deletePage=Ge,y.documentReducer=Xe,y.duplicatePage=Ke,y.getAllImageKeys=Pt,y.getImage=wt,y.initializeDocument=Re,y.insertPageAt=Je,y.logger=Ee,y.movePageTo=Fe,y.removePageBreak=ke,y.resetDocument=We,y.saveImage=Ae,y.setActivePage=q,y.setEditorMode=Ye,y.updateContinuousContent=X,y.updatePageBoundaries=be,y.updatePageContent=qe,y.updatePageSize=le,y.updatePages=Ue,y.updateTitle=He,y.useContinuousReflow=ve,y.useFormatting=ye,Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})}));
//# sourceMappingURL=htmleditor.umd.cjs.map
