(function(U,m){typeof exports=="object"&&typeof module<"u"?m(exports,require("react"),require("uuid"),require("react-dom")):typeof define=="function"&&define.amd?define(["exports","react","uuid","react-dom"],m):(U=typeof globalThis<"u"?globalThis:U||self,m(U.HTMLEditor={},U.React,U.uuid,U.ReactDOM))})(this,(function(U,m,Ye,kn){"use strict";function Pn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Oe={exports:{}},Te={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tt;function Sn(){if(Tt)return Te;Tt=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function o(n,i,a){var r=null;if(a!==void 0&&(r=""+a),i.key!==void 0&&(r=""+i.key),"key"in i){a={};for(var s in i)s!=="key"&&(a[s]=i[s])}else a=i;return i=a.ref,{$$typeof:e,type:n,key:r,ref:i!==void 0?i:null,props:a}}return Te.Fragment=t,Te.jsx=o,Te.jsxs=o,Te}var ve={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vt;function wn(){return vt||(vt=1,process.env.NODE_ENV!=="production"&&(function(){function e(c){if(c==null)return null;if(typeof c=="function")return c.$$typeof===R?null:c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case M:return"Fragment";case _:return"Profiler";case T:return"StrictMode";case u:return"Suspense";case d:return"SuspenseList";case H:return"Activity"}if(typeof c=="object")switch(typeof c.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),c.$$typeof){case x:return"Portal";case B:return c.displayName||"Context";case k:return(c._context.displayName||"Context")+".Consumer";case g:var w=c.render;return c=c.displayName,c||(c=w.displayName||w.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case v:return w=c.displayName||null,w!==null?w:e(c.type)||"Memo";case N:w=c._payload,c=c._init;try{return e(c(w))}catch{}}return null}function t(c){return""+c}function o(c){try{t(c);var w=!1}catch{w=!0}if(w){w=console;var I=w.error,L=typeof Symbol=="function"&&Symbol.toStringTag&&c[Symbol.toStringTag]||c.constructor.name||"Object";return I.call(w,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",L),t(c)}}function n(c){if(c===M)return"<>";if(typeof c=="object"&&c!==null&&c.$$typeof===N)return"<...>";try{var w=e(c);return w?"<"+w+">":"<...>"}catch{return"<...>"}}function i(){var c=D.A;return c===null?null:c.getOwner()}function a(){return Error("react-stack-top-frame")}function r(c){if(q.call(c,"key")){var w=Object.getOwnPropertyDescriptor(c,"key").get;if(w&&w.isReactWarning)return!1}return c.key!==void 0}function s(c,w){function I(){ne||(ne=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",w))}I.isReactWarning=!0,Object.defineProperty(c,"key",{get:I,configurable:!0})}function y(){var c=e(this.type);return Y[c]||(Y[c]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),c=this.props.ref,c!==void 0?c:null}function p(c,w,I,L,V,Z){var z=I.ref;return c={$$typeof:P,type:c,key:w,props:I,_owner:L},(z!==void 0?z:null)!==null?Object.defineProperty(c,"ref",{enumerable:!1,get:y}):Object.defineProperty(c,"ref",{enumerable:!1,value:null}),c._store={},Object.defineProperty(c._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(c,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(c,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:V}),Object.defineProperty(c,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:Z}),Object.freeze&&(Object.freeze(c.props),Object.freeze(c)),c}function h(c,w,I,L,V,Z){var z=w.children;if(z!==void 0)if(L)if($(z)){for(L=0;L<z.length;L++)b(z[L]);Object.freeze&&Object.freeze(z)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else b(z);if(q.call(w,"key")){z=e(c);var G=Object.keys(w).filter(function(X){return X!=="key"});L=0<G.length?"{key: someKey, "+G.join(": ..., ")+": ...}":"{key: someKey}",E[z+L]||(G=0<G.length?"{"+G.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,L,z,G,z),E[z+L]=!0)}if(z=null,I!==void 0&&(o(I),z=""+I),r(w)&&(o(w.key),z=""+w.key),"key"in w){I={};for(var K in w)K!=="key"&&(I[K]=w[K])}else I=w;return z&&s(I,typeof c=="function"?c.displayName||c.name||"Unknown":c),p(c,z,I,i(),V,Z)}function b(c){f(c)?c._store&&(c._store.validated=1):typeof c=="object"&&c!==null&&c.$$typeof===N&&(c._payload.status==="fulfilled"?f(c._payload.value)&&c._payload.value._store&&(c._payload.value._store.validated=1):c._store&&(c._store.validated=1))}function f(c){return typeof c=="object"&&c!==null&&c.$$typeof===P}var O=m,P=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),k=Symbol.for("react.consumer"),B=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),v=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),H=Symbol.for("react.activity"),R=Symbol.for("react.client.reference"),D=O.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q=Object.prototype.hasOwnProperty,$=Array.isArray,oe=console.createTask?console.createTask:function(){return null};O={react_stack_bottom_frame:function(c){return c()}};var ne,Y={},W=O.react_stack_bottom_frame.bind(O,a)(),ae=oe(n(a)),E={};ve.Fragment=M,ve.jsx=function(c,w,I){var L=1e4>D.recentlyCreatedOwnerStacks++;return h(c,w,I,!1,L?Error("react-stack-top-frame"):W,L?oe(n(c)):ae)},ve.jsxs=function(c,w,I){var L=1e4>D.recentlyCreatedOwnerStacks++;return h(c,w,I,!0,L?Error("react-stack-top-frame"):W,L?oe(n(c)):ae)}})()),ve}var xt;function Cn(){return xt||(xt=1,process.env.NODE_ENV==="production"?Oe.exports=Sn():Oe.exports=wn()),Oe.exports}var l=Cn();const Ve=100,Ke=50,Xe=200,At=5,Je=e=>e<Xe,Qe=e=>e>Ke,On=96,Ne=e=>Math.round(e*On),Me={NORMAL:{name:"Normal",label:'Normal (1")',top:1,bottom:1,left:1,right:1},NARROW:{name:"Narrow",label:'Narrow (0.5")',top:.5,bottom:.5,left:.5,right:.5},MODERATE:{name:"Moderate",label:'Moderate (1" / 0.75")',top:1,bottom:1,left:.75,right:.75},WIDE:{name:"Wide",label:'Wide (1" / 2")',top:1,bottom:1,left:2,right:2},OFFICE_2003:{name:"Office 2003",label:'Office 2003 (1" / 1.25")',top:1,bottom:1,left:1.25,right:1.25}},pe="NORMAL",_t=(e=pe)=>{const t=Me[e]||Me[pe];return{top:Ne(t.top),bottom:Ne(t.bottom),left:Ne(t.left),right:Ne(t.right)}},Nn=(e=pe)=>{const t=_t(e);return t.top+t.bottom},Mn=()=>Object.keys(Me),Rn=e=>{const t=Me[e];return t?t.label:"Unknown"},ce={A4:{name:"A4",width:794,height:1123,widthMm:210,heightMm:297,widthIn:8.27,heightIn:11.69},Letter:{name:"Letter",width:816,height:1056,widthMm:216,heightMm:279,widthIn:8.5,heightIn:11},Legal:{name:"Legal",width:816,height:1344,widthMm:216,heightMm:356,widthIn:8.5,heightIn:14}},et="A4",Re=e=>{const t=ce[e]||ce[et];return{width:t.width,height:t.height}},In=e=>Object.keys(ce).includes(e),Ln=()=>Object.keys(ce),xe=et,me="<p><br></p>",jn="continuous",Ae=(e,t=xe)=>({id:Ye.v4(),index:e,size:t,content:me,images:[],isBreakPoint:!1}),Ie=e=>typeof e!="string"||e.trim()===""?me:e,kt=(e,t=xe)=>(e.length>0?e:[Ae(0,t)]).map((n,i)=>({id:n.id||Ye.v4(),index:i,size:n.size||t,content:Ie(n.content),images:n.images||[],isBreakPoint:!!n.isBreakPoint})),Dn=(e=xe)=>[{id:"page-0",pageNumber:1,top:0,height:Re(e).height}],tt=(e={})=>{const t=new Date().toISOString(),o=e.pageSize||xe,n=kt(e.pages||[Ae(0,o)],o);return{id:Ye.v4(),title:e.title||"Untitled Document",createdAt:t,updatedAt:t,pageSize:o,pages:n,activePage:e.activePage&&e.activePage<n.length?e.activePage:0,pageBreaks:e.pageBreaks||[],totalPages:n.length,editorMode:e.editorMode||jn,continuousContent:e.continuousContent||me,pageBoundaries:e.pageBoundaries||Dn(o),zoomLevel:e.zoomLevel||Ve,pageMargins:e.pageMargins||pe,undoStack:[],redoStack:[],canUndo:!1,canRedo:!1}},F={INITIALIZE_DOCUMENT:"INITIALIZE_DOCUMENT",UPDATE_TITLE:"UPDATE_TITLE",UPDATE_PAGE_CONTENT:"UPDATE_PAGE_CONTENT",UPDATE_PAGES:"UPDATE_PAGES",ADD_PAGE:"ADD_PAGE",DELETE_PAGE:"DELETE_PAGE",SET_ACTIVE_PAGE:"SET_ACTIVE_PAGE",UPDATE_PAGE_SIZE:"UPDATE_PAGE_SIZE",RESET_DOCUMENT:"RESET_DOCUMENT",UPDATE_CONTINUOUS_CONTENT:"UPDATE_CONTINUOUS_CONTENT",UPDATE_PAGE_BOUNDARIES:"UPDATE_PAGE_BOUNDARIES",ADD_PAGE_BREAK:"ADD_PAGE_BREAK",REMOVE_PAGE_BREAK:"REMOVE_PAGE_BREAK",SET_EDITOR_MODE:"SET_EDITOR_MODE",INSERT_PAGE_AT:"INSERT_PAGE_AT",MOVE_PAGE_TO:"MOVE_PAGE_TO",DUPLICATE_PAGE:"DUPLICATE_PAGE",SET_ZOOM_LEVEL:"SET_ZOOM_LEVEL",ZOOM_IN:"ZOOM_IN",ZOOM_OUT:"ZOOM_OUT",RESET_ZOOM:"RESET_ZOOM",UPDATE_PAGE_MARGINS:"UPDATE_PAGE_MARGINS",RECORD_OPERATION:"RECORD_OPERATION",UNDO:"UNDO",REDO:"REDO",CLEAR_UNDO_REDO:"CLEAR_UNDO_REDO"},nt=(e,t)=>{const o=new Date().toISOString();switch(t.type){case F.INITIALIZE_DOCUMENT:{const{initialContent:n=me,pageSize:i=xe}=t.payload||{},a={...Ae(0,i),content:Ie(n)};return tt({title:e.title,pageSize:i,pages:[a]})}case F.UPDATE_TITLE:return{...e,title:t.payload,updatedAt:o};case F.UPDATE_PAGE_CONTENT:{const{pageIndex:n,content:i}=t.payload;if(n<0||n>=e.pages.length)return e;const a=[...e.pages];return a[n]={...a[n],content:Ie(i)},{...e,pages:a,updatedAt:o}}case F.UPDATE_PAGES:{const n=Array.isArray(t.payload)?{pages:t.payload}:t.payload||{},i=kt(n.pages||[],e.pageSize),a=Array.isArray(n.pageBreaks)?n.pageBreaks:i.slice(0,-1).map((r,s)=>({id:`auto-break-${s}`,pageNumber:s+1}));return{...e,pages:i,activePage:Math.min(e.activePage,i.length-1),pageBreaks:a,totalPages:i.length,updatedAt:o}}case F.ADD_PAGE:{const n=typeof t.payload?.index=="number"?Math.min(Math.max(t.payload.index,0),e.pages.length):e.pages.length,i=[...e.pages];i.splice(n,0,Ae(n,e.pageSize));const a=i.map((s,y)=>({...s,index:y,size:e.pageSize})),r=a.slice(0,-1).map((s,y)=>({id:`auto-break-${y}`,pageNumber:y+1}));return{...e,pages:a,activePage:n,pageBreaks:r,totalPages:a.length,updatedAt:o}}case F.DELETE_PAGE:{const n=t.payload;if(e.pages.length<=1)return e;const i=[...e.pages];i.splice(n,1);const a=i.map((y,p)=>({...y,index:p,size:e.pageSize}));let r=e.activePage;r>=a.length?r=a.length-1:n<=r&&r>0&&(r-=1);const s=a.slice(0,-1).map((y,p)=>({id:`auto-break-${p}`,pageNumber:p+1}));return{...e,pages:a,activePage:r,pageBreaks:s,totalPages:a.length,updatedAt:o}}case F.SET_ACTIVE_PAGE:{const n=t.payload;if(n===e.activePage)return e;const i=e.editorMode==="continuous"?e.pageBoundaries.length:e.pages.length;return n<0||n>=i?e:{...e,activePage:n,updatedAt:o}}case F.UPDATE_PAGE_SIZE:{const n=t.payload;if(n===e.pageSize)return e;try{Re(n)}catch{return console.warn(`Invalid page size: ${n}`),e}const i=e.pages.map((r,s)=>({...r,index:s,size:n})),a=i.slice(0,-1).map((r,s)=>({id:`auto-break-${s}`,pageNumber:s+1}));return{...e,pageSize:n,pages:i,pageBreaks:a,updatedAt:o}}case F.RESET_DOCUMENT:return tt();case F.UPDATE_CONTINUOUS_CONTENT:{const n=Ie(t.payload);return n===e.continuousContent?e:{...e,continuousContent:n,updatedAt:o}}case F.UPDATE_PAGE_BOUNDARIES:{const n=Array.isArray(t.payload)?t.payload:[];if(n.length===e.pageBoundaries.length&&n.length>0&&n[0].id===e.pageBoundaries[0]?.id&&n[n.length-1].id===e.pageBoundaries[n.length-1]?.id)return e;const i=e.activePage>=n.length?Math.max(0,n.length-1):e.activePage;return{...e,pageBoundaries:n,totalPages:n.length,activePage:i,updatedAt:o}}case F.ADD_PAGE_BREAK:{const{position:n="end",pageIndex:i}=t.payload||{},a='<page-break data-page-break="true" style="display: block; height: 20px; border-top: 2px dashed #ccc; margin: 20px 0; page-break-after: always;"></page-break>';let r=e.continuousContent;if(n==="end")r=r+a+"<p><br></p>";else if(typeof n=="number"){const s=r.substring(0,n),y=r.substring(n);r=s+a+y}else if(typeof i=="number"&&typeof document<"u"){const s=document.createElement("div");s.innerHTML=r;const y=s.querySelectorAll('page-break, [data-page-break="true"]');if(i===0&&y.length===0)r=r+a+"<p><br></p>";else if(i<y.length){const p=y[i],h=document.createElement("page-break");h.setAttribute("data-page-break","true"),h.setAttribute("style","display: block; height: 20px; border-top: 2px dashed #ccc; margin: 20px 0; page-break-after: always;");const b=document.createElement("p");b.innerHTML="<br>",p.parentNode.insertBefore(h,p.nextSibling),h.parentNode.insertBefore(b,h.nextSibling),r=s.innerHTML}else r=r+a+"<p><br></p>"}return{...e,continuousContent:r,updatedAt:o}}case F.REMOVE_PAGE_BREAK:{const{pageIndex:n}=t.payload||{};if(typeof n!="number"||typeof document>"u")return e;const i=document.createElement("div");i.innerHTML=e.continuousContent;const a=i.querySelectorAll('page-break, [data-page-break="true"]');return a[n]&&a[n].remove(),i.querySelectorAll('page-break, [data-page-break="true"]').forEach((s,y)=>{s.setAttribute("data-page-number",String(y+2))}),{...e,continuousContent:i.innerHTML,updatedAt:o}}case F.SET_EDITOR_MODE:{const n=t.payload;if(n===e.editorMode)return e;let i=e.continuousContent,a=e.pages;return n==="continuous"?i=e.pages.map(s=>s.content).filter(s=>s&&s!==me).join(`
`)||me:e.continuousContent&&e.continuousContent!==me&&(a=[{...Ae(0,e.pageSize),content:e.continuousContent}]),{...e,editorMode:n,continuousContent:i,pages:a,updatedAt:o}}case F.SET_ZOOM_LEVEL:{const n=t.payload;return n<Ke||n>Xe?(console.warn(`Invalid zoom level: ${n}. Must be between ${Ke} and ${Xe}.`),e):n===e.zoomLevel?e:{...e,zoomLevel:n,updatedAt:o}}case F.ZOOM_IN:{if(!Je(e.zoomLevel))return e;const n=e.zoomLevel+At;return{...e,zoomLevel:n,updatedAt:o}}case F.ZOOM_OUT:{if(!Qe(e.zoomLevel))return e;const n=e.zoomLevel-At;return{...e,zoomLevel:n,updatedAt:o}}case F.RESET_ZOOM:return e.zoomLevel===Ve?e:{...e,zoomLevel:Ve,updatedAt:o};case F.UPDATE_PAGE_MARGINS:{const n=t.payload;return n===e.pageMargins?e:{...e,pageMargins:n,updatedAt:o}}case F.RECORD_OPERATION:{const{operation:n,inverseOperation:i}=t.payload;return{...e,undoStack:[...e.undoStack,{operation:n,inverseOperation:i}],redoStack:[],canUndo:!0,canRedo:!1,updatedAt:o}}case F.UNDO:{if(e.undoStack.length===0)return e;const n=e.undoStack[e.undoStack.length-1],i=e.undoStack.slice(0,-1);let a=e;return n.inverseOperation&&(a=nt(e,n.inverseOperation)),{...a,undoStack:i,redoStack:[...e.redoStack,n],canUndo:i.length>0,canRedo:!0,updatedAt:o}}case F.REDO:{if(e.redoStack.length===0)return e;const n=e.redoStack[e.redoStack.length-1],i=e.redoStack.slice(0,-1);let a=e;return n.operation&&(a=nt(e,n.operation)),{...a,undoStack:[...e.undoStack,n],redoStack:i,canUndo:!0,canRedo:i.length>0,updatedAt:o}}case F.CLEAR_UNDO_REDO:return{...e,undoStack:[],redoStack:[],canUndo:!1,canRedo:!1,updatedAt:o};case"IMAGE_ALIGN":{const{element:n,state:i}=t.payload;return n&&i&&(n.style.float=i.float,n.style.margin=i.margin,n.style.display=i.display,i.width&&(n.style.width=i.width),i.height&&(n.style.height=i.height)),e}case"IMAGE_DELETE":{const{element:n}=t.payload;return n&&n.parentNode&&n.parentNode.removeChild(n),e}case"IMAGE_REINSERT":{const{state:n}=t.payload;return n&&n.parent&&n.element&&(n.nextSibling?n.parent.insertBefore(n.element,n.nextSibling):n.parent.appendChild(n.element)),e}case"IMAGE_ASPECT_RATIO":return e;case"IMAGE_RESIZE":{const{element:n,state:i}=t.payload;return n&&i&&(i.width&&(n.style.width=i.width),i.height&&(n.style.height=i.height)),e}default:return e}},Pt=m.createContext(null),Hn=({children:e,initialState:t={}})=>{const[o,n]=m.useReducer(nt,tt(t)),i=m.useMemo(()=>({initializeDocument:r=>n({type:F.INITIALIZE_DOCUMENT,payload:r}),updateTitle:r=>n({type:F.UPDATE_TITLE,payload:r}),updatePageContent:r=>n({type:F.UPDATE_PAGE_CONTENT,payload:r}),updatePages:r=>n({type:F.UPDATE_PAGES,payload:r}),addPage:r=>n({type:F.ADD_PAGE,payload:r}),deletePage:r=>n({type:F.DELETE_PAGE,payload:r}),setActivePage:r=>n({type:F.SET_ACTIVE_PAGE,payload:r}),updatePageSize:r=>n({type:F.UPDATE_PAGE_SIZE,payload:r}),resetDocument:()=>n({type:F.RESET_DOCUMENT}),updateContinuousContent:r=>n({type:F.UPDATE_CONTINUOUS_CONTENT,payload:r}),updatePageBoundaries:r=>n({type:F.UPDATE_PAGE_BOUNDARIES,payload:r}),addPageBreak:r=>n({type:F.ADD_PAGE_BREAK,payload:r}),removePageBreak:r=>n({type:F.REMOVE_PAGE_BREAK,payload:r}),setEditorMode:r=>n({type:F.SET_EDITOR_MODE,payload:r}),insertPageAt:r=>n({type:F.INSERT_PAGE_AT,payload:r}),movePageTo:r=>n({type:F.MOVE_PAGE_TO,payload:r}),duplicatePage:r=>n({type:F.DUPLICATE_PAGE,payload:r}),setZoomLevel:r=>n({type:F.SET_ZOOM_LEVEL,payload:r}),zoomIn:()=>n({type:F.ZOOM_IN}),zoomOut:()=>n({type:F.ZOOM_OUT}),resetZoom:()=>n({type:F.RESET_ZOOM}),updatePageMargins:r=>n({type:F.UPDATE_PAGE_MARGINS,payload:r}),recordOperation:(r,s)=>n({type:F.RECORD_OPERATION,payload:{operation:r,inverseOperation:s}}),undo:()=>n({type:F.UNDO}),redo:()=>n({type:F.REDO}),clearUndoRedo:()=>n({type:F.CLEAR_UNDO_REDO})}),[]),a=m.useMemo(()=>({state:o,actions:i,dispatch:n}),[o,i]);return l.jsx(Pt.Provider,{value:a,children:e})},rt=()=>{const e=m.useContext(Pt);if(!e)throw new Error("useDocument must be used within a DocumentProvider");return e},ot=()=>{const{state:e}=rt();return e},be=()=>{const{actions:e}=rt();return e};var Le={exports:{}},je={exports:{}},ee={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var St;function Bn(){if(St)return ee;St=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,o=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,i=e?Symbol.for("react.strict_mode"):60108,a=e?Symbol.for("react.profiler"):60114,r=e?Symbol.for("react.provider"):60109,s=e?Symbol.for("react.context"):60110,y=e?Symbol.for("react.async_mode"):60111,p=e?Symbol.for("react.concurrent_mode"):60111,h=e?Symbol.for("react.forward_ref"):60112,b=e?Symbol.for("react.suspense"):60113,f=e?Symbol.for("react.suspense_list"):60120,O=e?Symbol.for("react.memo"):60115,P=e?Symbol.for("react.lazy"):60116,x=e?Symbol.for("react.block"):60121,M=e?Symbol.for("react.fundamental"):60117,T=e?Symbol.for("react.responder"):60118,_=e?Symbol.for("react.scope"):60119;function k(g){if(typeof g=="object"&&g!==null){var u=g.$$typeof;switch(u){case t:switch(g=g.type,g){case y:case p:case n:case a:case i:case b:return g;default:switch(g=g&&g.$$typeof,g){case s:case h:case P:case O:case r:return g;default:return u}}case o:return u}}}function B(g){return k(g)===p}return ee.AsyncMode=y,ee.ConcurrentMode=p,ee.ContextConsumer=s,ee.ContextProvider=r,ee.Element=t,ee.ForwardRef=h,ee.Fragment=n,ee.Lazy=P,ee.Memo=O,ee.Portal=o,ee.Profiler=a,ee.StrictMode=i,ee.Suspense=b,ee.isAsyncMode=function(g){return B(g)||k(g)===y},ee.isConcurrentMode=B,ee.isContextConsumer=function(g){return k(g)===s},ee.isContextProvider=function(g){return k(g)===r},ee.isElement=function(g){return typeof g=="object"&&g!==null&&g.$$typeof===t},ee.isForwardRef=function(g){return k(g)===h},ee.isFragment=function(g){return k(g)===n},ee.isLazy=function(g){return k(g)===P},ee.isMemo=function(g){return k(g)===O},ee.isPortal=function(g){return k(g)===o},ee.isProfiler=function(g){return k(g)===a},ee.isStrictMode=function(g){return k(g)===i},ee.isSuspense=function(g){return k(g)===b},ee.isValidElementType=function(g){return typeof g=="string"||typeof g=="function"||g===n||g===p||g===a||g===i||g===b||g===f||typeof g=="object"&&g!==null&&(g.$$typeof===P||g.$$typeof===O||g.$$typeof===r||g.$$typeof===s||g.$$typeof===h||g.$$typeof===M||g.$$typeof===T||g.$$typeof===_||g.$$typeof===x)},ee.typeOf=k,ee}var te={};/** @license React v16.13.1
 * react-is.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wt;function zn(){return wt||(wt=1,process.env.NODE_ENV!=="production"&&(function(){var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,o=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,i=e?Symbol.for("react.strict_mode"):60108,a=e?Symbol.for("react.profiler"):60114,r=e?Symbol.for("react.provider"):60109,s=e?Symbol.for("react.context"):60110,y=e?Symbol.for("react.async_mode"):60111,p=e?Symbol.for("react.concurrent_mode"):60111,h=e?Symbol.for("react.forward_ref"):60112,b=e?Symbol.for("react.suspense"):60113,f=e?Symbol.for("react.suspense_list"):60120,O=e?Symbol.for("react.memo"):60115,P=e?Symbol.for("react.lazy"):60116,x=e?Symbol.for("react.block"):60121,M=e?Symbol.for("react.fundamental"):60117,T=e?Symbol.for("react.responder"):60118,_=e?Symbol.for("react.scope"):60119;function k(C){return typeof C=="string"||typeof C=="function"||C===n||C===p||C===a||C===i||C===b||C===f||typeof C=="object"&&C!==null&&(C.$$typeof===P||C.$$typeof===O||C.$$typeof===r||C.$$typeof===s||C.$$typeof===h||C.$$typeof===M||C.$$typeof===T||C.$$typeof===_||C.$$typeof===x)}function B(C){if(typeof C=="object"&&C!==null){var se=C.$$typeof;switch(se){case t:var Ee=C.type;switch(Ee){case y:case p:case n:case a:case i:case b:return Ee;default:var we=Ee&&Ee.$$typeof;switch(we){case s:case h:case P:case O:case r:return we;default:return se}}case o:return se}}}var g=y,u=p,d=s,v=r,N=t,H=h,R=n,D=P,q=O,$=o,oe=a,ne=i,Y=b,W=!1;function ae(C){return W||(W=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),E(C)||B(C)===y}function E(C){return B(C)===p}function c(C){return B(C)===s}function w(C){return B(C)===r}function I(C){return typeof C=="object"&&C!==null&&C.$$typeof===t}function L(C){return B(C)===h}function V(C){return B(C)===n}function Z(C){return B(C)===P}function z(C){return B(C)===O}function G(C){return B(C)===o}function K(C){return B(C)===a}function X(C){return B(C)===i}function ie(C){return B(C)===b}te.AsyncMode=g,te.ConcurrentMode=u,te.ContextConsumer=d,te.ContextProvider=v,te.Element=N,te.ForwardRef=H,te.Fragment=R,te.Lazy=D,te.Memo=q,te.Portal=$,te.Profiler=oe,te.StrictMode=ne,te.Suspense=Y,te.isAsyncMode=ae,te.isConcurrentMode=E,te.isContextConsumer=c,te.isContextProvider=w,te.isElement=I,te.isForwardRef=L,te.isFragment=V,te.isLazy=Z,te.isMemo=z,te.isPortal=G,te.isProfiler=K,te.isStrictMode=X,te.isSuspense=ie,te.isValidElementType=k,te.typeOf=B})()),te}var Ct;function Ot(){return Ct||(Ct=1,process.env.NODE_ENV==="production"?je.exports=Bn():je.exports=zn()),je.exports}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var at,Nt;function $n(){if(Nt)return at;Nt=1;var e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function n(a){if(a==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(a)}function i(){try{if(!Object.assign)return!1;var a=new String("abc");if(a[5]="de",Object.getOwnPropertyNames(a)[0]==="5")return!1;for(var r={},s=0;s<10;s++)r["_"+String.fromCharCode(s)]=s;var y=Object.getOwnPropertyNames(r).map(function(h){return r[h]});if(y.join("")!=="0123456789")return!1;var p={};return"abcdefghijklmnopqrst".split("").forEach(function(h){p[h]=h}),Object.keys(Object.assign({},p)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}return at=i()?Object.assign:function(a,r){for(var s,y=n(a),p,h=1;h<arguments.length;h++){s=Object(arguments[h]);for(var b in s)t.call(s,b)&&(y[b]=s[b]);if(e){p=e(s);for(var f=0;f<p.length;f++)o.call(s,p[f])&&(y[p[f]]=s[p[f]])}}return y},at}var it,Mt;function st(){if(Mt)return it;Mt=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return it=e,it}var ct,Rt;function It(){return Rt||(Rt=1,ct=Function.call.bind(Object.prototype.hasOwnProperty)),ct}var lt,Lt;function Un(){if(Lt)return lt;Lt=1;var e=function(){};if(process.env.NODE_ENV!=="production"){var t=st(),o={},n=It();e=function(a){var r="Warning: "+a;typeof console<"u"&&console.error(r);try{throw new Error(r)}catch{}}}function i(a,r,s,y,p){if(process.env.NODE_ENV!=="production"){for(var h in a)if(n(a,h)){var b;try{if(typeof a[h]!="function"){var f=Error((y||"React class")+": "+s+" type `"+h+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof a[h]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw f.name="Invariant Violation",f}b=a[h](r,h,y,s,null,t)}catch(P){b=P}if(b&&!(b instanceof Error)&&e((y||"React class")+": type specification of "+s+" `"+h+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof b+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),b instanceof Error&&!(b.message in o)){o[b.message]=!0;var O=p?p():"";e("Failed "+s+" type: "+b.message+(O??""))}}}}return i.resetWarningCache=function(){process.env.NODE_ENV!=="production"&&(o={})},lt=i,lt}var ut,jt;function Fn(){if(jt)return ut;jt=1;var e=Ot(),t=$n(),o=st(),n=It(),i=Un(),a=function(){};process.env.NODE_ENV!=="production"&&(a=function(s){var y="Warning: "+s;typeof console<"u"&&console.error(y);try{throw new Error(y)}catch{}});function r(){return null}return ut=function(s,y){var p=typeof Symbol=="function"&&Symbol.iterator,h="@@iterator";function b(E){var c=E&&(p&&E[p]||E[h]);if(typeof c=="function")return c}var f="<<anonymous>>",O={array:T("array"),bigint:T("bigint"),bool:T("boolean"),func:T("function"),number:T("number"),object:T("object"),string:T("string"),symbol:T("symbol"),any:_(),arrayOf:k,element:B(),elementType:g(),instanceOf:u,node:H(),objectOf:v,oneOf:d,oneOfType:N,shape:D,exact:q};function P(E,c){return E===c?E!==0||1/E===1/c:E!==E&&c!==c}function x(E,c){this.message=E,this.data=c&&typeof c=="object"?c:{},this.stack=""}x.prototype=Error.prototype;function M(E){if(process.env.NODE_ENV!=="production")var c={},w=0;function I(V,Z,z,G,K,X,ie){if(G=G||f,X=X||z,ie!==o){if(y){var C=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw C.name="Invariant Violation",C}else if(process.env.NODE_ENV!=="production"&&typeof console<"u"){var se=G+":"+z;!c[se]&&w<3&&(a("You are manually calling a React.PropTypes validation function for the `"+X+"` prop on `"+G+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),c[se]=!0,w++)}}return Z[z]==null?V?Z[z]===null?new x("The "+K+" `"+X+"` is marked as required "+("in `"+G+"`, but its value is `null`.")):new x("The "+K+" `"+X+"` is marked as required in "+("`"+G+"`, but its value is `undefined`.")):null:E(Z,z,G,K,X)}var L=I.bind(null,!1);return L.isRequired=I.bind(null,!0),L}function T(E){function c(w,I,L,V,Z,z){var G=w[I],K=ne(G);if(K!==E){var X=Y(G);return new x("Invalid "+V+" `"+Z+"` of type "+("`"+X+"` supplied to `"+L+"`, expected ")+("`"+E+"`."),{expectedType:E})}return null}return M(c)}function _(){return M(r)}function k(E){function c(w,I,L,V,Z){if(typeof E!="function")return new x("Property `"+Z+"` of component `"+L+"` has invalid PropType notation inside arrayOf.");var z=w[I];if(!Array.isArray(z)){var G=ne(z);return new x("Invalid "+V+" `"+Z+"` of type "+("`"+G+"` supplied to `"+L+"`, expected an array."))}for(var K=0;K<z.length;K++){var X=E(z,K,L,V,Z+"["+K+"]",o);if(X instanceof Error)return X}return null}return M(c)}function B(){function E(c,w,I,L,V){var Z=c[w];if(!s(Z)){var z=ne(Z);return new x("Invalid "+L+" `"+V+"` of type "+("`"+z+"` supplied to `"+I+"`, expected a single ReactElement."))}return null}return M(E)}function g(){function E(c,w,I,L,V){var Z=c[w];if(!e.isValidElementType(Z)){var z=ne(Z);return new x("Invalid "+L+" `"+V+"` of type "+("`"+z+"` supplied to `"+I+"`, expected a single ReactElement type."))}return null}return M(E)}function u(E){function c(w,I,L,V,Z){if(!(w[I]instanceof E)){var z=E.name||f,G=ae(w[I]);return new x("Invalid "+V+" `"+Z+"` of type "+("`"+G+"` supplied to `"+L+"`, expected ")+("instance of `"+z+"`."))}return null}return M(c)}function d(E){if(!Array.isArray(E))return process.env.NODE_ENV!=="production"&&(arguments.length>1?a("Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z])."):a("Invalid argument supplied to oneOf, expected an array.")),r;function c(w,I,L,V,Z){for(var z=w[I],G=0;G<E.length;G++)if(P(z,E[G]))return null;var K=JSON.stringify(E,function(ie,C){var se=Y(C);return se==="symbol"?String(C):C});return new x("Invalid "+V+" `"+Z+"` of value `"+String(z)+"` "+("supplied to `"+L+"`, expected one of "+K+"."))}return M(c)}function v(E){function c(w,I,L,V,Z){if(typeof E!="function")return new x("Property `"+Z+"` of component `"+L+"` has invalid PropType notation inside objectOf.");var z=w[I],G=ne(z);if(G!=="object")return new x("Invalid "+V+" `"+Z+"` of type "+("`"+G+"` supplied to `"+L+"`, expected an object."));for(var K in z)if(n(z,K)){var X=E(z,K,L,V,Z+"."+K,o);if(X instanceof Error)return X}return null}return M(c)}function N(E){if(!Array.isArray(E))return process.env.NODE_ENV!=="production"&&a("Invalid argument supplied to oneOfType, expected an instance of array."),r;for(var c=0;c<E.length;c++){var w=E[c];if(typeof w!="function")return a("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+W(w)+" at index "+c+"."),r}function I(L,V,Z,z,G){for(var K=[],X=0;X<E.length;X++){var ie=E[X],C=ie(L,V,Z,z,G,o);if(C==null)return null;C.data&&n(C.data,"expectedType")&&K.push(C.data.expectedType)}var se=K.length>0?", expected one of type ["+K.join(", ")+"]":"";return new x("Invalid "+z+" `"+G+"` supplied to "+("`"+Z+"`"+se+"."))}return M(I)}function H(){function E(c,w,I,L,V){return $(c[w])?null:new x("Invalid "+L+" `"+V+"` supplied to "+("`"+I+"`, expected a ReactNode."))}return M(E)}function R(E,c,w,I,L){return new x((E||"React class")+": "+c+" type `"+w+"."+I+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+L+"`.")}function D(E){function c(w,I,L,V,Z){var z=w[I],G=ne(z);if(G!=="object")return new x("Invalid "+V+" `"+Z+"` of type `"+G+"` "+("supplied to `"+L+"`, expected `object`."));for(var K in E){var X=E[K];if(typeof X!="function")return R(L,V,Z,K,Y(X));var ie=X(z,K,L,V,Z+"."+K,o);if(ie)return ie}return null}return M(c)}function q(E){function c(w,I,L,V,Z){var z=w[I],G=ne(z);if(G!=="object")return new x("Invalid "+V+" `"+Z+"` of type `"+G+"` "+("supplied to `"+L+"`, expected `object`."));var K=t({},w[I],E);for(var X in K){var ie=E[X];if(n(E,X)&&typeof ie!="function")return R(L,V,Z,X,Y(ie));if(!ie)return new x("Invalid "+V+" `"+Z+"` key `"+X+"` supplied to `"+L+"`.\nBad object: "+JSON.stringify(w[I],null,"  ")+`
Valid keys: `+JSON.stringify(Object.keys(E),null,"  "));var C=ie(z,X,L,V,Z+"."+X,o);if(C)return C}return null}return M(c)}function $(E){switch(typeof E){case"number":case"string":case"undefined":return!0;case"boolean":return!E;case"object":if(Array.isArray(E))return E.every($);if(E===null||s(E))return!0;var c=b(E);if(c){var w=c.call(E),I;if(c!==E.entries){for(;!(I=w.next()).done;)if(!$(I.value))return!1}else for(;!(I=w.next()).done;){var L=I.value;if(L&&!$(L[1]))return!1}}else return!1;return!0;default:return!1}}function oe(E,c){return E==="symbol"?!0:c?c["@@toStringTag"]==="Symbol"||typeof Symbol=="function"&&c instanceof Symbol:!1}function ne(E){var c=typeof E;return Array.isArray(E)?"array":E instanceof RegExp?"object":oe(c,E)?"symbol":c}function Y(E){if(typeof E>"u"||E===null)return""+E;var c=ne(E);if(c==="object"){if(E instanceof Date)return"date";if(E instanceof RegExp)return"regexp"}return c}function W(E){var c=Y(E);switch(c){case"array":case"object":return"an "+c;case"boolean":case"date":case"regexp":return"a "+c;default:return c}}function ae(E){return!E.constructor||!E.constructor.name?f:E.constructor.name}return O.checkPropTypes=i,O.resetWarningCache=i.resetWarningCache,O.PropTypes=O,O},ut}var dt,Dt;function Gn(){if(Dt)return dt;Dt=1;var e=st();function t(){}function o(){}return o.resetWarningCache=t,dt=function(){function n(r,s,y,p,h,b){if(b!==e){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}n.isRequired=n;function i(){return n}var a={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:i,element:n,elementType:n,instanceOf:i,node:n,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:o,resetWarningCache:t};return a.PropTypes=a,a},dt}var Ht;function qn(){if(Ht)return Le.exports;if(Ht=1,process.env.NODE_ENV!=="production"){var e=Ot(),t=!0;Le.exports=Fn()(e.isElement,t)}else Le.exports=Gn()();return Le.exports}var Wn=qn();const A=Pn(Wn),ft={"7.5pt":{pt:7.5,px:10,label:"7.5"},"9pt":{pt:9,px:12,label:"9"},"10pt":{pt:10,px:13,label:"10"},"11pt":{pt:11,px:15,label:"11"},"12pt":{pt:12,px:16,label:"12"},"14pt":{pt:14,px:19,label:"14"},"16pt":{pt:16,px:21,label:"16"},"18pt":{pt:18,px:24,label:"18"},"20pt":{pt:20,px:27,label:"20"},"22pt":{pt:22,px:29,label:"22"},"24pt":{pt:24,px:32,label:"24"},"26pt":{pt:26,px:35,label:"26"},"28pt":{pt:28,px:37,label:"28"},"36pt":{pt:36,px:48,label:"36"},"48pt":{pt:48,px:64,label:"48"},"72pt":{pt:72,px:96,label:"72"}},Bt=[{value:"10px",label:"7.5",pt:7.5},{value:"12px",label:"9",pt:9},{value:"13px",label:"10",pt:10},{value:"15px",label:"11",pt:11},{value:"16px",label:"12",pt:12},{value:"19px",label:"14",pt:14},{value:"21px",label:"16",pt:16},{value:"24px",label:"18",pt:18},{value:"27px",label:"20",pt:20},{value:"32px",label:"24",pt:24},{value:"37px",label:"28",pt:28},{value:"48px",label:"36",pt:36},{value:"64px",label:"48",pt:48},{value:"96px",label:"72",pt:72}],_e="16px",zt=e=>Math.round(e*96/72),$t=e=>Math.round(e*72/96*2)/2,Zn=e=>{const t=Object.values(ft).find(o=>o.pt===e);return t?`${t.px}px`:`${zt(e)}px`},Yn=e=>{const t=parseInt(e),o=Object.values(ft).find(n=>n.px===t);return o?o.pt:$t(t)},Vn=e=>{if(!e)return!1;if(e.endsWith("px")){const t=parseInt(e);return t>=8&&t<=144}if(e.endsWith("pt")){const t=parseFloat(e);return t>=6&&t<=108}return!1},fe={minWidth:50,minHeight:50,maxWidth:800,maxHeight:600,aspectRatio:!0,preserveAspectRatio:!0,defaultWidth:300,defaultHeight:200},S={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP:"top",BOTTOM:"bottom",LEFT:"left",RIGHT:"right"};function Kn({handler:e,startX:t,startY:o,currentX:n,currentY:i,startWidth:a,startHeight:r,options:s=fe}){const y=n-t,p=i-o;let h=a,b=r;switch(e){case S.TOP_LEFT:h=Math.max(s.minWidth,a-y),b=Math.max(s.minHeight,r-p);break;case S.TOP_RIGHT:h=Math.max(s.minWidth,a+y),b=Math.max(s.minHeight,r-p);break;case S.BOTTOM_LEFT:h=Math.max(s.minWidth,a-y),b=Math.max(s.minHeight,r+p);break;case S.BOTTOM_RIGHT:h=Math.max(s.minWidth,a+y),b=Math.max(s.minHeight,r+p);break;case S.TOP:b=Math.max(s.minHeight,r-p);break;case S.BOTTOM:b=Math.max(s.minHeight,r+p);break;case S.LEFT:h=Math.max(s.minWidth,a-y);break;case S.RIGHT:h=Math.max(s.minWidth,a+y);break;default:return{width:h,height:b}}if(s.preserveAspectRatio&&s.aspectRatio){const f=a/r;[S.TOP_LEFT,S.TOP_RIGHT,S.BOTTOM_LEFT,S.BOTTOM_RIGHT].includes(e)?h/f>b?b=Math.max(s.minHeight,h/f):h=Math.max(s.minWidth,b*f):[S.TOP,S.BOTTOM].includes(e)?h=b*f:[S.LEFT,S.RIGHT].includes(e)&&(b=h/f)}return s.maxWidth&&h>s.maxWidth&&(h=s.maxWidth,s.preserveAspectRatio&&s.aspectRatio&&(b=h/(a/r))),s.maxHeight&&b>s.maxHeight&&(b=s.maxHeight,s.preserveAspectRatio&&s.aspectRatio&&(h=b*(a/r))),h=Math.max(s.minWidth,h),b=Math.max(s.minHeight,b),{width:Math.round(h),height:Math.round(b)}}function de(e){return e?e.tagName==="IMG"?(console.log("Element is an IMG tag, returning true"),!0):!!(e.tagName==="DIV"&&e.style.backgroundImage&&e.style.backgroundImage!=="none"):!1}function Xn(e){return de(e)?{width:e.offsetWidth,height:e.offsetHeight}:{width:0,height:0}}function Jn(e,{width:t,height:o}){de(e)&&(e.tagName==="IMG"?(e.style.width=`${t}px`,e.style.height=`${o}px`,e.width=t,e.height=o):e.tagName==="DIV"&&(e.style.width=`${t}px`,e.style.height=`${o}px`))}function pt(e,t=fe){if(!de(e))return null;const o=document.createElement("div");o.className="image-resize-overlay",o.style.position="fixed",o.style.zIndex="1000",o.style.pointerEvents="none";const n=e.getBoundingClientRect();return o.style.top=`${n.top}px`,o.style.left=`${n.left}px`,o.style.width=`${n.width}px`,o.style.height=`${n.height}px`,Object.values(S).forEach(a=>{const r=document.createElement("div");r.className=`resize-handler resize-handler-${a}`,r.dataset.handler=a,r.style.position="absolute",r.style.width="10px",r.style.height="10px",r.style.backgroundColor="#007bff",r.style.border="2px solid white",r.style.borderRadius="50%",r.style.boxShadow="0 0 3px rgba(0,0,0,0.3)",r.style.cursor=Qn(a),r.style.pointerEvents="all",Ut(r,a,n.width,n.height),o.appendChild(r)}),o}function Qn(e){switch(e){case S.TOP_LEFT:case S.BOTTOM_RIGHT:return"nwse-resize";case S.TOP_RIGHT:case S.BOTTOM_LEFT:return"nesw-resize";case S.TOP:case S.BOTTOM:return"ns-resize";case S.LEFT:case S.RIGHT:return"ew-resize";default:return"default"}}function Ut(e,t,o,n){switch(t){case S.TOP_LEFT:e.style.top="-5px",e.style.left="-5px";break;case S.TOP_RIGHT:e.style.top="-5px",e.style.right="-5px";break;case S.BOTTOM_LEFT:e.style.bottom="-5px",e.style.left="-5px";break;case S.BOTTOM_RIGHT:e.style.bottom="-5px",e.style.right="-5px";break;case S.TOP:e.style.top="-5px",e.style.left=`${o/2+-5}px`;break;case S.BOTTOM:e.style.bottom="-5px",e.style.left=`${o/2+-5}px`;break;case S.LEFT:e.style.top=`${n/2+-5}px`,e.style.left="-5px";break;case S.RIGHT:e.style.top=`${n/2+-5}px`,e.style.right="-5px";break}}function ke(e,t){if(!e||!t)return;const o=t.getBoundingClientRect();e.style.top=`${o.top}px`,e.style.left=`${o.left}px`,e.style.width=`${o.width}px`,e.style.height=`${o.height}px`,e.querySelectorAll(".resize-handler").forEach(i=>{const a=i.dataset.handler;Ut(i,a,o.width,o.height)})}function ye(e){e&&e.parentNode&&e.parentNode.removeChild(e)}const er={"10px":"1","12px":"2","13px":"2","15px":"3","16px":"3","19px":"4","21px":"4","24px":"5","27px":"5","32px":"6","37px":"6","48px":"6","64px":"7","96px":"7"},Ft={bold:!1,italic:!1,underline:!1,strikethrough:!1,alignLeft:!1,alignCenter:!1,alignRight:!1,alignJustify:!1,fontFamily:"Arial",fontSize:_e,headingLevel:"p",imageSelected:!1,imageResizeOptions:fe,preserveAspectRatio:!0},Gt=()=>{const[e,t]=m.useState(Ft),o=be(),n=m.useCallback(T=>{try{const _=window.getSelection();if(!_||_.rangeCount===0)return!1;const k=_.getRangeAt(0);if(!k.toString())return t(g=>({...g,fontFamily:T})),!1;try{const g=document.createElement("span");g.style.fontFamily=T;const u=k.extractContents();return g.appendChild(u),k.insertNode(g),k.selectNodeContents(g),_.removeAllRanges(),_.addRange(k),t(d=>({...d,fontFamily:T})),!0}catch{return document.execCommand("fontName",!1,T),t(u=>({...u,fontFamily:T})),!0}}catch(_){return console.warn("[useFormatting] Font family change failed:",_),!1}},[]),i=m.useCallback(T=>{try{const _=window.getSelection();if(!_||_.rangeCount===0)return!1;const k=_.getRangeAt(0);if(!k.toString())return t(g=>({...g,fontSize:T})),!1;try{const g=document.createElement("span");g.style.fontSize=T;const u=k.extractContents();return g.appendChild(u),k.insertNode(g),k.selectNodeContents(g),_.removeAllRanges(),_.addRange(k),t(d=>({...d,fontSize:T})),!0}catch{const u=er[T]||"3";return document.execCommand("fontSize",!1,u),t(d=>({...d,fontSize:T})),!0}}catch(_){return console.warn("[useFormatting] Font size change failed:",_),!1}},[]),a=m.useCallback(T=>{try{const _=window.getSelection();if(!_||_.rangeCount===0)return!1;const k=_.getRangeAt(0),B=k.toString(),u={justifyLeft:"left",justifyCenter:"center",justifyRight:"right",justifyFull:"justify"}[T];if(!u)return!1;if(!B){const v=k.startContainer,N=v.nodeType===Node.TEXT_NODE?v.parentElement:v,H=De(N)||nr();return H&&(H.style.textAlign=u,r(u)),!0}const d=tr(k);if(d.length===0){const v=document.createElement("p");v.style.textAlign=u;const N=k.extractContents();v.appendChild(N),k.insertNode(v),k.selectNodeContents(v),_.removeAllRanges(),_.addRange(k)}else d.forEach(v=>{v.style.textAlign=u});return r(u),!0}catch(_){return console.warn("[useFormatting] Text alignment failed:",_),!1}},[]),r=m.useCallback(T=>{t(_=>({..._,alignLeft:T==="left",alignCenter:T==="center",alignRight:T==="right",alignJustify:T==="justify"}))},[]),s=m.useCallback((T,_=null)=>{try{if(T==="undo"){o.undo();return}if(T==="redo"){o.redo();return}if(typeof document.execCommand!="function"){console.warn("[useFormatting] execCommand not supported");return}if(T==="fontSize"){i(_);return}if(T==="fontName"){n(_);return}if(["justifyLeft","justifyCenter","justifyRight","justifyFull"].includes(T)){a(T);return}switch(document.execCommand(T,!1,_)||console.warn(`[useFormatting] Command "${T}" failed`),T){case"bold":case"italic":case"underline":case"strikethrough":case"justifyLeft":case"justifyCenter":case"justifyRight":case"justifyFull":case"fontName":break;case"formatBlock":t(B=>({...B,headingLevel:_}));break;default:break}}catch(k){console.warn(`[useFormatting] Error executing command "${T}":`,k)}},[i,n,o]),y=m.useRef(null),p=m.useRef(null),h=m.useRef(null),b=m.useRef(null),f=m.useRef(fe);m.useCallback(T=>{if(!de(T))return;y.current&&(ye(y.current),y.current=null),T.classList.add("selected");const _=pt(T);_&&(y.current=_,p.current=T,document.body.appendChild(_),t(k=>({...k,imageSelected:!0,preserveAspectRatio:f.current.preserveAspectRatio})))},[]);const O=m.useCallback(()=>{p.current&&(p.current.classList.remove("selected"),p.current=null),y.current&&(ye(y.current),y.current=null),h.current=null,b.current=null,t(T=>({...T,imageSelected:!1}))},[]),P=m.useCallback(()=>{const T=!f.current.preserveAspectRatio;f.current={...f.current,preserveAspectRatio:T,aspectRatio:T},t(_=>({..._,preserveAspectRatio:T}))},[]);m.useCallback((T,_,k)=>{p.current&&(h.current={x:_,y:k,width:p.current.offsetWidth,height:p.current.offsetHeight},b.current=T,document.body.classList.add("resize-in-progress"),document.body.style.cursor=rr(T))},[]),m.useCallback((T,_)=>{if(!p.current||!h.current||!b.current)return;const{x:k,y:B,width:g,height:u}=h.current,d=b.current,v=or({handler:d,startX:k,startY:B,currentX:T,currentY:_,startWidth:g,startHeight:u,options:f.current});ar(p.current,v),y.current&&ke(y.current,p.current)},[]),m.useCallback(()=>{if(h.current=null,b.current=null,document.body.classList.remove("resize-in-progress"),document.body.style.cursor="",p.current){const T=new Event("input",{bubbles:!0,cancelable:!0});p.current.dispatchEvent(T)}},[]);const x=m.useCallback(()=>{try{const T=window.getSelection();if(!T||T.rangeCount===0)return;const _=T.getRangeAt(0),k=_.toString();let B=_e,g="Arial",u="p",d="left";if(k){const N=_.startContainer,H=N.nodeType===Node.TEXT_NODE?N.parentElement:N;if(H){const R=window.getComputedStyle(H),D=R.fontSize,q=R.fontFamily;D&&D.endsWith("px")&&(B=D),q&&q!=="serif"&&(g=q.split(",")[0].replace(/['"]/g,"").trim());const $=De(H);if($){const oe=$.tagName?.toLowerCase();["h1","h2","h3","h4","h5","h6","p"].includes(oe)&&(u=oe);const Y=window.getComputedStyle($).textAlign;["left","center","right","justify"].includes(Y)&&(d=Y)}}}const v={bold:document.queryCommandState("bold"),italic:document.queryCommandState("italic"),underline:document.queryCommandState("underline"),strikethrough:document.queryCommandState("strikethrough"),alignLeft:d==="left",alignCenter:d==="center",alignRight:d==="right",alignJustify:d==="justify",fontFamily:g,fontSize:B,headingLevel:u};t(N=>({...N,...v}))}catch(T){console.warn("[useFormatting] Error updating format from selection:",T)}},[]),M=m.useCallback(()=>{O(),t(Ft)},[O]);return m.useEffect(()=>()=>{y.current&&ye(y.current)},[]),{currentFormat:e,formatText:s,resetFormat:M,updateCurrentFormatFromSelection:x,toggleAspectRatio:P}};function De(e){let t=e;for(;t&&t!==document.body;){const o=t.tagName?.toLowerCase();if(["h1","h2","h3","h4","h5","h6","p"].includes(o))return t;if(t.contentEditable==="true"||t.contentEditable==="")break;t=t.parentElement}return null}function tr(e){const t=[],o=e.startContainer,n=e.endContainer,i=De(o.nodeType===Node.TEXT_NODE?o.parentElement:o),a=De(n.nodeType===Node.TEXT_NODE?n.parentElement:n);if(i===a&&i)return[i];const r=document.createTreeWalker(e.commonAncestorContainer,NodeFilter.SHOW_ELEMENT,{acceptNode:y=>{const p=y.tagName?.toLowerCase();return["h1","h2","h3","h4","h5","h6","p"].includes(p)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});let s=r.nextNode();for(;s;)e.intersectsNode(s)&&t.push(s),s=r.nextNode();return t}function nr(){try{const e=window.getSelection();if(!e||e.rangeCount===0)return null;const t=e.getRangeAt(0),o=document.createElement("p");return o.innerHTML="<br>",t.insertNode(o),t.selectNodeContents(o),t.collapse(!0),e.removeAllRanges(),e.addRange(t),o}catch(e){return console.warn("[useFormatting] Failed to create paragraph at cursor:",e),null}}function rr(e){switch(e){case S.TOP_LEFT:case S.BOTTOM_RIGHT:return"nwse-resize";case S.TOP_RIGHT:case S.BOTTOM_LEFT:return"nesw-resize";case RESIZE_HANDLRES.TOP:case S.BOTTOM:return"ns-resize";case S.LEFT:case S.RIGHT:return"ew-resize";default:return"default"}}function or({handler:e,startX:t,startY:o,currentX:n,currentY:i,startWidth:a,startHeight:r,options:s=fe}){const y=n-t,p=i-o;let h=a,b=r;switch(e){case S.TOP_LEFT:h=Math.max(s.minWidth,a-y),b=Math.max(s.minHeight,r-p);break;case S.TOP_RIGHT:h=Math.max(s.minWidth,a+y),b=Math.max(s.minHeight,r-p);break;case S.BOTTOM_LEFT:h=Math.max(s.minWidth,a-y),b=Math.max(s.minHeight,r+p);break;case S.BOTTOM_RIGHT:h=Math.max(s.minWidth,a+y),b=Math.max(s.minHeight,r+p);break;case S.TOP:b=Math.max(s.minHeight,r-p);break;case S.BOTTOM:b=Math.max(s.minHeight,r+p);break;case S.LEFT:h=Math.max(s.minWidth,a-y);break;case S.RIGHT:h=Math.max(s.minWidth,a+y);break;default:return{width:h,height:b}}if(s.preserveAspectRatio&&s.aspectRatio){const f=a/r;[S.TOP_LEFT,S.TOP_RIGHT,S.BOTTOM_LEFT,S.BOTTOM_RIGHT].includes(e)?h/f>b?b=Math.max(s.minHeight,h/f):h=Math.max(s.minWidth,b*f):[S.TOP,S.BOTTOM].includes(e)?h=b*f:[S.LEFT,S.RIGHT].includes(e)&&(b=h/f)}return s.maxWidth&&h>s.maxWidth&&(h=s.maxWidth,s.preserveAspectRatio&&s.aspectRatio&&(b=h/(a/r))),s.maxHeight&&b>s.maxHeight&&(b=s.maxHeight,s.preserveAspectRatio&&s.aspectRatio&&(h=b*(a/r))),h=Math.max(s.minWidth,h),b=Math.max(s.minHeight,b),{width:Math.round(h),height:Math.round(b)}}function ar(e,{width:t,height:o}){de(e)&&(e.tagName==="IMG"?(e.style.width=`${t}px`,e.style.height=`${o}px`,e.width=t,e.height=o):e.tagName==="DIV"&&(e.style.width=`${t}px`,e.style.height=`${o}px`))}const ge='page-break, [data-page-break="true"]',qt=e=>ce[e]||ce.A4,ir=(e,t={})=>{if(!e||typeof document>"u")return[];const o=t.pageSize||"A4",n=qt(o),i=e.querySelectorAll(ge),a=[];a.push({id:"page-0",pageNumber:1,top:0,height:n.height});const r=e.getBoundingClientRect(),s=e.scrollTop;return i.forEach((y,p)=>{const b=y.getBoundingClientRect().top-r.top+s;a.push({id:`page-${p+1}`,pageNumber:p+2,top:b,height:n.height})}),a},Wt=(e,t=100,o=pe)=>{const n=qt(e),i=Nn(o),a=n.height-i,r=t/100;return a/r},sr=(e,t)=>{if(!e||!t)return 0;try{const o=t.querySelectorAll(ge);if(o.length===0)return 0;const n=e.getBoundingClientRect(),i=n.top+n.height/2;for(let a=o.length-1;a>=0;a--)if(o[a].getBoundingClientRect().top<i)return a+1;return 0}catch(o){return console.warn("[getCurrentPage] Failed to calculate page:",o),0}},Zt=e=>{if(!e)return[];const t=Array.from(e.children);if(t.length===0)return[];let o=[],n=[];for(const i of t)i.tagName==="PAGE-BREAK"||i.getAttribute("data-page-break")==="true"?n.length>0&&(o.push(n),n=[]):n.push(i);return n.length>0&&o.push(n),o.length===0&&t.length>0&&o.push(t.filter(i=>!(i.tagName==="PAGE-BREAK"||i.getAttribute("data-page-break")==="true"))),o},cr=e=>{if(!e||!e.getBoundingClientRect)return 0;const t=e.getBoundingClientRect();if(e.tagName==="P"){const o=e.querySelectorAll("img"),n=e.textContent.trim();if(o.length===1&&!n){const a=o[0].getBoundingClientRect(),s=window.getComputedStyle(e).textAlign;if(s==="center"||s==="-webkit-center")return a.height+16}return t.height+16}return e.tagName==="H1"||e.tagName==="H2"||e.tagName==="H3"||e.tagName==="H4"||e.tagName==="H5"||e.tagName==="H6"?t.height+20:e.tagName==="UL"||e.tagName==="OL"?t.height+16:t.height},lr=(e,t)=>{if(!e)return!1;try{const o=document.createElement("page-break");return o.setAttribute("data-page-break","true"),o.setAttribute("contenteditable","false"),o.setAttribute("data-page-number",t||"2"),e.parentNode.insertBefore(o,e),!0}catch(o){return console.warn("[insertPageBreakBefore] Failed to insert page break:",o),!1}},ur=(e,t,o,n,i,a,r)=>{if(!e)return!1;try{const y=Wt(o,n,i)*(t-1),p=Array.from(e.children);let h=0,b=null;for(let f=0;f<p.length;f++){const O=p[f];if(O.tagName==="PAGE-BREAK"||O.getAttribute("data-page-break")==="true")continue;const P=cr(O);if(h+P>y){b=O;break}h+=P}if(b){const f=document.createElement("page-break");if(f.setAttribute("data-page-break","true"),f.setAttribute("contenteditable","false"),f.setAttribute("data-page-number",String(t)),b.parentNode.insertBefore(f,b),a){const O=e.innerHTML;a(O)}return r&&setTimeout(()=>{r()},50),!0}else{const f=document.createElement("page-break");f.setAttribute("data-page-break","true"),f.setAttribute("contenteditable","false"),f.setAttribute("data-page-number",String(t)),e.appendChild(f);const O=document.createElement("p");if(O.innerHTML="<br>",e.appendChild(O),a){const P=e.innerHTML;a(P)}return r&&setTimeout(()=>{r()},50),!0}}catch(s){return console.error("[insertPageBreakAtBoundary] Failed to insert page break:",s),!1}},dr=(e,t,o,n,i,a,r)=>{if(!e)return!1;if(o().length<=1)return console.warn("[removePageAndContent] Cannot delete the only page"),!1;try{const y=Array.from(e.querySelectorAll(ge));if(t>y.length)return console.warn("[removePageAndContent] Invalid page index"),!1;const p=window.getSelection();let h=!1,b=[],f=null;if(t===0){const P=y[0];if(!P)return console.warn("[removePageAndContent] No page break found for first page"),!1;let x=e.firstChild;for(;x&&x!==P;)b.push(x),x=x.nextSibling;f=P}else{const P=y[t-1];if(!P)return console.warn("[removePageAndContent] Page break not found"),!1;const x=y[t];let M=P.nextSibling;for(;M&&M!==x;)b.push(M),M=M.nextSibling;f=P}if(p&&p.rangeCount>0){const x=p.getRangeAt(0).startContainer;for(const M of b)if(M.contains(x)||M===x){h=!0;break}}if(f&&f.parentNode&&f.remove(),b.forEach(P=>{P.parentNode&&P.remove()}),e.querySelectorAll(ge).forEach((P,x)=>{P.setAttribute("data-page-number",String(x+2))}),h&&a&&setTimeout(()=>{a(0)},50),n){const P=e.innerHTML;n(P)}return i&&setTimeout(()=>{i(),r&&setTimeout(()=>{r()},150)},100),!0}catch(y){return console.error("[removePageAndContent] Failed to remove page:",y),!1}},fr=e=>{if(e)try{e.querySelectorAll(ge).forEach((o,n)=>{o.setAttribute("data-page-number",String(n+2))})}catch(t){console.error("[renumberPageBreaks] Failed to renumber page breaks:",t)}},pr=(e,t,o,n,i)=>{if(!e||!t)return!1;try{if(e.remove(),fr(t),o){const a=t.innerHTML;o(a)}return n&&setTimeout(()=>{n(),i&&setTimeout(()=>{i()},100)},50),!0}catch(a){return console.error("[removePageBreak] Failed to remove page break:",a),!1}},gr=200,hr=50,Yt=3,mr=20,Vt=e=>{if(!e||!e.getBoundingClientRect)return 0;const t=e.getBoundingClientRect();if(e.tagName==="P"){const o=e.querySelectorAll("img"),n=e.textContent.trim();if(o.length===1&&!n){const a=o[0].getBoundingClientRect(),s=window.getComputedStyle(e).textAlign;if(s==="center"||s==="-webkit-center")return a.height+16}return t.height+16}return e.tagName==="H1"||e.tagName==="H2"||e.tagName==="H3"||e.tagName==="H4"||e.tagName==="H5"||e.tagName==="H6"?t.height+20:e.tagName==="UL"||e.tagName==="OL"?t.height+16:t.height},yr=(e,t)=>{if(!e||e.length===0)return null;let o=0,n=null;for(let i=0;i<e.length;i++){const a=e[i];if(!a||!a.getBoundingClientRect)continue;const r=Vt(a);if(r<1)continue;if(o+r>t)return n===null?i>0?{overflowIndex:i,overflowElement:a,accumulatedHeight:o}:null:{overflowIndex:i,overflowElement:a,accumulatedHeight:o};o+=r,n=a}return null},br=(e,t,o,n,i,a,r,s)=>{if(!e||r.current)return!1;try{r.current=!0;const y=Wt(t,o,n);let p=Zt(e),h=!1,b=0;for(let f=0;f<p.length&&b<Yt;f++){const O=p[f],P=yr(O,y);if(P&&P.overflowIndex>0){let x=0;for(let k=0;k<O.length;k++){const B=O[k];B&&B.getBoundingClientRect&&(x+=Vt(B))}if(x-y<mr)continue;const T=f+2;lr(P.overflowElement,T)&&(h=!0,b++,p=Zt(e))}}if(h){if(i){const f=e.innerHTML;i(f)}setTimeout(()=>{a&&a(),b>=Yt&&s&&setTimeout(()=>{r.current||s()},100)},hr)}return h}catch(y){return console.warn("[checkAndReflow] Reflow failed:",y),!1}finally{r.current=!1}},Er=(e,t,o=gr)=>{t.current&&clearTimeout(t.current),t.current=setTimeout(()=>{t.current=null,e()},o)},Tr=400,Kt=(e,t)=>{if(e){e.focus();try{let o=null,n=0;if(t===0)o=e.firstChild,n=0;else{const a=e.querySelectorAll(ge)[t-1];a&&a.nextSibling&&(o=a.nextSibling,n=0)}if(o){const i=document.createRange(),a=window.getSelection();o.nodeType===Node.TEXT_NODE?i.setStart(o,n):i.setStart(o,0),i.collapse(!0),a.removeAllRanges(),a.addRange(i)}}catch(o){console.warn("[positionCursorAtPage] Failed to position cursor:",o)}}},vr=(e,t,o,n)=>{if(!e||!t){console.warn("[scrollToPage] Missing refs");return}try{let i=null;if(o===0)i=t;else{const r=t.querySelectorAll(ge)[o-1];if(r)i=r;else{console.warn("[scrollToPage] Page break not found for page",o);return}}if(i){const a=i.getBoundingClientRect(),r=e.getBoundingClientRect(),s=e.scrollTop+(a.top-r.top);console.log("[scrollToPage] Scrolling to page",o,"scrollTop:",s),e.scrollTo({top:s,behavior:"smooth"}),setTimeout(()=>{n?n(o):Kt(t,o)},Tr)}}catch(i){console.error("[scrollToPage] Error:",i)}},xr=(e,t,o={},n=300)=>{t.current&&clearTimeout(t.current),t.current=setTimeout(()=>{t.current=null,e(o)},Math.max(0,n))},Ar=e=>{if(!e)return null;const t=window.getSelection();if(t.rangeCount===0)return null;const o=t.getRangeAt(0);if(!e.contains(o.commonAncestorContainer))return null;let n=1;const i=e.querySelectorAll(ge);for(const h of i)if(o.comparePoint(h,0)>0)n++;else break;const a=document.createRange();a.setStart(e,0),a.setEnd(o.startContainer,o.startOffset);const s=a.toString().replace(/<[^>]*>/g," ").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/\s+/g," ").trim(),y=s.length,p=(s.match(/\n/g)||[]).length+1;return{page:n,line:p,charOffset:y}},_r=300,Xt=(e,t,o=100,n="NARROW")=>{const i=be(),a=m.useRef(null),r=m.useRef(null),s=m.useRef(e),y=m.useRef(o),p=m.useRef(n),h=m.useRef(!1);m.useEffect(()=>{s.current=e},[e]),m.useEffect(()=>{y.current=o},[o]),m.useEffect(()=>{p.current=n},[n]),m.useEffect(()=>()=>{a.current&&clearTimeout(a.current),r.current&&clearTimeout(r.current)},[]);const b=m.useCallback((u={})=>t?.current?ir(t.current,u):[],[t]),f=m.useCallback((u={})=>{const d=b(u);return i.updatePageBoundaries(d),d},[b,i]),O=m.useCallback(async u=>{if(!t?.current)return!1;const d=s.current||"A4",v=y.current||100,N=p.current||"NARROW";return ur(t.current,u,d,v,N,i.updateContinuousContent,f)},[t,i,f]),P=m.useCallback(()=>{if(!t?.current)return;const u=s.current||"A4",d=y.current||100,v=p.current||"NARROW";br(t.current,u,d,v,i.updateContinuousContent,f,h,P)},[t,i,f]),x=m.useCallback(u=>{Er(P,r,u)},[P]),M=m.useCallback((u={})=>{const d=typeof u.delay=="number"?u.delay:_r;xr(f,a,u,d)},[f]),T=m.useCallback(u=>!u?.current||!t?.current?0:sr(u.current,t.current),[t]),_=m.useCallback(u=>{t?.current&&Kt(t.current,u)},[t]),k=m.useCallback((u,d)=>{if(!d?.current||!t?.current){console.warn("[scrollToPage] Missing refs");return}vr(d.current,t.current,u,_)},[t,_]),B=m.useCallback(u=>t?.current?dr(t.current,u,b,i.updateContinuousContent,f,_,P):!1,[t,b,i,f,_,P]),g=m.useCallback(u=>t?.current?pr(u,t.current,i.updateContinuousContent,f,P):!1,[t,i,f,P]);return{calculatePageBoundaries:b,checkAndUpdateBoundaries:M,updateBoundaries:f,getCurrentPage:T,scrollToPage:k,positionCursorAtPage:_,checkAndReflow:P,triggerAutoReflow:x,removePageAndContent:B,removePageBreak:g,insertPageBreakAtBoundary:O,boundaryTimeoutRef:a,reflowTimeoutRef:r}},kr="html-editor-storage",Pr=1,le="images";function Sr(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function Pe(){return new Promise((e,t)=>{const o=indexedDB.open(kr,Pr);o.onerror=()=>{t(new Error("Failed to open IndexedDB database"))},o.onsuccess=()=>{e(o.result)},o.onupgradeneeded=n=>{const i=n.target.result;i.objectStoreNames.contains(le)||i.createObjectStore(le,{keyPath:"key"}).createIndex("timestamp","timestamp",{unique:!1})}})}function Jt(e){return new Promise((t,o)=>{if(!["image/png","image/jpeg","image/gif","image/webp"].includes(e.type)){o(new Error("Invalid image format. Supported formats: png, jpeg, gif, webp"));return}if(e.size>5*1024*1024){o(new Error("Image exceeds maximum size of 5MB"));return}const i=new FileReader;i.onload=async a=>{const r=a.target.result,y=r.split(",")[1].length*3/4;if(y>5*1024*1024){o(new Error("Image exceeds maximum size of 5MB"));return}try{const p=await Pe(),h=`editor-image-${Sr()}`,f=p.transaction([le],"readwrite").objectStore(le),O={key:h,dataUrl:r,size:y,type:e.type,timestamp:Date.now()},P=f.add(O);P.onsuccess=()=>{p.close(),t(h)},P.onerror=()=>{p.close(),o(new Error("Failed to save image to IndexedDB"))}}catch(p){o(p)}},i.onerror=()=>{o(new Error("Error reading image file"))},i.readAsDataURL(e)})}async function Qt(e){try{const t=await Pe();return new Promise((o,n)=>{const r=t.transaction([le],"readonly").objectStore(le).get(e);r.onsuccess=()=>{t.close();const s=r.result;o(s?s.dataUrl:null)},r.onerror=()=>{t.close(),n(new Error("Failed to retrieve image from IndexedDB"))}})}catch(t){return console.error("Error getting image:",t),null}}async function en(e){try{const t=await Pe();return new Promise((o,n)=>{const r=t.transaction([le],"readwrite").objectStore(le).delete(e);r.onsuccess=()=>{t.close(),o()},r.onerror=()=>{t.close(),n(new Error("Failed to delete image from IndexedDB"))}})}catch(t){console.error("Error deleting image:",t)}}async function wr(){try{const e=await Pe();return new Promise((t,o)=>{const a=e.transaction([le],"readwrite").objectStore(le).clear();a.onsuccess=()=>{e.close(),t()},a.onerror=()=>{e.close(),o(new Error("Failed to clear images from IndexedDB"))}})}catch(e){console.error("Error clearing images:",e)}}async function Cr(){try{const e=await Pe();return new Promise((t,o)=>{const a=e.transaction([le],"readonly").objectStore(le).getAllKeys();a.onsuccess=()=>{e.close(),t(a.result||[])},a.onerror=()=>{e.close(),o(new Error("Failed to get image keys from IndexedDB"))}})}catch(e){return console.error("Error getting image keys:",e),[]}}const Or=["SPAN","STRONG","EM","B","I","U","S","STRIKE","DEL","INS","SUB","SUP","MARK","SMALL","CODE","KBD","SAMP","VAR","A","ABBR","CITE","DFN","TIME"],Nr=["BR","HR","IMG","INPUT","PAGE-BREAK"];function Mr(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}function tn(e){const t=[];for(let o=0;o<e.attributes.length;o++){const n=e.attributes[o];t.push(` ${n.name}="${n.value}"`)}return t.join("")}function He(e){if(!e||typeof e!="string")return"<p><br></p>";const t=e.trim();if(!t)return"<p><br></p>";const o=document.createElement("div");return o.innerHTML=t,Se(o)||"<p><br></p>"}function Rr(e){const t=e.cloneNode(!0);return t.querySelectorAll(":scope > p").forEach(n=>{for(;n.firstChild;)t.insertBefore(n.firstChild,n);n.remove()}),t.innerHTML}function Se(e){const t=[],o=Array.from(e.childNodes);for(let n=0;n<o.length;n++){const i=o[n];if(i.nodeType===Node.TEXT_NODE){const a=i.textContent.trim();a&&t.push(`<p>${Mr(a)}</p>`)}else if(i.nodeType===Node.ELEMENT_NODE){const a=i,r=a.tagName,s=r.toLowerCase(),y=tn(a);if(r==="DIV"){const p=Se(a);p.trim()?t.push(p):t.push("<p><br></p>")}else if(r==="P")t.push(a.outerHTML);else if(["H1","H2","H3","H4","H5","H6"].includes(r)){const p=Rr(a);t.push(`<${s}${y}>${p}</${s}>`)}else if(r==="BR")t.push("<p><br></p>");else if(r==="IMG")t.push(a.outerHTML);else if(["UL","OL"].includes(r))t.push(Ir(a));else if(r==="LI")t.push(a.outerHTML);else if(r==="TABLE")t.push(Lr(a));else if(["TBODY","THEAD","TFOOT","TR","TD","TH"].includes(r))t.push(a.outerHTML);else if(r==="BLOCKQUOTE"){const p=Se(a);t.push(`<blockquote${y}>${p}</blockquote>`)}else if(r==="PRE")t.push(a.outerHTML);else if(Or.includes(r))t.push(a.outerHTML);else if(r==="PAGE-BREAK"||a.getAttribute("data-page-break")==="true")t.push(a.outerHTML);else if(r==="HR")t.push(a.outerHTML);else if(r==="FIGURE")t.push(a.outerHTML);else if(Nr.includes(r))t.push(a.outerHTML);else{const p=Se(a);t.push(`<${s}${y}>${p}</${s}>`)}}}return t.length===0?"":t.join("")}function Ir(e){const t=e.tagName.toLowerCase(),o=tn(e),n=[];return Array.from(e.children).forEach(i=>{if(i.tagName==="LI")n.push(i.outerHTML);else{const a=Se(i);a.trim()&&n.push(`<li>${a}</li>`)}}),n.length===0?`<${t}${o}><li><br></li></${t}>`:`<${t}${o}>${n.join("")}</${t}>`}function Lr(e){return e.outerHTML}/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jr=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Dr=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,o,n)=>n?n.toUpperCase():o.toLowerCase()),nn=e=>{const t=Dr(e);return t.charAt(0).toUpperCase()+t.slice(1)},rn=(...e)=>e.filter((t,o,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===o).join(" ").trim(),Hr=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Br={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=m.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:o=2,absoluteStrokeWidth:n,className:i="",children:a,iconNode:r,...s},y)=>m.createElement("svg",{ref:y,...Br,width:t,height:t,stroke:e,strokeWidth:n?Number(o)*24/Number(t):o,className:rn("lucide",i),...!a&&!Hr(s)&&{"aria-hidden":"true"},...s},[...r.map(([p,h])=>m.createElement(p,h)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=(e,t)=>{const o=m.forwardRef(({className:n,...i},a)=>m.createElement(zr,{ref:a,iconNode:t,className:rn(`lucide-${jr(nn(e))}`,`lucide-${e}`,n),...i}));return o.displayName=nn(e),o};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $r=J("bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ur=J("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fr=J("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=J("file-check",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=J("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qr=J("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wr=J("heading-1",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zr=J("heading-2",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yr=J("heading-3",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17.5 10.5c1.7-1 3.5 0 3.5 1.5a2 2 0 0 1-2 2",key:"68ncm8"}],["path",{d:"M17 17.5c2 1.5 4 .3 4-1.5a2 2 0 0 0-2-2",key:"1ejuhz"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vr=J("image-upscale",[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M17 21h2a2 2 0 0 0 2-2",key:"130fy9"}],["path",{d:"M21 12v3",key:"1wzk3p"}],["path",{d:"m21 3-5 5",key:"1g5oa7"}],["path",{d:"M3 7V5a2 2 0 0 1 2-2",key:"kk3yz1"}],["path",{d:"m5 21 4.144-4.144a1.21 1.21 0 0 1 1.712 0L13 19",key:"fyekpt"}],["path",{d:"M9 3h3",key:"d52fa"}],["rect",{x:"3",y:"11",width:"10",height:"10",rx:"1",key:"1wpmix"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=J("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xr=J("italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=J("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qr=J("list-indent-decrease",[["path",{d:"M21 5H11",key:"us1j55"}],["path",{d:"M21 12H11",key:"wd7e0v"}],["path",{d:"M21 19H11",key:"saa85w"}],["path",{d:"m7 8-4 4 4 4",key:"o5hrat"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eo=J("list-indent-increase",[["path",{d:"M21 5H11",key:"us1j55"}],["path",{d:"M21 12H11",key:"wd7e0v"}],["path",{d:"M21 19H11",key:"saa85w"}],["path",{d:"m3 8 4 4-4 4",key:"1a3j6y"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const to=J("list-ordered",[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const on=J("list",[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const no=J("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=J("redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oo=J("scaling",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M14 15H9v-5",key:"pi4jk9"}],["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M21 3 9 15",key:"15kdhq"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ao=J("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const io=J("strikethrough",[["path",{d:"M16 4H9a3 3 0 0 0-2.83 4",key:"43sutm"}],["path",{d:"M14 12a4 4 0 0 1 0 8H6",key:"nlfj13"}],["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const so=J("table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=J("text-align-center",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 19H5",key:"vjpgq2"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=J("text-align-end",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 19H7",key:"4cu937"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const co=J("text-align-justify",[["path",{d:"M3 5h18",key:"1u36vt"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 19h18",key:"awlh7x"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=J("text-align-start",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lo=J("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uo=J("underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fo=J("undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const po=J("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const go=J("zoom-in",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ho=J("zoom-out",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),ln=({editorView:e,isCollapsed:t,onToggle:o,wordCount:n,pageCount:i})=>{const a=ot(),{pages:r,activePage:s,continuousContent:y,editorMode:p}=a,[h,b]=m.useState(0),[f,O]=m.useState([]);m.useEffect(()=>{if(n!==void 0&&i!==void 0){if(b(n),y){const T=document.createElement("div");T.innerHTML=y;const _=T.querySelectorAll("h1, h2, h3, h4, h5, h6"),k=Array.from(_).map((B,g)=>{const u=parseInt(B.tagName.charAt(1)),d=B.textContent.trim();return d?{id:`heading-${g}`,level:u,text:d,page:1}:null}).filter(Boolean);O(k)}return}let x=0;const M=[];r.forEach((T,_)=>{if(T.content){const k=document.createElement("div");k.innerHTML=T.content;const g=(k.textContent||k.innerText||"").trim().split(/\s+/).filter(d=>d.length>0);x+=g.length,k.querySelectorAll("h1, h2, h3, h4, h5, h6").forEach((d,v)=>{const N=parseInt(d.tagName.charAt(1)),H=d.textContent.trim();H&&M.push({id:`heading-${_}-${v}`,level:N,text:H,page:_+1})})}}),b(x),O(M)},[r,n,i,y]);const P=i!==void 0?i:r.length;return l.jsxs("aside",{className:`sidebar ${t?"collapsed":""}`,role:"complementary","aria-label":"Document information","data-testid":"sidebar",children:[l.jsxs("div",{className:"sidebar-header",children:[l.jsxs("div",{className:"sidebar-title",children:[l.jsx(Be,{size:18}),l.jsx("h2",{children:"Document Info"})]}),l.jsx("button",{className:"sidebar-toggle",onClick:o,"aria-label":t?"Expand sidebar":"Collapse sidebar",title:t?"Expand sidebar":"Collapse sidebar",children:t?l.jsx(Fr,{size:16}):l.jsx(Ur,{size:16})})]}),!t&&l.jsxs("div",{className:"sidebar-content",children:[l.jsxs("div",{className:"sidebar-section",children:[l.jsx("h3",{children:"Statistics"}),l.jsxs("div",{className:"stat-item",children:[l.jsxs("div",{className:"stat-label",children:[l.jsx(Gr,{size:14}),l.jsx("span",{children:"Pages:"})]}),l.jsx("span",{className:"stat-value",children:P})]}),l.jsxs("div",{className:"stat-item","data-testid":"word-count",children:[l.jsxs("div",{className:"stat-label",children:[l.jsx(qr,{size:14}),l.jsx("span",{children:"Words:"})]}),l.jsx("span",{className:"stat-value",children:h.toLocaleString()})]}),l.jsxs("div",{className:"stat-item",children:[l.jsxs("div",{className:"stat-label",children:[l.jsx(Be,{size:14}),l.jsx("span",{children:"Active Page:"})]}),l.jsx("span",{className:"stat-value",children:s+1})]})]}),f.length>0&&l.jsxs("div",{className:"sidebar-section",children:[l.jsxs("h3",{children:[l.jsx(on,{size:14,style:{display:"inline-block",marginRight:"6px",verticalAlign:"middle"}}),"Document Outline"]}),l.jsx("div",{className:"document-outline","data-testid":"outline",children:f.map(x=>{const M=x.level===1?Wr:x.level===2?Zr:Yr;return l.jsxs("div",{className:`outline-item outline-level-${x.level}`,style:{marginLeft:`${(x.level-1)*12}px`},children:[l.jsx(M,{size:12,className:"outline-icon"}),l.jsx("span",{className:"outline-text",children:x.text}),l.jsxs("span",{className:"outline-page",children:["p.",x.page]})]},x.id)})})]}),l.jsxs("div",{className:"sidebar-section",children:[l.jsx("h3",{children:"Document"}),l.jsx("p",{children:"HTML Editor"}),l.jsx("p",{children:"Multi-page support"})]})]})]})};class un{constructor(t="Editor"){this.namespace=t}_format(t,o,n){return`[${new Date().toISOString()}] [${this.namespace}] [${t}] ${o}`}info(t,o){}warn(t,o){}error(t,o){}debug(t,o){}}const dn=new un("Editor"),fn=new Set(["P","DIV","H1","H2","H3","H4","H5","H6","LI","BLOCKQUOTE","PRE","TABLE"]),pn=32;function gn(e,t){if(!e)return;e.dataset||(e.dataset={}),e.style||(e.style={});const o=parseInt(e.dataset.indentLevel||"0",10),n=Math.max(0,t?o-1:o+1);n===0?(e.style.marginLeft="",delete e.dataset.indentLevel):(e.style.marginLeft=`${n*pn}px`,e.dataset.indentLevel=String(n))}function mo(e,t){gn(e,t)}function yo(e){let t=e;for(;t;){if(t.nodeType===1&&t.tagName&&fn.has(t.tagName.toUpperCase()))return t;t=t.parentElement||t.parentNode}return null}function bo(){const e=window.getSelection();if(!e||e.rangeCount===0)return[];const t=e.getRangeAt(0),o=new Set;let n=t.commonAncestorContainer;for(n.nodeType===Node.TEXT_NODE&&(n=n.parentElement);n&&n.contentEditable!=="true";)n=n.parentElement;return n?(n.querySelectorAll("p, div, h1, h2, h3, h4, h5, h6, li, blockquote, pre, table").forEach(r=>{document.createRange().selectNodeContents(r),t.intersectsNode(r)&&o.add(r)}),o.size===0&&n.querySelectorAll("img").forEach(s=>{if(document.createRange().selectNode(s),t.intersectsNode(s)){let p=s.parentElement;for(;p&&p!==n;){if(p.tagName&&fn.has(p.tagName.toUpperCase())){o.add(p);break}p=p.parentElement}}}),Array.from(o).filter(r=>{let s=r.parentElement;for(;s;){if(o.has(s))return!1;s=s.parentElement}return!0})):[]}function Eo(e){if(e.style&&e.style.marginLeft&&e.style.marginLeft!==""){const t=parseInt(e.dataset.indentLevel||"0",10),o=Math.max(0,t-1);o===0?(e.style.marginLeft="",delete e.dataset.indentLevel):(e.style.marginLeft=`${o*pn}px`,e.dataset.indentLevel=String(o));return}if(e.innerHTML.startsWith("&nbsp;&nbsp;&nbsp;&nbsp;")){e.innerHTML=e.innerHTML.replace(/^(&nbsp;){4}/,"");return}try{const t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null);let o=t.nextNode();for(;o;){const n=o.textContent;if(n.startsWith("    ")){o.textContent=n.substring(4);break}o=t.nextNode()}}catch{e.innerHTML=e.innerHTML.replace(/^(&nbsp;){4}/,"")}}function gt(e=!1){const t=window.getSelection();if(!t||t.rangeCount===0)return!1;let o=bo();const n=t.getRangeAt(0);if(o.length===0){const r=yo(n.startContainer);if(!r)return!1;o=[r]}const i=o[0],a=o[o.length-1];o.forEach(r=>{if((r.tagName?r.tagName.toUpperCase():"")==="LI"){mo(r,e);return}e?Eo(r):gn(r,!1)});try{const r=document.createRange(),s=b=>b.nodeType===Node.TEXT_NODE?b:document.createTreeWalker(b,NodeFilter.SHOW_TEXT,null).nextNode(),y=b=>{if(b.nodeType===Node.TEXT_NODE)return b;const f=document.createTreeWalker(b,NodeFilter.SHOW_TEXT,null);let O=null,P=f.nextNode();for(;P;)O=P,P=f.nextNode();return O},p=s(i);p?r.setStart(p,0):r.setStart(i,0);const h=y(a);h?r.setEnd(h,h.length):r.setEnd(a,a.childNodes.length),t.removeAllRanges(),t.addRange(r)}catch{try{const s=document.createRange();s.setStartBefore(i),s.setEndAfter(a),t.removeAllRanges(),t.addRange(s)}catch(s){console.warn("Could not restore selection after indentation:",s)}}return!0}function To(e){if(e.key!=="Tab")return!1;e.preventDefault();const t=e.shiftKey,o=window.getSelection(),n=o&&o.rangeCount>0?o.getRangeAt(0):null;return o&&o.rangeCount>0&&n&&!n.collapsed&&gt(t)||t||document.execCommand("insertHTML",!1,"&nbsp;&nbsp;&nbsp;&nbsp;"),!0}const ze=({currentFormat:e,onFormatText:t,onAddPageBreak:o,canUndo:n=!1,canRedo:i=!1})=>{const a=async r=>{try{if(!["image/png","image/jpeg","image/gif","image/webp"].includes(r.type)){alert("Invalid image format. Supported: PNG, JPEG, GIF, WEBP");return}if(r.size>5242880){alert("Image exceeds maximum size of 5MB");return}const y=await Jt(r),p=await Qt(y);if(p){const b=`<img src="${p}" data-key="${y}" alt="Inserted image" />`;document.execCommand("insertHTML",!1,b),dn.info("Image inserted",{key:y})}const h=document.getElementById("image-upload");h&&(h.value="")}catch(s){dn.error("Error uploading image",s)}};return l.jsxs("div",{className:"editor-toolbar",children:[l.jsx("button",{onClick:()=>t("undo"),disabled:!n,title:"Undo",style:{opacity:n?1:.5},children:l.jsx(fo,{size:16})}),l.jsx("button",{onClick:()=>t("redo"),disabled:!i,title:"Redo",style:{opacity:i?1:.5},children:l.jsx(ro,{size:16})}),l.jsx("div",{className:"toolbar-separator"}),l.jsx("button",{onClick:()=>t("bold"),className:e.bold?"active":"",title:"Bold",children:l.jsx($r,{size:16})}),l.jsx("button",{onClick:()=>t("italic"),className:e.italic?"active":"",title:"Italic",children:l.jsx(Xr,{size:16})}),l.jsx("button",{onClick:()=>t("underline"),className:e.underline?"active":"",title:"Underline",children:l.jsx(uo,{size:16})}),l.jsx("button",{onClick:()=>t("strikethrough"),className:e.strikethrough?"active":"",title:"Strikethrough",children:l.jsx(io,{size:16})}),l.jsx("div",{className:"toolbar-separator"}),l.jsx("button",{onClick:()=>t("justifyLeft"),className:e.alignLeft?"active":"",title:"Align Left",children:l.jsx(cn,{size:16})}),l.jsx("button",{onClick:()=>t("justifyCenter"),className:e.alignCenter?"active":"",title:"Align Center",children:l.jsx(an,{size:16})}),l.jsx("button",{onClick:()=>t("justifyRight"),className:e.alignRight?"active":"",title:"Align Right",children:l.jsx(sn,{size:16})}),l.jsx("button",{onClick:()=>t("justifyFull"),className:e.alignJustify?"active":"",title:"Justify",children:l.jsx(co,{size:16})}),l.jsx("div",{className:"toolbar-separator"}),l.jsxs("select",{onChange:r=>t("fontName",r.target.value),value:e.fontFamily||"Segoe UI",title:"Font Family",children:[l.jsx("option",{value:"Segoe UI",children:"Segoe UI "}),l.jsx("option",{value:"Arial",children:"Arial "}),l.jsx("option",{value:"Times New Roman",children:"Times New Roman "}),l.jsx("option",{value:"Courier New",children:"Courier New "}),l.jsx("option",{value:"Georgia",children:"Georgia "}),l.jsx("option",{value:"Verdana",children:"Verdana "}),l.jsx("option",{value:"Noto Sans Sinhala",children:"Noto Sans Sinhala "}),l.jsx("option",{value:"Iskoola Pota",children:"Iskoola Pota "}),l.jsx("option",{value:"Noto Sans Tamil",children:"Noto Sans Tamil "}),l.jsx("option",{value:"Noto Sans",children:"Noto Sans "})]}),l.jsx("select",{onChange:r=>t("fontSize",r.target.value),value:e.fontSize||_e,title:"Font Size",children:Bt.map(({value:r,label:s})=>l.jsx("option",{value:r,children:s},r))}),l.jsxs("select",{onChange:r=>t("formatBlock",r.target.value),value:e.headingLevel||"p",title:"Heading Level",children:[l.jsx("option",{value:"p",children:"Normal"}),l.jsx("option",{value:"h1",children:"Heading 1"}),l.jsx("option",{value:"h2",children:"Heading 2"}),l.jsx("option",{value:"h3",children:"Heading 3"}),l.jsx("option",{value:"h4",children:"Heading 4"}),l.jsx("option",{value:"h5",children:"Heading 5"}),l.jsx("option",{value:"h6",children:"Heading 6"})]}),l.jsx("div",{className:"toolbar-separator"}),l.jsx("button",{onClick:()=>t("insertUnorderedList"),title:"Bullet List",children:l.jsx(on,{size:16})}),l.jsx("button",{onClick:()=>t("insertOrderedList"),title:"Numbered List",children:l.jsx(to,{size:16})}),l.jsx("div",{className:"toolbar-separator"}),l.jsx("button",{onClick:()=>{gt(!1)||document.execCommand("insertHTML",!1,"&nbsp;&nbsp;&nbsp;&nbsp;")},title:"Increase Indent (Tab)",children:l.jsx(eo,{size:16})}),l.jsx("button",{onClick:()=>{gt(!0)},title:"Decrease Indent (Shift+Tab)",children:l.jsx(Qr,{size:16})}),l.jsx("div",{className:"toolbar-separator"}),l.jsx("button",{onClick:()=>{const r=prompt("Enter URL:");r&&t("createLink",r)},title:"Insert Link",children:l.jsx(Jr,{size:16})}),l.jsx("button",{onClick:()=>t("insertHTML",'<table border="1"><tr><td>Cell 1</td><td>Cell 2</td></tr><tr><td>Cell 3</td><td>Cell 4</td></tr></table>'),title:"Insert Table",children:l.jsx(so,{size:16})}),o&&l.jsx("button",{onClick:o,title:"Insert Page Break",children:l.jsx(Be,{size:16})}),l.jsx("div",{className:"toolbar-separator"}),l.jsx("input",{type:"file",accept:"image/*",onChange:r=>r.target.files[0]&&a(r.target.files[0]),style:{display:"none"},id:"image-upload"}),l.jsx("button",{onClick:()=>document.getElementById("image-upload").click(),title:"Insert Image",children:l.jsx(Kr,{size:16})})]})};ze.propTypes={currentFormat:A.shape({bold:A.bool,italic:A.bool,underline:A.bool,strikethrough:A.bool,alignLeft:A.bool,alignCenter:A.bool,alignRight:A.bool,alignJustify:A.bool,fontFamily:A.string,fontSize:A.string,headingLevel:A.string}).isRequired,onFormatText:A.func.isRequired,onAddPageBreak:A.func,canUndo:A.bool,canRedo:A.bool},ze.defaultProps={onAddPageBreak:void 0,canUndo:!1,canRedo:!1};function vo(e){return!e||typeof e!="string"?e:He(e)}function xo(e){e.preventDefault();const t=e.clipboardData||window.clipboardData;if(!t)return null;let o=t.getData("text/html")||t.getData("text/plain");return o?(t.getData("text/html")?o=vo(o):o=Ao(o),document.execCommand("insertHTML",!1,o),o):null}function Ao(e){if(!e)return"";const t=e.split(/\n\s*\n/).filter(o=>o.trim());return t.length===0?"<p><br></p>":t.map(o=>{const n=o.split(`
`).filter(a=>a.trim());return n.length===0?"<p><br></p>":`<p>${n.map(a=>_o(a.trim())).join("<br>")}</p>`}).join("")}function _o(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}const $e=({content:e,dimensions:t,pageSize:o,pageBoundaries:n=[],editorRef:i,onInput:a,onContentChange:r,onKeyDown:s,onClick:y,onScroll:p,onPaste:h,onRemovePageBreak:b,zoomLevel:f=100,pageMargins:O=pe})=>{const P=_t(O),x=f/100,M=(u,d)=>{if(!u)return!1;const v=u.getBoundingClientRect(),N=d-v.top;return N<P.top||N>v.height-P.bottom},T=u=>u?u.nodeType===Node.ELEMENT_NODE?u.tagName==="PAGE-BREAK"||u.getAttribute("data-page-break")==="true":u.parentElement&&T(u.parentElement):!1,_=u=>{const d=window.getSelection();if(!d||d.rangeCount===0)return;const v=d.getRangeAt(0),{startContainer:N,endContainer:H}=v;if((T(N)||T(H))&&(u.key.length===1||u.key==="Enter"||u.key===" "))return u.preventDefault(),!1;if(To(u))return r&&r(),!1;if((u.key==="Backspace"||u.key==="Delete")&&(T(N)||T(H)))return u.preventDefault(),!1;s&&s(u)},k=u=>{if(!i.current)return;const d=u.target;if(T(d)){u.preventDefault();const v=d.getBoundingClientRect(),N=u.clientX-v.left,H=u.clientY-v.top,R=v.width-40,D=-12,q=v.width-20;N>=R&&N<=q&&H>=D&&H<=8&&b&&b(d);return}if(M(i.current,u.clientY)){u.preventDefault();const v=i.current.getBoundingClientRect();if(u.clientY-v.top<P.top){const H=i.current.firstElementChild;if(H&&H.tagName!=="PAGE-BREAK"){const R=document.createRange(),D=window.getSelection();R.setStart(H,0),R.collapse(!0),D.removeAllRanges(),D.addRange(R)}}else{const H=i.current.lastElementChild;if(H&&H.tagName!=="PAGE-BREAK"){const R=document.createRange(),D=window.getSelection();R.selectNodeContents(H),R.collapse(!1),D.removeAllRanges(),D.addRange(R)}}return}y&&y(u)},B=u=>{const d=window.getSelection();if(!d||d.rangeCount===0)return;const v=d.getRangeAt(0),{startContainer:N}=v;if(T(N))return u.preventDefault(),!1},g=u=>{const d=xo(u);h&&h(u,d)};return l.jsx("div",{className:"continuous-page-container",style:{position:"relative",width:"100%",maxWidth:`${t.width}px`,margin:"40px auto",backgroundColor:"transparent",minHeight:"100vh",transform:`scale(${x})`,transformOrigin:"top center",transition:"transform 0.2s ease-out"},children:l.jsx("div",{ref:i,contentEditable:!0,suppressContentEditableWarning:!0,className:"continuous-content",style:{position:"relative",zIndex:1,minHeight:`${t.height}px`,width:`${t.width}px`,backgroundColor:"white",padding:`${P.top}px ${P.right}px ${P.bottom}px ${P.left}px`,boxSizing:"border-box",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",outline:"none",cursor:"text",fontFamily:'"Segoe UI", "Noto Sans Sinhala", "Noto Sans", "Malithi Web", "Iskoola Pota", "Kaputa Unicode", "Helvetica Neue", Arial, "Hiragino Sans GB", "WenQuanYi Micro Hei", "Microsoft YaHei", sans-serif',fontSize:_e,lineHeight:"1.3",color:"#333",wordWrap:"break-word",whiteSpace:"pre-wrap",overflowWrap:"break-word",border:"1px solid #e0e0e0"},onInput:a,onKeyDown:_,onBeforeInput:B,onClick:k,onScroll:p,onPaste:g,"data-testid":"continuous-editor"})})};$e.propTypes={content:A.string.isRequired,dimensions:A.shape({width:A.number.isRequired,height:A.number.isRequired}).isRequired,pageSize:A.oneOf(["A4","Letter","Legal"]).isRequired,pageBoundaries:A.arrayOf(A.shape({id:A.string.isRequired,pageNumber:A.number.isRequired,top:A.number,height:A.number})),editorRef:A.shape({current:A.instanceOf(typeof Element<"u"?Element:Object)}).isRequired,onInput:A.func.isRequired,onContentChange:A.func,onKeyDown:A.func,onClick:A.func,onScroll:A.func,onPaste:A.func,onRemovePageBreak:A.func,zoomLevel:A.number,pageMargins:A.string},$e.defaultProps={pageBoundaries:[],onContentChange:void 0,onKeyDown:void 0,onClick:void 0,onScroll:void 0,onPaste:void 0,onRemovePageBreak:void 0,zoomLevel:100,pageMargins:pe};const ht=({pageBoundaries:e=[{id:"page-0",pageNumber:1}],activePage:t=0,pageSize:o="A4",pageMargins:n=pe,zoomLevel:i=100,canZoomIn:a=!0,canZoomOut:r=!0,onNavigate:s,onAddPage:y,onDeletePage:p,onPageSizeChange:h,onPageMarginsChange:b,onZoomIn:f,onZoomOut:O,onZoomReset:P}={})=>{const x=Math.max(e?.length||0,1),M=g=>{s&&s(g)},T=()=>{y&&y()},_=g=>{if(x<=1){console.warn("[PageManager] Cannot delete the only page");return}p&&p(g)},k=g=>{h&&h(g)},B=g=>{b&&b(g)};return l.jsxs("div",{className:"page-manager",children:[l.jsxs("div",{className:"page-settings-group",children:[l.jsxs("div",{className:"page-settings-header",children:[l.jsx(ao,{size:14,style:{marginRight:"4px",verticalAlign:"middle"}}),"Page Settings"]}),l.jsxs("div",{className:"page-settings-controls",children:[l.jsxs("div",{className:"page-setting-item",children:[l.jsx("label",{htmlFor:"page-size-selector",children:"Size:"}),l.jsxs("select",{id:"page-size-selector",role:"combobox","aria-label":"Page size selector",value:o,onChange:g=>k(g.target.value),children:[l.jsx("option",{value:"A4",children:"A4"}),l.jsx("option",{value:"Letter",children:"Letter"}),l.jsx("option",{value:"Legal",children:"Legal"})]})]}),l.jsxs("div",{className:"page-setting-item",children:[l.jsx("label",{htmlFor:"page-margins-selector",children:"Margins:"}),l.jsx("select",{id:"page-margins-selector",role:"combobox","aria-label":"Page margins selector",value:n,onChange:g=>B(g.target.value),children:Mn().map(g=>l.jsx("option",{value:g,children:Rn(g)},g))})]})]})]}),l.jsxs("div",{className:"zoom-controls-compact",children:[l.jsx("button",{type:"button",className:"zoom-button-compact",onClick:O,disabled:!r,"aria-label":"Zoom out",title:"Zoom out (Ctrl + -)",children:l.jsx(ho,{size:12})}),l.jsxs("span",{className:"zoom-level-display",children:[i,"%"]}),l.jsx("button",{type:"button",className:"zoom-button-compact",onClick:f,disabled:!a,"aria-label":"Zoom in",title:"Zoom in (Ctrl + +)",children:l.jsx(go,{size:12})}),l.jsx("button",{type:"button",className:"zoom-reset-compact",onClick:P,"aria-label":"Reset zoom",title:"Reset zoom to 100% (Ctrl + 0)",children:"Reset"})]}),l.jsx("div",{className:"page-list",children:(e&&e.length>0?e:[{id:"page-0",pageNumber:1}]).map((g,u)=>l.jsxs("div",{className:"page-item",children:[l.jsxs("button",{type:"button",className:`page-button ${u===t?"active":""}`,onClick:()=>M(u),"aria-label":`Go to page ${u+1}`,"aria-current":u===t?"page":void 0,children:[l.jsx(Be,{size:14}),l.jsxs("span",{children:["Page ",u+1]})]}),x>1&&l.jsx("button",{type:"button",className:"delete-page-button",onClick:d=>{d.stopPropagation(),_(u)},"aria-label":`Delete page ${u+1}`,title:"Delete this page and its content",children:l.jsx(po,{size:14})})]},g.id||`page-${u}`))}),l.jsxs("button",{type:"button",className:"add-page-button",onClick:T,"aria-label":"Add new page",title:"Add new page at end",children:[l.jsx(no,{size:16}),l.jsx("span",{children:"Add Page"})]})]})};ht.propTypes={pageBoundaries:A.arrayOf(A.shape({id:A.string.isRequired,pageNumber:A.number.isRequired,top:A.number,height:A.number})),activePage:A.number,pageSize:A.oneOf(["A4","Letter","Legal"]),pageMargins:A.string,zoomLevel:A.number,canZoomIn:A.bool,canZoomOut:A.bool,onNavigate:A.func,onAddPage:A.func,onDeletePage:A.func,onPageSizeChange:A.func,onPageMarginsChange:A.func,onZoomIn:A.func,onZoomOut:A.func,onZoomReset:A.func},ht.defaultProps={pageBoundaries:[{id:"page-0",pageNumber:1}],activePage:0,pageSize:"A4",pageMargins:pe,zoomLevel:100,canZoomIn:!0,canZoomOut:!0,onNavigate:void 0,onAddPage:void 0,onDeletePage:void 0,onPageSizeChange:void 0,onPageMarginsChange:void 0,onZoomIn:void 0,onZoomOut:void 0,onZoomReset:void 0};const hn=m.memo(ht),Ue=({editorRef:e,onImageResize:t,onImageSelect:o,onImageDeselect:n,resizeOptions:i=fe})=>{const a=m.useRef(null),r=m.useRef(null),s=m.useRef(null),y=m.useRef(null),p=m.useRef(i),h=m.useRef(!1),b=be();m.useEffect(()=>{p.current=i},[i]);const f=m.useCallback(d=>{if(!de(d))return;a.current&&(ye(a.current),a.current=null),d.classList.add("selected");const v=pt(d,p.current);v&&(a.current=v,r.current=d,document.body.appendChild(v),v.querySelectorAll(".resize-handler").forEach(H=>{H.addEventListener("mousedown",P)}),o&&(console.log("Image selected, calling onImageSelect callback"),o(d)))},[o]),O=m.useCallback(()=>{r.current&&(r.current.classList.remove("selected"),r.current=null),a.current&&(ye(a.current),a.current=null),s.current=null,y.current=null,h.current=!1,n&&n()},[n]),P=m.useCallback(d=>{if(d.preventDefault(),d.stopPropagation(),!r.current)return;const v=d.currentTarget.dataset.handler,N=r.current.getBoundingClientRect(),H=window.pageYOffset||document.documentElement.scrollTop,R=window.pageXOffset||document.documentElement.scrollLeft;s.current={x:d.clientX,y:d.clientY,width:r.current.offsetWidth,height:r.current.offsetHeight,originalWidth:r.current.offsetWidth,originalHeight:r.current.offsetHeight,offsetX:d.clientX-N.left-R,offsetY:d.clientY-N.top-H},y.current=v,h.current=!0,document.body.classList.add("resize-in-progress"),document.body.style.cursor=B(v),document.addEventListener("mousemove",x),document.addEventListener("mouseup",M)},[]),x=m.useCallback(d=>{if(!h.current||!r.current||!s.current||!y.current)return;d.preventDefault(),d.stopPropagation();const{x:v,y:N,width:H,height:R}=s.current,D=y.current,q=d.clientX,$=d.clientY,oe=g({handler:D,startX:v,startY:N,currentX:q,currentY:$,startWidth:H,startHeight:R,options:p.current});u(r.current,oe),a.current&&ke(a.current,r.current)},[]),M=m.useCallback(d=>{if(h.current){if(d.preventDefault(),d.stopPropagation(),r.current&&s.current){const v={width:s.current.originalWidth,height:s.current.originalHeight},N={width:r.current.offsetWidth,height:r.current.offsetHeight};(v.width!==N.width||v.height!==N.height)&&b.recordOperation({type:"IMAGE_RESIZE",payload:{element:r.current,state:N}},{type:"IMAGE_RESIZE",payload:{element:r.current,state:v}})}if(s.current=null,y.current=null,h.current=!1,document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",M),document.body.classList.remove("resize-in-progress"),document.body.style.cursor="",r.current){const v=new Event("input",{bubbles:!0,cancelable:!0});r.current.dispatchEvent(v),t&&t(r.current,{width:r.current.offsetWidth,height:r.current.offsetHeight})}}},[t,b]),T=m.useCallback(d=>{a.current&&!a.current.contains(d.target)&&O();const v=d.target;if(de(v)){if(v===r.current)return;f(v)}else console.log("Clicked on non-image element")},[f,O]),_=m.useCallback(d=>{if((d.key==="Delete"||d.key==="Backspace")&&r.current&&!h.current){d.preventDefault();const v=r.current;if(v.parentNode){v.parentNode.removeChild(v),O();const N=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(N)}}if(d.key==="Escape"&&r.current&&O(),r.current&&!h.current){if((d.ctrlKey||d.metaKey)&&d.shiftKey&&d.key===">"){d.preventDefault();const v=r.current.offsetWidth,N=Math.min(p.current.maxWidth||800,v+10);u(r.current,{width:N,height:r.current.offsetHeight});const H=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(H)}if((d.ctrlKey||d.metaKey)&&d.shiftKey&&d.key==="<"){d.preventDefault();const v=r.current.offsetWidth,N=Math.max(p.current.minWidth||50,v-10);u(r.current,{width:N,height:r.current.offsetHeight});const H=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(H)}if((d.ctrlKey||d.metaKey)&&d.shiftKey&&d.key==="+"){d.preventDefault();const v=r.current.offsetHeight,N=Math.min(p.current.maxHeight||600,v+10);u(r.current,{width:r.current.offsetWidth,height:N});const H=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(H)}if((d.ctrlKey||d.metaKey)&&d.shiftKey&&d.key==="-"){d.preventDefault();const v=r.current.offsetHeight,N=Math.max(p.current.minHeight||50,v-10);u(r.current,{width:r.current.offsetWidth,height:N});const H=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(H)}if((d.ctrlKey||d.metaKey)&&d.key==="r"){d.preventDefault(),u(r.current,{width:300,height:200});const v=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(v)}}},[e,O]),k=m.useCallback(()=>{a.current&&r.current&&ke(a.current,r.current)},[]);m.useEffect(()=>{if(!e.current)return;const v=e.current.closest(".editor-viewport");return v&&(v.addEventListener("scroll",k),window.addEventListener("scroll",k)),()=>{v&&v.removeEventListener("scroll",k),window.removeEventListener("scroll",k)}},[e,k]),m.useEffect(()=>{if(!e.current)return;const d=e.current;d.addEventListener("click",T),d.addEventListener("keydown",_);const v=d.closest(".editor-viewport");return v&&v.addEventListener("scroll",k),window.addEventListener("resize",k),()=>{d.removeEventListener("click",T),d.removeEventListener("keydown",_),v&&v.removeEventListener("scroll",k),window.removeEventListener("resize",k),h.current&&(document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",M),document.body.classList.remove("resize-in-progress"),document.body.style.cursor=""),a.current&&ye(a.current)}},[e,T,_,k,x,M]),m.useEffect(()=>{if(!e.current)return;const d=new MutationObserver(v=>{v.forEach(N=>{N.type==="childList"&&(N.removedNodes.length>0&&N.removedNodes.forEach(H=>{H.nodeType===Node.ELEMENT_NODE&&de(H)&&H===r.current&&O()}),N.addedNodes.length>0&&N.addedNodes.forEach(H=>{if(H.nodeType===Node.ELEMENT_NODE)if(de(H))setTimeout(()=>{f(H)},50);else{const R=H.querySelectorAll?H.querySelectorAll("img"):[];R.length>0&&setTimeout(()=>{f(R[0])},50)}}))})});return d.observe(e.current,{childList:!0,subtree:!0}),()=>{d.disconnect()}},[e,O,f]);function B(d){switch(d){case S.TOP_LEFT:case S.BOTTOM_RIGHT:return"nwse-resize";case S.TOP_RIGHT:case S.BOTTOM_LEFT:return"nesw-resize";case S.TOP:case S.BOTTOM:return"ns-resize";case S.LEFT:case S.RIGHT:return"ew-resize";default:return"default"}}function g({handler:d,startX:v,startY:N,currentX:H,currentY:R,startWidth:D,startHeight:q,options:$=fe}){const oe=H-v,ne=R-N;let Y=D,W=q;switch(d){case S.TOP_LEFT:Y=Math.max($.minWidth,D-oe),W=Math.max($.minHeight,q-ne);break;case S.TOP_RIGHT:Y=Math.max($.minWidth,D+oe),W=Math.max($.minHeight,q-ne);break;case S.BOTTOM_LEFT:Y=Math.max($.minWidth,D-oe),W=Math.max($.minHeight,q+ne);break;case S.BOTTOM_RIGHT:Y=Math.max($.minWidth,D+oe),W=Math.max($.minHeight,q+ne);break;case S.TOP:W=Math.max($.minHeight,q-ne);break;case S.BOTTOM:W=Math.max($.minHeight,q+ne);break;case S.LEFT:Y=Math.max($.minWidth,D-oe);break;case S.RIGHT:Y=Math.max($.minWidth,D+oe);break;default:return{width:Y,height:W}}if($.preserveAspectRatio&&$.aspectRatio){const ae=D/q;[S.TOP_LEFT,S.TOP_RIGHT,S.BOTTOM_LEFT,S.BOTTOM_RIGHT].includes(d)?Y/ae>W?W=Math.max($.minHeight,Y/ae):Y=Math.max($.minWidth,W*ae):[S.TOP,S.BOTTOM].includes(d)?Y=W*ae:[S.LEFT,S.RIGHT].includes(d)&&(W=Y/ae)}return $.maxWidth&&Y>$.maxWidth&&(Y=$.maxWidth,$.preserveAspectRatio&&$.aspectRatio&&(W=Y/(D/q))),$.maxHeight&&W>$.maxHeight&&(W=$.maxHeight,$.preserveAspectRatio&&$.aspectRatio&&(Y=W*(D/q))),Y=Math.max($.minWidth,Y),W=Math.max($.minHeight,W),{width:Math.round(Y),height:Math.round(W)}}function u(d,{width:v,height:N}){de(d)&&(d.tagName==="IMG"?(d.style.width=`${v}px`,d.style.height=`${N}px`,d.width=v,d.height=N):d.tagName==="DIV"&&(d.style.width=`${v}px`,d.style.height=`${N}px`))}return null};Ue.propTypes={editorRef:A.shape({current:A.instanceOf(typeof Element<"u"?Element:Object)}).isRequired,onImageResize:A.func,onImageSelect:A.func,onImageDeselect:A.func,resizeOptions:A.shape({minWidth:A.number,minHeight:A.number,maxWidth:A.number,maxHeight:A.number,aspectRatio:A.bool,preserveAspectRatio:A.bool,defaultWidth:A.number,defaultHeight:A.number})},Ue.defaultProps={onImageResize:void 0,onImageSelect:void 0,onImageDeselect:void 0,resizeOptions:fe};const mt=({imageElement:e,onAlignChange:t,onAspectRatioToggle:o,onDelete:n,onClose:i,initialPreserveAspectRatio:a=!0})=>{const[r,s]=m.useState({top:0,left:0}),[y,p]=m.useState(!1),[h,b]=m.useState("top"),[f,O]=m.useState(a),P=m.useRef(null),x=m.useRef(null),M=be(),T=R=>{if(!R)return;(typeof window<"u"&&typeof window.requestAnimationFrame=="function"?window.requestAnimationFrame:q=>setTimeout(q,16))(()=>{const q=document.querySelector(".image-resize-overlay");q&&ke(q,R)})},_=R=>{if(!R)return null;const D=window.getComputedStyle(R);return{float:D.float||"none",margin:R.style.margin||"",display:D.display||"inline",width:R.style.width||R.width||"",height:R.style.height||R.height||"",aspectRatio:f}},k=()=>{if(!e)return"left";const R=window.getComputedStyle(e);return R.float||R.display==="block"?"left":R.display==="flex"&&R.justifyContent==="center"?"center":R.float==="right"?"right":"left"},[B,g]=m.useState(k());m.useEffect(()=>()=>{console.log("ImageTooltipMenu unmounted")},[e]),m.useEffect(()=>{if(e){let R=e.closest(".editor-viewport")||e.closest(".continuous-scroll");R&&(x.current=R)}},[e]),m.useLayoutEffect(()=>{if(!e||!P.current)return;const R=()=>{const q=e.getBoundingClientRect(),$=P.current.getBoundingClientRect();x.current;const oe=window.visualViewport?window.visualViewport:{width:window.innerWidth,height:window.innerHeight},ne=q.bottom>=0&&q.top<=oe.height&&q.right>=0&&q.left<=oe.width;let Y="top",W=0,ae=0;if(ne){const L=q.top-$.height-10,V=oe.height-q.bottom-$.height-10;V>L&&V>0?(Y="bottom",W=q.bottom+10):(Y="top",W=q.top-$.height-10)}else Y="top",W=10;ae=q.left+q.width/2-$.width/2;const E=window.innerWidth,c=window.innerHeight;let w=ae,I=W;ae<10?w=10:ae+$.width>E-10&&(w=E-$.width-10),W<10?I=10:W+$.height>c-10&&(I=c-$.height-10),s({top:I,left:w}),b(Y),p(!0)};R();const D=()=>{R()};return x.current&&x.current.addEventListener("scroll",D),window.addEventListener("scroll",D),window.addEventListener("resize",D),()=>{x.current&&x.current.removeEventListener("scroll",D),window.removeEventListener("scroll",D),window.removeEventListener("resize",D),p(!1)}},[e]),m.useEffect(()=>{const R=D=>{P.current&&!P.current.contains(D.target)&&D.target!==e&&i()};return document.addEventListener("mousedown",R),()=>{document.removeEventListener("mousedown",R)}},[e,i]);const u=()=>{if(e){const R=_(e);e.style.float="left",e.style.margin="0 10px 10px 0",e.style.display="block",g("left"),T(e);const D=_(e);M.recordOperation({type:"IMAGE_ALIGN",payload:{element:e,alignment:"left",state:D}},{type:"IMAGE_ALIGN",payload:{element:e,alignment:k(),state:R}}),t&&t("left")}},d=()=>{if(e){const R=_(e);e.style.float="none",e.style.margin="10px auto",e.style.display="block",g("center"),T(e);const D=_(e);M.recordOperation({type:"IMAGE_ALIGN",payload:{element:e,alignment:"center",state:D}},{type:"IMAGE_ALIGN",payload:{element:e,alignment:k(),state:R}}),t&&t("center")}},v=()=>{if(e){const R=_(e);e.style.float="right",e.style.margin="0 0 10px 10px",e.style.display="block",g("right"),T(e);const D=_(e);M.recordOperation({type:"IMAGE_ALIGN",payload:{element:e,alignment:"right",state:D}},{type:"IMAGE_ALIGN",payload:{element:e,alignment:k(),state:R}}),t&&t("right")}},N=()=>{if(e&&e.parentNode){const R={element:e,parent:e.parentNode,nextSibling:e.nextSibling};M.recordOperation({type:"IMAGE_DELETE",payload:{element:e}},{type:"IMAGE_REINSERT",payload:{state:R}}),e.parentNode.removeChild(e),n&&n(),i()}},H=()=>{const R=f,D=!f;O(D),M.recordOperation({type:"IMAGE_ASPECT_RATIO",payload:{element:e,preserveAspectRatio:D}},{type:"IMAGE_ASPECT_RATIO",payload:{element:e,preserveAspectRatio:R}}),o&&o(D)};return!e||typeof document>"u"?null:kn.createPortal(l.jsxs("div",{ref:P,className:"image-tooltip-menu","data-menu-position":h,"aria-hidden":!y,style:{position:"fixed",top:`${r.top}px`,left:`${r.left}px`,zIndex:999,background:"#fff",border:"1px solid #ddd",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",padding:"8px",display:"flex",gap:"2px",alignItems:"center",pointerEvents:y?"auto":"none",minWidth:"140px",minHeight:"32px",opacity:y?1:0,visibility:y?"visible":"hidden",transition:"opacity 0.15s ease, visibility 0.15s ease"},children:[l.jsx("button",{className:`tooltip-button aspect-ratio-toggle ${f?"":"active"}`,onClick:H,title:`Toggle aspect ratio preservation (currently ${f?"ON":"OFF"})`,children:f?l.jsx(oo,{size:14}):l.jsx(Vr,{size:14})}),l.jsx("button",{className:`tooltip-button ${B==="left"?"active":""}`,onClick:u,title:"Align Left",style:{background:B==="left"?"#007bff":"transparent",color:B==="left"?"#fff":"#333",border:"1px solid #ccc",borderRadius:"4px",padding:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"28px",height:"28px"},children:l.jsx(cn,{size:14})}),l.jsx("button",{className:`tooltip-button ${B==="center"?"active":""}`,onClick:d,title:"Align Center",style:{background:B==="center"?"#007bff":"transparent",color:B==="center"?"#fff":"#333",border:"1px solid #ccc",borderRadius:"4px",padding:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"28px",height:"28px"},children:l.jsx(an,{size:14})}),l.jsx("button",{className:`tooltip-button ${B==="right"?"active":""}`,onClick:v,title:"Align Right",style:{background:B==="right"?"#007bff":"transparent",color:B==="right"?"#fff":"#333",border:"1px solid #ccc",borderRadius:"4px",padding:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"28px",height:"28px"},children:l.jsx(sn,{size:14})}),l.jsx("button",{className:"tooltip-button delete-button",onClick:N,title:"Delete Image",style:{background:"transparent",color:"#dc3545",border:"1px solid #dc3545",borderRadius:"4px",padding:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"28px",height:"28px"},children:l.jsx(lo,{size:14})})]}),document.body)};mt.propTypes={imageElement:A.instanceOf(typeof Element<"u"?Element:Object),onAlignChange:A.func,onAspectRatioToggle:A.func,onDelete:A.func,onClose:A.func.isRequired,initialPreserveAspectRatio:A.bool},mt.defaultProps={imageElement:null,onAlignChange:void 0,onAspectRatioToggle:void 0,onDelete:void 0,initialPreserveAspectRatio:!0};const ko=50,yt=50,mn=50,Po=100,So=500,yn="UPDATE_CONTINUOUS_CONTENT",Fe=m.forwardRef(({pageManagerComponent:e=null,onNavigatePage:t,onAddPage:o,onDeletePage:n,onPageSizeChange:i,onPageMarginsChange:a,onChange:r,showSidebar:s=!0,showToolbar:y=!0,showPageManager:p=!0},h)=>{const b=ot(),f=be(),{pageSize:O,pageMargins:P,continuousContent:x,pageBoundaries:M,activePage:T,zoomLevel:_,canUndo:k,canRedo:B}=b,g=m.useRef(null),u=m.useRef(null),{currentFormat:d,formatText:v,updateCurrentFormatFromSelection:N}=Gt(),[H,R]=m.useState(!1),[D,q]=m.useState(null),[$,oe]=m.useState(!0),ne=m.useRef(null),{checkAndUpdateBoundaries:Y,getCurrentPage:W,scrollToPage:ae,updateBoundaries:E,triggerAutoReflow:c,removePageAndContent:w,removePageBreak:I,insertPageBreakAtBoundary:L}=Xt(O,u,_,P),V=m.useMemo(()=>Re(O),[O]),[Z,z]=m.useState(!1),G=m.useRef(null),K=m.useRef(!1),X=m.useRef(!1),ie=m.useRef(!1),C=m.useRef(x);m.useEffect(()=>{if(u.current){if(!ie.current){u.current.innerHTML=x,ie.current=!0,C.current=x;const j=setTimeout(()=>{E()},ko);return()=>clearTimeout(j)}if(C.current!==x){if(u.current.innerHTML!==x){u.current.innerHTML=x;const Q=setTimeout(()=>{if(E(),K.current){K.current=!1;const re=Math.max(0,M.length-1);f.setActivePage(re),setTimeout(()=>{ae(re,g)},mn)}},yt);return C.current=x,()=>clearTimeout(Q)}C.current=x}}},[x,E,M.length,f,ae]),m.useEffect(()=>{r&&ie.current&&r(x)},[x,r]),m.useImperativeHandle(h,()=>({getHTMLContent:()=>u.current?u.current.innerHTML:x,getPlainText:()=>(u.current?u.current.innerHTML:x).replace(/<[^>]*>/g," ").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/\s+/g," ").trim(),getCursorPosition:()=>u.current?Ar(u.current):null,setContent:j=>{const Q=He(j);Q!==x&&f.updateContinuousContent(Q),u.current&&u.current.innerHTML!==Q&&(u.current.innerHTML=Q),C.current=Q,u.current&&setTimeout(()=>{E()},yt)},insertContent:j=>{if(!u.current||!j)return;const Q=He(j),re=window.getSelection();let ue=!1;if(re&&re.rangeCount>0){const Et=re.getRangeAt(0);u.current.contains(Et.commonAncestorContainer)&&(ue=!0)}if(!ue&&ne.current)try{re.removeAllRanges(),re.addRange(ne.current)}catch(Et){console.warn("[insertContent] Failed to restore last cursor position:",Et);const Ce=u.current.lastChild;if(Ce){const Ze=document.createRange();Ce.nodeType===Node.TEXT_NODE?Ze.setStart(Ce,Ce.textContent.length):Ze.setStartAfter(Ce),Ze.collapse(!0),re.removeAllRanges(),re.addRange(Ze)}}document.execCommand("insertHTML",!1,Q);const he=u.current.innerHTML;f.updateContinuousContent(he),C.current=he,setTimeout(()=>{E(),c(200)},yt)}}),[x,f,E,u,ne,Y]),m.useEffect(()=>{const j=()=>{if(N(),u.current){const re=window.getSelection();if(re.rangeCount>0){const ue=re.getRangeAt(0);ue.collapsed&&u.current.contains(ue.commonAncestorContainer)&&(ne.current=ue.cloneRange())}}};document.addEventListener("selectionchange",j);const Q=()=>{if(setTimeout(N,10),ne.current&&u.current)try{const re=window.getSelection();re.removeAllRanges(),re.addRange(ne.current)}catch(re){console.warn("[handleFocus] Failed to restore cursor:",re)}};return u.current&&u.current.addEventListener("focus",Q),()=>{document.removeEventListener("selectionchange",j),u.current&&u.current.removeEventListener("focus",Q)}},[N]);const se=m.useCallback(()=>{if(!u.current)return;let j=u.current.innerHTML;j=He(j),j!==u.current.innerHTML&&(u.current.innerHTML=j);const Q=x;if(Q!==j){const ue={type:yn,payload:j},he={type:yn,payload:Q};f.recordOperation(ue,he)}f.updateContinuousContent(j),Y(),c(200);const re=W(g);re!==T&&f.setActivePage(re)},[f,Y,W,T,c,g,u,x]),Ee=m.useCallback(j=>{se()},[se]),we=m.useCallback(j=>{f.updatePageSize(j),E({pageSize:j}),i&&i(j)},[f,E,i]),bn=m.useCallback(j=>{f.updatePageMargins(j),E({pageMargins:j}),a&&a(j)},[f,E,a]),En=m.useCallback(j=>{j<0||j>=M.length||(X.current=!0,f.setActivePage(j),ae(j,g),setTimeout(()=>{X.current=!1},So),t&&t(j))},[f,ae,t,M.length]),Tn=m.useCallback(()=>{const j=M.length+1;L(j)&&(K.current=!0,setTimeout(()=>{if(K.current){K.current=!1;const re=Math.max(0,M.length-1);f.setActivePage(re),setTimeout(()=>{ae(re,g)},mn)}},100)),o&&o()},[M.length,L,f,ae,o]),Co=m.useCallback(()=>{const j=window.getSelection();if(j&&j.rangeCount>0){if(!u?.current)return;const ue=`<page-break data-page-break="true" contenteditable="false" data-page-number="${u.current.querySelectorAll('page-break, [data-page-break="true"]').length+2}"></page-break><p><br></p>`;document.execCommand("insertHTML",!1,ue),setTimeout(()=>{E();const he=W(g);f.setActivePage(he)},150)}},[E,W,f,g]),Oo=m.useCallback(j=>{if(!j)return;I(j)&&setTimeout(()=>{const re=W(g);f.setActivePage(re)},200)},[I,W,f,g]),vn=m.useCallback(j=>{if(M.length<=1){console.warn("Cannot delete the only page");return}w(j)&&(f.setActivePage(0),n&&n(j))},[M.length,w,f,n]),Ge=m.useCallback(()=>{f.zoomIn()},[f]),qe=m.useCallback(()=>{f.zoomOut()},[f]),We=m.useCallback(()=>{f.resetZoom()},[f]),xn=m.useCallback(()=>{f.undo()},[f]),An=m.useCallback(()=>{f.redo()},[f]);m.useEffect(()=>{const j=Q=>{if(Q.ctrlKey||Q.metaKey){["+","=","-","_","0","z","y"].includes(Q.key)&&Q.preventDefault();const re=document.activeElement===u.current,ue=document.activeElement===g.current,he=document.activeElement?.tagName==="INPUT"||document.activeElement?.tagName==="TEXTAREA"||document.activeElement?.isContentEditable===!1;if(re||ue||!he)switch(Q.key){case"+":case"=":Ge();break;case"-":case"_":qe();break;case"0":We();break;case"z":Q.shiftKey||xn();break;case"y":An();break}}};return window.addEventListener("keydown",j),()=>{window.removeEventListener("keydown",j)}},[Ge,qe,We,xn,An]);const No=m.useCallback(()=>{!g.current||!u.current||X.current||(G.current&&clearTimeout(G.current),G.current=setTimeout(()=>{if(X.current){G.current=null;return}const j=W(g);j!==T&&j>=0&&f.setActivePage(j),G.current=null},Po))},[W,T,f]),Mo=m.useMemo(()=>{if(!x)return 0;const Q=x.replace(/<[^>]*>/g," ").match(new RegExp("\\p{L}+","gu"));return Q?Q.length:0},[x]),Ro=M.length||1,Io=m.useCallback(j=>{R(!0),q(j)},[]),_n=m.useCallback(()=>{R(!1),q(null)},[]),Lo=m.useCallback((j,Q)=>{},[]);return m.useEffect(()=>()=>{G.current&&clearTimeout(G.current)},[]),l.jsxs("div",{className:"multi-page-editor",children:[y&&l.jsx(ze,{currentFormat:{...d,imageSelected:H},onFormatText:v,onAddPageBreak:Co,canUndo:k,canRedo:B}),l.jsxs("div",{className:"editor-container",children:[s&&l.jsx(ln,{editorView:null,isCollapsed:Z,onToggle:()=>z(j=>!j),wordCount:Mo,pageCount:Ro}),l.jsx("div",{className:"editor-viewport continuous-scroll",ref:g,onScroll:No,children:l.jsx($e,{content:x,dimensions:V,pageSize:O,pageMargins:P,pageBoundaries:M,editorRef:u,onInput:Ee,onContentChange:se,onClick:()=>u.current?.focus(),onRemovePageBreak:Oo,zoomLevel:_})}),l.jsx(Ue,{editorRef:u,onImageSelect:Io,onImageDeselect:_n,onImageResize:Lo,resizeOptions:{...fe,preserveAspectRatio:$,aspectRatio:$}}),H&&D&&l.jsx(mt,{imageElement:D,initialPreserveAspectRatio:$,onAlignChange:j=>{},onAspectRatioToggle:j=>{oe(j)},onDelete:()=>{if(D){const j=D.getAttribute("data-key");j&&en(j).catch(Q=>{console.error("Failed to delete image from IndexedDB:",Q)})}},onClose:_n}),p&&l.jsx("div",{className:"page-manager-sidebar",children:e?m.cloneElement(e,{onNavigate:En,onAddPage:Tn,onDeletePage:vn,onPageSizeChange:we,onPageMarginsChange:bn,zoomLevel:_,canZoomIn:Je(_),canZoomOut:Qe(_),onZoomIn:Ge,onZoomOut:qe,onZoomReset:We}):l.jsx(hn,{pageBoundaries:M,activePage:T,pageSize:O,pageMargins:P,zoomLevel:_,canZoomIn:Je(_),canZoomOut:Qe(_),onNavigate:En,onAddPage:Tn,onDeletePage:vn,onPageSizeChange:we,onPageMarginsChange:bn,onZoomIn:Ge,onZoomOut:qe,onZoomReset:We})})]})]})});Fe.displayName="HtmlEditor",Fe.propTypes={pageManagerComponent:A.element,onNavigatePage:A.func,onAddPage:A.func,onDeletePage:A.func,onPageSizeChange:A.func,onPageMarginsChange:A.func,onChange:A.func,showSidebar:A.bool,showToolbar:A.bool,showPageManager:A.bool},Fe.defaultProps={pageManagerComponent:null,onNavigatePage:void 0,onAddPage:void 0,onDeletePage:void 0,onPageSizeChange:void 0,onPageMarginsChange:void 0,onChange:void 0,showSidebar:!0,showToolbar:!0,showPageManager:!0};class bt extends m.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,o){console.error("[ErrorBoundary] Caught error:",t),console.error("[ErrorBoundary] Error info:",o),this.setState({error:t,errorInfo:o}),this.props.onError&&this.props.onError(t,o)}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null}),this.props.onReset&&this.props.onReset()};render(){return this.state.hasError?this.props.fallback?this.props.fallback:l.jsxs("div",{style:{padding:"20px",margin:"20px",border:"2px solid #f44336",borderRadius:"4px",backgroundColor:"#ffebee",color:"#c62828"},children:[l.jsx("h2",{style:{marginTop:0},children:"⚠️ Something went wrong"}),l.jsx("p",{children:"The editor encountered an unexpected error and couldn't continue."}),this.props.showDetails&&this.state.error&&l.jsxs("details",{style:{marginTop:"10px",padding:"10px",backgroundColor:"white",borderRadius:"4px",fontSize:"12px",fontFamily:"monospace"},children:[l.jsx("summary",{style:{cursor:"pointer",fontWeight:"bold"},children:"Error Details"}),l.jsxs("pre",{style:{marginTop:"10px",overflow:"auto",maxHeight:"200px"},children:[this.state.error.toString(),this.state.errorInfo&&this.state.errorInfo.componentStack]})]}),l.jsx("button",{onClick:this.handleReset,style:{marginTop:"15px",padding:"8px 16px",backgroundColor:"#f44336",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold"},children:"Try Again"})]}):this.props.children}}bt.propTypes={children:A.node.isRequired,fallback:A.node,onError:A.func,onReset:A.func,showDetails:A.bool},bt.defaultProps={fallback:null,onError:void 0,onReset:void 0,showDetails:process.env.NODE_ENV==="development"};const wo={A4:{width:ce.A4.width,height:ce.A4.height},Letter:{width:ce.Letter.width,height:ce.Letter.height},Legal:{width:ce.Legal.width,height:ce.Legal.height}};U.COMMON_FONT_SIZES=Bt,U.DEFAULT_FONT_SIZE=_e,U.DEFAULT_IMAGE_RESIZE_OPTIONS=fe,U.DEFAULT_PAGE_SIZE=et,U.DocumentProvider=Hn,U.EditorToolbar=ze,U.ErrorBoundary=bt,U.FONT_SIZE_MAP=ft,U.HtmlEditor=Fe,U.ImageResizeHandlers=Ue,U.PAGE_DIMENSIONS=wo,U.PAGE_SIZES=ce,U.PageManager=hn,U.PageView=$e,U.RESIZE_HANDLERS=S,U.Sidebar=ln,U.applyImageDimensions=Jn,U.calculateResizeDimensions=Kn,U.clearImages=wr,U.createResizeOverlay=pt,U.deleteImage=en,U.getAllImageKeys=Cr,U.getAvailablePageSizes=Ln,U.getImage=Qt,U.getImageDimensions=Xn,U.getPageDimensions=Re,U.getPixelValue=Zn,U.getPointValue=Yn,U.isResizableImage=de,U.isValidFontSize=Vn,U.isValidPageSize=In,U.logger=un,U.pixelsToPoints=$t,U.pointsToPixels=zt,U.removeResizeOverlay=ye,U.saveImage=Jt,U.updateResizeOverlay=ke,U.useContinuousReflow=Xt,U.useDocument=rt,U.useDocumentActions=be,U.useDocumentState=ot,U.useFormatting=Gt,Object.defineProperty(U,Symbol.toStringTag,{value:"Module"})}));
//# sourceMappingURL=htmleditor.umd.cjs.map
