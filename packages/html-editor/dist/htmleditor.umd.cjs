(function(U,m){typeof exports=="object"&&typeof module<"u"?m(exports,require("react"),require("uuid"),require("react-dom")):typeof define=="function"&&define.amd?define(["exports","react","uuid","react-dom"],m):(U=typeof globalThis<"u"?globalThis:U||self,m(U.HTMLEditor={},U.React,U.uuid,U.ReactDOM))})(this,(function(U,m,We,Tn){"use strict";function vn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ce={exports:{}},Te={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yt;function xn(){if(yt)return Te;yt=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function o(n,i,a){var r=null;if(a!==void 0&&(r=""+a),i.key!==void 0&&(r=""+i.key),"key"in i){a={};for(var s in i)s!=="key"&&(a[s]=i[s])}else a=i;return i=a.ref,{$$typeof:e,type:n,key:r,ref:i!==void 0?i:null,props:a}}return Te.Fragment=t,Te.jsx=o,Te.jsxs=o,Te}var ve={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Et;function _n(){return Et||(Et=1,process.env.NODE_ENV!=="production"&&(function(){function e(l){if(l==null)return null;if(typeof l=="function")return l.$$typeof===L?null:l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case O:return"Fragment";case A:return"Profiler";case b:return"StrictMode";case E:return"Suspense";case g:return"SuspenseList";case $:return"Activity"}if(typeof l=="object")switch(typeof l.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),l.$$typeof){case v:return"Portal";case H:return l.displayName||"Context";case k:return(l._context.displayName||"Context")+".Consumer";case c:var S=l.render;return l=l.displayName,l||(l=S.displayName||S.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case _:return S=l.displayName||null,S!==null?S:e(l.type)||"Memo";case M:S=l._payload,l=l._init;try{return e(l(S))}catch{}}return null}function t(l){return""+l}function o(l){try{t(l);var S=!1}catch{S=!0}if(S){S=console;var R=S.error,I=typeof Symbol=="function"&&Symbol.toStringTag&&l[Symbol.toStringTag]||l.constructor.name||"Object";return R.call(S,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",I),t(l)}}function n(l){if(l===O)return"<>";if(typeof l=="object"&&l!==null&&l.$$typeof===M)return"<...>";try{var S=e(l);return S?"<"+S+">":"<...>"}catch{return"<...>"}}function i(){var l=B.A;return l===null?null:l.getOwner()}function a(){return Error("react-stack-top-frame")}function r(l){if(Z.call(l,"key")){var S=Object.getOwnPropertyDescriptor(l,"key").get;if(S&&S.isReactWarning)return!1}return l.key!==void 0}function s(l,S){function R(){re||(re=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",S))}R.isReactWarning=!0,Object.defineProperty(l,"key",{get:R,configurable:!0})}function h(){var l=e(this.type);return q[l]||(q[l]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),l=this.props.ref,l!==void 0?l:null}function f(l,S,R,I,Y,F){var j=R.ref;return l={$$typeof:C,type:l,key:S,props:R,_owner:I},(j!==void 0?j:null)!==null?Object.defineProperty(l,"ref",{enumerable:!1,get:h}):Object.defineProperty(l,"ref",{enumerable:!1,value:null}),l._store={},Object.defineProperty(l._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(l,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(l,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:Y}),Object.defineProperty(l,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:F}),Object.freeze&&(Object.freeze(l.props),Object.freeze(l)),l}function p(l,S,R,I,Y,F){var j=S.children;if(j!==void 0)if(I)if(z(j)){for(I=0;I<j.length;I++)y(j[I]);Object.freeze&&Object.freeze(j)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else y(j);if(Z.call(S,"key")){j=e(l);var W=Object.keys(S).filter(function(K){return K!=="key"});I=0<W.length?"{key: someKey, "+W.join(": ..., ")+": ...}":"{key: someKey}",T[j+I]||(W=0<W.length?"{"+W.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,I,j,W,j),T[j+I]=!0)}if(j=null,R!==void 0&&(o(R),j=""+R),r(S)&&(o(S.key),j=""+S.key),"key"in S){R={};for(var X in S)X!=="key"&&(R[X]=S[X])}else R=S;return j&&s(R,typeof l=="function"?l.displayName||l.name||"Unknown":l),f(l,j,R,i(),Y,F)}function y(l){d(l)?l._store&&(l._store.validated=1):typeof l=="object"&&l!==null&&l.$$typeof===M&&(l._payload.status==="fulfilled"?d(l._payload.value)&&l._payload.value._store&&(l._payload.value._store.validated=1):l._store&&(l._store.validated=1))}function d(l){return typeof l=="object"&&l!==null&&l.$$typeof===C}var w=m,C=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),O=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),k=Symbol.for("react.consumer"),H=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),g=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),$=Symbol.for("react.activity"),L=Symbol.for("react.client.reference"),B=w.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z=Object.prototype.hasOwnProperty,z=Array.isArray,oe=console.createTask?console.createTask:function(){return null};w={react_stack_bottom_frame:function(l){return l()}};var re,q={},V=w.react_stack_bottom_frame.bind(w,a)(),ne=oe(n(a)),T={};ve.Fragment=O,ve.jsx=function(l,S,R){var I=1e4>B.recentlyCreatedOwnerStacks++;return p(l,S,R,!1,I?Error("react-stack-top-frame"):V,I?oe(n(l)):ne)},ve.jsxs=function(l,S,R){var I=1e4>B.recentlyCreatedOwnerStacks++;return p(l,S,R,!0,I?Error("react-stack-top-frame"):V,I?oe(n(l)):ne)}})()),ve}var bt;function An(){return bt||(bt=1,process.env.NODE_ENV==="production"?Ce.exports=xn():Ce.exports=_n()),Ce.exports}var u=An();const Ze=100,Ye=50,Ve=200,Tt=5,Ke=e=>e<Ve,Xe=e=>e>Ye,kn=96,Oe=e=>Math.round(e*kn),Ne={NORMAL:{name:"Normal",label:'Normal (1")',top:1,bottom:1,left:1,right:1},NARROW:{name:"Narrow",label:'Narrow (0.5")',top:.5,bottom:.5,left:.5,right:.5},MODERATE:{name:"Moderate",label:'Moderate (1" / 0.75")',top:1,bottom:1,left:.75,right:.75},WIDE:{name:"Wide",label:'Wide (1" / 2")',top:1,bottom:1,left:2,right:2},OFFICE_2003:{name:"Office 2003",label:'Office 2003 (1" / 1.25")',top:1,bottom:1,left:1.25,right:1.25}},fe="NORMAL",vt=(e=fe)=>{const t=Ne[e]||Ne[fe];return{top:Oe(t.top),bottom:Oe(t.bottom),left:Oe(t.left),right:Oe(t.right)}},Pn=(e=fe)=>{const t=vt(e);return t.top+t.bottom},Sn=()=>Object.keys(Ne),wn=e=>{const t=Ne[e];return t?t.label:"Unknown"},se={A4:{name:"A4",width:794,height:1123,widthMm:210,heightMm:297,widthIn:8.27,heightIn:11.69},Letter:{name:"Letter",width:816,height:1056,widthMm:216,heightMm:279,widthIn:8.5,heightIn:11},Legal:{name:"Legal",width:816,height:1344,widthMm:216,heightMm:356,widthIn:8.5,heightIn:14}},Je="A4",Me=e=>{const t=se[e]||se[Je];return{width:t.width,height:t.height}},Cn=e=>Object.keys(se).includes(e),On=()=>Object.keys(se),xe=Je,ge="<p><br></p>",Nn="continuous",_e=(e,t=xe)=>({id:We.v4(),index:e,size:t,content:ge,images:[],isBreakPoint:!1}),Re=e=>typeof e!="string"||e.trim()===""?ge:e,xt=(e,t=xe)=>(e.length>0?e:[_e(0,t)]).map((n,i)=>({id:n.id||We.v4(),index:i,size:n.size||t,content:Re(n.content),images:n.images||[],isBreakPoint:!!n.isBreakPoint})),Mn=(e=xe)=>[{id:"page-0",pageNumber:1,top:0,height:Me(e).height}],Qe=(e={})=>{const t=new Date().toISOString(),o=e.pageSize||xe,n=xt(e.pages||[_e(0,o)],o);return{id:We.v4(),title:e.title||"Untitled Document",createdAt:t,updatedAt:t,pageSize:o,pages:n,activePage:e.activePage&&e.activePage<n.length?e.activePage:0,pageBreaks:e.pageBreaks||[],totalPages:n.length,editorMode:e.editorMode||Nn,continuousContent:e.continuousContent||ge,pageBoundaries:e.pageBoundaries||Mn(o),zoomLevel:e.zoomLevel||Ze,pageMargins:e.pageMargins||fe,undoStack:[],redoStack:[],canUndo:!1,canRedo:!1}},G={INITIALIZE_DOCUMENT:"INITIALIZE_DOCUMENT",UPDATE_TITLE:"UPDATE_TITLE",UPDATE_PAGE_CONTENT:"UPDATE_PAGE_CONTENT",UPDATE_PAGES:"UPDATE_PAGES",ADD_PAGE:"ADD_PAGE",DELETE_PAGE:"DELETE_PAGE",SET_ACTIVE_PAGE:"SET_ACTIVE_PAGE",UPDATE_PAGE_SIZE:"UPDATE_PAGE_SIZE",RESET_DOCUMENT:"RESET_DOCUMENT",UPDATE_CONTINUOUS_CONTENT:"UPDATE_CONTINUOUS_CONTENT",UPDATE_PAGE_BOUNDARIES:"UPDATE_PAGE_BOUNDARIES",ADD_PAGE_BREAK:"ADD_PAGE_BREAK",REMOVE_PAGE_BREAK:"REMOVE_PAGE_BREAK",SET_EDITOR_MODE:"SET_EDITOR_MODE",INSERT_PAGE_AT:"INSERT_PAGE_AT",MOVE_PAGE_TO:"MOVE_PAGE_TO",DUPLICATE_PAGE:"DUPLICATE_PAGE",SET_ZOOM_LEVEL:"SET_ZOOM_LEVEL",ZOOM_IN:"ZOOM_IN",ZOOM_OUT:"ZOOM_OUT",RESET_ZOOM:"RESET_ZOOM",UPDATE_PAGE_MARGINS:"UPDATE_PAGE_MARGINS",RECORD_OPERATION:"RECORD_OPERATION",UNDO:"UNDO",REDO:"REDO",CLEAR_UNDO_REDO:"CLEAR_UNDO_REDO"},et=(e,t)=>{const o=new Date().toISOString();switch(t.type){case G.INITIALIZE_DOCUMENT:{const{initialContent:n=ge,pageSize:i=xe}=t.payload||{},a={..._e(0,i),content:Re(n)};return Qe({title:e.title,pageSize:i,pages:[a]})}case G.UPDATE_TITLE:return{...e,title:t.payload,updatedAt:o};case G.UPDATE_PAGE_CONTENT:{const{pageIndex:n,content:i}=t.payload;if(n<0||n>=e.pages.length)return e;const a=[...e.pages];return a[n]={...a[n],content:Re(i)},{...e,pages:a,updatedAt:o}}case G.UPDATE_PAGES:{const n=Array.isArray(t.payload)?{pages:t.payload}:t.payload||{},i=xt(n.pages||[],e.pageSize),a=Array.isArray(n.pageBreaks)?n.pageBreaks:i.slice(0,-1).map((r,s)=>({id:`auto-break-${s}`,pageNumber:s+1}));return{...e,pages:i,activePage:Math.min(e.activePage,i.length-1),pageBreaks:a,totalPages:i.length,updatedAt:o}}case G.ADD_PAGE:{const n=typeof t.payload?.index=="number"?Math.min(Math.max(t.payload.index,0),e.pages.length):e.pages.length,i=[...e.pages];i.splice(n,0,_e(n,e.pageSize));const a=i.map((s,h)=>({...s,index:h,size:e.pageSize})),r=a.slice(0,-1).map((s,h)=>({id:`auto-break-${h}`,pageNumber:h+1}));return{...e,pages:a,activePage:n,pageBreaks:r,totalPages:a.length,updatedAt:o}}case G.DELETE_PAGE:{const n=t.payload;if(e.pages.length<=1)return e;const i=[...e.pages];i.splice(n,1);const a=i.map((h,f)=>({...h,index:f,size:e.pageSize}));let r=e.activePage;r>=a.length?r=a.length-1:n<=r&&r>0&&(r-=1);const s=a.slice(0,-1).map((h,f)=>({id:`auto-break-${f}`,pageNumber:f+1}));return{...e,pages:a,activePage:r,pageBreaks:s,totalPages:a.length,updatedAt:o}}case G.SET_ACTIVE_PAGE:{const n=t.payload;if(n===e.activePage)return e;const i=e.editorMode==="continuous"?e.pageBoundaries.length:e.pages.length;return n<0||n>=i?e:{...e,activePage:n,updatedAt:o}}case G.UPDATE_PAGE_SIZE:{const n=t.payload;if(n===e.pageSize)return e;try{Me(n)}catch{return console.warn(`Invalid page size: ${n}`),e}const i=e.pages.map((r,s)=>({...r,index:s,size:n})),a=i.slice(0,-1).map((r,s)=>({id:`auto-break-${s}`,pageNumber:s+1}));return{...e,pageSize:n,pages:i,pageBreaks:a,updatedAt:o}}case G.RESET_DOCUMENT:return Qe();case G.UPDATE_CONTINUOUS_CONTENT:{const n=Re(t.payload);return n===e.continuousContent?e:{...e,continuousContent:n,updatedAt:o}}case G.UPDATE_PAGE_BOUNDARIES:{const n=Array.isArray(t.payload)?t.payload:[];if(n.length===e.pageBoundaries.length&&n.length>0&&n[0].id===e.pageBoundaries[0]?.id&&n[n.length-1].id===e.pageBoundaries[n.length-1]?.id)return e;const i=e.activePage>=n.length?Math.max(0,n.length-1):e.activePage;return{...e,pageBoundaries:n,totalPages:n.length,activePage:i,updatedAt:o}}case G.ADD_PAGE_BREAK:{const{position:n="end",pageIndex:i}=t.payload||{},a='<page-break data-page-break="true" style="display: block; height: 20px; border-top: 2px dashed #ccc; margin: 20px 0; page-break-after: always;"></page-break>';let r=e.continuousContent;if(n==="end")r=r+a+"<p><br></p>";else if(typeof n=="number"){const s=r.substring(0,n),h=r.substring(n);r=s+a+h}else if(typeof i=="number"&&typeof document<"u"){const s=document.createElement("div");s.innerHTML=r;const h=s.querySelectorAll('page-break, [data-page-break="true"]');if(i===0&&h.length===0)r=r+a+"<p><br></p>";else if(i<h.length){const f=h[i],p=document.createElement("page-break");p.setAttribute("data-page-break","true"),p.setAttribute("style","display: block; height: 20px; border-top: 2px dashed #ccc; margin: 20px 0; page-break-after: always;");const y=document.createElement("p");y.innerHTML="<br>",f.parentNode.insertBefore(p,f.nextSibling),p.parentNode.insertBefore(y,p.nextSibling),r=s.innerHTML}else r=r+a+"<p><br></p>"}return{...e,continuousContent:r,updatedAt:o}}case G.REMOVE_PAGE_BREAK:{const{pageIndex:n}=t.payload||{};if(typeof n!="number"||typeof document>"u")return e;const i=document.createElement("div");i.innerHTML=e.continuousContent;const a=i.querySelectorAll('page-break, [data-page-break="true"]');return a[n]&&a[n].remove(),i.querySelectorAll('page-break, [data-page-break="true"]').forEach((s,h)=>{s.setAttribute("data-page-number",String(h+2))}),{...e,continuousContent:i.innerHTML,updatedAt:o}}case G.SET_EDITOR_MODE:{const n=t.payload;if(n===e.editorMode)return e;let i=e.continuousContent,a=e.pages;return n==="continuous"?i=e.pages.map(s=>s.content).filter(s=>s&&s!==ge).join(`
`)||ge:e.continuousContent&&e.continuousContent!==ge&&(a=[{..._e(0,e.pageSize),content:e.continuousContent}]),{...e,editorMode:n,continuousContent:i,pages:a,updatedAt:o}}case G.SET_ZOOM_LEVEL:{const n=t.payload;return n<Ye||n>Ve?(console.warn(`Invalid zoom level: ${n}. Must be between ${Ye} and ${Ve}.`),e):n===e.zoomLevel?e:{...e,zoomLevel:n,updatedAt:o}}case G.ZOOM_IN:{if(!Ke(e.zoomLevel))return e;const n=e.zoomLevel+Tt;return{...e,zoomLevel:n,updatedAt:o}}case G.ZOOM_OUT:{if(!Xe(e.zoomLevel))return e;const n=e.zoomLevel-Tt;return{...e,zoomLevel:n,updatedAt:o}}case G.RESET_ZOOM:return e.zoomLevel===Ze?e:{...e,zoomLevel:Ze,updatedAt:o};case G.UPDATE_PAGE_MARGINS:{const n=t.payload;return n===e.pageMargins?e:{...e,pageMargins:n,updatedAt:o}}case G.RECORD_OPERATION:{const{operation:n,inverseOperation:i}=t.payload;return{...e,undoStack:[...e.undoStack,{operation:n,inverseOperation:i}],redoStack:[],canUndo:!0,canRedo:!1,updatedAt:o}}case G.UNDO:{if(e.undoStack.length===0)return e;const n=e.undoStack[e.undoStack.length-1],i=e.undoStack.slice(0,-1);let a=e;return n.inverseOperation&&(a=et(e,n.inverseOperation)),{...a,undoStack:i,redoStack:[...e.redoStack,n],canUndo:i.length>0,canRedo:!0,updatedAt:o}}case G.REDO:{if(e.redoStack.length===0)return e;const n=e.redoStack[e.redoStack.length-1],i=e.redoStack.slice(0,-1);let a=e;return n.operation&&(a=et(e,n.operation)),{...a,undoStack:[...e.undoStack,n],redoStack:i,canUndo:!0,canRedo:i.length>0,updatedAt:o}}case G.CLEAR_UNDO_REDO:return{...e,undoStack:[],redoStack:[],canUndo:!1,canRedo:!1,updatedAt:o};case"IMAGE_ALIGN":{const{element:n,state:i}=t.payload;return n&&i&&(n.style.float=i.float,n.style.margin=i.margin,n.style.display=i.display,i.width&&(n.style.width=i.width),i.height&&(n.style.height=i.height)),e}case"IMAGE_DELETE":{const{element:n}=t.payload;return n&&n.parentNode&&n.parentNode.removeChild(n),e}case"IMAGE_REINSERT":{const{state:n}=t.payload;return n&&n.parent&&n.element&&(n.nextSibling?n.parent.insertBefore(n.element,n.nextSibling):n.parent.appendChild(n.element)),e}case"IMAGE_ASPECT_RATIO":return e;case"IMAGE_RESIZE":{const{element:n,state:i}=t.payload;return n&&i&&(i.width&&(n.style.width=i.width),i.height&&(n.style.height=i.height)),e}default:return e}},_t=m.createContext(null),Rn=({children:e,initialState:t={}})=>{const[o,n]=m.useReducer(et,Qe(t)),i=m.useMemo(()=>({initializeDocument:r=>n({type:G.INITIALIZE_DOCUMENT,payload:r}),updateTitle:r=>n({type:G.UPDATE_TITLE,payload:r}),updatePageContent:r=>n({type:G.UPDATE_PAGE_CONTENT,payload:r}),updatePages:r=>n({type:G.UPDATE_PAGES,payload:r}),addPage:r=>n({type:G.ADD_PAGE,payload:r}),deletePage:r=>n({type:G.DELETE_PAGE,payload:r}),setActivePage:r=>n({type:G.SET_ACTIVE_PAGE,payload:r}),updatePageSize:r=>n({type:G.UPDATE_PAGE_SIZE,payload:r}),resetDocument:()=>n({type:G.RESET_DOCUMENT}),updateContinuousContent:r=>n({type:G.UPDATE_CONTINUOUS_CONTENT,payload:r}),updatePageBoundaries:r=>n({type:G.UPDATE_PAGE_BOUNDARIES,payload:r}),addPageBreak:r=>n({type:G.ADD_PAGE_BREAK,payload:r}),removePageBreak:r=>n({type:G.REMOVE_PAGE_BREAK,payload:r}),setEditorMode:r=>n({type:G.SET_EDITOR_MODE,payload:r}),insertPageAt:r=>n({type:G.INSERT_PAGE_AT,payload:r}),movePageTo:r=>n({type:G.MOVE_PAGE_TO,payload:r}),duplicatePage:r=>n({type:G.DUPLICATE_PAGE,payload:r}),setZoomLevel:r=>n({type:G.SET_ZOOM_LEVEL,payload:r}),zoomIn:()=>n({type:G.ZOOM_IN}),zoomOut:()=>n({type:G.ZOOM_OUT}),resetZoom:()=>n({type:G.RESET_ZOOM}),updatePageMargins:r=>n({type:G.UPDATE_PAGE_MARGINS,payload:r}),recordOperation:(r,s)=>n({type:G.RECORD_OPERATION,payload:{operation:r,inverseOperation:s}}),undo:()=>n({type:G.UNDO}),redo:()=>n({type:G.REDO}),clearUndoRedo:()=>n({type:G.CLEAR_UNDO_REDO})}),[]),a=m.useMemo(()=>({state:o,actions:i,dispatch:n}),[o,i]);return u.jsx(_t.Provider,{value:a,children:e})},tt=()=>{const e=m.useContext(_t);if(!e)throw new Error("useDocument must be used within a DocumentProvider");return e},nt=()=>{const{state:e}=tt();return e},Ee=()=>{const{actions:e}=tt();return e};var Ie={exports:{}},Le={exports:{}},ee={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var At;function In(){if(At)return ee;At=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,o=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,i=e?Symbol.for("react.strict_mode"):60108,a=e?Symbol.for("react.profiler"):60114,r=e?Symbol.for("react.provider"):60109,s=e?Symbol.for("react.context"):60110,h=e?Symbol.for("react.async_mode"):60111,f=e?Symbol.for("react.concurrent_mode"):60111,p=e?Symbol.for("react.forward_ref"):60112,y=e?Symbol.for("react.suspense"):60113,d=e?Symbol.for("react.suspense_list"):60120,w=e?Symbol.for("react.memo"):60115,C=e?Symbol.for("react.lazy"):60116,v=e?Symbol.for("react.block"):60121,O=e?Symbol.for("react.fundamental"):60117,b=e?Symbol.for("react.responder"):60118,A=e?Symbol.for("react.scope"):60119;function k(c){if(typeof c=="object"&&c!==null){var E=c.$$typeof;switch(E){case t:switch(c=c.type,c){case h:case f:case n:case a:case i:case y:return c;default:switch(c=c&&c.$$typeof,c){case s:case p:case C:case w:case r:return c;default:return E}}case o:return E}}}function H(c){return k(c)===f}return ee.AsyncMode=h,ee.ConcurrentMode=f,ee.ContextConsumer=s,ee.ContextProvider=r,ee.Element=t,ee.ForwardRef=p,ee.Fragment=n,ee.Lazy=C,ee.Memo=w,ee.Portal=o,ee.Profiler=a,ee.StrictMode=i,ee.Suspense=y,ee.isAsyncMode=function(c){return H(c)||k(c)===h},ee.isConcurrentMode=H,ee.isContextConsumer=function(c){return k(c)===s},ee.isContextProvider=function(c){return k(c)===r},ee.isElement=function(c){return typeof c=="object"&&c!==null&&c.$$typeof===t},ee.isForwardRef=function(c){return k(c)===p},ee.isFragment=function(c){return k(c)===n},ee.isLazy=function(c){return k(c)===C},ee.isMemo=function(c){return k(c)===w},ee.isPortal=function(c){return k(c)===o},ee.isProfiler=function(c){return k(c)===a},ee.isStrictMode=function(c){return k(c)===i},ee.isSuspense=function(c){return k(c)===y},ee.isValidElementType=function(c){return typeof c=="string"||typeof c=="function"||c===n||c===f||c===a||c===i||c===y||c===d||typeof c=="object"&&c!==null&&(c.$$typeof===C||c.$$typeof===w||c.$$typeof===r||c.$$typeof===s||c.$$typeof===p||c.$$typeof===O||c.$$typeof===b||c.$$typeof===A||c.$$typeof===v)},ee.typeOf=k,ee}var te={};/** @license React v16.13.1
 * react-is.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kt;function Ln(){return kt||(kt=1,process.env.NODE_ENV!=="production"&&(function(){var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,o=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,i=e?Symbol.for("react.strict_mode"):60108,a=e?Symbol.for("react.profiler"):60114,r=e?Symbol.for("react.provider"):60109,s=e?Symbol.for("react.context"):60110,h=e?Symbol.for("react.async_mode"):60111,f=e?Symbol.for("react.concurrent_mode"):60111,p=e?Symbol.for("react.forward_ref"):60112,y=e?Symbol.for("react.suspense"):60113,d=e?Symbol.for("react.suspense_list"):60120,w=e?Symbol.for("react.memo"):60115,C=e?Symbol.for("react.lazy"):60116,v=e?Symbol.for("react.block"):60121,O=e?Symbol.for("react.fundamental"):60117,b=e?Symbol.for("react.responder"):60118,A=e?Symbol.for("react.scope"):60119;function k(N){return typeof N=="string"||typeof N=="function"||N===n||N===f||N===a||N===i||N===y||N===d||typeof N=="object"&&N!==null&&(N.$$typeof===C||N.$$typeof===w||N.$$typeof===r||N.$$typeof===s||N.$$typeof===p||N.$$typeof===O||N.$$typeof===b||N.$$typeof===A||N.$$typeof===v)}function H(N){if(typeof N=="object"&&N!==null){var ce=N.$$typeof;switch(ce){case t:var me=N.type;switch(me){case h:case f:case n:case a:case i:case y:return me;default:var we=me&&me.$$typeof;switch(we){case s:case p:case C:case w:case r:return we;default:return ce}}case o:return ce}}}var c=h,E=f,g=s,_=r,M=t,$=p,L=n,B=C,Z=w,z=o,oe=a,re=i,q=y,V=!1;function ne(N){return V||(V=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),T(N)||H(N)===h}function T(N){return H(N)===f}function l(N){return H(N)===s}function S(N){return H(N)===r}function R(N){return typeof N=="object"&&N!==null&&N.$$typeof===t}function I(N){return H(N)===p}function Y(N){return H(N)===n}function F(N){return H(N)===C}function j(N){return H(N)===w}function W(N){return H(N)===o}function X(N){return H(N)===a}function K(N){return H(N)===i}function ae(N){return H(N)===y}te.AsyncMode=c,te.ConcurrentMode=E,te.ContextConsumer=g,te.ContextProvider=_,te.Element=M,te.ForwardRef=$,te.Fragment=L,te.Lazy=B,te.Memo=Z,te.Portal=z,te.Profiler=oe,te.StrictMode=re,te.Suspense=q,te.isAsyncMode=ne,te.isConcurrentMode=T,te.isContextConsumer=l,te.isContextProvider=S,te.isElement=R,te.isForwardRef=I,te.isFragment=Y,te.isLazy=F,te.isMemo=j,te.isPortal=W,te.isProfiler=X,te.isStrictMode=K,te.isSuspense=ae,te.isValidElementType=k,te.typeOf=H})()),te}var Pt;function St(){return Pt||(Pt=1,process.env.NODE_ENV==="production"?Le.exports=In():Le.exports=Ln()),Le.exports}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var rt,wt;function jn(){if(wt)return rt;wt=1;var e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function n(a){if(a==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(a)}function i(){try{if(!Object.assign)return!1;var a=new String("abc");if(a[5]="de",Object.getOwnPropertyNames(a)[0]==="5")return!1;for(var r={},s=0;s<10;s++)r["_"+String.fromCharCode(s)]=s;var h=Object.getOwnPropertyNames(r).map(function(p){return r[p]});if(h.join("")!=="0123456789")return!1;var f={};return"abcdefghijklmnopqrst".split("").forEach(function(p){f[p]=p}),Object.keys(Object.assign({},f)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}return rt=i()?Object.assign:function(a,r){for(var s,h=n(a),f,p=1;p<arguments.length;p++){s=Object(arguments[p]);for(var y in s)t.call(s,y)&&(h[y]=s[y]);if(e){f=e(s);for(var d=0;d<f.length;d++)o.call(s,f[d])&&(h[f[d]]=s[f[d]])}}return h},rt}var ot,Ct;function at(){if(Ct)return ot;Ct=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ot=e,ot}var it,Ot;function Nt(){return Ot||(Ot=1,it=Function.call.bind(Object.prototype.hasOwnProperty)),it}var st,Mt;function Dn(){if(Mt)return st;Mt=1;var e=function(){};if(process.env.NODE_ENV!=="production"){var t=at(),o={},n=Nt();e=function(a){var r="Warning: "+a;typeof console<"u"&&console.error(r);try{throw new Error(r)}catch{}}}function i(a,r,s,h,f){if(process.env.NODE_ENV!=="production"){for(var p in a)if(n(a,p)){var y;try{if(typeof a[p]!="function"){var d=Error((h||"React class")+": "+s+" type `"+p+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof a[p]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw d.name="Invariant Violation",d}y=a[p](r,p,h,s,null,t)}catch(C){y=C}if(y&&!(y instanceof Error)&&e((h||"React class")+": type specification of "+s+" `"+p+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof y+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),y instanceof Error&&!(y.message in o)){o[y.message]=!0;var w=f?f():"";e("Failed "+s+" type: "+y.message+(w??""))}}}}return i.resetWarningCache=function(){process.env.NODE_ENV!=="production"&&(o={})},st=i,st}var ct,Rt;function Hn(){if(Rt)return ct;Rt=1;var e=St(),t=jn(),o=at(),n=Nt(),i=Dn(),a=function(){};process.env.NODE_ENV!=="production"&&(a=function(s){var h="Warning: "+s;typeof console<"u"&&console.error(h);try{throw new Error(h)}catch{}});function r(){return null}return ct=function(s,h){var f=typeof Symbol=="function"&&Symbol.iterator,p="@@iterator";function y(T){var l=T&&(f&&T[f]||T[p]);if(typeof l=="function")return l}var d="<<anonymous>>",w={array:b("array"),bigint:b("bigint"),bool:b("boolean"),func:b("function"),number:b("number"),object:b("object"),string:b("string"),symbol:b("symbol"),any:A(),arrayOf:k,element:H(),elementType:c(),instanceOf:E,node:$(),objectOf:_,oneOf:g,oneOfType:M,shape:B,exact:Z};function C(T,l){return T===l?T!==0||1/T===1/l:T!==T&&l!==l}function v(T,l){this.message=T,this.data=l&&typeof l=="object"?l:{},this.stack=""}v.prototype=Error.prototype;function O(T){if(process.env.NODE_ENV!=="production")var l={},S=0;function R(Y,F,j,W,X,K,ae){if(W=W||d,K=K||j,ae!==o){if(h){var N=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw N.name="Invariant Violation",N}else if(process.env.NODE_ENV!=="production"&&typeof console<"u"){var ce=W+":"+j;!l[ce]&&S<3&&(a("You are manually calling a React.PropTypes validation function for the `"+K+"` prop on `"+W+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),l[ce]=!0,S++)}}return F[j]==null?Y?F[j]===null?new v("The "+X+" `"+K+"` is marked as required "+("in `"+W+"`, but its value is `null`.")):new v("The "+X+" `"+K+"` is marked as required in "+("`"+W+"`, but its value is `undefined`.")):null:T(F,j,W,X,K)}var I=R.bind(null,!1);return I.isRequired=R.bind(null,!0),I}function b(T){function l(S,R,I,Y,F,j){var W=S[R],X=re(W);if(X!==T){var K=q(W);return new v("Invalid "+Y+" `"+F+"` of type "+("`"+K+"` supplied to `"+I+"`, expected ")+("`"+T+"`."),{expectedType:T})}return null}return O(l)}function A(){return O(r)}function k(T){function l(S,R,I,Y,F){if(typeof T!="function")return new v("Property `"+F+"` of component `"+I+"` has invalid PropType notation inside arrayOf.");var j=S[R];if(!Array.isArray(j)){var W=re(j);return new v("Invalid "+Y+" `"+F+"` of type "+("`"+W+"` supplied to `"+I+"`, expected an array."))}for(var X=0;X<j.length;X++){var K=T(j,X,I,Y,F+"["+X+"]",o);if(K instanceof Error)return K}return null}return O(l)}function H(){function T(l,S,R,I,Y){var F=l[S];if(!s(F)){var j=re(F);return new v("Invalid "+I+" `"+Y+"` of type "+("`"+j+"` supplied to `"+R+"`, expected a single ReactElement."))}return null}return O(T)}function c(){function T(l,S,R,I,Y){var F=l[S];if(!e.isValidElementType(F)){var j=re(F);return new v("Invalid "+I+" `"+Y+"` of type "+("`"+j+"` supplied to `"+R+"`, expected a single ReactElement type."))}return null}return O(T)}function E(T){function l(S,R,I,Y,F){if(!(S[R]instanceof T)){var j=T.name||d,W=ne(S[R]);return new v("Invalid "+Y+" `"+F+"` of type "+("`"+W+"` supplied to `"+I+"`, expected ")+("instance of `"+j+"`."))}return null}return O(l)}function g(T){if(!Array.isArray(T))return process.env.NODE_ENV!=="production"&&(arguments.length>1?a("Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z])."):a("Invalid argument supplied to oneOf, expected an array.")),r;function l(S,R,I,Y,F){for(var j=S[R],W=0;W<T.length;W++)if(C(j,T[W]))return null;var X=JSON.stringify(T,function(ae,N){var ce=q(N);return ce==="symbol"?String(N):N});return new v("Invalid "+Y+" `"+F+"` of value `"+String(j)+"` "+("supplied to `"+I+"`, expected one of "+X+"."))}return O(l)}function _(T){function l(S,R,I,Y,F){if(typeof T!="function")return new v("Property `"+F+"` of component `"+I+"` has invalid PropType notation inside objectOf.");var j=S[R],W=re(j);if(W!=="object")return new v("Invalid "+Y+" `"+F+"` of type "+("`"+W+"` supplied to `"+I+"`, expected an object."));for(var X in j)if(n(j,X)){var K=T(j,X,I,Y,F+"."+X,o);if(K instanceof Error)return K}return null}return O(l)}function M(T){if(!Array.isArray(T))return process.env.NODE_ENV!=="production"&&a("Invalid argument supplied to oneOfType, expected an instance of array."),r;for(var l=0;l<T.length;l++){var S=T[l];if(typeof S!="function")return a("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+V(S)+" at index "+l+"."),r}function R(I,Y,F,j,W){for(var X=[],K=0;K<T.length;K++){var ae=T[K],N=ae(I,Y,F,j,W,o);if(N==null)return null;N.data&&n(N.data,"expectedType")&&X.push(N.data.expectedType)}var ce=X.length>0?", expected one of type ["+X.join(", ")+"]":"";return new v("Invalid "+j+" `"+W+"` supplied to "+("`"+F+"`"+ce+"."))}return O(R)}function $(){function T(l,S,R,I,Y){return z(l[S])?null:new v("Invalid "+I+" `"+Y+"` supplied to "+("`"+R+"`, expected a ReactNode."))}return O(T)}function L(T,l,S,R,I){return new v((T||"React class")+": "+l+" type `"+S+"."+R+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+I+"`.")}function B(T){function l(S,R,I,Y,F){var j=S[R],W=re(j);if(W!=="object")return new v("Invalid "+Y+" `"+F+"` of type `"+W+"` "+("supplied to `"+I+"`, expected `object`."));for(var X in T){var K=T[X];if(typeof K!="function")return L(I,Y,F,X,q(K));var ae=K(j,X,I,Y,F+"."+X,o);if(ae)return ae}return null}return O(l)}function Z(T){function l(S,R,I,Y,F){var j=S[R],W=re(j);if(W!=="object")return new v("Invalid "+Y+" `"+F+"` of type `"+W+"` "+("supplied to `"+I+"`, expected `object`."));var X=t({},S[R],T);for(var K in X){var ae=T[K];if(n(T,K)&&typeof ae!="function")return L(I,Y,F,K,q(ae));if(!ae)return new v("Invalid "+Y+" `"+F+"` key `"+K+"` supplied to `"+I+"`.\nBad object: "+JSON.stringify(S[R],null,"  ")+`
Valid keys: `+JSON.stringify(Object.keys(T),null,"  "));var N=ae(j,K,I,Y,F+"."+K,o);if(N)return N}return null}return O(l)}function z(T){switch(typeof T){case"number":case"string":case"undefined":return!0;case"boolean":return!T;case"object":if(Array.isArray(T))return T.every(z);if(T===null||s(T))return!0;var l=y(T);if(l){var S=l.call(T),R;if(l!==T.entries){for(;!(R=S.next()).done;)if(!z(R.value))return!1}else for(;!(R=S.next()).done;){var I=R.value;if(I&&!z(I[1]))return!1}}else return!1;return!0;default:return!1}}function oe(T,l){return T==="symbol"?!0:l?l["@@toStringTag"]==="Symbol"||typeof Symbol=="function"&&l instanceof Symbol:!1}function re(T){var l=typeof T;return Array.isArray(T)?"array":T instanceof RegExp?"object":oe(l,T)?"symbol":l}function q(T){if(typeof T>"u"||T===null)return""+T;var l=re(T);if(l==="object"){if(T instanceof Date)return"date";if(T instanceof RegExp)return"regexp"}return l}function V(T){var l=q(T);switch(l){case"array":case"object":return"an "+l;case"boolean":case"date":case"regexp":return"a "+l;default:return l}}function ne(T){return!T.constructor||!T.constructor.name?d:T.constructor.name}return w.checkPropTypes=i,w.resetWarningCache=i.resetWarningCache,w.PropTypes=w,w},ct}var lt,It;function zn(){if(It)return lt;It=1;var e=at();function t(){}function o(){}return o.resetWarningCache=t,lt=function(){function n(r,s,h,f,p,y){if(y!==e){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}n.isRequired=n;function i(){return n}var a={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:i,element:n,elementType:n,instanceOf:i,node:n,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:o,resetWarningCache:t};return a.PropTypes=a,a},lt}var Lt;function $n(){if(Lt)return Ie.exports;if(Lt=1,process.env.NODE_ENV!=="production"){var e=St(),t=!0;Ie.exports=Hn()(e.isElement,t)}else Ie.exports=zn()();return Ie.exports}var Bn=$n();const x=vn(Bn),ut={"7.5pt":{pt:7.5,px:10,label:"7.5"},"9pt":{pt:9,px:12,label:"9"},"10pt":{pt:10,px:13,label:"10"},"11pt":{pt:11,px:15,label:"11"},"12pt":{pt:12,px:16,label:"12"},"14pt":{pt:14,px:19,label:"14"},"16pt":{pt:16,px:21,label:"16"},"18pt":{pt:18,px:24,label:"18"},"20pt":{pt:20,px:27,label:"20"},"22pt":{pt:22,px:29,label:"22"},"24pt":{pt:24,px:32,label:"24"},"26pt":{pt:26,px:35,label:"26"},"28pt":{pt:28,px:37,label:"28"},"36pt":{pt:36,px:48,label:"36"},"48pt":{pt:48,px:64,label:"48"},"72pt":{pt:72,px:96,label:"72"}},jt=[{value:"10px",label:"7.5",pt:7.5},{value:"12px",label:"9",pt:9},{value:"13px",label:"10",pt:10},{value:"15px",label:"11",pt:11},{value:"16px",label:"12",pt:12},{value:"19px",label:"14",pt:14},{value:"21px",label:"16",pt:16},{value:"24px",label:"18",pt:18},{value:"27px",label:"20",pt:20},{value:"32px",label:"24",pt:24},{value:"37px",label:"28",pt:28},{value:"48px",label:"36",pt:36},{value:"64px",label:"48",pt:48},{value:"96px",label:"72",pt:72}],Ae="16px",Dt=e=>Math.round(e*96/72),Ht=e=>Math.round(e*72/96*2)/2,Un=e=>{const t=Object.values(ut).find(o=>o.pt===e);return t?`${t.px}px`:`${Dt(e)}px`},Gn=e=>{const t=parseInt(e),o=Object.values(ut).find(n=>n.px===t);return o?o.pt:Ht(t)},Fn=e=>{if(!e)return!1;if(e.endsWith("px")){const t=parseInt(e);return t>=8&&t<=144}if(e.endsWith("pt")){const t=parseFloat(e);return t>=6&&t<=108}return!1},de={minWidth:50,minHeight:50,maxWidth:800,maxHeight:600,aspectRatio:!0,preserveAspectRatio:!0,defaultWidth:300,defaultHeight:200},P={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP:"top",BOTTOM:"bottom",LEFT:"left",RIGHT:"right"};function qn({handler:e,startX:t,startY:o,currentX:n,currentY:i,startWidth:a,startHeight:r,options:s=de}){const h=n-t,f=i-o;let p=a,y=r;switch(e){case P.TOP_LEFT:p=Math.max(s.minWidth,a-h),y=Math.max(s.minHeight,r-f);break;case P.TOP_RIGHT:p=Math.max(s.minWidth,a+h),y=Math.max(s.minHeight,r-f);break;case P.BOTTOM_LEFT:p=Math.max(s.minWidth,a-h),y=Math.max(s.minHeight,r+f);break;case P.BOTTOM_RIGHT:p=Math.max(s.minWidth,a+h),y=Math.max(s.minHeight,r+f);break;case P.TOP:y=Math.max(s.minHeight,r-f);break;case P.BOTTOM:y=Math.max(s.minHeight,r+f);break;case P.LEFT:p=Math.max(s.minWidth,a-h);break;case P.RIGHT:p=Math.max(s.minWidth,a+h);break;default:return{width:p,height:y}}if(s.preserveAspectRatio&&s.aspectRatio){const d=a/r;[P.TOP_LEFT,P.TOP_RIGHT,P.BOTTOM_LEFT,P.BOTTOM_RIGHT].includes(e)?p/d>y?y=Math.max(s.minHeight,p/d):p=Math.max(s.minWidth,y*d):[P.TOP,P.BOTTOM].includes(e)?p=y*d:[P.LEFT,P.RIGHT].includes(e)&&(y=p/d)}return s.maxWidth&&p>s.maxWidth&&(p=s.maxWidth,s.preserveAspectRatio&&s.aspectRatio&&(y=p/(a/r))),s.maxHeight&&y>s.maxHeight&&(y=s.maxHeight,s.preserveAspectRatio&&s.aspectRatio&&(p=y*(a/r))),p=Math.max(s.minWidth,p),y=Math.max(s.minHeight,y),{width:Math.round(p),height:Math.round(y)}}function ue(e){return e?e.tagName==="IMG"?(console.log("Element is an IMG tag, returning true"),!0):!!(e.tagName==="DIV"&&e.style.backgroundImage&&e.style.backgroundImage!=="none"):!1}function Wn(e){return ue(e)?{width:e.offsetWidth,height:e.offsetHeight}:{width:0,height:0}}function Zn(e,{width:t,height:o}){ue(e)&&(e.tagName==="IMG"?(e.style.width=`${t}px`,e.style.height=`${o}px`,e.width=t,e.height=o):e.tagName==="DIV"&&(e.style.width=`${t}px`,e.style.height=`${o}px`))}function dt(e,t=de){if(!ue(e))return null;const o=document.createElement("div");o.className="image-resize-overlay",o.style.position="fixed",o.style.zIndex="1000",o.style.pointerEvents="none";const n=e.getBoundingClientRect();return o.style.top=`${n.top}px`,o.style.left=`${n.left}px`,o.style.width=`${n.width}px`,o.style.height=`${n.height}px`,Object.values(P).forEach(a=>{const r=document.createElement("div");r.className=`resize-handler resize-handler-${a}`,r.dataset.handler=a,r.style.position="absolute",r.style.width="10px",r.style.height="10px",r.style.backgroundColor="#007bff",r.style.border="2px solid white",r.style.borderRadius="50%",r.style.boxShadow="0 0 3px rgba(0,0,0,0.3)",r.style.cursor=Yn(a),r.style.pointerEvents="all",zt(r,a,n.width,n.height),o.appendChild(r)}),o}function Yn(e){switch(e){case P.TOP_LEFT:case P.BOTTOM_RIGHT:return"nwse-resize";case P.TOP_RIGHT:case P.BOTTOM_LEFT:return"nesw-resize";case P.TOP:case P.BOTTOM:return"ns-resize";case P.LEFT:case P.RIGHT:return"ew-resize";default:return"default"}}function zt(e,t,o,n){switch(t){case P.TOP_LEFT:e.style.top="-5px",e.style.left="-5px";break;case P.TOP_RIGHT:e.style.top="-5px",e.style.right="-5px";break;case P.BOTTOM_LEFT:e.style.bottom="-5px",e.style.left="-5px";break;case P.BOTTOM_RIGHT:e.style.bottom="-5px",e.style.right="-5px";break;case P.TOP:e.style.top="-5px",e.style.left=`${o/2+-5}px`;break;case P.BOTTOM:e.style.bottom="-5px",e.style.left=`${o/2+-5}px`;break;case P.LEFT:e.style.top=`${n/2+-5}px`,e.style.left="-5px";break;case P.RIGHT:e.style.top=`${n/2+-5}px`,e.style.right="-5px";break}}function ke(e,t){if(!e||!t)return;const o=t.getBoundingClientRect();e.style.top=`${o.top}px`,e.style.left=`${o.left}px`,e.style.width=`${o.width}px`,e.style.height=`${o.height}px`,e.querySelectorAll(".resize-handler").forEach(i=>{const a=i.dataset.handler;zt(i,a,o.width,o.height)})}function he(e){e&&e.parentNode&&e.parentNode.removeChild(e)}const Vn={"10px":"1","12px":"2","13px":"2","15px":"3","16px":"3","19px":"4","21px":"4","24px":"5","27px":"5","32px":"6","37px":"6","48px":"6","64px":"7","96px":"7"},$t={bold:!1,italic:!1,underline:!1,strikethrough:!1,alignLeft:!1,alignCenter:!1,alignRight:!1,alignJustify:!1,fontFamily:"Arial",fontSize:Ae,headingLevel:"p",imageSelected:!1,imageResizeOptions:de,preserveAspectRatio:!0},Bt=()=>{const[e,t]=m.useState($t),o=Ee(),n=m.useCallback(b=>{try{const A=window.getSelection();if(!A||A.rangeCount===0)return!1;const k=A.getRangeAt(0);if(!k.toString())return t(c=>({...c,fontFamily:b})),!1;try{const c=document.createElement("span");c.style.fontFamily=b;const E=k.extractContents();return c.appendChild(E),k.insertNode(c),k.selectNodeContents(c),A.removeAllRanges(),A.addRange(k),t(g=>({...g,fontFamily:b})),!0}catch{return document.execCommand("fontName",!1,b),t(E=>({...E,fontFamily:b})),!0}}catch(A){return console.warn("[useFormatting] Font family change failed:",A),!1}},[]),i=m.useCallback(b=>{try{const A=window.getSelection();if(!A||A.rangeCount===0)return!1;const k=A.getRangeAt(0);if(!k.toString())return t(c=>({...c,fontSize:b})),!1;try{const c=document.createElement("span");c.style.fontSize=b;const E=k.extractContents();return c.appendChild(E),k.insertNode(c),k.selectNodeContents(c),A.removeAllRanges(),A.addRange(k),t(g=>({...g,fontSize:b})),!0}catch{const E=Vn[b]||"3";return document.execCommand("fontSize",!1,E),t(g=>({...g,fontSize:b})),!0}}catch(A){return console.warn("[useFormatting] Font size change failed:",A),!1}},[]),a=m.useCallback(b=>{try{const A=window.getSelection();if(!A||A.rangeCount===0)return!1;const k=A.getRangeAt(0),H=k.toString(),E={justifyLeft:"left",justifyCenter:"center",justifyRight:"right",justifyFull:"justify"}[b];if(!E)return!1;if(!H){const _=k.startContainer,M=_.nodeType===Node.TEXT_NODE?_.parentElement:_,$=je(M)||Xn();return $&&($.style.textAlign=E,r(E)),!0}const g=Kn(k);if(g.length===0){const _=document.createElement("p");_.style.textAlign=E;const M=k.extractContents();_.appendChild(M),k.insertNode(_),k.selectNodeContents(_),A.removeAllRanges(),A.addRange(k)}else g.forEach(_=>{_.style.textAlign=E});return r(E),!0}catch(A){return console.warn("[useFormatting] Text alignment failed:",A),!1}},[]),r=m.useCallback(b=>{t(A=>({...A,alignLeft:b==="left",alignCenter:b==="center",alignRight:b==="right",alignJustify:b==="justify"}))},[]),s=m.useCallback((b,A=null)=>{try{if(b==="undo"){o.undo();return}if(b==="redo"){o.redo();return}if(typeof document.execCommand!="function"){console.warn("[useFormatting] execCommand not supported");return}if(b==="fontSize"){i(A);return}if(b==="fontName"){n(A);return}if(["justifyLeft","justifyCenter","justifyRight","justifyFull"].includes(b)){a(b);return}switch(document.execCommand(b,!1,A)||console.warn(`[useFormatting] Command "${b}" failed`),b){case"bold":case"italic":case"underline":case"strikethrough":case"justifyLeft":case"justifyCenter":case"justifyRight":case"justifyFull":case"fontName":break;case"formatBlock":t(H=>({...H,headingLevel:A}));break;default:break}}catch(k){console.warn(`[useFormatting] Error executing command "${b}":`,k)}},[i,n,o]),h=m.useRef(null),f=m.useRef(null),p=m.useRef(null),y=m.useRef(null),d=m.useRef(de);m.useCallback(b=>{if(!ue(b))return;h.current&&(he(h.current),h.current=null),b.classList.add("selected");const A=dt(b);A&&(h.current=A,f.current=b,document.body.appendChild(A),t(k=>({...k,imageSelected:!0,preserveAspectRatio:d.current.preserveAspectRatio})))},[]);const w=m.useCallback(()=>{f.current&&(f.current.classList.remove("selected"),f.current=null),h.current&&(he(h.current),h.current=null),p.current=null,y.current=null,t(b=>({...b,imageSelected:!1}))},[]),C=m.useCallback(()=>{const b=!d.current.preserveAspectRatio;d.current={...d.current,preserveAspectRatio:b,aspectRatio:b},t(A=>({...A,preserveAspectRatio:b}))},[]);m.useCallback((b,A,k)=>{f.current&&(p.current={x:A,y:k,width:f.current.offsetWidth,height:f.current.offsetHeight},y.current=b,document.body.classList.add("resize-in-progress"),document.body.style.cursor=Jn(b))},[]),m.useCallback((b,A)=>{if(!f.current||!p.current||!y.current)return;const{x:k,y:H,width:c,height:E}=p.current,g=y.current,_=Qn({handler:g,startX:k,startY:H,currentX:b,currentY:A,startWidth:c,startHeight:E,options:d.current});er(f.current,_),h.current&&ke(h.current,f.current)},[]),m.useCallback(()=>{if(p.current=null,y.current=null,document.body.classList.remove("resize-in-progress"),document.body.style.cursor="",f.current){const b=new Event("input",{bubbles:!0,cancelable:!0});f.current.dispatchEvent(b)}},[]);const v=m.useCallback(()=>{try{const b=window.getSelection();if(!b||b.rangeCount===0)return;const A=b.getRangeAt(0),k=A.toString();let H=Ae,c="Arial",E="p",g="left";if(k){const M=A.startContainer,$=M.nodeType===Node.TEXT_NODE?M.parentElement:M;if($){const L=window.getComputedStyle($),B=L.fontSize,Z=L.fontFamily;B&&B.endsWith("px")&&(H=B),Z&&Z!=="serif"&&(c=Z.split(",")[0].replace(/['"]/g,"").trim());const z=je($);if(z){const oe=z.tagName?.toLowerCase();["h1","h2","h3","h4","h5","h6","p"].includes(oe)&&(E=oe);const q=window.getComputedStyle(z).textAlign;["left","center","right","justify"].includes(q)&&(g=q)}}}const _={bold:document.queryCommandState("bold"),italic:document.queryCommandState("italic"),underline:document.queryCommandState("underline"),strikethrough:document.queryCommandState("strikethrough"),alignLeft:g==="left",alignCenter:g==="center",alignRight:g==="right",alignJustify:g==="justify",fontFamily:c,fontSize:H,headingLevel:E};t(M=>({...M,..._}))}catch(b){console.warn("[useFormatting] Error updating format from selection:",b)}},[]),O=m.useCallback(()=>{w(),t($t)},[w]);return m.useEffect(()=>()=>{h.current&&he(h.current)},[]),{currentFormat:e,formatText:s,resetFormat:O,updateCurrentFormatFromSelection:v,toggleAspectRatio:C}};function je(e){let t=e;for(;t&&t!==document.body;){const o=t.tagName?.toLowerCase();if(["h1","h2","h3","h4","h5","h6","p"].includes(o))return t;if(t.contentEditable==="true"||t.contentEditable==="")break;t=t.parentElement}return null}function Kn(e){const t=[],o=e.startContainer,n=e.endContainer,i=je(o.nodeType===Node.TEXT_NODE?o.parentElement:o),a=je(n.nodeType===Node.TEXT_NODE?n.parentElement:n);if(i===a&&i)return[i];const r=document.createTreeWalker(e.commonAncestorContainer,NodeFilter.SHOW_ELEMENT,{acceptNode:h=>{const f=h.tagName?.toLowerCase();return["h1","h2","h3","h4","h5","h6","p"].includes(f)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});let s=r.nextNode();for(;s;)e.intersectsNode(s)&&t.push(s),s=r.nextNode();return t}function Xn(){try{const e=window.getSelection();if(!e||e.rangeCount===0)return null;const t=e.getRangeAt(0),o=document.createElement("p");return o.innerHTML="<br>",t.insertNode(o),t.selectNodeContents(o),t.collapse(!0),e.removeAllRanges(),e.addRange(t),o}catch(e){return console.warn("[useFormatting] Failed to create paragraph at cursor:",e),null}}function Jn(e){switch(e){case P.TOP_LEFT:case P.BOTTOM_RIGHT:return"nwse-resize";case P.TOP_RIGHT:case P.BOTTOM_LEFT:return"nesw-resize";case RESIZE_HANDLRES.TOP:case P.BOTTOM:return"ns-resize";case P.LEFT:case P.RIGHT:return"ew-resize";default:return"default"}}function Qn({handler:e,startX:t,startY:o,currentX:n,currentY:i,startWidth:a,startHeight:r,options:s=de}){const h=n-t,f=i-o;let p=a,y=r;switch(e){case P.TOP_LEFT:p=Math.max(s.minWidth,a-h),y=Math.max(s.minHeight,r-f);break;case P.TOP_RIGHT:p=Math.max(s.minWidth,a+h),y=Math.max(s.minHeight,r-f);break;case P.BOTTOM_LEFT:p=Math.max(s.minWidth,a-h),y=Math.max(s.minHeight,r+f);break;case P.BOTTOM_RIGHT:p=Math.max(s.minWidth,a+h),y=Math.max(s.minHeight,r+f);break;case P.TOP:y=Math.max(s.minHeight,r-f);break;case P.BOTTOM:y=Math.max(s.minHeight,r+f);break;case P.LEFT:p=Math.max(s.minWidth,a-h);break;case P.RIGHT:p=Math.max(s.minWidth,a+h);break;default:return{width:p,height:y}}if(s.preserveAspectRatio&&s.aspectRatio){const d=a/r;[P.TOP_LEFT,P.TOP_RIGHT,P.BOTTOM_LEFT,P.BOTTOM_RIGHT].includes(e)?p/d>y?y=Math.max(s.minHeight,p/d):p=Math.max(s.minWidth,y*d):[P.TOP,P.BOTTOM].includes(e)?p=y*d:[P.LEFT,P.RIGHT].includes(e)&&(y=p/d)}return s.maxWidth&&p>s.maxWidth&&(p=s.maxWidth,s.preserveAspectRatio&&s.aspectRatio&&(y=p/(a/r))),s.maxHeight&&y>s.maxHeight&&(y=s.maxHeight,s.preserveAspectRatio&&s.aspectRatio&&(p=y*(a/r))),p=Math.max(s.minWidth,p),y=Math.max(s.minHeight,y),{width:Math.round(p),height:Math.round(y)}}function er(e,{width:t,height:o}){ue(e)&&(e.tagName==="IMG"?(e.style.width=`${t}px`,e.style.height=`${o}px`,e.width=t,e.height=o):e.tagName==="DIV"&&(e.style.width=`${t}px`,e.style.height=`${o}px`))}const be='page-break, [data-page-break="true"]',Ut=e=>se[e]||se.A4,tr=(e,t={})=>{if(!e||typeof document>"u")return[];const o=t.pageSize||"A4",n=Ut(o),i=e.querySelectorAll(be),a=[];a.push({id:"page-0",pageNumber:1,top:0,height:n.height});const r=e.getBoundingClientRect(),s=e.scrollTop;return i.forEach((h,f)=>{const y=h.getBoundingClientRect().top-r.top+s;a.push({id:`page-${f+1}`,pageNumber:f+2,top:y,height:n.height})}),a},Gt=(e,t=100,o=fe)=>{const n=Ut(e),i=Pn(o),a=n.height-i,r=t/100;return a/r},nr=(e,t)=>{if(!e||!t)return 0;try{const o=t.querySelectorAll(be);if(o.length===0)return 0;const n=e.getBoundingClientRect(),i=n.top+n.height/2;for(let a=o.length-1;a>=0;a--)if(o[a].getBoundingClientRect().top<i)return a+1;return 0}catch(o){return console.warn("[getCurrentPage] Failed to calculate page:",o),0}},Ft=e=>{if(!e)return[];const t=Array.from(e.children);if(t.length===0)return[];let o=[],n=[];for(const i of t)i.tagName==="PAGE-BREAK"||i.getAttribute("data-page-break")==="true"?n.length>0&&(o.push(n),n=[]):n.push(i);return n.length>0&&o.push(n),o.length===0&&t.length>0&&o.push(t.filter(i=>!(i.tagName==="PAGE-BREAK"||i.getAttribute("data-page-break")==="true"))),o},rr=e=>{if(!e||!e.getBoundingClientRect)return 0;const t=e.getBoundingClientRect();return e.tagName==="P"?t.height+16:e.tagName==="H1"||e.tagName==="H2"||e.tagName==="H3"||e.tagName==="H4"||e.tagName==="H5"||e.tagName==="H6"?t.height+20:e.tagName==="UL"||e.tagName==="OL"?t.height+16:t.height},or=(e,t)=>{if(!e)return!1;try{const o=document.createElement("page-break");return o.setAttribute("data-page-break","true"),o.setAttribute("contenteditable","false"),o.setAttribute("data-page-number",t||"2"),e.parentNode.insertBefore(o,e),!0}catch(o){return console.warn("[insertPageBreakBefore] Failed to insert page break:",o),!1}},ar=(e,t,o,n,i,a,r)=>{if(!e)return!1;try{const h=Gt(o,n,i)*(t-1),f=Array.from(e.children);let p=0,y=null;for(let d=0;d<f.length;d++){const w=f[d];if(w.tagName==="PAGE-BREAK"||w.getAttribute("data-page-break")==="true")continue;const C=rr(w);if(p+C>h){y=w;break}p+=C}if(y){const d=document.createElement("page-break");if(d.setAttribute("data-page-break","true"),d.setAttribute("contenteditable","false"),d.setAttribute("data-page-number",String(t)),y.parentNode.insertBefore(d,y),a){const w=e.innerHTML;a(w)}return r&&setTimeout(()=>{r()},50),!0}else{const d=document.createElement("page-break");d.setAttribute("data-page-break","true"),d.setAttribute("contenteditable","false"),d.setAttribute("data-page-number",String(t)),e.appendChild(d);const w=document.createElement("p");if(w.innerHTML="<br>",e.appendChild(w),a){const C=e.innerHTML;a(C)}return r&&setTimeout(()=>{r()},50),!0}}catch(s){return console.error("[insertPageBreakAtBoundary] Failed to insert page break:",s),!1}},ir=(e,t,o,n,i,a,r)=>{if(!e)return!1;if(o().length<=1)return console.warn("[removePageAndContent] Cannot delete the only page"),!1;try{const h=Array.from(e.querySelectorAll(be));if(t>h.length)return console.warn("[removePageAndContent] Invalid page index"),!1;const f=window.getSelection();let p=!1,y=[],d=null;if(t===0){const C=h[0];if(!C)return console.warn("[removePageAndContent] No page break found for first page"),!1;let v=e.firstChild;for(;v&&v!==C;)y.push(v),v=v.nextSibling;d=C}else{const C=h[t-1];if(!C)return console.warn("[removePageAndContent] Page break not found"),!1;const v=h[t];let O=C.nextSibling;for(;O&&O!==v;)y.push(O),O=O.nextSibling;d=C}if(f&&f.rangeCount>0){const v=f.getRangeAt(0).startContainer;for(const O of y)if(O.contains(v)||O===v){p=!0;break}}if(d&&d.parentNode&&d.remove(),y.forEach(C=>{C.parentNode&&C.remove()}),e.querySelectorAll(be).forEach((C,v)=>{C.setAttribute("data-page-number",String(v+2))}),p&&a&&setTimeout(()=>{a(0)},50),n){const C=e.innerHTML;n(C)}return i&&setTimeout(()=>{i(),r&&setTimeout(()=>{r()},150)},100),!0}catch(h){return console.error("[removePageAndContent] Failed to remove page:",h),!1}},sr=200,cr=50,qt=3,lr=20,Wt=e=>{if(!e||!e.getBoundingClientRect)return 0;const t=e.getBoundingClientRect();return e.tagName==="P"?t.height+16:e.tagName==="H1"||e.tagName==="H2"||e.tagName==="H3"||e.tagName==="H4"||e.tagName==="H5"||e.tagName==="H6"?t.height+20:e.tagName==="UL"||e.tagName==="OL"?t.height+16:t.height},ur=(e,t)=>{if(!e||e.length===0)return null;let o=0,n=null;for(let i=0;i<e.length;i++){const a=e[i];if(!a||!a.getBoundingClientRect)continue;const r=Wt(a);if(r<1)continue;if(o+r>t)return n===null?i>0?{overflowIndex:i,overflowElement:a,accumulatedHeight:o}:null:{overflowIndex:i,overflowElement:a,accumulatedHeight:o};o+=r,n=a}return null},dr=(e,t,o,n,i,a,r,s)=>{if(!e||r.current)return!1;try{r.current=!0;const h=Gt(t,o,n);let f=Ft(e),p=!1,y=0;for(let d=0;d<f.length&&y<qt;d++){const w=f[d],C=ur(w,h);if(C&&C.overflowIndex>0){let v=0;for(let k=0;k<w.length;k++){const H=w[k];H&&H.getBoundingClientRect&&(v+=Wt(H))}if(v-h<lr)continue;const b=d+2;or(C.overflowElement,b)&&(p=!0,y++,f=Ft(e))}}if(p){if(i){const d=e.innerHTML;i(d)}setTimeout(()=>{a&&a(),y>=qt&&s&&setTimeout(()=>{r.current||s()},100)},cr)}return p}catch(h){return console.warn("[checkAndReflow] Reflow failed:",h),!1}finally{r.current=!1}},fr=(e,t,o=sr)=>{t.current&&clearTimeout(t.current),t.current=setTimeout(()=>{t.current=null,e()},o)},pr=400,Zt=(e,t)=>{if(e){e.focus();try{let o=null,n=0;if(t===0)o=e.firstChild,n=0;else{const a=e.querySelectorAll(be)[t-1];a&&a.nextSibling&&(o=a.nextSibling,n=0)}if(o){const i=document.createRange(),a=window.getSelection();o.nodeType===Node.TEXT_NODE?i.setStart(o,n):i.setStart(o,0),i.collapse(!0),a.removeAllRanges(),a.addRange(i)}}catch(o){console.warn("[positionCursorAtPage] Failed to position cursor:",o)}}},gr=(e,t,o,n)=>{if(!e||!t){console.warn("[scrollToPage] Missing refs");return}try{let i=null;if(o===0)i=t;else{const r=t.querySelectorAll(be)[o-1];if(r)i=r;else{console.warn("[scrollToPage] Page break not found for page",o);return}}if(i){const a=i.getBoundingClientRect(),r=e.getBoundingClientRect(),s=e.scrollTop+(a.top-r.top);console.log("[scrollToPage] Scrolling to page",o,"scrollTop:",s),e.scrollTo({top:s,behavior:"smooth"}),setTimeout(()=>{n?n(o):Zt(t,o)},pr)}}catch(i){console.error("[scrollToPage] Error:",i)}},hr=(e,t,o={},n=300)=>{t.current&&clearTimeout(t.current),t.current=setTimeout(()=>{t.current=null,e(o)},Math.max(0,n))},mr=300,Yt=(e,t,o=100,n="NARROW")=>{const i=Ee(),a=m.useRef(null),r=m.useRef(null),s=m.useRef(e),h=m.useRef(o),f=m.useRef(n),p=m.useRef(!1);m.useEffect(()=>{s.current=e},[e]),m.useEffect(()=>{h.current=o},[o]),m.useEffect(()=>{f.current=n},[n]),m.useEffect(()=>()=>{a.current&&clearTimeout(a.current),r.current&&clearTimeout(r.current)},[]);const y=m.useCallback((c={})=>t?.current?tr(t.current,c):[],[t]),d=m.useCallback((c={})=>{const E=y(c);return i.updatePageBoundaries(E),E},[y,i]),w=m.useCallback(async c=>{if(!t?.current)return!1;const E=s.current||"A4",g=h.current||100,_=f.current||"NARROW";return ar(t.current,c,E,g,_,i.updateContinuousContent,d)},[t,i,d]),C=m.useCallback(()=>{if(!t?.current)return;const c=s.current||"A4",E=h.current||100,g=f.current||"NARROW";dr(t.current,c,E,g,i.updateContinuousContent,d,p,C)},[t,i,d]),v=m.useCallback(c=>{fr(C,r,c)},[C]),O=m.useCallback((c={})=>{const E=typeof c.delay=="number"?c.delay:mr;hr(d,a,c,E)},[d]),b=m.useCallback(c=>!c?.current||!t?.current?0:nr(c.current,t.current),[t]),A=m.useCallback(c=>{t?.current&&Zt(t.current,c)},[t]),k=m.useCallback((c,E)=>{if(!E?.current||!t?.current){console.warn("[scrollToPage] Missing refs");return}gr(E.current,t.current,c,A)},[t,A]),H=m.useCallback(c=>t?.current?ir(t.current,c,y,i.updateContinuousContent,d,A,C):!1,[t,y,i,d,A,C]);return{calculatePageBoundaries:y,checkAndUpdateBoundaries:O,updateBoundaries:d,getCurrentPage:b,scrollToPage:k,positionCursorAtPage:A,checkAndReflow:C,triggerAutoReflow:v,removePageAndContent:H,insertPageBreakAtBoundary:w,boundaryTimeoutRef:a,reflowTimeoutRef:r}},yr="html-editor-storage",Er=1,le="images";function br(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function Pe(){return new Promise((e,t)=>{const o=indexedDB.open(yr,Er);o.onerror=()=>{t(new Error("Failed to open IndexedDB database"))},o.onsuccess=()=>{e(o.result)},o.onupgradeneeded=n=>{const i=n.target.result;i.objectStoreNames.contains(le)||i.createObjectStore(le,{keyPath:"key"}).createIndex("timestamp","timestamp",{unique:!1})}})}function Vt(e){return new Promise((t,o)=>{if(!["image/png","image/jpeg","image/gif","image/webp"].includes(e.type)){o(new Error("Invalid image format. Supported formats: png, jpeg, gif, webp"));return}if(e.size>5*1024*1024){o(new Error("Image exceeds maximum size of 5MB"));return}const i=new FileReader;i.onload=async a=>{const r=a.target.result,h=r.split(",")[1].length*3/4;if(h>5*1024*1024){o(new Error("Image exceeds maximum size of 5MB"));return}try{const f=await Pe(),p=`editor-image-${br()}`,d=f.transaction([le],"readwrite").objectStore(le),w={key:p,dataUrl:r,size:h,type:e.type,timestamp:Date.now()},C=d.add(w);C.onsuccess=()=>{f.close(),t(p)},C.onerror=()=>{f.close(),o(new Error("Failed to save image to IndexedDB"))}}catch(f){o(f)}},i.onerror=()=>{o(new Error("Error reading image file"))},i.readAsDataURL(e)})}async function Kt(e){try{const t=await Pe();return new Promise((o,n)=>{const r=t.transaction([le],"readonly").objectStore(le).get(e);r.onsuccess=()=>{t.close();const s=r.result;o(s?s.dataUrl:null)},r.onerror=()=>{t.close(),n(new Error("Failed to retrieve image from IndexedDB"))}})}catch(t){return console.error("Error getting image:",t),null}}async function Xt(e){try{const t=await Pe();return new Promise((o,n)=>{const r=t.transaction([le],"readwrite").objectStore(le).delete(e);r.onsuccess=()=>{t.close(),o()},r.onerror=()=>{t.close(),n(new Error("Failed to delete image from IndexedDB"))}})}catch(t){console.error("Error deleting image:",t)}}async function Tr(){try{const e=await Pe();return new Promise((t,o)=>{const a=e.transaction([le],"readwrite").objectStore(le).clear();a.onsuccess=()=>{e.close(),t()},a.onerror=()=>{e.close(),o(new Error("Failed to clear images from IndexedDB"))}})}catch(e){console.error("Error clearing images:",e)}}async function vr(){try{const e=await Pe();return new Promise((t,o)=>{const a=e.transaction([le],"readonly").objectStore(le).getAllKeys();a.onsuccess=()=>{e.close(),t(a.result||[])},a.onerror=()=>{e.close(),o(new Error("Failed to get image keys from IndexedDB"))}})}catch(e){return console.error("Error getting image keys:",e),[]}}const xr=["SPAN","STRONG","EM","B","I","U","S","STRIKE","DEL","INS","SUB","SUP","MARK","SMALL","CODE","KBD","SAMP","VAR","A","ABBR","CITE","DFN","TIME"],_r=["BR","HR","IMG","INPUT","PAGE-BREAK"];function Ar(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}function Jt(e){const t=[];for(let o=0;o<e.attributes.length;o++){const n=e.attributes[o];t.push(` ${n.name}="${n.value}"`)}return t.join("")}function De(e){if(!e||typeof e!="string")return"<p><br></p>";const t=e.trim();if(!t)return"<p><br></p>";const o=document.createElement("div");return o.innerHTML=t,Se(o)||"<p><br></p>"}function kr(e){const t=e.cloneNode(!0);return t.querySelectorAll(":scope > p").forEach(n=>{for(;n.firstChild;)t.insertBefore(n.firstChild,n);n.remove()}),t.innerHTML}function Se(e){const t=[],o=Array.from(e.childNodes);for(let n=0;n<o.length;n++){const i=o[n];if(i.nodeType===Node.TEXT_NODE){const a=i.textContent.trim();a&&t.push(`<p>${Ar(a)}</p>`)}else if(i.nodeType===Node.ELEMENT_NODE){const a=i,r=a.tagName,s=r.toLowerCase(),h=Jt(a);if(r==="DIV"){const f=Se(a);f.trim()?t.push(f):t.push("<p><br></p>")}else if(r==="P")t.push(a.outerHTML);else if(["H1","H2","H3","H4","H5","H6"].includes(r)){const f=kr(a);t.push(`<${s}${h}>${f}</${s}>`)}else if(r==="BR")t.push("<p><br></p>");else if(r==="IMG")t.push(a.outerHTML);else if(["UL","OL"].includes(r))t.push(Pr(a));else if(r==="LI")t.push(a.outerHTML);else if(r==="TABLE")t.push(Sr(a));else if(["TBODY","THEAD","TFOOT","TR","TD","TH"].includes(r))t.push(a.outerHTML);else if(r==="BLOCKQUOTE"){const f=Se(a);t.push(`<blockquote${h}>${f}</blockquote>`)}else if(r==="PRE")t.push(a.outerHTML);else if(xr.includes(r))t.push(a.outerHTML);else if(r==="PAGE-BREAK"||a.getAttribute("data-page-break")==="true")t.push(a.outerHTML);else if(r==="HR")t.push(a.outerHTML);else if(r==="FIGURE")t.push(a.outerHTML);else if(_r.includes(r))t.push(a.outerHTML);else{const f=Se(a);t.push(`<${s}${h}>${f}</${s}>`)}}}return t.length===0?"":t.join("")}function Pr(e){const t=e.tagName.toLowerCase(),o=Jt(e),n=[];return Array.from(e.children).forEach(i=>{if(i.tagName==="LI")n.push(i.outerHTML);else{const a=Se(i);a.trim()&&n.push(`<li>${a}</li>`)}}),n.length===0?`<${t}${o}><li><br></li></${t}>`:`<${t}${o}>${n.join("")}</${t}>`}function Sr(e){return e.outerHTML}/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Cr=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,o,n)=>n?n.toUpperCase():o.toLowerCase()),Qt=e=>{const t=Cr(e);return t.charAt(0).toUpperCase()+t.slice(1)},en=(...e)=>e.filter((t,o,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===o).join(" ").trim(),Or=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Nr={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=m.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:o=2,absoluteStrokeWidth:n,className:i="",children:a,iconNode:r,...s},h)=>m.createElement("svg",{ref:h,...Nr,width:t,height:t,stroke:e,strokeWidth:n?Number(o)*24/Number(t):o,className:en("lucide",i),...!a&&!Or(s)&&{"aria-hidden":"true"},...s},[...r.map(([f,p])=>m.createElement(f,p)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=(e,t)=>{const o=m.forwardRef(({className:n,...i},a)=>m.createElement(Mr,{ref:a,iconNode:t,className:en(`lucide-${wr(Qt(e))}`,`lucide-${e}`,n),...i}));return o.displayName=Qt(e),o};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rr=J("bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ir=J("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lr=J("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jr=J("file-check",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=J("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dr=J("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hr=J("heading-1",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=J("heading-2",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $r=J("heading-3",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17.5 10.5c1.7-1 3.5 0 3.5 1.5a2 2 0 0 1-2 2",key:"68ncm8"}],["path",{d:"M17 17.5c2 1.5 4 .3 4-1.5a2 2 0 0 0-2-2",key:"1ejuhz"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Br=J("image-upscale",[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M17 21h2a2 2 0 0 0 2-2",key:"130fy9"}],["path",{d:"M21 12v3",key:"1wzk3p"}],["path",{d:"m21 3-5 5",key:"1g5oa7"}],["path",{d:"M3 7V5a2 2 0 0 1 2-2",key:"kk3yz1"}],["path",{d:"m5 21 4.144-4.144a1.21 1.21 0 0 1 1.712 0L13 19",key:"fyekpt"}],["path",{d:"M9 3h3",key:"d52fa"}],["rect",{x:"3",y:"11",width:"10",height:"10",rx:"1",key:"1wpmix"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ur=J("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=J("italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fr=J("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qr=J("list-indent-decrease",[["path",{d:"M21 5H11",key:"us1j55"}],["path",{d:"M21 12H11",key:"wd7e0v"}],["path",{d:"M21 19H11",key:"saa85w"}],["path",{d:"m7 8-4 4 4 4",key:"o5hrat"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wr=J("list-indent-increase",[["path",{d:"M21 5H11",key:"us1j55"}],["path",{d:"M21 12H11",key:"wd7e0v"}],["path",{d:"M21 19H11",key:"saa85w"}],["path",{d:"m3 8 4 4-4 4",key:"1a3j6y"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zr=J("list-ordered",[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tn=J("list",[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yr=J("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vr=J("redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=J("scaling",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M14 15H9v-5",key:"pi4jk9"}],["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M21 3 9 15",key:"15kdhq"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xr=J("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=J("strikethrough",[["path",{d:"M16 4H9a3 3 0 0 0-2.83 4",key:"43sutm"}],["path",{d:"M14 12a4 4 0 0 1 0 8H6",key:"nlfj13"}],["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qr=J("table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nn=J("text-align-center",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 19H5",key:"vjpgq2"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=J("text-align-end",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 19H7",key:"4cu937"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eo=J("text-align-justify",[["path",{d:"M3 5h18",key:"1u36vt"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 19h18",key:"awlh7x"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const on=J("text-align-start",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const to=J("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const no=J("underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=J("undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oo=J("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ao=J("zoom-in",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const io=J("zoom-out",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),an=({editorView:e,isCollapsed:t,onToggle:o,wordCount:n,pageCount:i})=>{const a=nt(),{pages:r,activePage:s,continuousContent:h,editorMode:f}=a,[p,y]=m.useState(0),[d,w]=m.useState([]);m.useEffect(()=>{if(n!==void 0&&i!==void 0){if(y(n),h){const b=document.createElement("div");b.innerHTML=h;const A=b.querySelectorAll("h1, h2, h3, h4, h5, h6"),k=Array.from(A).map((H,c)=>{const E=parseInt(H.tagName.charAt(1)),g=H.textContent.trim();return g?{id:`heading-${c}`,level:E,text:g,page:1}:null}).filter(Boolean);w(k)}return}let v=0;const O=[];r.forEach((b,A)=>{if(b.content){const k=document.createElement("div");k.innerHTML=b.content;const c=(k.textContent||k.innerText||"").trim().split(/\s+/).filter(g=>g.length>0);v+=c.length,k.querySelectorAll("h1, h2, h3, h4, h5, h6").forEach((g,_)=>{const M=parseInt(g.tagName.charAt(1)),$=g.textContent.trim();$&&O.push({id:`heading-${A}-${_}`,level:M,text:$,page:A+1})})}}),y(v),w(O)},[r,n,i,h]);const C=i!==void 0?i:r.length;return u.jsxs("aside",{className:`sidebar ${t?"collapsed":""}`,role:"complementary","aria-label":"Document information","data-testid":"sidebar",children:[u.jsxs("div",{className:"sidebar-header",children:[u.jsxs("div",{className:"sidebar-title",children:[u.jsx(He,{size:18}),u.jsx("h2",{children:"Document Info"})]}),u.jsx("button",{className:"sidebar-toggle",onClick:o,"aria-label":t?"Expand sidebar":"Collapse sidebar",title:t?"Expand sidebar":"Collapse sidebar",children:t?u.jsx(Lr,{size:16}):u.jsx(Ir,{size:16})})]}),!t&&u.jsxs("div",{className:"sidebar-content",children:[u.jsxs("div",{className:"sidebar-section",children:[u.jsx("h3",{children:"Statistics"}),u.jsxs("div",{className:"stat-item",children:[u.jsxs("div",{className:"stat-label",children:[u.jsx(jr,{size:14}),u.jsx("span",{children:"Pages:"})]}),u.jsx("span",{className:"stat-value",children:C})]}),u.jsxs("div",{className:"stat-item","data-testid":"word-count",children:[u.jsxs("div",{className:"stat-label",children:[u.jsx(Dr,{size:14}),u.jsx("span",{children:"Words:"})]}),u.jsx("span",{className:"stat-value",children:p.toLocaleString()})]}),u.jsxs("div",{className:"stat-item",children:[u.jsxs("div",{className:"stat-label",children:[u.jsx(He,{size:14}),u.jsx("span",{children:"Active Page:"})]}),u.jsx("span",{className:"stat-value",children:s+1})]})]}),d.length>0&&u.jsxs("div",{className:"sidebar-section",children:[u.jsxs("h3",{children:[u.jsx(tn,{size:14,style:{display:"inline-block",marginRight:"6px",verticalAlign:"middle"}}),"Document Outline"]}),u.jsx("div",{className:"document-outline","data-testid":"outline",children:d.map(v=>{const O=v.level===1?Hr:v.level===2?zr:$r;return u.jsxs("div",{className:`outline-item outline-level-${v.level}`,style:{marginLeft:`${(v.level-1)*12}px`},children:[u.jsx(O,{size:12,className:"outline-icon"}),u.jsx("span",{className:"outline-text",children:v.text}),u.jsxs("span",{className:"outline-page",children:["p.",v.page]})]},v.id)})})]}),u.jsxs("div",{className:"sidebar-section",children:[u.jsx("h3",{children:"Document"}),u.jsx("p",{children:"HTML Editor"}),u.jsx("p",{children:"Multi-page support"})]})]})]})};class sn{constructor(t="Editor"){this.namespace=t}_format(t,o,n){return`[${new Date().toISOString()}] [${this.namespace}] [${t}] ${o}`}info(t,o){}warn(t,o){}error(t,o){}debug(t,o){}}const cn=new sn("Editor"),ln=new Set(["P","DIV","H1","H2","H3","H4","H5","H6","LI","BLOCKQUOTE","PRE","TABLE"]),un=32;function dn(e,t){if(!e)return;e.dataset||(e.dataset={}),e.style||(e.style={});const o=parseInt(e.dataset.indentLevel||"0",10),n=Math.max(0,t?o-1:o+1);n===0?(e.style.marginLeft="",delete e.dataset.indentLevel):(e.style.marginLeft=`${n*un}px`,e.dataset.indentLevel=String(n))}function so(e,t){dn(e,t)}function co(e){let t=e;for(;t;){if(t.nodeType===1&&t.tagName&&ln.has(t.tagName.toUpperCase()))return t;t=t.parentElement||t.parentNode}return null}function lo(){const e=window.getSelection();if(!e||e.rangeCount===0)return[];const t=e.getRangeAt(0),o=new Set;let n=t.commonAncestorContainer;for(n.nodeType===Node.TEXT_NODE&&(n=n.parentElement);n&&n.contentEditable!=="true";)n=n.parentElement;return n?(n.querySelectorAll("p, div, h1, h2, h3, h4, h5, h6, li, blockquote, pre, table").forEach(r=>{document.createRange().selectNodeContents(r),t.intersectsNode(r)&&o.add(r)}),o.size===0&&n.querySelectorAll("img").forEach(s=>{if(document.createRange().selectNode(s),t.intersectsNode(s)){let f=s.parentElement;for(;f&&f!==n;){if(f.tagName&&ln.has(f.tagName.toUpperCase())){o.add(f);break}f=f.parentElement}}}),Array.from(o).filter(r=>{let s=r.parentElement;for(;s;){if(o.has(s))return!1;s=s.parentElement}return!0})):[]}function uo(e){if(e.style&&e.style.marginLeft&&e.style.marginLeft!==""){const t=parseInt(e.dataset.indentLevel||"0",10),o=Math.max(0,t-1);o===0?(e.style.marginLeft="",delete e.dataset.indentLevel):(e.style.marginLeft=`${o*un}px`,e.dataset.indentLevel=String(o));return}if(e.innerHTML.startsWith("&nbsp;&nbsp;&nbsp;&nbsp;")){e.innerHTML=e.innerHTML.replace(/^(&nbsp;){4}/,"");return}try{const t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null);let o=t.nextNode();for(;o;){const n=o.textContent;if(n.startsWith("")){o.textContent=n.substring(4);break}o=t.nextNode()}}catch{e.innerHTML=e.innerHTML.replace(/^(&nbsp;){4}/,"")}}function ft(e=!1){const t=window.getSelection();if(!t||t.rangeCount===0)return!1;let o=lo();const n=t.getRangeAt(0);if(o.length===0){const r=co(n.startContainer);if(!r)return!1;o=[r]}const i=o[0],a=o[o.length-1];o.forEach(r=>{if((r.tagName?r.tagName.toUpperCase():"")==="LI"){so(r,e);return}e?uo(r):dn(r,!1)});try{const r=document.createRange(),s=y=>y.nodeType===Node.TEXT_NODE?y:document.createTreeWalker(y,NodeFilter.SHOW_TEXT,null).nextNode(),h=y=>{if(y.nodeType===Node.TEXT_NODE)return y;const d=document.createTreeWalker(y,NodeFilter.SHOW_TEXT,null);let w=null,C=d.nextNode();for(;C;)w=C,C=d.nextNode();return w},f=s(i);f?r.setStart(f,0):r.setStart(i,0);const p=h(a);p?r.setEnd(p,p.length):r.setEnd(a,a.childNodes.length),t.removeAllRanges(),t.addRange(r)}catch{try{const s=document.createRange();s.setStartBefore(i),s.setEndAfter(a),t.removeAllRanges(),t.addRange(s)}catch(s){console.warn("Could not restore selection after indentation:",s)}}return!0}function fo(e){if(e.key!=="Tab")return!1;e.preventDefault();const t=e.shiftKey,o=window.getSelection(),n=o&&o.rangeCount>0?o.getRangeAt(0):null;return o&&o.rangeCount>0&&n&&!n.collapsed&&ft(t)||t||document.execCommand("insertHTML",!1,"&nbsp;&nbsp;&nbsp;&nbsp;"),!0}const ze=({currentFormat:e,onFormatText:t,onAddPageBreak:o,canUndo:n=!1,canRedo:i=!1})=>{const a=async r=>{try{if(!["image/png","image/jpeg","image/gif","image/webp"].includes(r.type)){alert("Invalid image format. Supported: PNG, JPEG, GIF, WEBP");return}if(r.size>5242880){alert("Image exceeds maximum size of 5MB");return}const h=await Vt(r),f=await Kt(h);if(f){const y=`<img src="${f}" data-key="${h}" alt="Inserted image" />`;document.execCommand("insertHTML",!1,y),cn.info("Image inserted",{key:h})}const p=document.getElementById("image-upload");p&&(p.value="")}catch(s){cn.error("Error uploading image",s)}};return u.jsxs("div",{className:"editor-toolbar",children:[u.jsx("button",{onClick:()=>t("undo"),disabled:!n,title:"Undo",style:{opacity:n?1:.5},children:u.jsx(ro,{size:16})}),u.jsx("button",{onClick:()=>t("redo"),disabled:!i,title:"Redo",style:{opacity:i?1:.5},children:u.jsx(Vr,{size:16})}),u.jsx("div",{className:"toolbar-separator"}),u.jsx("button",{onClick:()=>t("bold"),className:e.bold?"active":"",title:"Bold",children:u.jsx(Rr,{size:16})}),u.jsx("button",{onClick:()=>t("italic"),className:e.italic?"active":"",title:"Italic",children:u.jsx(Gr,{size:16})}),u.jsx("button",{onClick:()=>t("underline"),className:e.underline?"active":"",title:"Underline",children:u.jsx(no,{size:16})}),u.jsx("button",{onClick:()=>t("strikethrough"),className:e.strikethrough?"active":"",title:"Strikethrough",children:u.jsx(Jr,{size:16})}),u.jsx("div",{className:"toolbar-separator"}),u.jsx("button",{onClick:()=>t("justifyLeft"),className:e.alignLeft?"active":"",title:"Align Left",children:u.jsx(on,{size:16})}),u.jsx("button",{onClick:()=>t("justifyCenter"),className:e.alignCenter?"active":"",title:"Align Center",children:u.jsx(nn,{size:16})}),u.jsx("button",{onClick:()=>t("justifyRight"),className:e.alignRight?"active":"",title:"Align Right",children:u.jsx(rn,{size:16})}),u.jsx("button",{onClick:()=>t("justifyFull"),className:e.alignJustify?"active":"",title:"Justify",children:u.jsx(eo,{size:16})}),u.jsx("div",{className:"toolbar-separator"}),u.jsxs("select",{onChange:r=>t("fontName",r.target.value),value:e.fontFamily||"Segoe UI",title:"Font Family",children:[u.jsx("option",{value:"Segoe UI",children:"Segoe UI "}),u.jsx("option",{value:"Arial",children:"Arial "}),u.jsx("option",{value:"Times New Roman",children:"Times New Roman "}),u.jsx("option",{value:"Courier New",children:"Courier New "}),u.jsx("option",{value:"Georgia",children:"Georgia "}),u.jsx("option",{value:"Verdana",children:"Verdana "}),u.jsx("option",{value:"Noto Sans Sinhala",children:"Noto Sans Sinhala "}),u.jsx("option",{value:"Iskoola Pota",children:"Iskoola Pota "}),u.jsx("option",{value:"Noto Sans Tamil",children:"Noto Sans Tamil "}),u.jsx("option",{value:"Noto Sans",children:"Noto Sans "})]}),u.jsx("select",{onChange:r=>t("fontSize",r.target.value),value:e.fontSize||Ae,title:"Font Size",children:jt.map(({value:r,label:s})=>u.jsx("option",{value:r,children:s},r))}),u.jsxs("select",{onChange:r=>t("formatBlock",r.target.value),value:e.headingLevel||"p",title:"Heading Level",children:[u.jsx("option",{value:"p",children:"Normal"}),u.jsx("option",{value:"h1",children:"Heading 1"}),u.jsx("option",{value:"h2",children:"Heading 2"}),u.jsx("option",{value:"h3",children:"Heading 3"}),u.jsx("option",{value:"h4",children:"Heading 4"}),u.jsx("option",{value:"h5",children:"Heading 5"}),u.jsx("option",{value:"h6",children:"Heading 6"})]}),u.jsx("div",{className:"toolbar-separator"}),u.jsx("button",{onClick:()=>t("insertUnorderedList"),title:"Bullet List",children:u.jsx(tn,{size:16})}),u.jsx("button",{onClick:()=>t("insertOrderedList"),title:"Numbered List",children:u.jsx(Zr,{size:16})}),u.jsx("div",{className:"toolbar-separator"}),u.jsx("button",{onClick:()=>{ft(!1)||document.execCommand("insertHTML",!1,"&nbsp;&nbsp;&nbsp;&nbsp;")},title:"Increase Indent (Tab)",children:u.jsx(Wr,{size:16})}),u.jsx("button",{onClick:()=>{ft(!0)},title:"Decrease Indent (Shift+Tab)",children:u.jsx(qr,{size:16})}),u.jsx("div",{className:"toolbar-separator"}),u.jsx("button",{onClick:()=>{const r=prompt("Enter URL:");r&&t("createLink",r)},title:"Insert Link",children:u.jsx(Fr,{size:16})}),u.jsx("button",{onClick:()=>t("insertHTML",'<table border="1"><tr><td>Cell 1</td><td>Cell 2</td></tr><tr><td>Cell 3</td><td>Cell 4</td></tr></table>'),title:"Insert Table",children:u.jsx(Qr,{size:16})}),o&&u.jsx("button",{onClick:o,title:"Insert Page Break",children:u.jsx(He,{size:16})}),u.jsx("div",{className:"toolbar-separator"}),u.jsx("input",{type:"file",accept:"image/*",onChange:r=>r.target.files[0]&&a(r.target.files[0]),style:{display:"none"},id:"image-upload"}),u.jsx("button",{onClick:()=>document.getElementById("image-upload").click(),title:"Insert Image",children:u.jsx(Ur,{size:16})})]})};ze.propTypes={currentFormat:x.shape({bold:x.bool,italic:x.bool,underline:x.bool,strikethrough:x.bool,alignLeft:x.bool,alignCenter:x.bool,alignRight:x.bool,alignJustify:x.bool,fontFamily:x.string,fontSize:x.string,headingLevel:x.string}).isRequired,onFormatText:x.func.isRequired,onAddPageBreak:x.func,canUndo:x.bool,canRedo:x.bool},ze.defaultProps={onAddPageBreak:void 0,canUndo:!1,canRedo:!1};function po(e){return!e||typeof e!="string"?e:De(e)}function go(e){e.preventDefault();const t=e.clipboardData||window.clipboardData;if(!t)return null;let o=t.getData("text/html")||t.getData("text/plain");return o?(t.getData("text/html")?o=po(o):o=ho(o),document.execCommand("insertHTML",!1,o),o):null}function ho(e){if(!e)return"";const t=e.split(/\n\s*\n/).filter(o=>o.trim());return t.length===0?"<p><br></p>":t.map(o=>{const n=o.split(`
`).filter(a=>a.trim());return n.length===0?"<p><br></p>":`<p>${n.map(a=>mo(a.trim())).join("<br>")}</p>`}).join("")}function mo(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}const $e=({content:e,dimensions:t,pageSize:o,pageBoundaries:n=[],editorRef:i,onInput:a,onContentChange:r,onKeyDown:s,onClick:h,onScroll:f,onPaste:p,zoomLevel:y=100,pageMargins:d=fe})=>{const w=vt(d),C=y/100,v=(c,E)=>{if(!c)return!1;const g=c.getBoundingClientRect(),_=E-g.top;return _<w.top||_>g.height-w.bottom},O=c=>c?c.nodeType===Node.ELEMENT_NODE?c.tagName==="PAGE-BREAK"||c.getAttribute("data-page-break")==="true":c.parentElement&&O(c.parentElement):!1,b=c=>{const E=window.getSelection();if(!E||E.rangeCount===0)return;const g=E.getRangeAt(0),{startContainer:_,endContainer:M}=g;if((O(_)||O(M))&&(c.key.length===1||c.key==="Enter"||c.key===" "))return c.preventDefault(),!1;if(fo(c))return r&&r(),!1;if((c.key==="Backspace"||c.key==="Delete")&&(O(_)||O(M)))return c.preventDefault(),!1;s&&s(c)},A=c=>{if(!i.current)return;const E=c.target;if(O(E)){c.preventDefault();return}if(v(i.current,c.clientY)){c.preventDefault();const g=i.current.getBoundingClientRect();if(c.clientY-g.top<w.top){const M=i.current.firstElementChild;if(M&&M.tagName!=="PAGE-BREAK"){const $=document.createRange(),L=window.getSelection();$.setStart(M,0),$.collapse(!0),L.removeAllRanges(),L.addRange($)}}else{const M=i.current.lastElementChild;if(M&&M.tagName!=="PAGE-BREAK"){const $=document.createRange(),L=window.getSelection();$.selectNodeContents(M),$.collapse(!1),L.removeAllRanges(),L.addRange($)}}return}h&&h(c)},k=c=>{const E=window.getSelection();if(!E||E.rangeCount===0)return;const g=E.getRangeAt(0),{startContainer:_}=g;if(O(_))return c.preventDefault(),!1},H=c=>{const E=go(c);p&&p(c,E)};return u.jsx("div",{className:"continuous-page-container",style:{position:"relative",width:"100%",maxWidth:`${t.width}px`,margin:"40px auto",backgroundColor:"transparent",minHeight:"100vh",transform:`scale(${C})`,transformOrigin:"top center",transition:"transform 0.2s ease-out"},children:u.jsx("div",{ref:i,contentEditable:!0,suppressContentEditableWarning:!0,className:"continuous-content",style:{position:"relative",zIndex:1,minHeight:`${t.height}px`,width:`${t.width}px`,backgroundColor:"white",padding:`${w.top}px ${w.right}px ${w.bottom}px ${w.left}px`,boxSizing:"border-box",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",outline:"none",cursor:"text",fontFamily:'"Segoe UI", "Noto Sans Sinhala", "Noto Sans", "Malithi Web", "Iskoola Pota", "Kaputa Unicode", "Helvetica Neue", Arial, "Hiragino Sans GB", "WenQuanYi Micro Hei", "Microsoft YaHei", sans-serif',fontSize:Ae,lineHeight:"1.3",color:"#333",wordWrap:"break-word",whiteSpace:"pre-wrap",overflowWrap:"break-word",border:"1px solid #e0e0e0"},onInput:a,onKeyDown:b,onBeforeInput:k,onClick:A,onScroll:f,onPaste:H,"data-testid":"continuous-editor"})})};$e.propTypes={content:x.string.isRequired,dimensions:x.shape({width:x.number.isRequired,height:x.number.isRequired}).isRequired,pageSize:x.oneOf(["A4","Letter","Legal"]).isRequired,pageBoundaries:x.arrayOf(x.shape({id:x.string.isRequired,pageNumber:x.number.isRequired,top:x.number,height:x.number})),editorRef:x.shape({current:x.instanceOf(typeof Element<"u"?Element:Object)}).isRequired,onInput:x.func.isRequired,onContentChange:x.func,onKeyDown:x.func,onClick:x.func,onScroll:x.func,onPaste:x.func,zoomLevel:x.number,pageMargins:x.string},$e.defaultProps={pageBoundaries:[],onContentChange:void 0,onKeyDown:void 0,onClick:void 0,onScroll:void 0,onPaste:void 0,zoomLevel:100,pageMargins:fe};const pt=({pageBoundaries:e=[{id:"page-0",pageNumber:1}],activePage:t=0,pageSize:o="A4",pageMargins:n=fe,zoomLevel:i=100,canZoomIn:a=!0,canZoomOut:r=!0,onNavigate:s,onAddPage:h,onDeletePage:f,onPageSizeChange:p,onPageMarginsChange:y,onZoomIn:d,onZoomOut:w,onZoomReset:C}={})=>{const v=Math.max(e?.length||0,1),O=c=>{s&&s(c)},b=()=>{h&&h()},A=c=>{if(v<=1){console.warn("[PageManager] Cannot delete the only page");return}f&&f(c)},k=c=>{p&&p(c)},H=c=>{y&&y(c)};return u.jsxs("div",{className:"page-manager",children:[u.jsxs("div",{className:"page-settings-group",children:[u.jsxs("div",{className:"page-settings-header",children:[u.jsx(Xr,{size:14,style:{marginRight:"4px",verticalAlign:"middle"}}),"Page Settings"]}),u.jsxs("div",{className:"page-settings-controls",children:[u.jsxs("div",{className:"page-setting-item",children:[u.jsx("label",{htmlFor:"page-size-selector",children:"Size:"}),u.jsxs("select",{id:"page-size-selector",role:"combobox","aria-label":"Page size selector",value:o,onChange:c=>k(c.target.value),children:[u.jsx("option",{value:"A4",children:"A4"}),u.jsx("option",{value:"Letter",children:"Letter"}),u.jsx("option",{value:"Legal",children:"Legal"})]})]}),u.jsxs("div",{className:"page-setting-item",children:[u.jsx("label",{htmlFor:"page-margins-selector",children:"Margins:"}),u.jsx("select",{id:"page-margins-selector",role:"combobox","aria-label":"Page margins selector",value:n,onChange:c=>H(c.target.value),children:Sn().map(c=>u.jsx("option",{value:c,children:wn(c)},c))})]})]})]}),u.jsxs("div",{className:"zoom-controls-compact",children:[u.jsx("button",{type:"button",className:"zoom-button-compact",onClick:w,disabled:!r,"aria-label":"Zoom out",title:"Zoom out (Ctrl + -)",children:u.jsx(io,{size:12})}),u.jsxs("span",{className:"zoom-level-display",children:[i,"%"]}),u.jsx("button",{type:"button",className:"zoom-button-compact",onClick:d,disabled:!a,"aria-label":"Zoom in",title:"Zoom in (Ctrl + +)",children:u.jsx(ao,{size:12})}),u.jsx("button",{type:"button",className:"zoom-reset-compact",onClick:C,"aria-label":"Reset zoom",title:"Reset zoom to 100% (Ctrl + 0)",children:"Reset"})]}),u.jsx("div",{className:"page-list",children:(e&&e.length>0?e:[{id:"page-0",pageNumber:1}]).map((c,E)=>u.jsxs("div",{className:"page-item",children:[u.jsxs("button",{type:"button",className:`page-button ${E===t?"active":""}`,onClick:()=>O(E),"aria-label":`Go to page ${E+1}`,"aria-current":E===t?"page":void 0,children:[u.jsx(He,{size:14}),u.jsxs("span",{children:["Page ",E+1]})]}),v>1&&u.jsx("button",{type:"button",className:"delete-page-button",onClick:g=>{g.stopPropagation(),A(E)},"aria-label":`Delete page ${E+1}`,title:"Delete this page and its content",children:u.jsx(oo,{size:14})})]},c.id||`page-${E}`))}),u.jsxs("button",{type:"button",className:"add-page-button",onClick:b,"aria-label":"Add new page",title:"Add new page at end",children:[u.jsx(Yr,{size:16}),u.jsx("span",{children:"Add Page"})]})]})};pt.propTypes={pageBoundaries:x.arrayOf(x.shape({id:x.string.isRequired,pageNumber:x.number.isRequired,top:x.number,height:x.number})),activePage:x.number,pageSize:x.oneOf(["A4","Letter","Legal"]),pageMargins:x.string,zoomLevel:x.number,canZoomIn:x.bool,canZoomOut:x.bool,onNavigate:x.func,onAddPage:x.func,onDeletePage:x.func,onPageSizeChange:x.func,onPageMarginsChange:x.func,onZoomIn:x.func,onZoomOut:x.func,onZoomReset:x.func},pt.defaultProps={pageBoundaries:[{id:"page-0",pageNumber:1}],activePage:0,pageSize:"A4",pageMargins:fe,zoomLevel:100,canZoomIn:!0,canZoomOut:!0,onNavigate:void 0,onAddPage:void 0,onDeletePage:void 0,onPageSizeChange:void 0,onPageMarginsChange:void 0,onZoomIn:void 0,onZoomOut:void 0,onZoomReset:void 0};const fn=m.memo(pt),Be=({editorRef:e,onImageResize:t,onImageSelect:o,onImageDeselect:n,resizeOptions:i=de})=>{const a=m.useRef(null),r=m.useRef(null),s=m.useRef(null),h=m.useRef(null),f=m.useRef(i),p=m.useRef(!1),y=Ee();m.useEffect(()=>{f.current=i},[i]);const d=m.useCallback(g=>{if(!ue(g))return;a.current&&(he(a.current),a.current=null),g.classList.add("selected");const _=dt(g,f.current);_&&(a.current=_,r.current=g,document.body.appendChild(_),_.querySelectorAll(".resize-handler").forEach($=>{$.addEventListener("mousedown",C)}),o&&(console.log("Image selected, calling onImageSelect callback"),o(g)))},[o]),w=m.useCallback(()=>{r.current&&(r.current.classList.remove("selected"),r.current=null),a.current&&(he(a.current),a.current=null),s.current=null,h.current=null,p.current=!1,n&&n()},[n]),C=m.useCallback(g=>{if(g.preventDefault(),g.stopPropagation(),!r.current)return;const _=g.currentTarget.dataset.handler,M=r.current.getBoundingClientRect(),$=window.pageYOffset||document.documentElement.scrollTop,L=window.pageXOffset||document.documentElement.scrollLeft;s.current={x:g.clientX,y:g.clientY,width:r.current.offsetWidth,height:r.current.offsetHeight,originalWidth:r.current.offsetWidth,originalHeight:r.current.offsetHeight,offsetX:g.clientX-M.left-L,offsetY:g.clientY-M.top-$},h.current=_,p.current=!0,document.body.classList.add("resize-in-progress"),document.body.style.cursor=H(_),document.addEventListener("mousemove",v),document.addEventListener("mouseup",O)},[]),v=m.useCallback(g=>{if(!p.current||!r.current||!s.current||!h.current)return;g.preventDefault(),g.stopPropagation();const{x:_,y:M,width:$,height:L}=s.current,B=h.current,Z=g.clientX,z=g.clientY,oe=c({handler:B,startX:_,startY:M,currentX:Z,currentY:z,startWidth:$,startHeight:L,options:f.current});E(r.current,oe),a.current&&ke(a.current,r.current)},[]),O=m.useCallback(g=>{if(p.current){if(g.preventDefault(),g.stopPropagation(),r.current&&s.current){const _={width:s.current.originalWidth,height:s.current.originalHeight},M={width:r.current.offsetWidth,height:r.current.offsetHeight};(_.width!==M.width||_.height!==M.height)&&y.recordOperation({type:"IMAGE_RESIZE",payload:{element:r.current,state:M}},{type:"IMAGE_RESIZE",payload:{element:r.current,state:_}})}if(s.current=null,h.current=null,p.current=!1,document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",O),document.body.classList.remove("resize-in-progress"),document.body.style.cursor="",r.current){const _=new Event("input",{bubbles:!0,cancelable:!0});r.current.dispatchEvent(_),t&&t(r.current,{width:r.current.offsetWidth,height:r.current.offsetHeight})}}},[t,y]),b=m.useCallback(g=>{a.current&&!a.current.contains(g.target)&&w();const _=g.target;if(ue(_)){if(_===r.current)return;d(_)}else console.log("Clicked on non-image element")},[d,w]),A=m.useCallback(g=>{if((g.key==="Delete"||g.key==="Backspace")&&r.current&&!p.current){g.preventDefault();const _=r.current;if(_.parentNode){_.parentNode.removeChild(_),w();const M=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(M)}}if(g.key==="Escape"&&r.current&&w(),r.current&&!p.current){if((g.ctrlKey||g.metaKey)&&g.shiftKey&&g.key===">"){g.preventDefault();const _=r.current.offsetWidth,M=Math.min(f.current.maxWidth||800,_+10);E(r.current,{width:M,height:r.current.offsetHeight});const $=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent($)}if((g.ctrlKey||g.metaKey)&&g.shiftKey&&g.key==="<"){g.preventDefault();const _=r.current.offsetWidth,M=Math.max(f.current.minWidth||50,_-10);E(r.current,{width:M,height:r.current.offsetHeight});const $=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent($)}if((g.ctrlKey||g.metaKey)&&g.shiftKey&&g.key==="+"){g.preventDefault();const _=r.current.offsetHeight,M=Math.min(f.current.maxHeight||600,_+10);E(r.current,{width:r.current.offsetWidth,height:M});const $=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent($)}if((g.ctrlKey||g.metaKey)&&g.shiftKey&&g.key==="-"){g.preventDefault();const _=r.current.offsetHeight,M=Math.max(f.current.minHeight||50,_-10);E(r.current,{width:r.current.offsetWidth,height:M});const $=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent($)}if((g.ctrlKey||g.metaKey)&&g.key==="r"){g.preventDefault(),E(r.current,{width:300,height:200});const _=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(_)}}},[e,w]),k=m.useCallback(()=>{a.current&&r.current&&ke(a.current,r.current)},[]);m.useEffect(()=>{if(!e.current)return;const _=e.current.closest(".editor-viewport");return _&&(_.addEventListener("scroll",k),window.addEventListener("scroll",k)),()=>{_&&_.removeEventListener("scroll",k),window.removeEventListener("scroll",k)}},[e,k]),m.useEffect(()=>{if(!e.current)return;const g=e.current;g.addEventListener("click",b),g.addEventListener("keydown",A);const _=g.closest(".editor-viewport");return _&&_.addEventListener("scroll",k),window.addEventListener("resize",k),()=>{g.removeEventListener("click",b),g.removeEventListener("keydown",A),_&&_.removeEventListener("scroll",k),window.removeEventListener("resize",k),p.current&&(document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",O),document.body.classList.remove("resize-in-progress"),document.body.style.cursor=""),a.current&&he(a.current)}},[e,b,A,k,v,O]),m.useEffect(()=>{if(!e.current)return;const g=new MutationObserver(_=>{_.forEach(M=>{M.type==="childList"&&(M.removedNodes.length>0&&M.removedNodes.forEach($=>{$.nodeType===Node.ELEMENT_NODE&&ue($)&&$===r.current&&w()}),M.addedNodes.length>0&&M.addedNodes.forEach($=>{if($.nodeType===Node.ELEMENT_NODE)if(ue($))setTimeout(()=>{d($)},50);else{const L=$.querySelectorAll?$.querySelectorAll("img"):[];L.length>0&&setTimeout(()=>{d(L[0])},50)}}))})});return g.observe(e.current,{childList:!0,subtree:!0}),()=>{g.disconnect()}},[e,w,d]);function H(g){switch(g){case P.TOP_LEFT:case P.BOTTOM_RIGHT:return"nwse-resize";case P.TOP_RIGHT:case P.BOTTOM_LEFT:return"nesw-resize";case P.TOP:case P.BOTTOM:return"ns-resize";case P.LEFT:case P.RIGHT:return"ew-resize";default:return"default"}}function c({handler:g,startX:_,startY:M,currentX:$,currentY:L,startWidth:B,startHeight:Z,options:z=de}){const oe=$-_,re=L-M;let q=B,V=Z;switch(g){case P.TOP_LEFT:q=Math.max(z.minWidth,B-oe),V=Math.max(z.minHeight,Z-re);break;case P.TOP_RIGHT:q=Math.max(z.minWidth,B+oe),V=Math.max(z.minHeight,Z-re);break;case P.BOTTOM_LEFT:q=Math.max(z.minWidth,B-oe),V=Math.max(z.minHeight,Z+re);break;case P.BOTTOM_RIGHT:q=Math.max(z.minWidth,B+oe),V=Math.max(z.minHeight,Z+re);break;case P.TOP:V=Math.max(z.minHeight,Z-re);break;case P.BOTTOM:V=Math.max(z.minHeight,Z+re);break;case P.LEFT:q=Math.max(z.minWidth,B-oe);break;case P.RIGHT:q=Math.max(z.minWidth,B+oe);break;default:return{width:q,height:V}}if(z.preserveAspectRatio&&z.aspectRatio){const ne=B/Z;[P.TOP_LEFT,P.TOP_RIGHT,P.BOTTOM_LEFT,P.BOTTOM_RIGHT].includes(g)?q/ne>V?V=Math.max(z.minHeight,q/ne):q=Math.max(z.minWidth,V*ne):[P.TOP,P.BOTTOM].includes(g)?q=V*ne:[P.LEFT,P.RIGHT].includes(g)&&(V=q/ne)}return z.maxWidth&&q>z.maxWidth&&(q=z.maxWidth,z.preserveAspectRatio&&z.aspectRatio&&(V=q/(B/Z))),z.maxHeight&&V>z.maxHeight&&(V=z.maxHeight,z.preserveAspectRatio&&z.aspectRatio&&(q=V*(B/Z))),q=Math.max(z.minWidth,q),V=Math.max(z.minHeight,V),{width:Math.round(q),height:Math.round(V)}}function E(g,{width:_,height:M}){ue(g)&&(g.tagName==="IMG"?(g.style.width=`${_}px`,g.style.height=`${M}px`,g.width=_,g.height=M):g.tagName==="DIV"&&(g.style.width=`${_}px`,g.style.height=`${M}px`))}return null};Be.propTypes={editorRef:x.shape({current:x.instanceOf(typeof Element<"u"?Element:Object)}).isRequired,onImageResize:x.func,onImageSelect:x.func,onImageDeselect:x.func,resizeOptions:x.shape({minWidth:x.number,minHeight:x.number,maxWidth:x.number,maxHeight:x.number,aspectRatio:x.bool,preserveAspectRatio:x.bool,defaultWidth:x.number,defaultHeight:x.number})},Be.defaultProps={onImageResize:void 0,onImageSelect:void 0,onImageDeselect:void 0,resizeOptions:de};const gt=({imageElement:e,onAlignChange:t,onAspectRatioToggle:o,onDelete:n,onClose:i,initialPreserveAspectRatio:a=!0})=>{const[r,s]=m.useState({top:0,left:0}),[h,f]=m.useState(!1),[p,y]=m.useState("top"),[d,w]=m.useState(a),C=m.useRef(null),v=m.useRef(null),O=Ee(),b=L=>{if(!L)return;(typeof window<"u"&&typeof window.requestAnimationFrame=="function"?window.requestAnimationFrame:Z=>setTimeout(Z,16))(()=>{const Z=document.querySelector(".image-resize-overlay");Z&&ke(Z,L)})},A=L=>{if(!L)return null;const B=window.getComputedStyle(L);return{float:B.float||"none",margin:L.style.margin||"",display:B.display||"inline",width:L.style.width||L.width||"",height:L.style.height||L.height||"",aspectRatio:d}},k=()=>{if(!e)return"left";const L=window.getComputedStyle(e);return L.float||L.display==="block"?"left":L.display==="flex"&&L.justifyContent==="center"?"center":L.float==="right"?"right":"left"},[H,c]=m.useState(k());m.useEffect(()=>()=>{console.log("ImageTooltipMenu unmounted")},[e]),m.useEffect(()=>{if(e){let L=e.closest(".editor-viewport")||e.closest(".continuous-scroll");L&&(v.current=L)}},[e]),m.useLayoutEffect(()=>{if(!e||!C.current)return;const L=()=>{const Z=e.getBoundingClientRect(),z=C.current.getBoundingClientRect();v.current;const oe=window.visualViewport?window.visualViewport:{width:window.innerWidth,height:window.innerHeight},re=Z.bottom>=0&&Z.top<=oe.height&&Z.right>=0&&Z.left<=oe.width;let q="top",V=0,ne=0;if(re){const I=Z.top-z.height-10,Y=oe.height-Z.bottom-z.height-10;Y>I&&Y>0?(q="bottom",V=Z.bottom+10):(q="top",V=Z.top-z.height-10)}else q="top",V=10;ne=Z.left+Z.width/2-z.width/2;const T=window.innerWidth,l=window.innerHeight;let S=ne,R=V;ne<10?S=10:ne+z.width>T-10&&(S=T-z.width-10),V<10?R=10:V+z.height>l-10&&(R=l-z.height-10),s({top:R,left:S}),y(q),f(!0)};L();const B=()=>{L()};return v.current&&v.current.addEventListener("scroll",B),window.addEventListener("scroll",B),window.addEventListener("resize",B),()=>{v.current&&v.current.removeEventListener("scroll",B),window.removeEventListener("scroll",B),window.removeEventListener("resize",B),f(!1)}},[e]),m.useEffect(()=>{const L=B=>{C.current&&!C.current.contains(B.target)&&B.target!==e&&i()};return document.addEventListener("mousedown",L),()=>{document.removeEventListener("mousedown",L)}},[e,i]);const E=()=>{if(e){const L=A(e);e.style.float="left",e.style.margin="0 10px 10px 0",e.style.display="block",c("left"),b(e);const B=A(e);O.recordOperation({type:"IMAGE_ALIGN",payload:{element:e,alignment:"left",state:B}},{type:"IMAGE_ALIGN",payload:{element:e,alignment:k(),state:L}}),t&&t("left")}},g=()=>{if(e){const L=A(e);e.style.float="none",e.style.margin="10px auto",e.style.display="block",c("center"),b(e);const B=A(e);O.recordOperation({type:"IMAGE_ALIGN",payload:{element:e,alignment:"center",state:B}},{type:"IMAGE_ALIGN",payload:{element:e,alignment:k(),state:L}}),t&&t("center")}},_=()=>{if(e){const L=A(e);e.style.float="right",e.style.margin="0 0 10px 10px",e.style.display="block",c("right"),b(e);const B=A(e);O.recordOperation({type:"IMAGE_ALIGN",payload:{element:e,alignment:"right",state:B}},{type:"IMAGE_ALIGN",payload:{element:e,alignment:k(),state:L}}),t&&t("right")}},M=()=>{if(e&&e.parentNode){const L={element:e,parent:e.parentNode,nextSibling:e.nextSibling};O.recordOperation({type:"IMAGE_DELETE",payload:{element:e}},{type:"IMAGE_REINSERT",payload:{state:L}}),e.parentNode.removeChild(e),n&&n(),i()}},$=()=>{const L=d,B=!d;w(B),O.recordOperation({type:"IMAGE_ASPECT_RATIO",payload:{element:e,preserveAspectRatio:B}},{type:"IMAGE_ASPECT_RATIO",payload:{element:e,preserveAspectRatio:L}}),o&&o(B)};return!e||typeof document>"u"?null:Tn.createPortal(u.jsxs("div",{ref:C,className:"image-tooltip-menu","data-menu-position":p,"aria-hidden":!h,style:{position:"fixed",top:`${r.top}px`,left:`${r.left}px`,zIndex:999,background:"#fff",border:"1px solid #ddd",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",padding:"8px",display:"flex",gap:"2px",alignItems:"center",pointerEvents:h?"auto":"none",minWidth:"140px",minHeight:"32px",opacity:h?1:0,visibility:h?"visible":"hidden",transition:"opacity 0.15s ease, visibility 0.15s ease"},children:[u.jsx("button",{className:`tooltip-button aspect-ratio-toggle ${d?"":"active"}`,onClick:$,title:`Toggle aspect ratio preservation (currently ${d?"ON":"OFF"})`,children:d?u.jsx(Kr,{size:14}):u.jsx(Br,{size:14})}),u.jsx("button",{className:`tooltip-button ${H==="left"?"active":""}`,onClick:E,title:"Align Left",style:{background:H==="left"?"#007bff":"transparent",color:H==="left"?"#fff":"#333",border:"1px solid #ccc",borderRadius:"4px",padding:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"28px",height:"28px"},children:u.jsx(on,{size:14})}),u.jsx("button",{className:`tooltip-button ${H==="center"?"active":""}`,onClick:g,title:"Align Center",style:{background:H==="center"?"#007bff":"transparent",color:H==="center"?"#fff":"#333",border:"1px solid #ccc",borderRadius:"4px",padding:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"28px",height:"28px"},children:u.jsx(nn,{size:14})}),u.jsx("button",{className:`tooltip-button ${H==="right"?"active":""}`,onClick:_,title:"Align Right",style:{background:H==="right"?"#007bff":"transparent",color:H==="right"?"#fff":"#333",border:"1px solid #ccc",borderRadius:"4px",padding:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"28px",height:"28px"},children:u.jsx(rn,{size:14})}),u.jsx("button",{className:"tooltip-button delete-button",onClick:M,title:"Delete Image",style:{background:"transparent",color:"#dc3545",border:"1px solid #dc3545",borderRadius:"4px",padding:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"28px",height:"28px"},children:u.jsx(to,{size:14})})]}),document.body)};gt.propTypes={imageElement:x.instanceOf(typeof Element<"u"?Element:Object),onAlignChange:x.func,onAspectRatioToggle:x.func,onDelete:x.func,onClose:x.func.isRequired,initialPreserveAspectRatio:x.bool},gt.defaultProps={imageElement:null,onAlignChange:void 0,onAspectRatioToggle:void 0,onDelete:void 0,initialPreserveAspectRatio:!0};const yo=50,ht=50,pn=50,Eo=100,bo=500,gn="UPDATE_CONTINUOUS_CONTENT",Ue=m.forwardRef(({pageManagerComponent:e=null,onNavigatePage:t,onAddPage:o,onDeletePage:n,onPageSizeChange:i,onPageMarginsChange:a,onChange:r,showSidebar:s=!0,showToolbar:h=!0,showPageManager:f=!0},p)=>{const y=nt(),d=Ee(),{pageSize:w,pageMargins:C,continuousContent:v,pageBoundaries:O,activePage:b,zoomLevel:A,canUndo:k,canRedo:H}=y,c=m.useRef(null),E=m.useRef(null),{currentFormat:g,formatText:_,updateCurrentFormatFromSelection:M}=Bt(),[$,L]=m.useState(!1),[B,Z]=m.useState(null),[z,oe]=m.useState(!0),{checkAndUpdateBoundaries:re,getCurrentPage:q,scrollToPage:V,updateBoundaries:ne,triggerAutoReflow:T,removePageAndContent:l,insertPageBreakAtBoundary:S}=Yt(w,E,A,C),R=m.useMemo(()=>Me(w),[w]),[I,Y]=m.useState(!1),F=m.useRef(null),j=m.useRef(!1),W=m.useRef(!1),X=m.useRef(!1),K=m.useRef(v);m.useEffect(()=>{if(E.current){if(!X.current){E.current.innerHTML=v,X.current=!0,K.current=v;const D=setTimeout(()=>{ne()},yo);return()=>clearTimeout(D)}if(K.current!==v){if(E.current.innerHTML!==v){E.current.innerHTML=v;const Q=setTimeout(()=>{if(ne(),j.current){j.current=!1;const ie=Math.max(0,O.length-1);d.setActivePage(ie),setTimeout(()=>{V(ie,c)},pn)}},ht);return K.current=v,()=>clearTimeout(Q)}K.current=v}}},[v,ne,O.length,d,V]),m.useEffect(()=>{r&&X.current&&r(v)},[v,r]),m.useImperativeHandle(p,()=>({getHTMLContent:()=>E.current?E.current.innerHTML:v,getPlainText:()=>(E.current?E.current.innerHTML:v).replace(/<[^>]*>/g," ").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/\s+/g," ").trim(),setContent:D=>{const Q=De(D);Q!==v&&d.updateContinuousContent(Q),E.current&&E.current.innerHTML!==Q&&(E.current.innerHTML=Q),K.current=Q,E.current&&setTimeout(()=>{ne()},ht)},insertContent:D=>{if(!E.current||!D)return;const Q=De(D),ie=window.getSelection();if(ie&&ie.rangeCount>0){const ye=ie.getRangeAt(0);if(E.current.contains(ye.commonAncestorContainer)){document.execCommand("insertHTML",!1,Q);const pe=E.current.innerHTML;d.updateContinuousContent(pe),K.current=pe,setTimeout(()=>{ne(),T(200)},ht)}}}}),[v,d,ne,E]),m.useEffect(()=>{const D=()=>{M()};document.addEventListener("selectionchange",D);const Q=()=>{setTimeout(M,10)};return E.current&&E.current.addEventListener("focus",Q),()=>{document.removeEventListener("selectionchange",D),E.current&&E.current.removeEventListener("focus",Q)}},[M]);const ae=m.useCallback(()=>{if(!E.current)return;let D=E.current.innerHTML;D=De(D),D!==E.current.innerHTML&&(E.current.innerHTML=D);const Q=v;if(Q!==D){const ye={type:gn,payload:D},pe={type:gn,payload:Q};d.recordOperation(ye,pe)}d.updateContinuousContent(D),re(),T(200);const ie=q(c);ie!==b&&d.setActivePage(ie)},[d,re,q,b,T,c,E,v]),N=m.useCallback(D=>{ae()},[ae]),ce=m.useCallback(D=>{d.updatePageSize(D),ne({pageSize:D}),i&&i(D)},[d,ne,i]),me=m.useCallback(D=>{d.updatePageMargins(D),ne({pageMargins:D}),a&&a(D)},[d,ne,a]),we=m.useCallback(D=>{D<0||D>=O.length||(W.current=!0,d.setActivePage(D),V(D,c),setTimeout(()=>{W.current=!1},bo),t&&t(D))},[d,V,t,O.length]),hn=m.useCallback(()=>{const D=O.length+1;S(D)&&(j.current=!0,setTimeout(()=>{if(j.current){j.current=!1;const ie=Math.max(0,O.length-1);d.setActivePage(ie),setTimeout(()=>{V(ie,c)},pn)}},100)),o&&o()},[O.length,S,d,V,o]),vo=m.useCallback(()=>{const D=window.getSelection();if(D&&D.rangeCount>0){if(!E?.current)return;const ye=`<page-break data-page-break="true" contenteditable="false" data-page-number="${E.current.querySelectorAll('page-break, [data-page-break="true"]').length+2}"></page-break><p><br></p>`;document.execCommand("insertHTML",!1,ye),setTimeout(()=>{ne();const pe=q(c);d.setActivePage(pe)},150)}},[ne,q,d,c]),mn=m.useCallback(D=>{if(O.length<=1){console.warn("Cannot delete the only page");return}l(D)&&(d.setActivePage(0),n&&n(D))},[O.length,l,d,n]),Ge=m.useCallback(()=>{d.zoomIn()},[d]),Fe=m.useCallback(()=>{d.zoomOut()},[d]),qe=m.useCallback(()=>{d.resetZoom()},[d]),yn=m.useCallback(()=>{d.undo()},[d]),En=m.useCallback(()=>{d.redo()},[d]);m.useEffect(()=>{const D=Q=>{if(Q.ctrlKey||Q.metaKey){["+","=","-","_","0","z","y"].includes(Q.key)&&Q.preventDefault();const ie=document.activeElement===E.current,ye=document.activeElement===c.current,pe=document.activeElement?.tagName==="INPUT"||document.activeElement?.tagName==="TEXTAREA"||document.activeElement?.isContentEditable===!1;if(ie||ye||!pe)switch(Q.key){case"+":case"=":Ge();break;case"-":case"_":Fe();break;case"0":qe();break;case"z":Q.shiftKey||yn();break;case"y":En();break}}};return window.addEventListener("keydown",D),()=>{window.removeEventListener("keydown",D)}},[Ge,Fe,qe,yn,En]);const xo=m.useCallback(()=>{!c.current||!E.current||W.current||(F.current&&clearTimeout(F.current),F.current=setTimeout(()=>{if(W.current){F.current=null;return}const D=q(c);D!==b&&D>=0&&d.setActivePage(D),F.current=null},Eo))},[q,b,d]),_o=m.useMemo(()=>{if(!v)return 0;const Q=v.replace(/<[^>]*>/g," ").match(new RegExp("\\p{L}+","gu"));return Q?Q.length:0},[v]),Ao=O.length||1,ko=m.useCallback(D=>{L(!0),Z(D)},[]),bn=m.useCallback(()=>{L(!1),Z(null)},[]),Po=m.useCallback((D,Q)=>{},[]);return m.useEffect(()=>()=>{F.current&&clearTimeout(F.current)},[]),u.jsxs("div",{className:"multi-page-editor",children:[h&&u.jsx(ze,{currentFormat:{...g,imageSelected:$},onFormatText:_,onAddPageBreak:vo,canUndo:k,canRedo:H}),u.jsxs("div",{className:"editor-container",children:[s&&u.jsx(an,{editorView:null,isCollapsed:I,onToggle:()=>Y(D=>!D),wordCount:_o,pageCount:Ao}),u.jsx("div",{className:"editor-viewport continuous-scroll",ref:c,onScroll:xo,children:u.jsx($e,{content:v,dimensions:R,pageSize:w,pageMargins:C,pageBoundaries:O,editorRef:E,onInput:N,onContentChange:ae,onClick:()=>E.current?.focus(),zoomLevel:A})}),u.jsx(Be,{editorRef:E,onImageSelect:ko,onImageDeselect:bn,onImageResize:Po,resizeOptions:{...de,preserveAspectRatio:z,aspectRatio:z}}),$&&B&&u.jsx(gt,{imageElement:B,initialPreserveAspectRatio:z,onAlignChange:D=>{},onAspectRatioToggle:D=>{oe(D)},onDelete:()=>{if(B){const D=B.getAttribute("data-key");D&&Xt(D).catch(Q=>{console.error("Failed to delete image from IndexedDB:",Q)})}},onClose:bn}),f&&u.jsx("div",{className:"page-manager-sidebar",children:e?m.cloneElement(e,{onNavigate:we,onAddPage:hn,onDeletePage:mn,onPageSizeChange:ce,onPageMarginsChange:me,zoomLevel:A,canZoomIn:Ke(A),canZoomOut:Xe(A),onZoomIn:Ge,onZoomOut:Fe,onZoomReset:qe}):u.jsx(fn,{pageBoundaries:O,activePage:b,pageSize:w,pageMargins:C,zoomLevel:A,canZoomIn:Ke(A),canZoomOut:Xe(A),onNavigate:we,onAddPage:hn,onDeletePage:mn,onPageSizeChange:ce,onPageMarginsChange:me,onZoomIn:Ge,onZoomOut:Fe,onZoomReset:qe})})]})]})});Ue.displayName="HtmlEditor",Ue.propTypes={pageManagerComponent:x.element,onNavigatePage:x.func,onAddPage:x.func,onDeletePage:x.func,onPageSizeChange:x.func,onPageMarginsChange:x.func,onChange:x.func,showSidebar:x.bool,showToolbar:x.bool,showPageManager:x.bool},Ue.defaultProps={pageManagerComponent:null,onNavigatePage:void 0,onAddPage:void 0,onDeletePage:void 0,onPageSizeChange:void 0,onPageMarginsChange:void 0,onChange:void 0,showSidebar:!0,showToolbar:!0,showPageManager:!0};class mt extends m.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,o){console.error("[ErrorBoundary] Caught error:",t),console.error("[ErrorBoundary] Error info:",o),this.setState({error:t,errorInfo:o}),this.props.onError&&this.props.onError(t,o)}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null}),this.props.onReset&&this.props.onReset()};render(){return this.state.hasError?this.props.fallback?this.props.fallback:u.jsxs("div",{style:{padding:"20px",margin:"20px",border:"2px solid #f44336",borderRadius:"4px",backgroundColor:"#ffebee",color:"#c62828"},children:[u.jsx("h2",{style:{marginTop:0},children:" Something went wrong"}),u.jsx("p",{children:"The editor encountered an unexpected error and couldn't continue."}),this.props.showDetails&&this.state.error&&u.jsxs("details",{style:{marginTop:"10px",padding:"10px",backgroundColor:"white",borderRadius:"4px",fontSize:"12px",fontFamily:"monospace"},children:[u.jsx("summary",{style:{cursor:"pointer",fontWeight:"bold"},children:"Error Details"}),u.jsxs("pre",{style:{marginTop:"10px",overflow:"auto",maxHeight:"200px"},children:[this.state.error.toString(),this.state.errorInfo&&this.state.errorInfo.componentStack]})]}),u.jsx("button",{onClick:this.handleReset,style:{marginTop:"15px",padding:"8px 16px",backgroundColor:"#f44336",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold"},children:"Try Again"})]}):this.props.children}}mt.propTypes={children:x.node.isRequired,fallback:x.node,onError:x.func,onReset:x.func,showDetails:x.bool},mt.defaultProps={fallback:null,onError:void 0,onReset:void 0,showDetails:process.env.NODE_ENV==="development"};const To={A4:{width:se.A4.width,height:se.A4.height},Letter:{width:se.Letter.width,height:se.Letter.height},Legal:{width:se.Legal.width,height:se.Legal.height}};U.COMMON_FONT_SIZES=jt,U.DEFAULT_FONT_SIZE=Ae,U.DEFAULT_IMAGE_RESIZE_OPTIONS=de,U.DEFAULT_PAGE_SIZE=Je,U.DocumentProvider=Rn,U.EditorToolbar=ze,U.ErrorBoundary=mt,U.FONT_SIZE_MAP=ut,U.HtmlEditor=Ue,U.ImageResizeHandlers=Be,U.PAGE_DIMENSIONS=To,U.PAGE_SIZES=se,U.PageManager=fn,U.PageView=$e,U.RESIZE_HANDLERS=P,U.Sidebar=an,U.applyImageDimensions=Zn,U.calculateResizeDimensions=qn,U.clearImages=Tr,U.createResizeOverlay=dt,U.deleteImage=Xt,U.getAllImageKeys=vr,U.getAvailablePageSizes=On,U.getImage=Kt,U.getImageDimensions=Wn,U.getPageDimensions=Me,U.getPixelValue=Un,U.getPointValue=Gn,U.isResizableImage=ue,U.isValidFontSize=Fn,U.isValidPageSize=Cn,U.logger=sn,U.pixelsToPoints=Ht,U.pointsToPixels=Dt,U.removeResizeOverlay=he,U.saveImage=Vt,U.updateResizeOverlay=ke,U.useContinuousReflow=Yt,U.useDocument=tt,U.useDocumentActions=Ee,U.useDocumentState=nt,U.useFormatting=Bt,Object.defineProperty(U,Symbol.toStringTag,{value:"Module"})}));
//# sourceMappingURL=htmleditor.umd.cjs.map
