(function(R,E){typeof exports=="object"&&typeof module<"u"?E(exports,require("react"),require("uuid")):typeof define=="function"&&define.amd?define(["exports","react","uuid"],E):(R=typeof globalThis<"u"?globalThis:R||self,E(R.HTMLEditor={},R.React,R.uuid))})(this,(function(R,E,xe){"use strict";function Ot(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var fe={exports:{}},ce={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ze;function Nt(){if(Ze)return ce;Ze=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function a(n,r,s){var i=null;if(s!==void 0&&(i=""+s),r.key!==void 0&&(i=""+r.key),"key"in r){s={};for(var l in r)l!=="key"&&(s[l]=r[l])}else s=r;return r=s.ref,{$$typeof:e,type:n,key:i,ref:r!==void 0?r:null,props:s}}return ce.Fragment=t,ce.jsx=a,ce.jsxs=a,ce}var le={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qe;function jt(){return qe||(qe=1,process.env.NODE_ENV!=="production"&&(function(){function e(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===re?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case O:return"Fragment";case S:return"Profiler";case v:return"StrictMode";case H:return"Suspense";case q:return"SuspenseList";case Q:return"Activity"}if(typeof o=="object")switch(typeof o.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),o.$$typeof){case k:return"Portal";case N:return o.displayName||"Context";case b:return(o._context.displayName||"Context")+".Consumer";case g:var y=o.render;return o=o.displayName,o||(o=y.displayName||y.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case F:return y=o.displayName||null,y!==null?y:e(o.type)||"Memo";case X:y=o._payload,o=o._init;try{return e(o(y))}catch{}}return null}function t(o){return""+o}function a(o){try{t(o);var y=!1}catch{y=!0}if(y){y=console;var A=y.error,P=typeof Symbol=="function"&&Symbol.toStringTag&&o[Symbol.toStringTag]||o.constructor.name||"Object";return A.call(y,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",P),t(o)}}function n(o){if(o===O)return"<>";if(typeof o=="object"&&o!==null&&o.$$typeof===X)return"<...>";try{var y=e(o);return y?"<"+y+">":"<...>"}catch{return"<...>"}}function r(){var o=oe.A;return o===null?null:o.getOwner()}function s(){return Error("react-stack-top-frame")}function i(o){if(ae.call(o,"key")){var y=Object.getOwnPropertyDescriptor(o,"key").get;if(y&&y.isReactWarning)return!1}return o.key!==void 0}function l(o,y){function A(){G||(G=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",y))}A.isReactWarning=!0,Object.defineProperty(o,"key",{get:A,configurable:!0})}function m(){var o=e(this.type);return W[o]||(W[o]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),o=this.props.ref,o!==void 0?o:null}function p(o,y,A,P,I,j){var C=A.ref;return o={$$typeof:w,type:o,key:y,props:A,_owner:P},(C!==void 0?C:null)!==null?Object.defineProperty(o,"ref",{enumerable:!1,get:m}):Object.defineProperty(o,"ref",{enumerable:!1,value:null}),o._store={},Object.defineProperty(o._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(o,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(o,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:I}),Object.defineProperty(o,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:j}),Object.freeze&&(Object.freeze(o.props),Object.freeze(o)),o}function h(o,y,A,P,I,j){var C=y.children;if(C!==void 0)if(P)if(ne(C)){for(P=0;P<C.length;P++)d(C[P]);Object.freeze&&Object.freeze(C)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else d(C);if(ae.call(y,"key")){C=e(o);var M=Object.keys(y).filter(function(L){return L!=="key"});P=0<M.length?"{key: someKey, "+M.join(": ..., ")+": ...}":"{key: someKey}",f[C+P]||(M=0<M.length?"{"+M.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,P,C,M,C),f[C+P]=!0)}if(C=null,A!==void 0&&(a(A),C=""+A),i(y)&&(a(y.key),C=""+y.key),"key"in y){A={};for(var z in y)z!=="key"&&(A[z]=y[z])}else A=y;return C&&l(A,typeof o=="function"?o.displayName||o.name||"Unknown":o),p(o,C,A,r(),I,j)}function d(o){x(o)?o._store&&(o._store.validated=1):typeof o=="object"&&o!==null&&o.$$typeof===X&&(o._payload.status==="fulfilled"?x(o._payload.value)&&o._payload.value._store&&(o._payload.value._store.validated=1):o._store&&(o._store.validated=1))}function x(o){return typeof o=="object"&&o!==null&&o.$$typeof===w}var _=E,w=Symbol.for("react.transitional.element"),k=Symbol.for("react.portal"),O=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),b=Symbol.for("react.consumer"),N=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),H=Symbol.for("react.suspense"),q=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),X=Symbol.for("react.lazy"),Q=Symbol.for("react.activity"),re=Symbol.for("react.client.reference"),oe=_.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae=Object.prototype.hasOwnProperty,ne=Array.isArray,V=console.createTask?console.createTask:function(){return null};_={react_stack_bottom_frame:function(o){return o()}};var G,W={},ee=_.react_stack_bottom_frame.bind(_,s)(),te=V(n(s)),f={};le.Fragment=O,le.jsx=function(o,y,A){var P=1e4>oe.recentlyCreatedOwnerStacks++;return h(o,y,A,!1,P?Error("react-stack-top-frame"):ee,P?V(n(o)):te)},le.jsxs=function(o,y,A){var P=1e4>oe.recentlyCreatedOwnerStacks++;return h(o,y,A,!0,P?Error("react-stack-top-frame"):ee,P?V(n(o)):te)}})()),le}var Ge;function Mt(){return Ge||(Ge=1,process.env.NODE_ENV==="production"?fe.exports=Nt():fe.exports=jt()),fe.exports}var c=Mt();const Te=100,Ae=50,Pe=200,Fe=5,ke=e=>e<Pe,Ce=e=>e>Ae,ue="A4",ie="<p><br></p>",It="continuous",Se={A4:{width:595,height:842},Letter:{width:612,height:792},Legal:{width:612,height:1008}},de=(e,t=ue)=>({id:xe.v4(),index:e,size:t,content:ie,images:[],isBreakPoint:!1}),pe=e=>typeof e!="string"||e.trim()===""?ie:e,Ye=(e,t=ue)=>(e.length>0?e:[de(0,t)]).map((n,r)=>({id:n.id||xe.v4(),index:r,size:n.size||t,content:pe(n.content),images:n.images||[],isBreakPoint:!!n.isBreakPoint})),Rt=(e=ue)=>[{id:"page-0",pageNumber:1,top:0,height:(Se[e]||Se.A4).height}],we=(e={})=>{const t=new Date().toISOString(),a=e.pageSize||ue,n=Ye(e.pages||[de(0,a)],a);return{id:xe.v4(),title:e.title||"Untitled Document",createdAt:t,updatedAt:t,pageSize:a,pages:n,activePage:e.activePage&&e.activePage<n.length?e.activePage:0,pageBreaks:e.pageBreaks||[],totalPages:n.length,editorMode:e.editorMode||It,continuousContent:e.continuousContent||ie,pageBoundaries:e.pageBoundaries||Rt(a),zoomLevel:e.zoomLevel||Te}},D={INITIALIZE_DOCUMENT:"INITIALIZE_DOCUMENT",UPDATE_TITLE:"UPDATE_TITLE",UPDATE_PAGE_CONTENT:"UPDATE_PAGE_CONTENT",UPDATE_PAGES:"UPDATE_PAGES",ADD_PAGE:"ADD_PAGE",DELETE_PAGE:"DELETE_PAGE",SET_ACTIVE_PAGE:"SET_ACTIVE_PAGE",UPDATE_PAGE_SIZE:"UPDATE_PAGE_SIZE",RESET_DOCUMENT:"RESET_DOCUMENT",UPDATE_CONTINUOUS_CONTENT:"UPDATE_CONTINUOUS_CONTENT",UPDATE_PAGE_BOUNDARIES:"UPDATE_PAGE_BOUNDARIES",ADD_PAGE_BREAK:"ADD_PAGE_BREAK",REMOVE_PAGE_BREAK:"REMOVE_PAGE_BREAK",SET_EDITOR_MODE:"SET_EDITOR_MODE",INSERT_PAGE_AT:"INSERT_PAGE_AT",MOVE_PAGE_TO:"MOVE_PAGE_TO",DUPLICATE_PAGE:"DUPLICATE_PAGE",SET_ZOOM_LEVEL:"SET_ZOOM_LEVEL",ZOOM_IN:"ZOOM_IN",ZOOM_OUT:"ZOOM_OUT",RESET_ZOOM:"RESET_ZOOM"},Dt=(e,t)=>{const a=new Date().toISOString();switch(t.type){case D.INITIALIZE_DOCUMENT:{const{initialContent:n=ie,pageSize:r=ue}=t.payload||{},s={...de(0,r),content:pe(n)};return we({title:e.title,pageSize:r,pages:[s]})}case D.UPDATE_TITLE:return{...e,title:t.payload,updatedAt:a};case D.UPDATE_PAGE_CONTENT:{const{pageIndex:n,content:r}=t.payload;if(n<0||n>=e.pages.length)return e;const s=[...e.pages];return s[n]={...s[n],content:pe(r)},{...e,pages:s,updatedAt:a}}case D.UPDATE_PAGES:{const n=Array.isArray(t.payload)?{pages:t.payload}:t.payload||{},r=Ye(n.pages||[],e.pageSize),s=Array.isArray(n.pageBreaks)?n.pageBreaks:r.slice(0,-1).map((i,l)=>({id:`auto-break-${l}`,pageNumber:l+1}));return{...e,pages:r,activePage:Math.min(e.activePage,r.length-1),pageBreaks:s,totalPages:r.length,updatedAt:a}}case D.ADD_PAGE:{const n=typeof t.payload?.index=="number"?Math.min(Math.max(t.payload.index,0),e.pages.length):e.pages.length,r=[...e.pages];r.splice(n,0,de(n,e.pageSize));const s=r.map((l,m)=>({...l,index:m,size:e.pageSize})),i=s.slice(0,-1).map((l,m)=>({id:`auto-break-${m}`,pageNumber:m+1}));return{...e,pages:s,activePage:n,pageBreaks:i,totalPages:s.length,updatedAt:a}}case D.DELETE_PAGE:{const n=t.payload;if(e.pages.length<=1)return e;const r=[...e.pages];r.splice(n,1);const s=r.map((m,p)=>({...m,index:p,size:e.pageSize}));let i=e.activePage;i>=s.length?i=s.length-1:n<=i&&i>0&&(i-=1);const l=s.slice(0,-1).map((m,p)=>({id:`auto-break-${p}`,pageNumber:p+1}));return{...e,pages:s,activePage:i,pageBreaks:l,totalPages:s.length,updatedAt:a}}case D.SET_ACTIVE_PAGE:{const n=t.payload;if(n===e.activePage)return e;const r=e.editorMode==="continuous"?e.pageBoundaries.length:e.pages.length;return n<0||n>=r?e:{...e,activePage:n,updatedAt:a}}case D.UPDATE_PAGE_SIZE:{const n=t.payload;if(n===e.pageSize)return e;if(!Se[n])return console.warn(`Invalid page size: ${n}`),e;const r=e.pages.map((i,l)=>({...i,index:l,size:n})),s=r.slice(0,-1).map((i,l)=>({id:`auto-break-${l}`,pageNumber:l+1}));return{...e,pageSize:n,pages:r,pageBreaks:s,updatedAt:a}}case D.RESET_DOCUMENT:return we();case D.UPDATE_CONTINUOUS_CONTENT:{const n=pe(t.payload);return n===e.continuousContent?e:{...e,continuousContent:n,updatedAt:a}}case D.UPDATE_PAGE_BOUNDARIES:{const n=Array.isArray(t.payload)?t.payload:[];if(n.length===e.pageBoundaries.length&&n.length>0&&n[0].id===e.pageBoundaries[0]?.id&&n[n.length-1].id===e.pageBoundaries[n.length-1]?.id)return e;const r=e.activePage>=n.length?Math.max(0,n.length-1):e.activePage;return{...e,pageBoundaries:n,totalPages:n.length,activePage:r,updatedAt:a}}case D.ADD_PAGE_BREAK:{const{position:n="end",pageIndex:r}=t.payload||{},s='<page-break data-page-break="true" style="display: block; height: 20px; border-top: 2px dashed #ccc; margin: 20px 0; page-break-after: always;"></page-break>';let i=e.continuousContent;if(n==="end")i=i+s+"<p><br></p>";else if(typeof n=="number"){const l=i.substring(0,n),m=i.substring(n);i=l+s+m}else if(typeof r=="number"&&typeof document<"u"){const l=document.createElement("div");l.innerHTML=i;const m=l.querySelectorAll('page-break, [data-page-break="true"]');if(r===0&&m.length===0)i=i+s+"<p><br></p>";else if(r<m.length){const p=m[r],h=document.createElement("page-break");h.setAttribute("data-page-break","true"),h.setAttribute("style","display: block; height: 20px; border-top: 2px dashed #ccc; margin: 20px 0; page-break-after: always;");const d=document.createElement("p");d.innerHTML="<br>",p.parentNode.insertBefore(h,p.nextSibling),h.parentNode.insertBefore(d,h.nextSibling),i=l.innerHTML}else i=i+s+"<p><br></p>"}return{...e,continuousContent:i,updatedAt:a}}case D.REMOVE_PAGE_BREAK:{const{pageIndex:n}=t.payload||{};if(typeof n!="number"||typeof document>"u")return e;const r=document.createElement("div");r.innerHTML=e.continuousContent;const s=r.querySelectorAll('page-break, [data-page-break="true"]');return s[n]&&s[n].remove(),r.querySelectorAll('page-break, [data-page-break="true"]').forEach((l,m)=>{l.setAttribute("data-page-number",String(m+2))}),{...e,continuousContent:r.innerHTML,updatedAt:a}}case D.SET_EDITOR_MODE:{const n=t.payload;if(n===e.editorMode)return e;let r=e.continuousContent,s=e.pages;return n==="continuous"?r=e.pages.map(l=>l.content).filter(l=>l&&l!==ie).join(`
`)||ie:e.continuousContent&&e.continuousContent!==ie&&(s=[{...de(0,e.pageSize),content:e.continuousContent}]),{...e,editorMode:n,continuousContent:r,pages:s,updatedAt:a}}case D.SET_ZOOM_LEVEL:{const n=t.payload;return n<Ae||n>Pe?(console.warn(`Invalid zoom level: ${n}. Must be between ${Ae} and ${Pe}.`),e):n===e.zoomLevel?e:{...e,zoomLevel:n,updatedAt:a}}case D.ZOOM_IN:{if(!ke(e.zoomLevel))return e;const n=e.zoomLevel+Fe;return{...e,zoomLevel:n,updatedAt:a}}case D.ZOOM_OUT:{if(!Ce(e.zoomLevel))return e;const n=e.zoomLevel-Fe;return{...e,zoomLevel:n,updatedAt:a}}case D.RESET_ZOOM:return e.zoomLevel===Te?e:{...e,zoomLevel:Te,updatedAt:a};default:return e}},Ve=E.createContext(null),Lt=({children:e,initialState:t={}})=>{const[a,n]=E.useReducer(Dt,we(t)),r=E.useMemo(()=>({initializeDocument:i=>n({type:D.INITIALIZE_DOCUMENT,payload:i}),updateTitle:i=>n({type:D.UPDATE_TITLE,payload:i}),updatePageContent:i=>n({type:D.UPDATE_PAGE_CONTENT,payload:i}),updatePages:i=>n({type:D.UPDATE_PAGES,payload:i}),addPage:i=>n({type:D.ADD_PAGE,payload:i}),deletePage:i=>n({type:D.DELETE_PAGE,payload:i}),setActivePage:i=>n({type:D.SET_ACTIVE_PAGE,payload:i}),updatePageSize:i=>n({type:D.UPDATE_PAGE_SIZE,payload:i}),resetDocument:()=>n({type:D.RESET_DOCUMENT}),updateContinuousContent:i=>n({type:D.UPDATE_CONTINUOUS_CONTENT,payload:i}),updatePageBoundaries:i=>n({type:D.UPDATE_PAGE_BOUNDARIES,payload:i}),addPageBreak:i=>n({type:D.ADD_PAGE_BREAK,payload:i}),removePageBreak:i=>n({type:D.REMOVE_PAGE_BREAK,payload:i}),setEditorMode:i=>n({type:D.SET_EDITOR_MODE,payload:i}),insertPageAt:i=>n({type:D.INSERT_PAGE_AT,payload:i}),movePageTo:i=>n({type:D.MOVE_PAGE_TO,payload:i}),duplicatePage:i=>n({type:D.DUPLICATE_PAGE,payload:i}),setZoomLevel:i=>n({type:D.SET_ZOOM_LEVEL,payload:i}),zoomIn:()=>n({type:D.ZOOM_IN}),zoomOut:()=>n({type:D.ZOOM_OUT}),resetZoom:()=>n({type:D.RESET_ZOOM})}),[]),s=E.useMemo(()=>({state:a,actions:r,dispatch:n}),[a,r]);return c.jsx(Ve.Provider,{value:s,children:e})},Oe=()=>{const e=E.useContext(Ve);if(!e)throw new Error("useDocument must be used within a DocumentProvider");return e},Ne=()=>{const{state:e}=Oe();return e},je=()=>{const{actions:e}=Oe();return e};var ge={exports:{}},he={exports:{}},$={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var We;function zt(){if(We)return $;We=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,a=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,r=e?Symbol.for("react.strict_mode"):60108,s=e?Symbol.for("react.profiler"):60114,i=e?Symbol.for("react.provider"):60109,l=e?Symbol.for("react.context"):60110,m=e?Symbol.for("react.async_mode"):60111,p=e?Symbol.for("react.concurrent_mode"):60111,h=e?Symbol.for("react.forward_ref"):60112,d=e?Symbol.for("react.suspense"):60113,x=e?Symbol.for("react.suspense_list"):60120,_=e?Symbol.for("react.memo"):60115,w=e?Symbol.for("react.lazy"):60116,k=e?Symbol.for("react.block"):60121,O=e?Symbol.for("react.fundamental"):60117,v=e?Symbol.for("react.responder"):60118,S=e?Symbol.for("react.scope"):60119;function b(g){if(typeof g=="object"&&g!==null){var H=g.$$typeof;switch(H){case t:switch(g=g.type,g){case m:case p:case n:case s:case r:case d:return g;default:switch(g=g&&g.$$typeof,g){case l:case h:case w:case _:case i:return g;default:return H}}case a:return H}}}function N(g){return b(g)===p}return $.AsyncMode=m,$.ConcurrentMode=p,$.ContextConsumer=l,$.ContextProvider=i,$.Element=t,$.ForwardRef=h,$.Fragment=n,$.Lazy=w,$.Memo=_,$.Portal=a,$.Profiler=s,$.StrictMode=r,$.Suspense=d,$.isAsyncMode=function(g){return N(g)||b(g)===m},$.isConcurrentMode=N,$.isContextConsumer=function(g){return b(g)===l},$.isContextProvider=function(g){return b(g)===i},$.isElement=function(g){return typeof g=="object"&&g!==null&&g.$$typeof===t},$.isForwardRef=function(g){return b(g)===h},$.isFragment=function(g){return b(g)===n},$.isLazy=function(g){return b(g)===w},$.isMemo=function(g){return b(g)===_},$.isPortal=function(g){return b(g)===a},$.isProfiler=function(g){return b(g)===s},$.isStrictMode=function(g){return b(g)===r},$.isSuspense=function(g){return b(g)===d},$.isValidElementType=function(g){return typeof g=="string"||typeof g=="function"||g===n||g===p||g===s||g===r||g===d||g===x||typeof g=="object"&&g!==null&&(g.$$typeof===w||g.$$typeof===_||g.$$typeof===i||g.$$typeof===l||g.$$typeof===h||g.$$typeof===O||g.$$typeof===v||g.$$typeof===S||g.$$typeof===k)},$.typeOf=b,$}var B={};/** @license React v16.13.1
 * react-is.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ke;function $t(){return Ke||(Ke=1,process.env.NODE_ENV!=="production"&&(function(){var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,a=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,r=e?Symbol.for("react.strict_mode"):60108,s=e?Symbol.for("react.profiler"):60114,i=e?Symbol.for("react.provider"):60109,l=e?Symbol.for("react.context"):60110,m=e?Symbol.for("react.async_mode"):60111,p=e?Symbol.for("react.concurrent_mode"):60111,h=e?Symbol.for("react.forward_ref"):60112,d=e?Symbol.for("react.suspense"):60113,x=e?Symbol.for("react.suspense_list"):60120,_=e?Symbol.for("react.memo"):60115,w=e?Symbol.for("react.lazy"):60116,k=e?Symbol.for("react.block"):60121,O=e?Symbol.for("react.fundamental"):60117,v=e?Symbol.for("react.responder"):60118,S=e?Symbol.for("react.scope"):60119;function b(u){return typeof u=="string"||typeof u=="function"||u===n||u===p||u===s||u===r||u===d||u===x||typeof u=="object"&&u!==null&&(u.$$typeof===w||u.$$typeof===_||u.$$typeof===i||u.$$typeof===l||u.$$typeof===h||u.$$typeof===O||u.$$typeof===v||u.$$typeof===S||u.$$typeof===k)}function N(u){if(typeof u=="object"&&u!==null){var Z=u.$$typeof;switch(Z){case t:var K=u.type;switch(K){case m:case p:case n:case s:case r:case d:return K;default:var _e=K&&K.$$typeof;switch(_e){case l:case h:case w:case _:case i:return _e;default:return Z}}case a:return Z}}}var g=m,H=p,q=l,F=i,X=t,Q=h,re=n,oe=w,ae=_,ne=a,V=s,G=r,W=d,ee=!1;function te(u){return ee||(ee=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),f(u)||N(u)===m}function f(u){return N(u)===p}function o(u){return N(u)===l}function y(u){return N(u)===i}function A(u){return typeof u=="object"&&u!==null&&u.$$typeof===t}function P(u){return N(u)===h}function I(u){return N(u)===n}function j(u){return N(u)===w}function C(u){return N(u)===_}function M(u){return N(u)===a}function z(u){return N(u)===s}function L(u){return N(u)===r}function Y(u){return N(u)===d}B.AsyncMode=g,B.ConcurrentMode=H,B.ContextConsumer=q,B.ContextProvider=F,B.Element=X,B.ForwardRef=Q,B.Fragment=re,B.Lazy=oe,B.Memo=ae,B.Portal=ne,B.Profiler=V,B.StrictMode=G,B.Suspense=W,B.isAsyncMode=te,B.isConcurrentMode=f,B.isContextConsumer=o,B.isContextProvider=y,B.isElement=A,B.isForwardRef=P,B.isFragment=I,B.isLazy=j,B.isMemo=C,B.isPortal=M,B.isProfiler=z,B.isStrictMode=L,B.isSuspense=Y,B.isValidElementType=b,B.typeOf=N})()),B}var Je;function Xe(){return Je||(Je=1,process.env.NODE_ENV==="production"?he.exports=zt():he.exports=$t()),he.exports}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var Me,Qe;function Bt(){if(Qe)return Me;Qe=1;var e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function n(s){if(s==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(s)}function r(){try{if(!Object.assign)return!1;var s=new String("abc");if(s[5]="de",Object.getOwnPropertyNames(s)[0]==="5")return!1;for(var i={},l=0;l<10;l++)i["_"+String.fromCharCode(l)]=l;var m=Object.getOwnPropertyNames(i).map(function(h){return i[h]});if(m.join("")!=="0123456789")return!1;var p={};return"abcdefghijklmnopqrst".split("").forEach(function(h){p[h]=h}),Object.keys(Object.assign({},p)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}return Me=r()?Object.assign:function(s,i){for(var l,m=n(s),p,h=1;h<arguments.length;h++){l=Object(arguments[h]);for(var d in l)t.call(l,d)&&(m[d]=l[d]);if(e){p=e(l);for(var x=0;x<p.length;x++)a.call(l,p[x])&&(m[p[x]]=l[p[x]])}}return m},Me}var Ie,et;function Re(){if(et)return Ie;et=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Ie=e,Ie}var De,tt;function nt(){return tt||(tt=1,De=Function.call.bind(Object.prototype.hasOwnProperty)),De}var Le,rt;function Ut(){if(rt)return Le;rt=1;var e=function(){};if(process.env.NODE_ENV!=="production"){var t=Re(),a={},n=nt();e=function(s){var i="Warning: "+s;typeof console<"u"&&console.error(i);try{throw new Error(i)}catch{}}}function r(s,i,l,m,p){if(process.env.NODE_ENV!=="production"){for(var h in s)if(n(s,h)){var d;try{if(typeof s[h]!="function"){var x=Error((m||"React class")+": "+l+" type `"+h+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof s[h]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw x.name="Invariant Violation",x}d=s[h](i,h,m,l,null,t)}catch(w){d=w}if(d&&!(d instanceof Error)&&e((m||"React class")+": type specification of "+l+" `"+h+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof d+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),d instanceof Error&&!(d.message in a)){a[d.message]=!0;var _=p?p():"";e("Failed "+l+" type: "+d.message+(_??""))}}}}return r.resetWarningCache=function(){process.env.NODE_ENV!=="production"&&(a={})},Le=r,Le}var ze,ot;function Ht(){if(ot)return ze;ot=1;var e=Xe(),t=Bt(),a=Re(),n=nt(),r=Ut(),s=function(){};process.env.NODE_ENV!=="production"&&(s=function(l){var m="Warning: "+l;typeof console<"u"&&console.error(m);try{throw new Error(m)}catch{}});function i(){return null}return ze=function(l,m){var p=typeof Symbol=="function"&&Symbol.iterator,h="@@iterator";function d(f){var o=f&&(p&&f[p]||f[h]);if(typeof o=="function")return o}var x="<<anonymous>>",_={array:v("array"),bigint:v("bigint"),bool:v("boolean"),func:v("function"),number:v("number"),object:v("object"),string:v("string"),symbol:v("symbol"),any:S(),arrayOf:b,element:N(),elementType:g(),instanceOf:H,node:Q(),objectOf:F,oneOf:q,oneOfType:X,shape:oe,exact:ae};function w(f,o){return f===o?f!==0||1/f===1/o:f!==f&&o!==o}function k(f,o){this.message=f,this.data=o&&typeof o=="object"?o:{},this.stack=""}k.prototype=Error.prototype;function O(f){if(process.env.NODE_ENV!=="production")var o={},y=0;function A(I,j,C,M,z,L,Y){if(M=M||x,L=L||C,Y!==a){if(m){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}else if(process.env.NODE_ENV!=="production"&&typeof console<"u"){var Z=M+":"+C;!o[Z]&&y<3&&(s("You are manually calling a React.PropTypes validation function for the `"+L+"` prop on `"+M+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),o[Z]=!0,y++)}}return j[C]==null?I?j[C]===null?new k("The "+z+" `"+L+"` is marked as required "+("in `"+M+"`, but its value is `null`.")):new k("The "+z+" `"+L+"` is marked as required in "+("`"+M+"`, but its value is `undefined`.")):null:f(j,C,M,z,L)}var P=A.bind(null,!1);return P.isRequired=A.bind(null,!0),P}function v(f){function o(y,A,P,I,j,C){var M=y[A],z=G(M);if(z!==f){var L=W(M);return new k("Invalid "+I+" `"+j+"` of type "+("`"+L+"` supplied to `"+P+"`, expected ")+("`"+f+"`."),{expectedType:f})}return null}return O(o)}function S(){return O(i)}function b(f){function o(y,A,P,I,j){if(typeof f!="function")return new k("Property `"+j+"` of component `"+P+"` has invalid PropType notation inside arrayOf.");var C=y[A];if(!Array.isArray(C)){var M=G(C);return new k("Invalid "+I+" `"+j+"` of type "+("`"+M+"` supplied to `"+P+"`, expected an array."))}for(var z=0;z<C.length;z++){var L=f(C,z,P,I,j+"["+z+"]",a);if(L instanceof Error)return L}return null}return O(o)}function N(){function f(o,y,A,P,I){var j=o[y];if(!l(j)){var C=G(j);return new k("Invalid "+P+" `"+I+"` of type "+("`"+C+"` supplied to `"+A+"`, expected a single ReactElement."))}return null}return O(f)}function g(){function f(o,y,A,P,I){var j=o[y];if(!e.isValidElementType(j)){var C=G(j);return new k("Invalid "+P+" `"+I+"` of type "+("`"+C+"` supplied to `"+A+"`, expected a single ReactElement type."))}return null}return O(f)}function H(f){function o(y,A,P,I,j){if(!(y[A]instanceof f)){var C=f.name||x,M=te(y[A]);return new k("Invalid "+I+" `"+j+"` of type "+("`"+M+"` supplied to `"+P+"`, expected ")+("instance of `"+C+"`."))}return null}return O(o)}function q(f){if(!Array.isArray(f))return process.env.NODE_ENV!=="production"&&(arguments.length>1?s("Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z])."):s("Invalid argument supplied to oneOf, expected an array.")),i;function o(y,A,P,I,j){for(var C=y[A],M=0;M<f.length;M++)if(w(C,f[M]))return null;var z=JSON.stringify(f,function(Y,u){var Z=W(u);return Z==="symbol"?String(u):u});return new k("Invalid "+I+" `"+j+"` of value `"+String(C)+"` "+("supplied to `"+P+"`, expected one of "+z+"."))}return O(o)}function F(f){function o(y,A,P,I,j){if(typeof f!="function")return new k("Property `"+j+"` of component `"+P+"` has invalid PropType notation inside objectOf.");var C=y[A],M=G(C);if(M!=="object")return new k("Invalid "+I+" `"+j+"` of type "+("`"+M+"` supplied to `"+P+"`, expected an object."));for(var z in C)if(n(C,z)){var L=f(C,z,P,I,j+"."+z,a);if(L instanceof Error)return L}return null}return O(o)}function X(f){if(!Array.isArray(f))return process.env.NODE_ENV!=="production"&&s("Invalid argument supplied to oneOfType, expected an instance of array."),i;for(var o=0;o<f.length;o++){var y=f[o];if(typeof y!="function")return s("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+ee(y)+" at index "+o+"."),i}function A(P,I,j,C,M){for(var z=[],L=0;L<f.length;L++){var Y=f[L],u=Y(P,I,j,C,M,a);if(u==null)return null;u.data&&n(u.data,"expectedType")&&z.push(u.data.expectedType)}var Z=z.length>0?", expected one of type ["+z.join(", ")+"]":"";return new k("Invalid "+C+" `"+M+"` supplied to "+("`"+j+"`"+Z+"."))}return O(A)}function Q(){function f(o,y,A,P,I){return ne(o[y])?null:new k("Invalid "+P+" `"+I+"` supplied to "+("`"+A+"`, expected a ReactNode."))}return O(f)}function re(f,o,y,A,P){return new k((f||"React class")+": "+o+" type `"+y+"."+A+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+P+"`.")}function oe(f){function o(y,A,P,I,j){var C=y[A],M=G(C);if(M!=="object")return new k("Invalid "+I+" `"+j+"` of type `"+M+"` "+("supplied to `"+P+"`, expected `object`."));for(var z in f){var L=f[z];if(typeof L!="function")return re(P,I,j,z,W(L));var Y=L(C,z,P,I,j+"."+z,a);if(Y)return Y}return null}return O(o)}function ae(f){function o(y,A,P,I,j){var C=y[A],M=G(C);if(M!=="object")return new k("Invalid "+I+" `"+j+"` of type `"+M+"` "+("supplied to `"+P+"`, expected `object`."));var z=t({},y[A],f);for(var L in z){var Y=f[L];if(n(f,L)&&typeof Y!="function")return re(P,I,j,L,W(Y));if(!Y)return new k("Invalid "+I+" `"+j+"` key `"+L+"` supplied to `"+P+"`.\nBad object: "+JSON.stringify(y[A],null,"  ")+`
Valid keys: `+JSON.stringify(Object.keys(f),null,"  "));var u=Y(C,L,P,I,j+"."+L,a);if(u)return u}return null}return O(o)}function ne(f){switch(typeof f){case"number":case"string":case"undefined":return!0;case"boolean":return!f;case"object":if(Array.isArray(f))return f.every(ne);if(f===null||l(f))return!0;var o=d(f);if(o){var y=o.call(f),A;if(o!==f.entries){for(;!(A=y.next()).done;)if(!ne(A.value))return!1}else for(;!(A=y.next()).done;){var P=A.value;if(P&&!ne(P[1]))return!1}}else return!1;return!0;default:return!1}}function V(f,o){return f==="symbol"?!0:o?o["@@toStringTag"]==="Symbol"||typeof Symbol=="function"&&o instanceof Symbol:!1}function G(f){var o=typeof f;return Array.isArray(f)?"array":f instanceof RegExp?"object":V(o,f)?"symbol":o}function W(f){if(typeof f>"u"||f===null)return""+f;var o=G(f);if(o==="object"){if(f instanceof Date)return"date";if(f instanceof RegExp)return"regexp"}return o}function ee(f){var o=W(f);switch(o){case"array":case"object":return"an "+o;case"boolean":case"date":case"regexp":return"a "+o;default:return o}}function te(f){return!f.constructor||!f.constructor.name?x:f.constructor.name}return _.checkPropTypes=r,_.resetWarningCache=r.resetWarningCache,_.PropTypes=_,_},ze}var $e,at;function Zt(){if(at)return $e;at=1;var e=Re();function t(){}function a(){}return a.resetWarningCache=t,$e=function(){function n(i,l,m,p,h,d){if(d!==e){var x=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw x.name="Invariant Violation",x}}n.isRequired=n;function r(){return n}var s={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:r,element:n,elementType:n,instanceOf:r,node:n,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:a,resetWarningCache:t};return s.PropTypes=s,s},$e}var it;function qt(){if(it)return ge.exports;if(it=1,process.env.NODE_ENV!=="production"){var e=Xe(),t=!0;ge.exports=Ht()(e.isElement,t)}else ge.exports=Zt()();return ge.exports}var Gt=qt();const T=Ot(Gt),Be={"7.5pt":{pt:7.5,px:10,label:"7.5"},"9pt":{pt:9,px:12,label:"9"},"10pt":{pt:10,px:13,label:"10"},"11pt":{pt:11,px:15,label:"11"},"12pt":{pt:12,px:16,label:"12"},"14pt":{pt:14,px:19,label:"14"},"16pt":{pt:16,px:21,label:"16"},"18pt":{pt:18,px:24,label:"18"},"20pt":{pt:20,px:27,label:"20"},"22pt":{pt:22,px:29,label:"22"},"24pt":{pt:24,px:32,label:"24"},"26pt":{pt:26,px:35,label:"26"},"28pt":{pt:28,px:37,label:"28"},"36pt":{pt:36,px:48,label:"36"},"48pt":{pt:48,px:64,label:"48"},"72pt":{pt:72,px:96,label:"72"}},st=[{value:"10px",label:"7.5",pt:7.5},{value:"12px",label:"9",pt:9},{value:"13px",label:"10",pt:10},{value:"15px",label:"11",pt:11},{value:"16px",label:"12",pt:12},{value:"19px",label:"14",pt:14},{value:"21px",label:"16",pt:16},{value:"24px",label:"18",pt:18},{value:"27px",label:"20",pt:20},{value:"32px",label:"24",pt:24},{value:"37px",label:"28",pt:28},{value:"48px",label:"36",pt:36},{value:"64px",label:"48",pt:48},{value:"96px",label:"72",pt:72}],me="16px",ct=e=>Math.round(e*96/72),lt=e=>Math.round(e*72/96*2)/2,Ft=e=>{const t=Object.values(Be).find(a=>a.pt===e);return t?`${t.px}px`:`${ct(e)}px`},Yt=e=>{const t=parseInt(e),a=Object.values(Be).find(n=>n.px===t);return a?a.pt:lt(t)},Vt=e=>{if(!e)return!1;if(e.endsWith("px")){const t=parseInt(e);return t>=8&&t<=144}if(e.endsWith("pt")){const t=parseFloat(e);return t>=6&&t<=108}return!1},Wt={"10px":"1","12px":"2","13px":"2","15px":"3","16px":"3","19px":"4","21px":"4","24px":"5","27px":"5","32px":"6","37px":"6","48px":"6","64px":"7","96px":"7"},ut={bold:!1,italic:!1,underline:!1,strikethrough:!1,alignLeft:!1,alignCenter:!1,alignRight:!1,alignJustify:!1,fontFamily:"Arial",fontSize:me,headingLevel:"p"},dt=()=>{const[e,t]=E.useState(ut),a=E.useCallback(i=>{t(l=>({...l,alignLeft:i==="left",alignCenter:i==="center",alignRight:i==="right",alignJustify:i==="justify"}))},[]),n=E.useCallback(i=>{try{const l=window.getSelection();if(!l||l.rangeCount===0)return!1;const m=l.getRangeAt(0);if(!m.toString())return t(h=>({...h,fontSize:i})),!1;try{const h=document.createElement("span");h.style.fontSize=i;const d=m.extractContents();return h.appendChild(d),m.insertNode(h),m.selectNodeContents(h),l.removeAllRanges(),l.addRange(m),t(x=>({...x,fontSize:i})),!0}catch{const d=Wt[i]||"2";return document.execCommand("fontSize",!1,d),t(x=>({...x,fontSize:i})),!0}}catch(l){return console.warn("[useFormatting] Font size change failed:",l),!1}},[]),r=E.useCallback((i,l=null)=>{try{if(typeof document.execCommand!="function"){console.warn("[useFormatting] execCommand not supported");return}if(i==="fontSize"){n(l);return}switch(document.execCommand(i,!1,l)||console.warn(`[useFormatting] Command "${i}" failed`),i){case"bold":t(p=>({...p,bold:!p.bold}));break;case"italic":t(p=>({...p,italic:!p.italic}));break;case"underline":t(p=>({...p,underline:!p.underline}));break;case"strikethrough":t(p=>({...p,strikethrough:!p.strikethrough}));break;case"justifyLeft":a("left");break;case"justifyCenter":a("center");break;case"justifyRight":a("right");break;case"justifyFull":a("justify");break;case"fontName":t(p=>({...p,fontFamily:l}));break;case"formatBlock":t(p=>({...p,headingLevel:l}));break;default:break}}catch(m){console.warn(`[useFormatting] Error executing command "${i}":`,m)}},[n,a]),s=E.useCallback(()=>{t(ut)},[]);return{currentFormat:e,formatText:r,resetFormat:s}},J={A4:{name:"A4",width:794,height:1123,widthMm:210,heightMm:297,widthIn:8.27,heightIn:11.69},Letter:{name:"Letter",width:816,height:1056,widthMm:216,heightMm:279,widthIn:8.5,heightIn:11},Legal:{name:"Legal",width:816,height:1344,widthMm:216,heightMm:356,widthIn:8.5,heightIn:14}},ft="A4",pt=e=>{const t=J[e]||J[ft];return{width:t.width,height:t.height}},Kt=e=>Object.keys(J).includes(e),Jt=()=>Object.keys(J),gt={top:40,bottom:40},se='page-break, [data-page-break="true"]',ht=e=>J[e]||J.A4,Xt=(e,t={})=>{if(!e||typeof document>"u")return[];const a=t.pageSize||"A4",n=ht(a),r=e.querySelectorAll(se),s=[];s.push({id:"page-0",pageNumber:1,top:0,height:n.height});const i=e.getBoundingClientRect(),l=e.scrollTop;return r.forEach((m,p)=>{const d=m.getBoundingClientRect().top-i.top+l;s.push({id:`page-${p+1}`,pageNumber:p+2,top:d,height:n.height})}),s},mt=(e,t=100)=>{const n=ht(e).height-gt.top-gt.bottom,r=t/100;return n/r},Qt=(e,t)=>{if(!e||!t)return 0;try{const a=t.querySelectorAll(se);if(a.length===0)return 0;const n=e.getBoundingClientRect(),r=n.top+n.height/2;for(let s=a.length-1;s>=0;s--)if(a[s].getBoundingClientRect().top<r)return s+1;return 0}catch(a){return console.warn("[getCurrentPage] Failed to calculate page:",a),0}},yt=e=>{if(!e)return[];const t=Array.from(e.children);if(t.length===0)return[];let a=[],n=[];for(const r of t)r.tagName==="PAGE-BREAK"||r.getAttribute("data-page-break")==="true"?n.length>0&&(a.push(n),n=[]):n.push(r);return n.length>0&&a.push(n),a.length===0&&t.length>0&&a.push(t.filter(r=>!(r.tagName==="PAGE-BREAK"||r.getAttribute("data-page-break")==="true"))),a},en=(e,t)=>{if(!e)return!1;try{const a=document.createElement("page-break");return a.setAttribute("data-page-break","true"),a.setAttribute("contenteditable","false"),a.setAttribute("data-page-number",t||"2"),e.parentNode.insertBefore(a,e),!0}catch(a){return console.warn("[insertPageBreakBefore] Failed to insert page break:",a),!1}},tn=(e,t,a,n,r,s)=>{if(!e)return!1;try{const l=mt(a,n)*(t-1),m=Array.from(e.children);let p=0,h=null;for(let d=0;d<m.length;d++){const x=m[d];if(x.tagName==="PAGE-BREAK"||x.getAttribute("data-page-break")==="true")continue;const _=x.getBoundingClientRect().height;if(p+_>l){h=x;break}p+=_}if(h){const d=document.createElement("page-break");if(d.setAttribute("data-page-break","true"),d.setAttribute("contenteditable","false"),d.setAttribute("data-page-number",String(t)),h.parentNode.insertBefore(d,h),r){const x=e.innerHTML;r(x)}return s&&setTimeout(()=>{s()},50),!0}else{const d=document.createElement("page-break");d.setAttribute("data-page-break","true"),d.setAttribute("contenteditable","false"),d.setAttribute("data-page-number",String(t)),e.appendChild(d);const x=document.createElement("p");if(x.innerHTML="<br>",e.appendChild(x),r){const _=e.innerHTML;r(_)}return s&&setTimeout(()=>{s()},50),!0}}catch(i){return console.error("[insertPageBreakAtBoundary] Failed to insert page break:",i),!1}},nn=(e,t,a,n,r,s,i)=>{if(!e)return!1;if(a().length<=1)return console.warn("[removePageAndContent] Cannot delete the only page"),!1;try{const m=Array.from(e.querySelectorAll(se));if(t>m.length)return console.warn("[removePageAndContent] Invalid page index"),!1;const p=window.getSelection();let h=!1,d=[],x=null;if(t===0){const w=m[0];if(!w)return console.warn("[removePageAndContent] No page break found for first page"),!1;let k=e.firstChild;for(;k&&k!==w;)d.push(k),k=k.nextSibling;x=w}else{const w=m[t-1];if(!w)return console.warn("[removePageAndContent] Page break not found"),!1;const k=m[t];let O=w.nextSibling;for(;O&&O!==k;)d.push(O),O=O.nextSibling;x=w}if(p&&p.rangeCount>0){const k=p.getRangeAt(0).startContainer;for(const O of d)if(O.contains(k)||O===k){h=!0;break}}if(x&&x.parentNode&&x.remove(),d.forEach(w=>{w.parentNode&&w.remove()}),e.querySelectorAll(se).forEach((w,k)=>{w.setAttribute("data-page-number",String(k+2))}),h&&s&&setTimeout(()=>{s(0)},50),n){const w=e.innerHTML;n(w)}return r&&setTimeout(()=>{r(),i&&setTimeout(()=>{i()},150)},100),!0}catch(m){return console.error("[removePageAndContent] Failed to remove page:",m),!1}},rn=200,on=50,bt=3,an=20,sn=(e,t)=>{if(!e||e.length===0)return null;let a=0,n=null;for(let r=0;r<e.length;r++){const s=e[r];if(!s||!s.getBoundingClientRect)continue;const i=s.getBoundingClientRect().height;if(i<1)continue;if(a+i>t)return n===null?r>0?{overflowIndex:r,overflowElement:s,accumulatedHeight:a}:null:{overflowIndex:r,overflowElement:s,accumulatedHeight:a};a+=i,n=s}return null},cn=(e,t,a,n,r,s,i)=>{if(!e||s.current)return!1;try{s.current=!0;const l=mt(t,a);let m=yt(e),p=!1,h=0;for(let d=0;d<m.length&&h<bt;d++){const x=m[d],_=sn(x,l);if(_&&_.overflowIndex>0){let w=0;for(let S=0;S<x.length;S++){const b=x[S];b&&b.getBoundingClientRect&&(w+=b.getBoundingClientRect().height)}if(w-l<an)continue;const O=d+2;en(_.overflowElement,O)&&(p=!0,h++,m=yt(e))}}if(p){if(n){const d=e.innerHTML;n(d)}setTimeout(()=>{r&&r(),h>=bt&&i&&setTimeout(()=>{s.current||i()},100)},on)}return p}catch(l){return console.warn("[checkAndReflow] Reflow failed:",l),!1}finally{s.current=!1}},ln=(e,t,a=rn)=>{t.current&&clearTimeout(t.current),t.current=setTimeout(()=>{t.current=null,e()},a)},un=400,Et=(e,t)=>{if(e){e.focus();try{let a=null,n=0;if(t===0)a=e.firstChild,n=0;else{const s=e.querySelectorAll(se)[t-1];s&&s.nextSibling&&(a=s.nextSibling,n=0)}if(a){const r=document.createRange(),s=window.getSelection();a.nodeType===Node.TEXT_NODE?r.setStart(a,n):r.setStart(a,0),r.collapse(!0),s.removeAllRanges(),s.addRange(r)}}catch(a){console.warn("[positionCursorAtPage] Failed to position cursor:",a)}}},dn=(e,t,a,n)=>{if(!e||!t){console.warn("[scrollToPage] Missing refs");return}try{let r=null;if(a===0)r=t;else{const i=t.querySelectorAll(se)[a-1];if(i)r=i;else{console.warn("[scrollToPage] Page break not found for page",a);return}}if(r){const s=r.getBoundingClientRect(),i=e.getBoundingClientRect(),l=e.scrollTop+(s.top-i.top);console.log("[scrollToPage] Scrolling to page",a,"scrollTop:",l),e.scrollTo({top:l,behavior:"smooth"}),setTimeout(()=>{n?n(a):Et(t,a)},un)}}catch(r){console.error("[scrollToPage] Error:",r)}},fn=(e,t,a={},n=300)=>{t.current&&clearTimeout(t.current),t.current=setTimeout(()=>{t.current=null,e(a)},Math.max(0,n))},pn=300,vt=(e,t,a=100)=>{const n=je(),r=E.useRef(null),s=E.useRef(null),i=E.useRef(e),l=E.useRef(a),m=E.useRef(!1);E.useEffect(()=>{i.current=e},[e]),E.useEffect(()=>{l.current=a},[a]),E.useEffect(()=>()=>{r.current&&clearTimeout(r.current),s.current&&clearTimeout(s.current)},[]);const p=E.useCallback((b={})=>t?.current?Xt(t.current,b):[],[t]),h=E.useCallback((b={})=>{const N=p(b);return n.updatePageBoundaries(N),N},[p,n]),d=E.useCallback(async b=>{if(!t?.current)return!1;const N=i.current||"A4",g=l.current||100;return tn(t.current,b,N,g,n.updateContinuousContent,h)},[t,n,h]),x=E.useCallback(()=>{if(!t?.current)return;const b=i.current||"A4",N=l.current||100;cn(t.current,b,N,n.updateContinuousContent,h,m,x)},[t,n,h]),_=E.useCallback(b=>{ln(x,s,b)},[x]),w=E.useCallback((b={})=>{const N=typeof b.delay=="number"?b.delay:pn;fn(h,r,b,N)},[h]),k=E.useCallback(b=>!b?.current||!t?.current?0:Qt(b.current,t.current),[t]),O=E.useCallback(b=>{t?.current&&Et(t.current,b)},[t]),v=E.useCallback((b,N)=>{if(!N?.current||!t?.current){console.warn("[scrollToPage] Missing refs");return}dn(N.current,t.current,b,O)},[t,O]),S=E.useCallback(b=>t?.current?nn(t.current,b,p,n.updateContinuousContent,h,O,x):!1,[t,p,n,h,O,x]);return{calculatePageBoundaries:p,checkAndUpdateBoundaries:w,updateBoundaries:h,getCurrentPage:k,scrollToPage:v,positionCursorAtPage:O,checkAndReflow:x,triggerAutoReflow:_,removePageAndContent:S,insertPageBreakAtBoundary:d,boundaryTimeoutRef:r,reflowTimeoutRef:s}};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gn=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),hn=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,a,n)=>n?n.toUpperCase():a.toLowerCase()),_t=e=>{const t=hn(e);return t.charAt(0).toUpperCase()+t.slice(1)},xt=(...e)=>e.filter((t,a,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===a).join(" ").trim(),mn=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var yn={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bn=E.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:n,className:r="",children:s,iconNode:i,...l},m)=>E.createElement("svg",{ref:m,...yn,width:t,height:t,stroke:e,strokeWidth:n?Number(a)*24/Number(t):a,className:xt("lucide",r),...!s&&!mn(l)&&{"aria-hidden":"true"},...l},[...i.map(([p,h])=>E.createElement(p,h)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=(e,t)=>{const a=E.forwardRef(({className:n,...r},s)=>E.createElement(bn,{ref:s,iconNode:t,className:xt(`lucide-${gn(_t(e))}`,`lucide-${e}`,n),...r}));return a.displayName=_t(e),a};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const En=U("bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vn=U("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _n=U("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xn=U("file-check",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=U("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tn=U("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const An=U("heading-1",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pn=U("heading-2",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kn=U("heading-3",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17.5 10.5c1.7-1 3.5 0 3.5 1.5a2 2 0 0 1-2 2",key:"68ncm8"}],["path",{d:"M17 17.5c2 1.5 4 .3 4-1.5a2 2 0 0 0-2-2",key:"1ejuhz"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cn=U("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sn=U("italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wn=U("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const On=U("list-ordered",[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=U("list",[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nn=U("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jn=U("redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mn=U("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const In=U("strikethrough",[["path",{d:"M16 4H9a3 3 0 0 0-2.83 4",key:"43sutm"}],["path",{d:"M14 12a4 4 0 0 1 0 8H6",key:"nlfj13"}],["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rn=U("table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dn=U("text-align-center",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 19H5",key:"vjpgq2"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ln=U("text-align-end",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 19H7",key:"4cu937"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zn=U("text-align-justify",[["path",{d:"M3 5h18",key:"1u36vt"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 19h18",key:"awlh7x"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $n=U("text-align-start",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bn=U("underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Un=U("undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hn=U("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zn=U("zoom-in",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qn=U("zoom-out",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),At=({editorView:e,isCollapsed:t,onToggle:a,wordCount:n,pageCount:r})=>{const s=Ne(),{pages:i,activePage:l,continuousContent:m,editorMode:p}=s,[h,d]=E.useState(0),[x,_]=E.useState([]);E.useEffect(()=>{if(n!==void 0&&r!==void 0){if(d(n),m){const v=document.createElement("div");v.innerHTML=m;const S=v.querySelectorAll("h1, h2, h3, h4, h5, h6"),b=Array.from(S).map((N,g)=>{const H=parseInt(N.tagName.charAt(1)),q=N.textContent.trim();return q?{id:`heading-${g}`,level:H,text:q,page:1}:null}).filter(Boolean);_(b)}return}let k=0;const O=[];i.forEach((v,S)=>{if(v.content){const b=document.createElement("div");b.innerHTML=v.content;const g=(b.textContent||b.innerText||"").trim().split(/\s+/).filter(q=>q.length>0);k+=g.length,b.querySelectorAll("h1, h2, h3, h4, h5, h6").forEach((q,F)=>{const X=parseInt(q.tagName.charAt(1)),Q=q.textContent.trim();Q&&O.push({id:`heading-${S}-${F}`,level:X,text:Q,page:S+1})})}}),d(k),_(O)},[i,n,r,m]);const w=r!==void 0?r:i.length;return c.jsxs("aside",{className:`sidebar ${t?"collapsed":""}`,role:"complementary","aria-label":"Document information","data-testid":"sidebar",children:[c.jsxs("div",{className:"sidebar-header",children:[c.jsxs("div",{className:"sidebar-title",children:[c.jsx(ye,{size:18}),c.jsx("h2",{children:"Document Info"})]}),c.jsx("button",{className:"sidebar-toggle",onClick:a,"aria-label":t?"Expand sidebar":"Collapse sidebar",title:t?"Expand sidebar":"Collapse sidebar",children:t?c.jsx(_n,{size:16}):c.jsx(vn,{size:16})})]}),!t&&c.jsxs("div",{className:"sidebar-content",children:[c.jsxs("div",{className:"sidebar-section",children:[c.jsx("h3",{children:"Statistics"}),c.jsxs("div",{className:"stat-item",children:[c.jsxs("div",{className:"stat-label",children:[c.jsx(xn,{size:14}),c.jsx("span",{children:"Pages:"})]}),c.jsx("span",{className:"stat-value",children:w})]}),c.jsxs("div",{className:"stat-item","data-testid":"word-count",children:[c.jsxs("div",{className:"stat-label",children:[c.jsx(Tn,{size:14}),c.jsx("span",{children:"Words:"})]}),c.jsx("span",{className:"stat-value",children:h.toLocaleString()})]}),c.jsxs("div",{className:"stat-item",children:[c.jsxs("div",{className:"stat-label",children:[c.jsx(ye,{size:14}),c.jsx("span",{children:"Active Page:"})]}),c.jsx("span",{className:"stat-value",children:l+1})]})]}),x.length>0&&c.jsxs("div",{className:"sidebar-section",children:[c.jsxs("h3",{children:[c.jsx(Tt,{size:14,style:{display:"inline-block",marginRight:"6px",verticalAlign:"middle"}}),"Document Outline"]}),c.jsx("div",{className:"document-outline","data-testid":"outline",children:x.map(k=>{const O=k.level===1?An:k.level===2?Pn:kn;return c.jsxs("div",{className:`outline-item outline-level-${k.level}`,style:{marginLeft:`${(k.level-1)*12}px`},children:[c.jsx(O,{size:12,className:"outline-icon"}),c.jsx("span",{className:"outline-text",children:k.text}),c.jsxs("span",{className:"outline-page",children:["p.",k.page]})]},k.id)})})]}),c.jsxs("div",{className:"sidebar-section",children:[c.jsx("h3",{children:"Document"}),c.jsx("p",{children:"HTML Editor"}),c.jsx("p",{children:"Multi-page support"})]})]})]})};function Gn(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function Pt(e){return new Promise((t,a)=>{if(!["image/png","image/jpeg","image/gif","image/webp"].includes(e.type)){a(new Error("Invalid image format. Supported formats: png, jpeg, gif, webp"));return}if(e.size>5*1024*1024){a(new Error("Image exceeds maximum size of 5MB"));return}const r=new FileReader;r.onload=s=>{const i=s.target.result;if(i.split(",")[1].length*3/4>5*1024*1024){a(new Error("Image exceeds maximum size of 5MB"));return}try{const p=`editor-image-${Gn()}`;localStorage.setItem(p,i),t(p)}catch(p){p.name==="QuotaExceededError"?a(new Error("Storage quota exceeded")):a(p)}},r.onerror=()=>{a(new Error("Error reading image file"))},r.readAsDataURL(e)})}function Fn(e){return localStorage.getItem(e)}function Yn(e){localStorage.removeItem(e)}function Vn(){Object.keys(localStorage).forEach(e=>{e.startsWith("editor-image-")&&localStorage.removeItem(e)})}function Wn(){return Object.keys(localStorage).filter(e=>e.startsWith("editor-image-"))}class kt{constructor(t="Editor"){this.namespace=t}_format(t,a,n){return`[${new Date().toISOString()}] [${this.namespace}] [${t}] ${a}`}info(t,a){}warn(t,a){}error(t,a){}debug(t,a){}}const Ct=new kt("Editor"),be=({currentFormat:e,onFormatText:t,onAddPageBreak:a})=>{const n=async r=>{try{if(!["image/png","image/jpeg","image/gif","image/webp"].includes(r.type)){alert("Invalid image format. Supported: PNG, JPEG, GIF, WEBP");return}if(r.size>5242880){alert("Image exceeds maximum size of 5MB");return}const i=await Pt(r),l=localStorage.getItem(i);l&&(document.execCommand("insertImage",!1,l),Ct.info("Image inserted",{key:i}))}catch(s){Ct.error("Error uploading image",s)}};return c.jsxs("div",{className:"editor-toolbar",children:[c.jsx("button",{onClick:()=>t("undo"),title:"Undo",children:c.jsx(Un,{size:16})}),c.jsx("button",{onClick:()=>t("redo"),title:"Redo",children:c.jsx(jn,{size:16})}),c.jsx("div",{className:"toolbar-separator"}),c.jsx("button",{onClick:()=>t("bold"),className:e.bold?"active":"",title:"Bold",children:c.jsx(En,{size:16})}),c.jsx("button",{onClick:()=>t("italic"),className:e.italic?"active":"",title:"Italic",children:c.jsx(Sn,{size:16})}),c.jsx("button",{onClick:()=>t("underline"),className:e.underline?"active":"",title:"Underline",children:c.jsx(Bn,{size:16})}),c.jsx("button",{onClick:()=>t("strikethrough"),className:e.strikethrough?"active":"",title:"Strikethrough",children:c.jsx(In,{size:16})}),c.jsx("div",{className:"toolbar-separator"}),c.jsx("button",{onClick:()=>t("justifyLeft"),className:e.alignLeft?"active":"",title:"Align Left",children:c.jsx($n,{size:16})}),c.jsx("button",{onClick:()=>t("justifyCenter"),className:e.alignCenter?"active":"",title:"Align Center",children:c.jsx(Dn,{size:16})}),c.jsx("button",{onClick:()=>t("justifyRight"),className:e.alignRight?"active":"",title:"Align Right",children:c.jsx(Ln,{size:16})}),c.jsx("button",{onClick:()=>t("justifyFull"),className:e.alignJustify?"active":"",title:"Justify",children:c.jsx(zn,{size:16})}),c.jsx("div",{className:"toolbar-separator"}),c.jsxs("select",{onChange:r=>t("fontName",r.target.value),defaultValue:"Arial",title:"Font Family",children:[c.jsx("option",{value:"Arial",children:"Arial"}),c.jsx("option",{value:"Times New Roman",children:"Times New Roman"}),c.jsx("option",{value:"Courier New",children:"Courier New"}),c.jsx("option",{value:"Georgia",children:"Georgia"}),c.jsx("option",{value:"Verdana",children:"Verdana"})]}),c.jsx("select",{onChange:r=>t("fontSize",r.target.value),defaultValue:me,title:"Font Size",children:st.map(({value:r,label:s,pt:i})=>c.jsx("option",{value:r,children:s},r))}),c.jsxs("select",{onChange:r=>t("formatBlock",r.target.value),value:e.headingLevel||"p",title:"Heading Level",children:[c.jsx("option",{value:"p",children:"Normal"}),c.jsx("option",{value:"h1",children:"Heading 1"}),c.jsx("option",{value:"h2",children:"Heading 2"}),c.jsx("option",{value:"h3",children:"Heading 3"}),c.jsx("option",{value:"h4",children:"Heading 4"}),c.jsx("option",{value:"h5",children:"Heading 5"}),c.jsx("option",{value:"h6",children:"Heading 6"})]}),c.jsx("div",{className:"toolbar-separator"}),c.jsx("button",{onClick:()=>t("insertUnorderedList"),title:"Bullet List",children:c.jsx(Tt,{size:16})}),c.jsx("button",{onClick:()=>t("insertOrderedList"),title:"Numbered List",children:c.jsx(On,{size:16})}),c.jsx("div",{className:"toolbar-separator"}),c.jsx("button",{onClick:()=>{const r=prompt("Enter URL:");r&&t("createLink",r)},title:"Insert Link",children:c.jsx(wn,{size:16})}),c.jsx("button",{onClick:()=>t("insertHTML",'<table border="1"><tr><td>Cell 1</td><td>Cell 2</td></tr><tr><td>Cell 3</td><td>Cell 4</td></tr></table>'),title:"Insert Table",children:c.jsx(Rn,{size:16})}),a&&c.jsx("button",{onClick:a,title:"Insert Page Break",children:c.jsx(ye,{size:16})}),c.jsx("input",{type:"file",accept:"image/*",onChange:r=>r.target.files[0]&&n(r.target.files[0]),style:{display:"none"},id:"image-upload"}),c.jsx("button",{onClick:()=>document.getElementById("image-upload").click(),title:"Insert Image",children:c.jsx(Cn,{size:16})})]})};be.propTypes={currentFormat:T.shape({bold:T.bool,italic:T.bool,underline:T.bool,strikethrough:T.bool,alignLeft:T.bool,alignCenter:T.bool,alignRight:T.bool,alignJustify:T.bool,fontFamily:T.string,fontSize:T.string,headingLevel:T.string}).isRequired,onFormatText:T.func.isRequired,onAddPageBreak:T.func},be.defaultProps={onAddPageBreak:void 0};const Ee=({content:e,dimensions:t,pageSize:a,pageBoundaries:n=[],editorRef:r,onInput:s,onKeyDown:i,onClick:l,onScroll:m,zoomLevel:p=100})=>{const h={top:48,bottom:48,left:48,right:48},d=p/100,x=(v,S)=>{if(!v)return!1;const b=v.getBoundingClientRect(),N=S-b.top;return N<h.top||N>b.height-h.bottom},_=v=>v?v.nodeType===Node.ELEMENT_NODE?v.tagName==="PAGE-BREAK"||v.getAttribute("data-page-break")==="true":v.parentElement&&_(v.parentElement):!1,w=v=>{const S=window.getSelection();if(!S||S.rangeCount===0)return;const b=S.getRangeAt(0),{startContainer:N,endContainer:g}=b;if((_(N)||_(g))&&(v.key.length===1||v.key==="Enter"||v.key===" "))return v.preventDefault(),!1;if(v.key==="Tab")return v.preventDefault(),document.execCommand("insertHTML",!1,"&nbsp;&nbsp;&nbsp;&nbsp;"),!1;if((v.key==="Backspace"||v.key==="Delete")&&(_(N)||_(g)))return v.preventDefault(),!1;i&&i(v)},k=v=>{if(!r.current)return;const S=v.target;if(_(S)){v.preventDefault();return}if(x(r.current,v.clientY)){v.preventDefault();const b=r.current.getBoundingClientRect();if(v.clientY-b.top<h.top){const g=r.current.firstElementChild;if(g&&g.tagName!=="PAGE-BREAK"){const H=document.createRange(),q=window.getSelection();H.setStart(g,0),H.collapse(!0),q.removeAllRanges(),q.addRange(H)}}else{const g=r.current.lastElementChild;if(g&&g.tagName!=="PAGE-BREAK"){const H=document.createRange(),q=window.getSelection();H.selectNodeContents(g),H.collapse(!1),q.removeAllRanges(),q.addRange(H)}}return}l&&l(v)},O=v=>{const S=window.getSelection();if(!S||S.rangeCount===0)return;const b=S.getRangeAt(0),{startContainer:N}=b;if(_(N))return v.preventDefault(),!1};return c.jsxs("div",{className:"continuous-page-container",style:{position:"relative",width:"100%",maxWidth:`${t.width}px`,margin:"40px auto",backgroundColor:"transparent",minHeight:"100vh",transform:`scale(${d})`,transformOrigin:"top center",transition:"transform 0.2s ease-out"},children:[n.map((v,S)=>{const b=v.top+t.height;return c.jsx("div",{className:"page-height-marker",style:{position:"absolute",top:`${b}px`,left:0,right:0,height:"2px",backgroundColor:"red",zIndex:10,pointerEvents:"none"},title:`End of Page ${v.pageNumber} (${t.height}px)`},`boundary-marker-${v.id}`)}),c.jsx("div",{ref:r,contentEditable:!0,suppressContentEditableWarning:!0,className:"continuous-content",style:{position:"relative",zIndex:1,minHeight:`${t.height}px`,width:`${t.width}px`,backgroundColor:"white",padding:`${h.top}px ${h.right}px ${h.bottom}px ${h.left}px`,boxSizing:"border-box",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",outline:"none",cursor:"text",fontFamily:"Arial, sans-serif",fontSize:me,lineHeight:"1.15",color:"#333",wordWrap:"break-word",whiteSpace:"pre-wrap",overflowWrap:"break-word",border:"1px solid #e0e0e0"},onInput:s,onKeyDown:w,onBeforeInput:O,onClick:k,onScroll:m,"data-testid":"continuous-editor"})]})};Ee.propTypes={content:T.string.isRequired,dimensions:T.shape({width:T.number.isRequired,height:T.number.isRequired}).isRequired,pageSize:T.oneOf(["A4","Letter","Legal"]).isRequired,pageBoundaries:T.arrayOf(T.shape({id:T.string.isRequired,pageNumber:T.number.isRequired,top:T.number,height:T.number})),editorRef:T.shape({current:T.instanceOf(typeof Element<"u"?Element:Object)}).isRequired,onInput:T.func.isRequired,onKeyDown:T.func,onClick:T.func,onScroll:T.func,zoomLevel:T.number},Ee.defaultProps={pageBoundaries:[],onKeyDown:void 0,onClick:void 0,onScroll:void 0,zoomLevel:100};const Ue=({pageBoundaries:e=[{id:"page-0",pageNumber:1}],activePage:t=0,pageSize:a="A4",zoomLevel:n=100,canZoomIn:r=!0,canZoomOut:s=!0,onNavigate:i,onAddPage:l,onDeletePage:m,onPageSizeChange:p,onZoomIn:h,onZoomOut:d,onZoomReset:x}={})=>{const _=Math.max(e?.length||0,1),w=S=>{i&&i(S)},k=()=>{l&&l()},O=S=>{if(_<=1){console.warn("[PageManager] Cannot delete the only page");return}m&&m(S)},v=S=>{p&&p(S)};return c.jsxs("div",{className:"page-manager",children:[c.jsxs("div",{className:"page-size-controls",children:[c.jsxs("label",{htmlFor:"page-size-selector",children:[c.jsx(Mn,{size:14,style:{marginRight:"4px",verticalAlign:"middle"}}),"Page Size:"]}),c.jsxs("select",{id:"page-size-selector",role:"combobox","aria-label":"Page size selector",value:a,onChange:S=>v(S.target.value),children:[c.jsx("option",{value:"A4",children:"A4"}),c.jsx("option",{value:"Letter",children:"Letter"}),c.jsx("option",{value:"Legal",children:"Legal"})]})]}),c.jsxs("div",{className:"zoom-controls",children:[c.jsx("button",{type:"button",className:"zoom-button",onClick:d,disabled:!s,"aria-label":"Zoom out",title:"Zoom out (Ctrl + -)",children:c.jsx(qn,{size:14})}),c.jsxs("button",{type:"button",className:"zoom-reset-button",onClick:x,"aria-label":"Reset zoom",title:"Reset zoom to 100% (Ctrl + 0)",children:[n,"%"]}),c.jsx("button",{type:"button",className:"zoom-button",onClick:h,disabled:!r,"aria-label":"Zoom in",title:"Zoom in (Ctrl + +)",children:c.jsx(Zn,{size:14})})]}),c.jsx("div",{className:"page-list",children:(e&&e.length>0?e:[{id:"page-0",pageNumber:1}]).map((S,b)=>c.jsxs("div",{className:"page-item",children:[c.jsxs("button",{type:"button",className:`page-button ${b===t?"active":""}`,onClick:()=>w(b),"aria-label":`Go to page ${b+1}`,"aria-current":b===t?"page":void 0,children:[c.jsx(ye,{size:14}),c.jsxs("span",{children:["Page ",b+1]})]}),_>1&&c.jsx("button",{type:"button",className:"delete-page-button",onClick:N=>{N.stopPropagation(),O(b)},"aria-label":`Delete page ${b+1}`,title:"Delete this page and its content",children:c.jsx(Hn,{size:14})})]},S.id||`page-${b}`))}),c.jsxs("button",{type:"button",className:"add-page-button",onClick:k,"aria-label":"Add new page",title:"Add new page at end",children:[c.jsx(Nn,{size:16}),c.jsx("span",{children:"Add Page"})]})]})};Ue.propTypes={pageBoundaries:T.arrayOf(T.shape({id:T.string.isRequired,pageNumber:T.number.isRequired,top:T.number,height:T.number})),activePage:T.number,pageSize:T.oneOf(["A4","Letter","Legal"]),zoomLevel:T.number,canZoomIn:T.bool,canZoomOut:T.bool,onNavigate:T.func,onAddPage:T.func,onDeletePage:T.func,onPageSizeChange:T.func,onZoomIn:T.func,onZoomOut:T.func,onZoomReset:T.func},Ue.defaultProps={pageBoundaries:[{id:"page-0",pageNumber:1}],activePage:0,pageSize:"A4",zoomLevel:100,canZoomIn:!0,canZoomOut:!0,onNavigate:void 0,onAddPage:void 0,onDeletePage:void 0,onPageSizeChange:void 0,onZoomIn:void 0,onZoomOut:void 0,onZoomReset:void 0};const St=E.memo(Ue),Kn=50,Jn=50,wt=50,Xn=100,Qn=500,ve=E.forwardRef(({pageManagerComponent:e=null,onNavigatePage:t,onAddPage:a,onDeletePage:n,onPageSizeChange:r,onChange:s,showSidebar:i=!0,showToolbar:l=!0,showPageManager:m=!0},p)=>{const h=Ne(),d=je(),{pageSize:x,continuousContent:_,pageBoundaries:w,activePage:k,zoomLevel:O}=h,v=E.useRef(null),S=E.useRef(null),{currentFormat:b,formatText:N}=dt(),{checkAndUpdateBoundaries:g,getCurrentPage:H,scrollToPage:q,updateBoundaries:F,triggerAutoReflow:X,removePageAndContent:Q,insertPageBreakAtBoundary:re}=vt(x,S,O),oe=E.useMemo(()=>pt(x),[x]),[ae,ne]=E.useState(!1),V=E.useRef(null),G=E.useRef(!1),W=E.useRef(!1),ee=E.useRef(!1),te=E.useRef(_);E.useEffect(()=>{if(S.current){if(!ee.current){S.current.innerHTML=_,ee.current=!0,te.current=_;const u=setTimeout(()=>{F()},Kn);return()=>clearTimeout(u)}if(te.current!==_){if(S.current.innerHTML!==_){S.current.innerHTML=_;const Z=setTimeout(()=>{if(F(),G.current){G.current=!1;const K=Math.max(0,w.length-1);d.setActivePage(K),setTimeout(()=>{q(K,v)},wt)}},Jn);return te.current=_,()=>clearTimeout(Z)}te.current=_}}},[_,F,w.length,d,q]),E.useEffect(()=>{s&&ee.current&&s(_)},[_,s]),E.useImperativeHandle(p,()=>({getHTMLContent:()=>_,getPlainText:()=>_.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim(),setContent:u=>{d.updateContinuousContent(u),S.current&&(S.current.innerHTML=u,setTimeout(()=>{F()},50))}}),[_,d,F]),E.useEffect(()=>{const u=setTimeout(()=>{S.current&&S.current.focus()},200);return()=>clearTimeout(u)},[]);const f=E.useCallback(u=>{const Z=u.currentTarget.innerHTML;d.updateContinuousContent(Z),g(),X(200);const K=H(v);K!==k&&d.setActivePage(K)},[g,d,H,k,X,v]),o=E.useCallback(u=>{d.updatePageSize(u),F({pageSize:u}),r&&r(u)},[d,F,r]),y=E.useCallback(u=>{u<0||u>=w.length||(W.current=!0,d.setActivePage(u),q(u,v),setTimeout(()=>{W.current=!1},Qn),t&&t(u))},[d,q,t,w.length]),A=E.useCallback(()=>{const u=w.length+1;re(u)&&(G.current=!0,setTimeout(()=>{if(G.current){G.current=!1;const K=Math.max(0,w.length-1);d.setActivePage(K),setTimeout(()=>{q(K,v)},wt)}},100)),a&&a()},[w.length,re,d,q,a]),P=E.useCallback(()=>{const u=window.getSelection();if(u&&u.rangeCount>0){if(!S?.current)return;const _e=`<page-break data-page-break="true" contenteditable="false" data-page-number="${S.current.querySelectorAll('page-break, [data-page-break="true"]').length+2}"></page-break><p><br></p>`;document.execCommand("insertHTML",!1,_e),setTimeout(()=>{F();const tr=H(v);d.setActivePage(tr)},150)}},[F,H,d,v]),I=E.useCallback(u=>{if(w.length<=1){console.warn("Cannot delete the only page");return}Q(u)&&(d.setActivePage(0),n&&n(u))},[w.length,Q,d,n]),j=E.useCallback(()=>{d.zoomIn()},[d]),C=E.useCallback(()=>{d.zoomOut()},[d]),M=E.useCallback(()=>{d.resetZoom()},[d]);E.useEffect(()=>{const u=Z=>{if(!(!S.current&&!v.current)&&(Z.ctrlKey||Z.metaKey))switch(Z.key){case"+":case"=":Z.preventDefault(),j();break;case"-":case"_":Z.preventDefault(),C();break;case"0":Z.preventDefault(),M();break}};return window.addEventListener("keydown",u),()=>{window.removeEventListener("keydown",u)}},[j,C,M]);const z=E.useCallback(()=>{!v.current||!S.current||W.current||(V.current&&clearTimeout(V.current),V.current=setTimeout(()=>{if(W.current){V.current=null;return}const u=H(v);u!==k&&u>=0&&d.setActivePage(u),V.current=null},Xn))},[H,k,d]),L=E.useMemo(()=>{if(!_)return 0;const Z=_.replace(/<[^>]*>/g," ").match(/\b\w+\b/g);return Z?Z.length:0},[_]),Y=w.length||1;return E.useEffect(()=>()=>{V.current&&clearTimeout(V.current)},[]),c.jsxs("div",{className:"multi-page-editor",children:[l&&c.jsx(be,{currentFormat:b,onFormatText:N,onAddPageBreak:P}),c.jsxs("div",{className:"editor-container",children:[i&&c.jsx(At,{editorView:null,isCollapsed:ae,onToggle:()=>ne(u=>!u),wordCount:L,pageCount:Y}),c.jsx("div",{className:"editor-viewport continuous-scroll",ref:v,onScroll:z,children:c.jsx(Ee,{content:_,dimensions:oe,pageSize:x,pageBoundaries:w,editorRef:S,onInput:f,onClick:()=>S.current?.focus(),zoomLevel:O})}),m&&c.jsx("div",{className:"page-manager-sidebar",children:e?E.cloneElement(e,{onNavigate:y,onAddPage:A,onDeletePage:I,onPageSizeChange:o,zoomLevel:O,canZoomIn:ke(O),canZoomOut:Ce(O),onZoomIn:j,onZoomOut:C,onZoomReset:M}):c.jsx(St,{pageBoundaries:w,activePage:k,pageSize:x,zoomLevel:O,canZoomIn:ke(O),canZoomOut:Ce(O),onNavigate:y,onAddPage:A,onDeletePage:I,onPageSizeChange:o,onZoomIn:j,onZoomOut:C,onZoomReset:M})})]})]})});ve.displayName="HtmlEditor",ve.propTypes={pageManagerComponent:T.element,onNavigatePage:T.func,onAddPage:T.func,onDeletePage:T.func,onPageSizeChange:T.func,onChange:T.func,showSidebar:T.bool,showToolbar:T.bool,showPageManager:T.bool},ve.defaultProps={pageManagerComponent:null,onNavigatePage:void 0,onAddPage:void 0,onDeletePage:void 0,onPageSizeChange:void 0,onChange:void 0,showSidebar:!0,showToolbar:!0,showPageManager:!0};class He extends E.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,a){console.error("[ErrorBoundary] Caught error:",t),console.error("[ErrorBoundary] Error info:",a),this.setState({error:t,errorInfo:a}),this.props.onError&&this.props.onError(t,a)}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null}),this.props.onReset&&this.props.onReset()};render(){return this.state.hasError?this.props.fallback?this.props.fallback:c.jsxs("div",{style:{padding:"20px",margin:"20px",border:"2px solid #f44336",borderRadius:"4px",backgroundColor:"#ffebee",color:"#c62828"},children:[c.jsx("h2",{style:{marginTop:0},children:"⚠️ Something went wrong"}),c.jsx("p",{children:"The editor encountered an unexpected error and couldn't continue."}),this.props.showDetails&&this.state.error&&c.jsxs("details",{style:{marginTop:"10px",padding:"10px",backgroundColor:"white",borderRadius:"4px",fontSize:"12px",fontFamily:"monospace"},children:[c.jsx("summary",{style:{cursor:"pointer",fontWeight:"bold"},children:"Error Details"}),c.jsxs("pre",{style:{marginTop:"10px",overflow:"auto",maxHeight:"200px"},children:[this.state.error.toString(),this.state.errorInfo&&this.state.errorInfo.componentStack]})]}),c.jsx("button",{onClick:this.handleReset,style:{marginTop:"15px",padding:"8px 16px",backgroundColor:"#f44336",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold"},children:"Try Again"})]}):this.props.children}}He.propTypes={children:T.node.isRequired,fallback:T.node,onError:T.func,onReset:T.func,showDetails:T.bool},He.defaultProps={fallback:null,onError:void 0,onReset:void 0,showDetails:process.env.NODE_ENV==="development"};const er={A4:{width:J.A4.width,height:J.A4.height},Letter:{width:J.Letter.width,height:J.Letter.height},Legal:{width:J.Legal.width,height:J.Legal.height}};R.COMMON_FONT_SIZES=st,R.DEFAULT_FONT_SIZE=me,R.DEFAULT_PAGE_SIZE=ft,R.DocumentProvider=Lt,R.EditorToolbar=be,R.ErrorBoundary=He,R.FONT_SIZE_MAP=Be,R.HtmlEditor=ve,R.PAGE_DIMENSIONS=er,R.PAGE_SIZES=J,R.PageManager=St,R.PageView=Ee,R.Sidebar=At,R.clearImages=Vn,R.deleteImage=Yn,R.getAllImageKeys=Wn,R.getAvailablePageSizes=Jt,R.getImage=Fn,R.getPageDimensions=pt,R.getPixelValue=Ft,R.getPointValue=Yt,R.isValidFontSize=Vt,R.isValidPageSize=Kt,R.logger=kt,R.pixelsToPoints=lt,R.pointsToPixels=ct,R.saveImage=Pt,R.useContinuousReflow=vt,R.useDocument=Oe,R.useDocumentActions=je,R.useDocumentState=Ne,R.useFormatting=dt,Object.defineProperty(R,Symbol.toStringTag,{value:"Module"})}));
//# sourceMappingURL=htmleditor.umd.cjs.map
