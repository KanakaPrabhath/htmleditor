(function(L,g){typeof exports=="object"&&typeof module<"u"?g(exports,require("react"),require("uuid"),require("react-dom")):typeof define=="function"&&define.amd?define(["exports","react","uuid","react-dom"],g):(L=typeof globalThis<"u"?globalThis:L||self,g(L.HTMLEditor={},L.React,L.uuid,L.ReactDOM))})(this,(function(L,g,$e,rn){"use strict";function on(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var _e={exports:{}},be={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ut;function an(){if(ut)return be;ut=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function o(r,i,a){var n=null;if(a!==void 0&&(n=""+a),i.key!==void 0&&(n=""+i.key),"key"in i){a={};for(var s in i)s!=="key"&&(a[s]=i[s])}else a=i;return i=a.ref,{$$typeof:e,type:r,key:n,ref:i!==void 0?i:null,props:a}}return be.Fragment=t,be.jsx=o,be.jsxs=o,be}var Ee={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dt;function sn(){return dt||(dt=1,process.env.NODE_ENV!=="production"&&(function(){function e(c){if(c==null)return null;if(typeof c=="function")return c.$$typeof===Y?null:c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case k:return"Fragment";case P:return"Profiler";case j:return"StrictMode";case d:return"Suspense";case A:return"SuspenseList";case K:return"Activity"}if(typeof c=="object")switch(typeof c.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),c.$$typeof){case y:return"Portal";case N:return c.displayName||"Context";case C:return(c._context.displayName||"Context")+".Consumer";case u:var w=c.render;return c=c.displayName,c||(c=w.displayName||w.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case R:return w=c.displayName||null,w!==null?w:e(c.type)||"Memo";case D:w=c._payload,c=c._init;try{return e(c(w))}catch{}}return null}function t(c){return""+c}function o(c){try{t(c);var w=!1}catch{w=!0}if(w){w=console;var M=w.error,S=typeof Symbol=="function"&&Symbol.toStringTag&&c[Symbol.toStringTag]||c.constructor.name||"Object";return M.call(w,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",S),t(c)}}function r(c){if(c===k)return"<>";if(typeof c=="object"&&c!==null&&c.$$typeof===D)return"<...>";try{var w=e(c);return w?"<"+w+">":"<...>"}catch{return"<...>"}}function i(){var c=te.A;return c===null?null:c.getOwner()}function a(){return Error("react-stack-top-frame")}function n(c){if(H.call(c,"key")){var w=Object.getOwnPropertyDescriptor(c,"key").get;if(w&&w.isReactWarning)return!1}return c.key!==void 0}function s(c,w){function M(){z||(z=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",w))}M.isReactWarning=!0,Object.defineProperty(c,"key",{get:M,configurable:!0})}function m(){var c=e(this.type);return W[c]||(W[c]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),c=this.props.ref,c!==void 0?c:null}function b(c,w,M,S,G,B){var I=M.ref;return c={$$typeof:E,type:c,key:w,props:M,_owner:S},(I!==void 0?I:null)!==null?Object.defineProperty(c,"ref",{enumerable:!1,get:m}):Object.defineProperty(c,"ref",{enumerable:!1,value:null}),c._store={},Object.defineProperty(c._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(c,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(c,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:G}),Object.defineProperty(c,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:B}),Object.freeze&&(Object.freeze(c.props),Object.freeze(c)),c}function h(c,w,M,S,G,B){var I=w.children;if(I!==void 0)if(S)if(Q(I)){for(S=0;S<I.length;S++)p(I[S]);Object.freeze&&Object.freeze(I)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else p(I);if(H.call(w,"key")){I=e(c);var F=Object.keys(w).filter(function(q){return q!=="key"});S=0<F.length?"{key: someKey, "+F.join(": ..., ")+": ...}":"{key: someKey}",v[I+S]||(F=0<F.length?"{"+F.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,S,I,F,I),v[I+S]=!0)}if(I=null,M!==void 0&&(o(M),I=""+M),n(w)&&(o(w.key),I=""+w.key),"key"in w){M={};for(var Z in w)Z!=="key"&&(M[Z]=w[Z])}else M=w;return I&&s(M,typeof c=="function"?c.displayName||c.name||"Unknown":c),b(c,I,M,i(),G,B)}function p(c){f(c)?c._store&&(c._store.validated=1):typeof c=="object"&&c!==null&&c.$$typeof===D&&(c._payload.status==="fulfilled"?f(c._payload.value)&&c._payload.value._store&&(c._payload.value._store.validated=1):c._store&&(c._store.validated=1))}function f(c){return typeof c=="object"&&c!==null&&c.$$typeof===E}var T=g,E=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),N=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),K=Symbol.for("react.activity"),Y=Symbol.for("react.client.reference"),te=T.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H=Object.prototype.hasOwnProperty,Q=Array.isArray,ee=console.createTask?console.createTask:function(){return null};T={react_stack_bottom_frame:function(c){return c()}};var z,W={},ne=T.react_stack_bottom_frame.bind(T,a)(),ie=ee(r(a)),v={};Ee.Fragment=k,Ee.jsx=function(c,w,M){var S=1e4>te.recentlyCreatedOwnerStacks++;return h(c,w,M,!1,S?Error("react-stack-top-frame"):ne,S?ee(r(c)):ie)},Ee.jsxs=function(c,w,M){var S=1e4>te.recentlyCreatedOwnerStacks++;return h(c,w,M,!0,S?Error("react-stack-top-frame"):ne,S?ee(r(c)):ie)}})()),Ee}var ft;function cn(){return ft||(ft=1,process.env.NODE_ENV==="production"?_e.exports=an():_e.exports=sn()),_e.exports}var l=cn();const Be=100,He=50,Ge=200,pt=5,Ue=e=>e<Ge,Fe=e=>e>He,ln=96,Pe=e=>Math.round(e*ln),Ae={NORMAL:{name:"Normal",label:'Normal (1")',top:1,bottom:1,left:1,right:1},NARROW:{name:"Narrow",label:'Narrow (0.5")',top:.5,bottom:.5,left:.5,right:.5},MODERATE:{name:"Moderate",label:'Moderate (1" / 0.75")',top:1,bottom:1,left:.75,right:.75},WIDE:{name:"Wide",label:'Wide (1" / 2")',top:1,bottom:1,left:2,right:2},OFFICE_2003:{name:"Office 2003",label:'Office 2003 (1" / 1.25")',top:1,bottom:1,left:1.25,right:1.25}},fe="NORMAL",gt=(e=fe)=>{const t=Ae[e]||Ae[fe];return{top:Pe(t.top),bottom:Pe(t.bottom),left:Pe(t.left),right:Pe(t.right)}},un=(e=fe)=>{const t=gt(e);return t.top+t.bottom},dn=()=>Object.keys(Ae),fn=e=>{const t=Ae[e];return t?t.label:"Unknown"},ae={A4:{name:"A4",width:794,height:1123,widthMm:210,heightMm:297,widthIn:8.27,heightIn:11.69},Letter:{name:"Letter",width:816,height:1056,widthMm:216,heightMm:279,widthIn:8.5,heightIn:11},Legal:{name:"Legal",width:816,height:1344,widthMm:216,heightMm:356,widthIn:8.5,heightIn:14}},qe="A4",ke=e=>{const t=ae[e]||ae[qe];return{width:t.width,height:t.height}},pn=e=>Object.keys(ae).includes(e),gn=()=>Object.keys(ae),ve=qe,pe="<p><br></p>",hn="continuous",Te=(e,t=ve)=>({id:$e.v4(),index:e,size:t,content:pe,images:[],isBreakPoint:!1}),we=e=>typeof e!="string"||e.trim()===""?pe:e,ht=(e,t=ve)=>(e.length>0?e:[Te(0,t)]).map((r,i)=>({id:r.id||$e.v4(),index:i,size:r.size||t,content:we(r.content),images:r.images||[],isBreakPoint:!!r.isBreakPoint})),mn=(e=ve)=>[{id:"page-0",pageNumber:1,top:0,height:ke(e).height}],We=(e={})=>{const t=new Date().toISOString(),o=e.pageSize||ve,r=ht(e.pages||[Te(0,o)],o);return{id:$e.v4(),title:e.title||"Untitled Document",createdAt:t,updatedAt:t,pageSize:o,pages:r,activePage:e.activePage&&e.activePage<r.length?e.activePage:0,pageBreaks:e.pageBreaks||[],totalPages:r.length,editorMode:e.editorMode||hn,continuousContent:e.continuousContent||pe,pageBoundaries:e.pageBoundaries||mn(o),zoomLevel:e.zoomLevel||Be,pageMargins:e.pageMargins||fe}},U={INITIALIZE_DOCUMENT:"INITIALIZE_DOCUMENT",UPDATE_TITLE:"UPDATE_TITLE",UPDATE_PAGE_CONTENT:"UPDATE_PAGE_CONTENT",UPDATE_PAGES:"UPDATE_PAGES",ADD_PAGE:"ADD_PAGE",DELETE_PAGE:"DELETE_PAGE",SET_ACTIVE_PAGE:"SET_ACTIVE_PAGE",UPDATE_PAGE_SIZE:"UPDATE_PAGE_SIZE",RESET_DOCUMENT:"RESET_DOCUMENT",UPDATE_CONTINUOUS_CONTENT:"UPDATE_CONTINUOUS_CONTENT",UPDATE_PAGE_BOUNDARIES:"UPDATE_PAGE_BOUNDARIES",ADD_PAGE_BREAK:"ADD_PAGE_BREAK",REMOVE_PAGE_BREAK:"REMOVE_PAGE_BREAK",SET_EDITOR_MODE:"SET_EDITOR_MODE",INSERT_PAGE_AT:"INSERT_PAGE_AT",MOVE_PAGE_TO:"MOVE_PAGE_TO",DUPLICATE_PAGE:"DUPLICATE_PAGE",SET_ZOOM_LEVEL:"SET_ZOOM_LEVEL",ZOOM_IN:"ZOOM_IN",ZOOM_OUT:"ZOOM_OUT",RESET_ZOOM:"RESET_ZOOM",UPDATE_PAGE_MARGINS:"UPDATE_PAGE_MARGINS"},yn=(e,t)=>{const o=new Date().toISOString();switch(t.type){case U.INITIALIZE_DOCUMENT:{const{initialContent:r=pe,pageSize:i=ve}=t.payload||{},a={...Te(0,i),content:we(r)};return We({title:e.title,pageSize:i,pages:[a]})}case U.UPDATE_TITLE:return{...e,title:t.payload,updatedAt:o};case U.UPDATE_PAGE_CONTENT:{const{pageIndex:r,content:i}=t.payload;if(r<0||r>=e.pages.length)return e;const a=[...e.pages];return a[r]={...a[r],content:we(i)},{...e,pages:a,updatedAt:o}}case U.UPDATE_PAGES:{const r=Array.isArray(t.payload)?{pages:t.payload}:t.payload||{},i=ht(r.pages||[],e.pageSize),a=Array.isArray(r.pageBreaks)?r.pageBreaks:i.slice(0,-1).map((n,s)=>({id:`auto-break-${s}`,pageNumber:s+1}));return{...e,pages:i,activePage:Math.min(e.activePage,i.length-1),pageBreaks:a,totalPages:i.length,updatedAt:o}}case U.ADD_PAGE:{const r=typeof t.payload?.index=="number"?Math.min(Math.max(t.payload.index,0),e.pages.length):e.pages.length,i=[...e.pages];i.splice(r,0,Te(r,e.pageSize));const a=i.map((s,m)=>({...s,index:m,size:e.pageSize})),n=a.slice(0,-1).map((s,m)=>({id:`auto-break-${m}`,pageNumber:m+1}));return{...e,pages:a,activePage:r,pageBreaks:n,totalPages:a.length,updatedAt:o}}case U.DELETE_PAGE:{const r=t.payload;if(e.pages.length<=1)return e;const i=[...e.pages];i.splice(r,1);const a=i.map((m,b)=>({...m,index:b,size:e.pageSize}));let n=e.activePage;n>=a.length?n=a.length-1:r<=n&&n>0&&(n-=1);const s=a.slice(0,-1).map((m,b)=>({id:`auto-break-${b}`,pageNumber:b+1}));return{...e,pages:a,activePage:n,pageBreaks:s,totalPages:a.length,updatedAt:o}}case U.SET_ACTIVE_PAGE:{const r=t.payload;if(r===e.activePage)return e;const i=e.editorMode==="continuous"?e.pageBoundaries.length:e.pages.length;return r<0||r>=i?e:{...e,activePage:r,updatedAt:o}}case U.UPDATE_PAGE_SIZE:{const r=t.payload;if(r===e.pageSize)return e;try{ke(r)}catch{return console.warn(`Invalid page size: ${r}`),e}const i=e.pages.map((n,s)=>({...n,index:s,size:r})),a=i.slice(0,-1).map((n,s)=>({id:`auto-break-${s}`,pageNumber:s+1}));return{...e,pageSize:r,pages:i,pageBreaks:a,updatedAt:o}}case U.RESET_DOCUMENT:return We();case U.UPDATE_CONTINUOUS_CONTENT:{const r=we(t.payload);return r===e.continuousContent?e:{...e,continuousContent:r,updatedAt:o}}case U.UPDATE_PAGE_BOUNDARIES:{const r=Array.isArray(t.payload)?t.payload:[];if(r.length===e.pageBoundaries.length&&r.length>0&&r[0].id===e.pageBoundaries[0]?.id&&r[r.length-1].id===e.pageBoundaries[r.length-1]?.id)return e;const i=e.activePage>=r.length?Math.max(0,r.length-1):e.activePage;return{...e,pageBoundaries:r,totalPages:r.length,activePage:i,updatedAt:o}}case U.ADD_PAGE_BREAK:{const{position:r="end",pageIndex:i}=t.payload||{},a='<page-break data-page-break="true" style="display: block; height: 20px; border-top: 2px dashed #ccc; margin: 20px 0; page-break-after: always;"></page-break>';let n=e.continuousContent;if(r==="end")n=n+a+"<p><br></p>";else if(typeof r=="number"){const s=n.substring(0,r),m=n.substring(r);n=s+a+m}else if(typeof i=="number"&&typeof document<"u"){const s=document.createElement("div");s.innerHTML=n;const m=s.querySelectorAll('page-break, [data-page-break="true"]');if(i===0&&m.length===0)n=n+a+"<p><br></p>";else if(i<m.length){const b=m[i],h=document.createElement("page-break");h.setAttribute("data-page-break","true"),h.setAttribute("style","display: block; height: 20px; border-top: 2px dashed #ccc; margin: 20px 0; page-break-after: always;");const p=document.createElement("p");p.innerHTML="<br>",b.parentNode.insertBefore(h,b.nextSibling),h.parentNode.insertBefore(p,h.nextSibling),n=s.innerHTML}else n=n+a+"<p><br></p>"}return{...e,continuousContent:n,updatedAt:o}}case U.REMOVE_PAGE_BREAK:{const{pageIndex:r}=t.payload||{};if(typeof r!="number"||typeof document>"u")return e;const i=document.createElement("div");i.innerHTML=e.continuousContent;const a=i.querySelectorAll('page-break, [data-page-break="true"]');return a[r]&&a[r].remove(),i.querySelectorAll('page-break, [data-page-break="true"]').forEach((s,m)=>{s.setAttribute("data-page-number",String(m+2))}),{...e,continuousContent:i.innerHTML,updatedAt:o}}case U.SET_EDITOR_MODE:{const r=t.payload;if(r===e.editorMode)return e;let i=e.continuousContent,a=e.pages;return r==="continuous"?i=e.pages.map(s=>s.content).filter(s=>s&&s!==pe).join(`
`)||pe:e.continuousContent&&e.continuousContent!==pe&&(a=[{...Te(0,e.pageSize),content:e.continuousContent}]),{...e,editorMode:r,continuousContent:i,pages:a,updatedAt:o}}case U.SET_ZOOM_LEVEL:{const r=t.payload;return r<He||r>Ge?(console.warn(`Invalid zoom level: ${r}. Must be between ${He} and ${Ge}.`),e):r===e.zoomLevel?e:{...e,zoomLevel:r,updatedAt:o}}case U.ZOOM_IN:{if(!Ue(e.zoomLevel))return e;const r=e.zoomLevel+pt;return{...e,zoomLevel:r,updatedAt:o}}case U.ZOOM_OUT:{if(!Fe(e.zoomLevel))return e;const r=e.zoomLevel-pt;return{...e,zoomLevel:r,updatedAt:o}}case U.RESET_ZOOM:return e.zoomLevel===Be?e:{...e,zoomLevel:Be,updatedAt:o};case U.UPDATE_PAGE_MARGINS:{const r=t.payload;return r===e.pageMargins?e:{...e,pageMargins:r,updatedAt:o}}default:return e}},mt=g.createContext(null),bn=({children:e,initialState:t={}})=>{const[o,r]=g.useReducer(yn,We(t)),i=g.useMemo(()=>({initializeDocument:n=>r({type:U.INITIALIZE_DOCUMENT,payload:n}),updateTitle:n=>r({type:U.UPDATE_TITLE,payload:n}),updatePageContent:n=>r({type:U.UPDATE_PAGE_CONTENT,payload:n}),updatePages:n=>r({type:U.UPDATE_PAGES,payload:n}),addPage:n=>r({type:U.ADD_PAGE,payload:n}),deletePage:n=>r({type:U.DELETE_PAGE,payload:n}),setActivePage:n=>r({type:U.SET_ACTIVE_PAGE,payload:n}),updatePageSize:n=>r({type:U.UPDATE_PAGE_SIZE,payload:n}),resetDocument:()=>r({type:U.RESET_DOCUMENT}),updateContinuousContent:n=>r({type:U.UPDATE_CONTINUOUS_CONTENT,payload:n}),updatePageBoundaries:n=>r({type:U.UPDATE_PAGE_BOUNDARIES,payload:n}),addPageBreak:n=>r({type:U.ADD_PAGE_BREAK,payload:n}),removePageBreak:n=>r({type:U.REMOVE_PAGE_BREAK,payload:n}),setEditorMode:n=>r({type:U.SET_EDITOR_MODE,payload:n}),insertPageAt:n=>r({type:U.INSERT_PAGE_AT,payload:n}),movePageTo:n=>r({type:U.MOVE_PAGE_TO,payload:n}),duplicatePage:n=>r({type:U.DUPLICATE_PAGE,payload:n}),setZoomLevel:n=>r({type:U.SET_ZOOM_LEVEL,payload:n}),zoomIn:()=>r({type:U.ZOOM_IN}),zoomOut:()=>r({type:U.ZOOM_OUT}),resetZoom:()=>r({type:U.RESET_ZOOM}),updatePageMargins:n=>r({type:U.UPDATE_PAGE_MARGINS,payload:n})}),[]),a=g.useMemo(()=>({state:o,actions:i,dispatch:r}),[o,i]);return l.jsx(mt.Provider,{value:a,children:e})},Ze=()=>{const e=g.useContext(mt);if(!e)throw new Error("useDocument must be used within a DocumentProvider");return e},Ye=()=>{const{state:e}=Ze();return e},Ve=()=>{const{actions:e}=Ze();return e};var Oe={exports:{}},Ce={exports:{}},X={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yt;function En(){if(yt)return X;yt=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,o=e?Symbol.for("react.portal"):60106,r=e?Symbol.for("react.fragment"):60107,i=e?Symbol.for("react.strict_mode"):60108,a=e?Symbol.for("react.profiler"):60114,n=e?Symbol.for("react.provider"):60109,s=e?Symbol.for("react.context"):60110,m=e?Symbol.for("react.async_mode"):60111,b=e?Symbol.for("react.concurrent_mode"):60111,h=e?Symbol.for("react.forward_ref"):60112,p=e?Symbol.for("react.suspense"):60113,f=e?Symbol.for("react.suspense_list"):60120,T=e?Symbol.for("react.memo"):60115,E=e?Symbol.for("react.lazy"):60116,y=e?Symbol.for("react.block"):60121,k=e?Symbol.for("react.fundamental"):60117,j=e?Symbol.for("react.responder"):60118,P=e?Symbol.for("react.scope"):60119;function C(u){if(typeof u=="object"&&u!==null){var d=u.$$typeof;switch(d){case t:switch(u=u.type,u){case m:case b:case r:case a:case i:case p:return u;default:switch(u=u&&u.$$typeof,u){case s:case h:case E:case T:case n:return u;default:return d}}case o:return d}}}function N(u){return C(u)===b}return X.AsyncMode=m,X.ConcurrentMode=b,X.ContextConsumer=s,X.ContextProvider=n,X.Element=t,X.ForwardRef=h,X.Fragment=r,X.Lazy=E,X.Memo=T,X.Portal=o,X.Profiler=a,X.StrictMode=i,X.Suspense=p,X.isAsyncMode=function(u){return N(u)||C(u)===m},X.isConcurrentMode=N,X.isContextConsumer=function(u){return C(u)===s},X.isContextProvider=function(u){return C(u)===n},X.isElement=function(u){return typeof u=="object"&&u!==null&&u.$$typeof===t},X.isForwardRef=function(u){return C(u)===h},X.isFragment=function(u){return C(u)===r},X.isLazy=function(u){return C(u)===E},X.isMemo=function(u){return C(u)===T},X.isPortal=function(u){return C(u)===o},X.isProfiler=function(u){return C(u)===a},X.isStrictMode=function(u){return C(u)===i},X.isSuspense=function(u){return C(u)===p},X.isValidElementType=function(u){return typeof u=="string"||typeof u=="function"||u===r||u===b||u===a||u===i||u===p||u===f||typeof u=="object"&&u!==null&&(u.$$typeof===E||u.$$typeof===T||u.$$typeof===n||u.$$typeof===s||u.$$typeof===h||u.$$typeof===k||u.$$typeof===j||u.$$typeof===P||u.$$typeof===y)},X.typeOf=C,X}var J={};/** @license React v16.13.1
 * react-is.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bt;function vn(){return bt||(bt=1,process.env.NODE_ENV!=="production"&&(function(){var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,o=e?Symbol.for("react.portal"):60106,r=e?Symbol.for("react.fragment"):60107,i=e?Symbol.for("react.strict_mode"):60108,a=e?Symbol.for("react.profiler"):60114,n=e?Symbol.for("react.provider"):60109,s=e?Symbol.for("react.context"):60110,m=e?Symbol.for("react.async_mode"):60111,b=e?Symbol.for("react.concurrent_mode"):60111,h=e?Symbol.for("react.forward_ref"):60112,p=e?Symbol.for("react.suspense"):60113,f=e?Symbol.for("react.suspense_list"):60120,T=e?Symbol.for("react.memo"):60115,E=e?Symbol.for("react.lazy"):60116,y=e?Symbol.for("react.block"):60121,k=e?Symbol.for("react.fundamental"):60117,j=e?Symbol.for("react.responder"):60118,P=e?Symbol.for("react.scope"):60119;function C(O){return typeof O=="string"||typeof O=="function"||O===r||O===b||O===a||O===i||O===p||O===f||typeof O=="object"&&O!==null&&(O.$$typeof===E||O.$$typeof===T||O.$$typeof===n||O.$$typeof===s||O.$$typeof===h||O.$$typeof===k||O.$$typeof===j||O.$$typeof===P||O.$$typeof===y)}function N(O){if(typeof O=="object"&&O!==null){var ce=O.$$typeof;switch(ce){case t:var he=O.type;switch(he){case m:case b:case r:case a:case i:case p:return he;default:var me=he&&he.$$typeof;switch(me){case s:case h:case E:case T:case n:return me;default:return ce}}case o:return ce}}}var u=m,d=b,A=s,R=n,D=t,K=h,Y=r,te=E,H=T,Q=o,ee=a,z=i,W=p,ne=!1;function ie(O){return ne||(ne=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),v(O)||N(O)===m}function v(O){return N(O)===b}function c(O){return N(O)===s}function w(O){return N(O)===n}function M(O){return typeof O=="object"&&O!==null&&O.$$typeof===t}function S(O){return N(O)===h}function G(O){return N(O)===r}function B(O){return N(O)===E}function I(O){return N(O)===T}function F(O){return N(O)===o}function Z(O){return N(O)===a}function q(O){return N(O)===i}function oe(O){return N(O)===p}J.AsyncMode=u,J.ConcurrentMode=d,J.ContextConsumer=A,J.ContextProvider=R,J.Element=D,J.ForwardRef=K,J.Fragment=Y,J.Lazy=te,J.Memo=H,J.Portal=Q,J.Profiler=ee,J.StrictMode=z,J.Suspense=W,J.isAsyncMode=ie,J.isConcurrentMode=v,J.isContextConsumer=c,J.isContextProvider=w,J.isElement=M,J.isForwardRef=S,J.isFragment=G,J.isLazy=B,J.isMemo=I,J.isPortal=F,J.isProfiler=Z,J.isStrictMode=q,J.isSuspense=oe,J.isValidElementType=C,J.typeOf=N})()),J}var Et;function vt(){return Et||(Et=1,process.env.NODE_ENV==="production"?Ce.exports=En():Ce.exports=vn()),Ce.exports}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var Ke,Tt;function Tn(){if(Tt)return Ke;Tt=1;var e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function r(a){if(a==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(a)}function i(){try{if(!Object.assign)return!1;var a=new String("abc");if(a[5]="de",Object.getOwnPropertyNames(a)[0]==="5")return!1;for(var n={},s=0;s<10;s++)n["_"+String.fromCharCode(s)]=s;var m=Object.getOwnPropertyNames(n).map(function(h){return n[h]});if(m.join("")!=="0123456789")return!1;var b={};return"abcdefghijklmnopqrst".split("").forEach(function(h){b[h]=h}),Object.keys(Object.assign({},b)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}return Ke=i()?Object.assign:function(a,n){for(var s,m=r(a),b,h=1;h<arguments.length;h++){s=Object(arguments[h]);for(var p in s)t.call(s,p)&&(m[p]=s[p]);if(e){b=e(s);for(var f=0;f<b.length;f++)o.call(s,b[f])&&(m[b[f]]=s[b[f]])}}return m},Ke}var Xe,xt;function Je(){if(xt)return Xe;xt=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Xe=e,Xe}var Qe,_t;function Pt(){return _t||(_t=1,Qe=Function.call.bind(Object.prototype.hasOwnProperty)),Qe}var et,At;function xn(){if(At)return et;At=1;var e=function(){};if(process.env.NODE_ENV!=="production"){var t=Je(),o={},r=Pt();e=function(a){var n="Warning: "+a;typeof console<"u"&&console.error(n);try{throw new Error(n)}catch{}}}function i(a,n,s,m,b){if(process.env.NODE_ENV!=="production"){for(var h in a)if(r(a,h)){var p;try{if(typeof a[h]!="function"){var f=Error((m||"React class")+": "+s+" type `"+h+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof a[h]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw f.name="Invariant Violation",f}p=a[h](n,h,m,s,null,t)}catch(E){p=E}if(p&&!(p instanceof Error)&&e((m||"React class")+": type specification of "+s+" `"+h+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof p+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),p instanceof Error&&!(p.message in o)){o[p.message]=!0;var T=b?b():"";e("Failed "+s+" type: "+p.message+(T??""))}}}}return i.resetWarningCache=function(){process.env.NODE_ENV!=="production"&&(o={})},et=i,et}var tt,kt;function _n(){if(kt)return tt;kt=1;var e=vt(),t=Tn(),o=Je(),r=Pt(),i=xn(),a=function(){};process.env.NODE_ENV!=="production"&&(a=function(s){var m="Warning: "+s;typeof console<"u"&&console.error(m);try{throw new Error(m)}catch{}});function n(){return null}return tt=function(s,m){var b=typeof Symbol=="function"&&Symbol.iterator,h="@@iterator";function p(v){var c=v&&(b&&v[b]||v[h]);if(typeof c=="function")return c}var f="<<anonymous>>",T={array:j("array"),bigint:j("bigint"),bool:j("boolean"),func:j("function"),number:j("number"),object:j("object"),string:j("string"),symbol:j("symbol"),any:P(),arrayOf:C,element:N(),elementType:u(),instanceOf:d,node:K(),objectOf:R,oneOf:A,oneOfType:D,shape:te,exact:H};function E(v,c){return v===c?v!==0||1/v===1/c:v!==v&&c!==c}function y(v,c){this.message=v,this.data=c&&typeof c=="object"?c:{},this.stack=""}y.prototype=Error.prototype;function k(v){if(process.env.NODE_ENV!=="production")var c={},w=0;function M(G,B,I,F,Z,q,oe){if(F=F||f,q=q||I,oe!==o){if(m){var O=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw O.name="Invariant Violation",O}else if(process.env.NODE_ENV!=="production"&&typeof console<"u"){var ce=F+":"+I;!c[ce]&&w<3&&(a("You are manually calling a React.PropTypes validation function for the `"+q+"` prop on `"+F+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),c[ce]=!0,w++)}}return B[I]==null?G?B[I]===null?new y("The "+Z+" `"+q+"` is marked as required "+("in `"+F+"`, but its value is `null`.")):new y("The "+Z+" `"+q+"` is marked as required in "+("`"+F+"`, but its value is `undefined`.")):null:v(B,I,F,Z,q)}var S=M.bind(null,!1);return S.isRequired=M.bind(null,!0),S}function j(v){function c(w,M,S,G,B,I){var F=w[M],Z=z(F);if(Z!==v){var q=W(F);return new y("Invalid "+G+" `"+B+"` of type "+("`"+q+"` supplied to `"+S+"`, expected ")+("`"+v+"`."),{expectedType:v})}return null}return k(c)}function P(){return k(n)}function C(v){function c(w,M,S,G,B){if(typeof v!="function")return new y("Property `"+B+"` of component `"+S+"` has invalid PropType notation inside arrayOf.");var I=w[M];if(!Array.isArray(I)){var F=z(I);return new y("Invalid "+G+" `"+B+"` of type "+("`"+F+"` supplied to `"+S+"`, expected an array."))}for(var Z=0;Z<I.length;Z++){var q=v(I,Z,S,G,B+"["+Z+"]",o);if(q instanceof Error)return q}return null}return k(c)}function N(){function v(c,w,M,S,G){var B=c[w];if(!s(B)){var I=z(B);return new y("Invalid "+S+" `"+G+"` of type "+("`"+I+"` supplied to `"+M+"`, expected a single ReactElement."))}return null}return k(v)}function u(){function v(c,w,M,S,G){var B=c[w];if(!e.isValidElementType(B)){var I=z(B);return new y("Invalid "+S+" `"+G+"` of type "+("`"+I+"` supplied to `"+M+"`, expected a single ReactElement type."))}return null}return k(v)}function d(v){function c(w,M,S,G,B){if(!(w[M]instanceof v)){var I=v.name||f,F=ie(w[M]);return new y("Invalid "+G+" `"+B+"` of type "+("`"+F+"` supplied to `"+S+"`, expected ")+("instance of `"+I+"`."))}return null}return k(c)}function A(v){if(!Array.isArray(v))return process.env.NODE_ENV!=="production"&&(arguments.length>1?a("Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z])."):a("Invalid argument supplied to oneOf, expected an array.")),n;function c(w,M,S,G,B){for(var I=w[M],F=0;F<v.length;F++)if(E(I,v[F]))return null;var Z=JSON.stringify(v,function(oe,O){var ce=W(O);return ce==="symbol"?String(O):O});return new y("Invalid "+G+" `"+B+"` of value `"+String(I)+"` "+("supplied to `"+S+"`, expected one of "+Z+"."))}return k(c)}function R(v){function c(w,M,S,G,B){if(typeof v!="function")return new y("Property `"+B+"` of component `"+S+"` has invalid PropType notation inside objectOf.");var I=w[M],F=z(I);if(F!=="object")return new y("Invalid "+G+" `"+B+"` of type "+("`"+F+"` supplied to `"+S+"`, expected an object."));for(var Z in I)if(r(I,Z)){var q=v(I,Z,S,G,B+"."+Z,o);if(q instanceof Error)return q}return null}return k(c)}function D(v){if(!Array.isArray(v))return process.env.NODE_ENV!=="production"&&a("Invalid argument supplied to oneOfType, expected an instance of array."),n;for(var c=0;c<v.length;c++){var w=v[c];if(typeof w!="function")return a("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+ne(w)+" at index "+c+"."),n}function M(S,G,B,I,F){for(var Z=[],q=0;q<v.length;q++){var oe=v[q],O=oe(S,G,B,I,F,o);if(O==null)return null;O.data&&r(O.data,"expectedType")&&Z.push(O.data.expectedType)}var ce=Z.length>0?", expected one of type ["+Z.join(", ")+"]":"";return new y("Invalid "+I+" `"+F+"` supplied to "+("`"+B+"`"+ce+"."))}return k(M)}function K(){function v(c,w,M,S,G){return Q(c[w])?null:new y("Invalid "+S+" `"+G+"` supplied to "+("`"+M+"`, expected a ReactNode."))}return k(v)}function Y(v,c,w,M,S){return new y((v||"React class")+": "+c+" type `"+w+"."+M+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+S+"`.")}function te(v){function c(w,M,S,G,B){var I=w[M],F=z(I);if(F!=="object")return new y("Invalid "+G+" `"+B+"` of type `"+F+"` "+("supplied to `"+S+"`, expected `object`."));for(var Z in v){var q=v[Z];if(typeof q!="function")return Y(S,G,B,Z,W(q));var oe=q(I,Z,S,G,B+"."+Z,o);if(oe)return oe}return null}return k(c)}function H(v){function c(w,M,S,G,B){var I=w[M],F=z(I);if(F!=="object")return new y("Invalid "+G+" `"+B+"` of type `"+F+"` "+("supplied to `"+S+"`, expected `object`."));var Z=t({},w[M],v);for(var q in Z){var oe=v[q];if(r(v,q)&&typeof oe!="function")return Y(S,G,B,q,W(oe));if(!oe)return new y("Invalid "+G+" `"+B+"` key `"+q+"` supplied to `"+S+"`.\nBad object: "+JSON.stringify(w[M],null,"  ")+`
Valid keys: `+JSON.stringify(Object.keys(v),null,"  "));var O=oe(I,q,S,G,B+"."+q,o);if(O)return O}return null}return k(c)}function Q(v){switch(typeof v){case"number":case"string":case"undefined":return!0;case"boolean":return!v;case"object":if(Array.isArray(v))return v.every(Q);if(v===null||s(v))return!0;var c=p(v);if(c){var w=c.call(v),M;if(c!==v.entries){for(;!(M=w.next()).done;)if(!Q(M.value))return!1}else for(;!(M=w.next()).done;){var S=M.value;if(S&&!Q(S[1]))return!1}}else return!1;return!0;default:return!1}}function ee(v,c){return v==="symbol"?!0:c?c["@@toStringTag"]==="Symbol"||typeof Symbol=="function"&&c instanceof Symbol:!1}function z(v){var c=typeof v;return Array.isArray(v)?"array":v instanceof RegExp?"object":ee(c,v)?"symbol":c}function W(v){if(typeof v>"u"||v===null)return""+v;var c=z(v);if(c==="object"){if(v instanceof Date)return"date";if(v instanceof RegExp)return"regexp"}return c}function ne(v){var c=W(v);switch(c){case"array":case"object":return"an "+c;case"boolean":case"date":case"regexp":return"a "+c;default:return c}}function ie(v){return!v.constructor||!v.constructor.name?f:v.constructor.name}return T.checkPropTypes=i,T.resetWarningCache=i.resetWarningCache,T.PropTypes=T,T},tt}var nt,wt;function Pn(){if(wt)return nt;wt=1;var e=Je();function t(){}function o(){}return o.resetWarningCache=t,nt=function(){function r(n,s,m,b,h,p){if(p!==e){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}r.isRequired=r;function i(){return r}var a={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:i,element:r,elementType:r,instanceOf:i,node:r,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:o,resetWarningCache:t};return a.PropTypes=a,a},nt}var Ot;function An(){if(Ot)return Oe.exports;if(Ot=1,process.env.NODE_ENV!=="production"){var e=vt(),t=!0;Oe.exports=_n()(e.isElement,t)}else Oe.exports=Pn()();return Oe.exports}var kn=An();const x=on(kn),rt={"7.5pt":{pt:7.5,px:10,label:"7.5"},"9pt":{pt:9,px:12,label:"9"},"10pt":{pt:10,px:13,label:"10"},"11pt":{pt:11,px:15,label:"11"},"12pt":{pt:12,px:16,label:"12"},"14pt":{pt:14,px:19,label:"14"},"16pt":{pt:16,px:21,label:"16"},"18pt":{pt:18,px:24,label:"18"},"20pt":{pt:20,px:27,label:"20"},"22pt":{pt:22,px:29,label:"22"},"24pt":{pt:24,px:32,label:"24"},"26pt":{pt:26,px:35,label:"26"},"28pt":{pt:28,px:37,label:"28"},"36pt":{pt:36,px:48,label:"36"},"48pt":{pt:48,px:64,label:"48"},"72pt":{pt:72,px:96,label:"72"}},Ct=[{value:"10px",label:"7.5",pt:7.5},{value:"12px",label:"9",pt:9},{value:"13px",label:"10",pt:10},{value:"15px",label:"11",pt:11},{value:"16px",label:"12",pt:12},{value:"19px",label:"14",pt:14},{value:"21px",label:"16",pt:16},{value:"24px",label:"18",pt:18},{value:"27px",label:"20",pt:20},{value:"32px",label:"24",pt:24},{value:"37px",label:"28",pt:28},{value:"48px",label:"36",pt:36},{value:"64px",label:"48",pt:48},{value:"96px",label:"72",pt:72}],Me="16px",Mt=e=>Math.round(e*96/72),St=e=>Math.round(e*72/96*2)/2,wn=e=>{const t=Object.values(rt).find(o=>o.pt===e);return t?`${t.px}px`:`${Mt(e)}px`},On=e=>{const t=parseInt(e),o=Object.values(rt).find(r=>r.px===t);return o?o.pt:St(t)},Cn=e=>{if(!e)return!1;if(e.endsWith("px")){const t=parseInt(e);return t>=8&&t<=144}if(e.endsWith("pt")){const t=parseFloat(e);return t>=6&&t<=108}return!1},de={minWidth:50,minHeight:50,maxWidth:800,maxHeight:600,aspectRatio:!0,preserveAspectRatio:!0,defaultWidth:300,defaultHeight:200},_={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP:"top",BOTTOM:"bottom",LEFT:"left",RIGHT:"right"};function Mn({handler:e,startX:t,startY:o,currentX:r,currentY:i,startWidth:a,startHeight:n,options:s=de}){const m=r-t,b=i-o;let h=a,p=n;switch(e){case _.TOP_LEFT:h=Math.max(s.minWidth,a-m),p=Math.max(s.minHeight,n-b);break;case _.TOP_RIGHT:h=Math.max(s.minWidth,a+m),p=Math.max(s.minHeight,n-b);break;case _.BOTTOM_LEFT:h=Math.max(s.minWidth,a-m),p=Math.max(s.minHeight,n+b);break;case _.BOTTOM_RIGHT:h=Math.max(s.minWidth,a+m),p=Math.max(s.minHeight,n+b);break;case _.TOP:p=Math.max(s.minHeight,n-b);break;case _.BOTTOM:p=Math.max(s.minHeight,n+b);break;case _.LEFT:h=Math.max(s.minWidth,a-m);break;case _.RIGHT:h=Math.max(s.minWidth,a+m);break;default:return{width:h,height:p}}if(s.preserveAspectRatio&&s.aspectRatio){const f=a/n;[_.TOP_LEFT,_.TOP_RIGHT,_.BOTTOM_LEFT,_.BOTTOM_RIGHT].includes(e)?h/f>p?p=Math.max(s.minHeight,h/f):h=Math.max(s.minWidth,p*f):[_.TOP,_.BOTTOM].includes(e)?h=p*f:[_.LEFT,_.RIGHT].includes(e)&&(p=h/f)}return s.maxWidth&&h>s.maxWidth&&(h=s.maxWidth,s.preserveAspectRatio&&s.aspectRatio&&(p=h/(a/n))),s.maxHeight&&p>s.maxHeight&&(p=s.maxHeight,s.preserveAspectRatio&&s.aspectRatio&&(h=p*(a/n))),h=Math.max(s.minWidth,h),p=Math.max(s.minHeight,p),{width:Math.round(h),height:Math.round(p)}}function le(e){return e?e.tagName==="IMG"?(console.log("Element is an IMG tag, returning true"),!0):!!(e.tagName==="DIV"&&e.style.backgroundImage&&e.style.backgroundImage!=="none"):!1}function Sn(e){return le(e)?{width:e.offsetWidth,height:e.offsetHeight}:{width:0,height:0}}function Nn(e,{width:t,height:o}){le(e)&&(e.tagName==="IMG"?(e.style.width=`${t}px`,e.style.height=`${o}px`,e.width=t,e.height=o):e.tagName==="DIV"&&(e.style.width=`${t}px`,e.style.height=`${o}px`))}function ot(e,t=de){if(!le(e))return null;const o=document.createElement("div");o.className="image-resize-overlay",o.style.position="fixed",o.style.zIndex="1000",o.style.pointerEvents="none";const r=e.getBoundingClientRect();return o.style.top=`${r.top}px`,o.style.left=`${r.left}px`,o.style.width=`${r.width}px`,o.style.height=`${r.height}px`,Object.values(_).forEach(a=>{const n=document.createElement("div");n.className=`resize-handler resize-handler-${a}`,n.dataset.handler=a,n.style.position="absolute",n.style.width="10px",n.style.height="10px",n.style.backgroundColor="#007bff",n.style.border="2px solid white",n.style.borderRadius="50%",n.style.boxShadow="0 0 3px rgba(0,0,0,0.3)",n.style.cursor=Rn(a),n.style.pointerEvents="all",Nt(n,a,r.width,r.height),o.appendChild(n)}),o}function Rn(e){switch(e){case _.TOP_LEFT:case _.BOTTOM_RIGHT:return"nwse-resize";case _.TOP_RIGHT:case _.BOTTOM_LEFT:return"nesw-resize";case _.TOP:case _.BOTTOM:return"ns-resize";case _.LEFT:case _.RIGHT:return"ew-resize";default:return"default"}}function Nt(e,t,o,r){switch(t){case _.TOP_LEFT:e.style.top="-5px",e.style.left="-5px";break;case _.TOP_RIGHT:e.style.top="-5px",e.style.right="-5px";break;case _.BOTTOM_LEFT:e.style.bottom="-5px",e.style.left="-5px";break;case _.BOTTOM_RIGHT:e.style.bottom="-5px",e.style.right="-5px";break;case _.TOP:e.style.top="-5px",e.style.left=`${o/2+-5}px`;break;case _.BOTTOM:e.style.bottom="-5px",e.style.left=`${o/2+-5}px`;break;case _.LEFT:e.style.top=`${r/2+-5}px`,e.style.left="-5px";break;case _.RIGHT:e.style.top=`${r/2+-5}px`,e.style.right="-5px";break}}function Se(e,t){if(!e||!t)return;const o=t.getBoundingClientRect();e.style.top=`${o.top}px`,e.style.left=`${o.left}px`,e.style.width=`${o.width}px`,e.style.height=`${o.height}px`,e.querySelectorAll(".resize-handler").forEach(i=>{const a=i.dataset.handler;Nt(i,a,o.width,o.height)})}function ge(e){e&&e.parentNode&&e.parentNode.removeChild(e)}const In={"10px":"1","12px":"2","13px":"2","15px":"3","16px":"3","19px":"4","21px":"4","24px":"5","27px":"5","32px":"6","37px":"6","48px":"6","64px":"7","96px":"7"},Rt={bold:!1,italic:!1,underline:!1,strikethrough:!1,alignLeft:!1,alignCenter:!1,alignRight:!1,alignJustify:!1,fontFamily:"Arial",fontSize:Me,headingLevel:"p",imageSelected:!1,imageResizeOptions:de,preserveAspectRatio:!0},It=()=>{const[e,t]=g.useState(Rt),o=g.useCallback(T=>{t(E=>({...E,alignLeft:T==="left",alignCenter:T==="center",alignRight:T==="right",alignJustify:T==="justify"}))},[]),r=g.useCallback(T=>{try{const E=window.getSelection();if(!E||E.rangeCount===0)return!1;const y=E.getRangeAt(0);if(!y.toString())return t(j=>({...j,fontSize:T})),!1;try{const j=document.createElement("span");j.style.fontSize=T;const P=y.extractContents();return j.appendChild(P),y.insertNode(j),y.selectNodeContents(j),E.removeAllRanges(),E.addRange(y),t(C=>({...C,fontSize:T})),!0}catch{const P=In[T]||"2";return document.execCommand("fontSize",!1,P),t(C=>({...C,fontSize:T})),!0}}catch(E){return console.warn("[useFormatting] Font size change failed:",E),!1}},[]),i=g.useCallback((T,E=null)=>{try{if(typeof document.execCommand!="function"){console.warn("[useFormatting] execCommand not supported");return}if(T==="fontSize"){r(E);return}switch(document.execCommand(T,!1,E)||console.warn(`[useFormatting] Command "${T}" failed`),T){case"bold":t(k=>({...k,bold:!k.bold}));break;case"italic":t(k=>({...k,italic:!k.italic}));break;case"underline":t(k=>({...k,underline:!k.underline}));break;case"strikethrough":t(k=>({...k,strikethrough:!k.strikethrough}));case"justifyLeft":o("left");break;case"justifyCenter":o("center");case"justifyRight":o("right");case"justifyFull":o("justify");case"fontName":t(k=>({...k,fontFamily:E}));case"formatBlock":t(k=>({...k,headingLevel:E}));default:break}}catch(y){console.warn(`[useFormatting] Error executing command "${T}":`,y)}},[r,o]),a=g.useRef(null),n=g.useRef(null),s=g.useRef(null),m=g.useRef(null),b=g.useRef(de);g.useCallback(T=>{if(!le(T))return;a.current&&(ge(a.current),a.current=null),T.classList.add("selected");const E=ot(T);E&&(a.current=E,n.current=T,document.body.appendChild(E),t(y=>({...y,imageSelected:!0,preserveAspectRatio:b.current.preserveAspectRatio})))},[]);const h=g.useCallback(()=>{n.current&&(n.current.classList.remove("selected"),n.current=null),a.current&&(ge(a.current),a.current=null),s.current=null,m.current=null,t(T=>({...T,imageSelected:!1}))},[]),p=g.useCallback(()=>{const T=!b.current.preserveAspectRatio;b.current={...b.current,preserveAspectRatio:T,aspectRatio:T},t(E=>({...E,preserveAspectRatio:T}))},[]);g.useCallback((T,E,y)=>{n.current&&(s.current={x:E,y,width:n.current.offsetWidth,height:n.current.offsetHeight},m.current=T,document.body.classList.add("resize-in-progress"),document.body.style.cursor=jn(T))},[]),g.useCallback((T,E)=>{if(!n.current||!s.current||!m.current)return;const{x:y,y:k,width:j,height:P}=s.current,C=m.current,N=Ln({handler:C,startX:y,startY:k,currentX:T,currentY:E,startWidth:j,startHeight:P,options:b.current});Dn(n.current,N),a.current&&Se(a.current,n.current)},[]),g.useCallback(()=>{if(s.current=null,m.current=null,document.body.classList.remove("resize-in-progress"),document.body.style.cursor="",n.current){const T=new Event("input",{bubbles:!0,cancelable:!0});n.current.dispatchEvent(T)}},[]);const f=g.useCallback(()=>{h(),t(Rt)},[h]);return g.useEffect(()=>()=>{a.current&&ge(a.current)},[]),{currentFormat:e,formatText:i,resetFormat:f,toggleAspectRatio:p}};function jn(e){switch(e){case _.TOP_LEFT:case _.BOTTOM_RIGHT:return"nwse-resize";case _.TOP_RIGHT:case _.BOTTOM_LEFT:return"nesw-resize";case RESIZE_HANDLRES.TOP:case _.BOTTOM:return"ns-resize";case _.LEFT:case _.RIGHT:return"ew-resize";default:return"default"}}function Ln({handler:e,startX:t,startY:o,currentX:r,currentY:i,startWidth:a,startHeight:n,options:s=de}){const m=r-t,b=i-o;let h=a,p=n;switch(e){case _.TOP_LEFT:h=Math.max(s.minWidth,a-m),p=Math.max(s.minHeight,n-b);break;case _.TOP_RIGHT:h=Math.max(s.minWidth,a+m),p=Math.max(s.minHeight,n-b);break;case _.BOTTOM_LEFT:h=Math.max(s.minWidth,a-m),p=Math.max(s.minHeight,n+b);break;case _.BOTTOM_RIGHT:h=Math.max(s.minWidth,a+m),p=Math.max(s.minHeight,n+b);break;case _.TOP:p=Math.max(s.minHeight,n-b);break;case _.BOTTOM:p=Math.max(s.minHeight,n+b);break;case _.LEFT:h=Math.max(s.minWidth,a-m);break;case _.RIGHT:h=Math.max(s.minWidth,a+m);break;default:return{width:h,height:p}}if(s.preserveAspectRatio&&s.aspectRatio){const f=a/n;[_.TOP_LEFT,_.TOP_RIGHT,_.BOTTOM_LEFT,_.BOTTOM_RIGHT].includes(e)?h/f>p?p=Math.max(s.minHeight,h/f):h=Math.max(s.minWidth,p*f):[_.TOP,_.BOTTOM].includes(e)?h=p*f:[_.LEFT,_.RIGHT].includes(e)&&(p=h/f)}return s.maxWidth&&h>s.maxWidth&&(h=s.maxWidth,s.preserveAspectRatio&&s.aspectRatio&&(p=h/(a/n))),s.maxHeight&&p>s.maxHeight&&(p=s.maxHeight,s.preserveAspectRatio&&s.aspectRatio&&(h=p*(a/n))),h=Math.max(s.minWidth,h),p=Math.max(s.minHeight,p),{width:Math.round(h),height:Math.round(p)}}function Dn(e,{width:t,height:o}){le(e)&&(e.tagName==="IMG"?(e.style.width=`${t}px`,e.style.height=`${o}px`,e.width=t,e.height=o):e.tagName==="DIV"&&(e.style.width=`${t}px`,e.style.height=`${o}px`))}const ye='page-break, [data-page-break="true"]',jt=e=>ae[e]||ae.A4,zn=(e,t={})=>{if(!e||typeof document>"u")return[];const o=t.pageSize||"A4",r=jt(o),i=e.querySelectorAll(ye),a=[];a.push({id:"page-0",pageNumber:1,top:0,height:r.height});const n=e.getBoundingClientRect(),s=e.scrollTop;return i.forEach((m,b)=>{const p=m.getBoundingClientRect().top-n.top+s;a.push({id:`page-${b+1}`,pageNumber:b+2,top:p,height:r.height})}),a},Lt=(e,t=100,o=fe)=>{const r=jt(e),i=un(o),a=r.height-i,n=t/100;return a/n},$n=(e,t)=>{if(!e||!t)return 0;try{const o=t.querySelectorAll(ye);if(o.length===0)return 0;const r=e.getBoundingClientRect(),i=r.top+r.height/2;for(let a=o.length-1;a>=0;a--)if(o[a].getBoundingClientRect().top<i)return a+1;return 0}catch(o){return console.warn("[getCurrentPage] Failed to calculate page:",o),0}},Dt=e=>{if(!e)return[];const t=Array.from(e.children);if(t.length===0)return[];let o=[],r=[];for(const i of t)i.tagName==="PAGE-BREAK"||i.getAttribute("data-page-break")==="true"?r.length>0&&(o.push(r),r=[]):r.push(i);return r.length>0&&o.push(r),o.length===0&&t.length>0&&o.push(t.filter(i=>!(i.tagName==="PAGE-BREAK"||i.getAttribute("data-page-break")==="true"))),o},Bn=e=>{if(!e||!e.getBoundingClientRect)return 0;const t=e.getBoundingClientRect();return e.tagName==="P"?t.height+16:e.tagName==="H1"||e.tagName==="H2"||e.tagName==="H3"||e.tagName==="H4"||e.tagName==="H5"||e.tagName==="H6"?t.height+20:e.tagName==="UL"||e.tagName==="OL"?t.height+16:t.height},Hn=(e,t)=>{if(!e)return!1;try{const o=document.createElement("page-break");return o.setAttribute("data-page-break","true"),o.setAttribute("contenteditable","false"),o.setAttribute("data-page-number",t||"2"),e.parentNode.insertBefore(o,e),!0}catch(o){return console.warn("[insertPageBreakBefore] Failed to insert page break:",o),!1}},Gn=(e,t,o,r,i,a,n)=>{if(!e)return!1;try{const m=Lt(o,r,i)*(t-1),b=Array.from(e.children);let h=0,p=null;for(let f=0;f<b.length;f++){const T=b[f];if(T.tagName==="PAGE-BREAK"||T.getAttribute("data-page-break")==="true")continue;const E=Bn(T);if(h+E>m){p=T;break}h+=E}if(p){const f=document.createElement("page-break");if(f.setAttribute("data-page-break","true"),f.setAttribute("contenteditable","false"),f.setAttribute("data-page-number",String(t)),p.parentNode.insertBefore(f,p),a){const T=e.innerHTML;a(T)}return n&&setTimeout(()=>{n()},50),!0}else{const f=document.createElement("page-break");f.setAttribute("data-page-break","true"),f.setAttribute("contenteditable","false"),f.setAttribute("data-page-number",String(t)),e.appendChild(f);const T=document.createElement("p");if(T.innerHTML="<br>",e.appendChild(T),a){const E=e.innerHTML;a(E)}return n&&setTimeout(()=>{n()},50),!0}}catch(s){return console.error("[insertPageBreakAtBoundary] Failed to insert page break:",s),!1}},Un=(e,t,o,r,i,a,n)=>{if(!e)return!1;if(o().length<=1)return console.warn("[removePageAndContent] Cannot delete the only page"),!1;try{const m=Array.from(e.querySelectorAll(ye));if(t>m.length)return console.warn("[removePageAndContent] Invalid page index"),!1;const b=window.getSelection();let h=!1,p=[],f=null;if(t===0){const E=m[0];if(!E)return console.warn("[removePageAndContent] No page break found for first page"),!1;let y=e.firstChild;for(;y&&y!==E;)p.push(y),y=y.nextSibling;f=E}else{const E=m[t-1];if(!E)return console.warn("[removePageAndContent] Page break not found"),!1;const y=m[t];let k=E.nextSibling;for(;k&&k!==y;)p.push(k),k=k.nextSibling;f=E}if(b&&b.rangeCount>0){const y=b.getRangeAt(0).startContainer;for(const k of p)if(k.contains(y)||k===y){h=!0;break}}if(f&&f.parentNode&&f.remove(),p.forEach(E=>{E.parentNode&&E.remove()}),e.querySelectorAll(ye).forEach((E,y)=>{E.setAttribute("data-page-number",String(y+2))}),h&&a&&setTimeout(()=>{a(0)},50),r){const E=e.innerHTML;r(E)}return i&&setTimeout(()=>{i(),n&&setTimeout(()=>{n()},150)},100),!0}catch(m){return console.error("[removePageAndContent] Failed to remove page:",m),!1}},Fn=200,qn=50,zt=3,Wn=20,$t=e=>{if(!e||!e.getBoundingClientRect)return 0;const t=e.getBoundingClientRect();return e.tagName==="P"?t.height+16:e.tagName==="H1"||e.tagName==="H2"||e.tagName==="H3"||e.tagName==="H4"||e.tagName==="H5"||e.tagName==="H6"?t.height+20:e.tagName==="UL"||e.tagName==="OL"?t.height+16:t.height},Zn=(e,t)=>{if(!e||e.length===0)return null;let o=0,r=null;for(let i=0;i<e.length;i++){const a=e[i];if(!a||!a.getBoundingClientRect)continue;const n=$t(a);if(n<1)continue;if(o+n>t)return r===null?i>0?{overflowIndex:i,overflowElement:a,accumulatedHeight:o}:null:{overflowIndex:i,overflowElement:a,accumulatedHeight:o};o+=n,r=a}return null},Yn=(e,t,o,r,i,a,n,s)=>{if(!e||n.current)return!1;try{n.current=!0;const m=Lt(t,o,r);let b=Dt(e),h=!1,p=0;for(let f=0;f<b.length&&p<zt;f++){const T=b[f],E=Zn(T,m);if(E&&E.overflowIndex>0){let y=0;for(let C=0;C<T.length;C++){const N=T[C];N&&N.getBoundingClientRect&&(y+=$t(N))}if(y-m<Wn)continue;const j=f+2;Hn(E.overflowElement,j)&&(h=!0,p++,b=Dt(e))}}if(h){if(i){const f=e.innerHTML;i(f)}setTimeout(()=>{a&&a(),p>=zt&&s&&setTimeout(()=>{n.current||s()},100)},qn)}return h}catch(m){return console.warn("[checkAndReflow] Reflow failed:",m),!1}finally{n.current=!1}},Vn=(e,t,o=Fn)=>{t.current&&clearTimeout(t.current),t.current=setTimeout(()=>{t.current=null,e()},o)},Kn=400,Bt=(e,t)=>{if(e){e.focus();try{let o=null,r=0;if(t===0)o=e.firstChild,r=0;else{const a=e.querySelectorAll(ye)[t-1];a&&a.nextSibling&&(o=a.nextSibling,r=0)}if(o){const i=document.createRange(),a=window.getSelection();o.nodeType===Node.TEXT_NODE?i.setStart(o,r):i.setStart(o,0),i.collapse(!0),a.removeAllRanges(),a.addRange(i)}}catch(o){console.warn("[positionCursorAtPage] Failed to position cursor:",o)}}},Xn=(e,t,o,r)=>{if(!e||!t){console.warn("[scrollToPage] Missing refs");return}try{let i=null;if(o===0)i=t;else{const n=t.querySelectorAll(ye)[o-1];if(n)i=n;else{console.warn("[scrollToPage] Page break not found for page",o);return}}if(i){const a=i.getBoundingClientRect(),n=e.getBoundingClientRect(),s=e.scrollTop+(a.top-n.top);console.log("[scrollToPage] Scrolling to page",o,"scrollTop:",s),e.scrollTo({top:s,behavior:"smooth"}),setTimeout(()=>{r?r(o):Bt(t,o)},Kn)}}catch(i){console.error("[scrollToPage] Error:",i)}},Jn=(e,t,o={},r=300)=>{t.current&&clearTimeout(t.current),t.current=setTimeout(()=>{t.current=null,e(o)},Math.max(0,r))},Qn=300,Ht=(e,t,o=100,r="NARROW")=>{const i=Ve(),a=g.useRef(null),n=g.useRef(null),s=g.useRef(e),m=g.useRef(o),b=g.useRef(r),h=g.useRef(!1);g.useEffect(()=>{s.current=e},[e]),g.useEffect(()=>{m.current=o},[o]),g.useEffect(()=>{b.current=r},[r]),g.useEffect(()=>()=>{a.current&&clearTimeout(a.current),n.current&&clearTimeout(n.current)},[]);const p=g.useCallback((u={})=>t?.current?zn(t.current,u):[],[t]),f=g.useCallback((u={})=>{const d=p(u);return i.updatePageBoundaries(d),d},[p,i]),T=g.useCallback(async u=>{if(!t?.current)return!1;const d=s.current||"A4",A=m.current||100,R=b.current||"NARROW";return Gn(t.current,u,d,A,R,i.updateContinuousContent,f)},[t,i,f]),E=g.useCallback(()=>{if(!t?.current)return;const u=s.current||"A4",d=m.current||100,A=b.current||"NARROW";Yn(t.current,u,d,A,i.updateContinuousContent,f,h,E)},[t,i,f]),y=g.useCallback(u=>{Vn(E,n,u)},[E]),k=g.useCallback((u={})=>{const d=typeof u.delay=="number"?u.delay:Qn;Jn(f,a,u,d)},[f]),j=g.useCallback(u=>!u?.current||!t?.current?0:$n(u.current,t.current),[t]),P=g.useCallback(u=>{t?.current&&Bt(t.current,u)},[t]),C=g.useCallback((u,d)=>{if(!d?.current||!t?.current){console.warn("[scrollToPage] Missing refs");return}Xn(d.current,t.current,u,P)},[t,P]),N=g.useCallback(u=>t?.current?Un(t.current,u,p,i.updateContinuousContent,f,P,E):!1,[t,p,i,f,P,E]);return{calculatePageBoundaries:p,checkAndUpdateBoundaries:k,updateBoundaries:f,getCurrentPage:j,scrollToPage:C,positionCursorAtPage:P,checkAndReflow:E,triggerAutoReflow:y,removePageAndContent:N,insertPageBreakAtBoundary:T,boundaryTimeoutRef:a,reflowTimeoutRef:n}},er="html-editor-storage",tr=1,se="images";function nr(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function xe(){return new Promise((e,t)=>{const o=indexedDB.open(er,tr);o.onerror=()=>{t(new Error("Failed to open IndexedDB database"))},o.onsuccess=()=>{e(o.result)},o.onupgradeneeded=r=>{const i=r.target.result;i.objectStoreNames.contains(se)||i.createObjectStore(se,{keyPath:"key"}).createIndex("timestamp","timestamp",{unique:!1})}})}function Gt(e){return new Promise((t,o)=>{if(!["image/png","image/jpeg","image/gif","image/webp"].includes(e.type)){o(new Error("Invalid image format. Supported formats: png, jpeg, gif, webp"));return}if(e.size>5*1024*1024){o(new Error("Image exceeds maximum size of 5MB"));return}const i=new FileReader;i.onload=async a=>{const n=a.target.result,m=n.split(",")[1].length*3/4;if(m>5*1024*1024){o(new Error("Image exceeds maximum size of 5MB"));return}try{const b=await xe(),h=`editor-image-${nr()}`,f=b.transaction([se],"readwrite").objectStore(se),T={key:h,dataUrl:n,size:m,type:e.type,timestamp:Date.now()},E=f.add(T);E.onsuccess=()=>{b.close(),t(h)},E.onerror=()=>{b.close(),o(new Error("Failed to save image to IndexedDB"))}}catch(b){o(b)}},i.onerror=()=>{o(new Error("Error reading image file"))},i.readAsDataURL(e)})}async function Ut(e){try{const t=await xe();return new Promise((o,r)=>{const n=t.transaction([se],"readonly").objectStore(se).get(e);n.onsuccess=()=>{t.close();const s=n.result;o(s?s.dataUrl:null)},n.onerror=()=>{t.close(),r(new Error("Failed to retrieve image from IndexedDB"))}})}catch(t){return console.error("Error getting image:",t),null}}async function Ft(e){try{const t=await xe();return new Promise((o,r)=>{const n=t.transaction([se],"readwrite").objectStore(se).delete(e);n.onsuccess=()=>{t.close(),o()},n.onerror=()=>{t.close(),r(new Error("Failed to delete image from IndexedDB"))}})}catch(t){console.error("Error deleting image:",t)}}async function rr(){try{const e=await xe();return new Promise((t,o)=>{const a=e.transaction([se],"readwrite").objectStore(se).clear();a.onsuccess=()=>{e.close(),t()},a.onerror=()=>{e.close(),o(new Error("Failed to clear images from IndexedDB"))}})}catch(e){console.error("Error clearing images:",e)}}async function or(){try{const e=await xe();return new Promise((t,o)=>{const a=e.transaction([se],"readonly").objectStore(se).getAllKeys();a.onsuccess=()=>{e.close(),t(a.result||[])},a.onerror=()=>{e.close(),o(new Error("Failed to get image keys from IndexedDB"))}})}catch(e){return console.error("Error getting image keys:",e),[]}}/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ar=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ir=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,o,r)=>r?r.toUpperCase():o.toLowerCase()),qt=e=>{const t=ir(e);return t.charAt(0).toUpperCase()+t.slice(1)},Wt=(...e)=>e.filter((t,o,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===o).join(" ").trim(),sr=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var cr={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lr=g.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:o=2,absoluteStrokeWidth:r,className:i="",children:a,iconNode:n,...s},m)=>g.createElement("svg",{ref:m,...cr,width:t,height:t,stroke:e,strokeWidth:r?Number(o)*24/Number(t):o,className:Wt("lucide",i),...!a&&!sr(s)&&{"aria-hidden":"true"},...s},[...n.map(([b,h])=>g.createElement(b,h)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=(e,t)=>{const o=g.forwardRef(({className:r,...i},a)=>g.createElement(lr,{ref:a,iconNode:t,className:Wt(`lucide-${ar(qt(e))}`,`lucide-${e}`,r),...i}));return o.displayName=qt(e),o};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=V("bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dr=V("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fr=V("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=V("file-check",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=V("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gr=V("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hr=V("heading-1",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mr=V("heading-2",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yr=V("heading-3",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17.5 10.5c1.7-1 3.5 0 3.5 1.5a2 2 0 0 1-2 2",key:"68ncm8"}],["path",{d:"M17 17.5c2 1.5 4 .3 4-1.5a2 2 0 0 0-2-2",key:"1ejuhz"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const br=V("image-upscale",[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M17 21h2a2 2 0 0 0 2-2",key:"130fy9"}],["path",{d:"M21 12v3",key:"1wzk3p"}],["path",{d:"m21 3-5 5",key:"1g5oa7"}],["path",{d:"M3 7V5a2 2 0 0 1 2-2",key:"kk3yz1"}],["path",{d:"m5 21 4.144-4.144a1.21 1.21 0 0 1 1.712 0L13 19",key:"fyekpt"}],["path",{d:"M9 3h3",key:"d52fa"}],["rect",{x:"3",y:"11",width:"10",height:"10",rx:"1",key:"1wpmix"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Er=V("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vr=V("italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tr=V("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xr=V("list-ordered",[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=V("list",[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _r=V("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pr=V("redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ar=V("scaling",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M14 15H9v-5",key:"pi4jk9"}],["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M21 3 9 15",key:"15kdhq"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kr=V("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=V("strikethrough",[["path",{d:"M16 4H9a3 3 0 0 0-2.83 4",key:"43sutm"}],["path",{d:"M14 12a4 4 0 0 1 0 8H6",key:"nlfj13"}],["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Or=V("table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=V("text-align-center",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 19H5",key:"vjpgq2"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=V("text-align-end",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 19H7",key:"4cu937"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cr=V("text-align-justify",[["path",{d:"M3 5h18",key:"1u36vt"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 19h18",key:"awlh7x"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=V("text-align-start",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=V("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=V("underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nr=V("undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rr=V("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ir=V("zoom-in",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jr=V("zoom-out",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),Xt=({editorView:e,isCollapsed:t,onToggle:o,wordCount:r,pageCount:i})=>{const a=Ye(),{pages:n,activePage:s,continuousContent:m,editorMode:b}=a,[h,p]=g.useState(0),[f,T]=g.useState([]);g.useEffect(()=>{if(r!==void 0&&i!==void 0){if(p(r),m){const j=document.createElement("div");j.innerHTML=m;const P=j.querySelectorAll("h1, h2, h3, h4, h5, h6"),C=Array.from(P).map((N,u)=>{const d=parseInt(N.tagName.charAt(1)),A=N.textContent.trim();return A?{id:`heading-${u}`,level:d,text:A,page:1}:null}).filter(Boolean);T(C)}return}let y=0;const k=[];n.forEach((j,P)=>{if(j.content){const C=document.createElement("div");C.innerHTML=j.content;const u=(C.textContent||C.innerText||"").trim().split(/\s+/).filter(A=>A.length>0);y+=u.length,C.querySelectorAll("h1, h2, h3, h4, h5, h6").forEach((A,R)=>{const D=parseInt(A.tagName.charAt(1)),K=A.textContent.trim();K&&k.push({id:`heading-${P}-${R}`,level:D,text:K,page:P+1})})}}),p(y),T(k)},[n,r,i,m]);const E=i!==void 0?i:n.length;return l.jsxs("aside",{className:`sidebar ${t?"collapsed":""}`,role:"complementary","aria-label":"Document information","data-testid":"sidebar",children:[l.jsxs("div",{className:"sidebar-header",children:[l.jsxs("div",{className:"sidebar-title",children:[l.jsx(Ne,{size:18}),l.jsx("h2",{children:"Document Info"})]}),l.jsx("button",{className:"sidebar-toggle",onClick:o,"aria-label":t?"Expand sidebar":"Collapse sidebar",title:t?"Expand sidebar":"Collapse sidebar",children:t?l.jsx(fr,{size:16}):l.jsx(dr,{size:16})})]}),!t&&l.jsxs("div",{className:"sidebar-content",children:[l.jsxs("div",{className:"sidebar-section",children:[l.jsx("h3",{children:"Statistics"}),l.jsxs("div",{className:"stat-item",children:[l.jsxs("div",{className:"stat-label",children:[l.jsx(pr,{size:14}),l.jsx("span",{children:"Pages:"})]}),l.jsx("span",{className:"stat-value",children:E})]}),l.jsxs("div",{className:"stat-item","data-testid":"word-count",children:[l.jsxs("div",{className:"stat-label",children:[l.jsx(gr,{size:14}),l.jsx("span",{children:"Words:"})]}),l.jsx("span",{className:"stat-value",children:h.toLocaleString()})]}),l.jsxs("div",{className:"stat-item",children:[l.jsxs("div",{className:"stat-label",children:[l.jsx(Ne,{size:14}),l.jsx("span",{children:"Active Page:"})]}),l.jsx("span",{className:"stat-value",children:s+1})]})]}),f.length>0&&l.jsxs("div",{className:"sidebar-section",children:[l.jsxs("h3",{children:[l.jsx(Zt,{size:14,style:{display:"inline-block",marginRight:"6px",verticalAlign:"middle"}}),"Document Outline"]}),l.jsx("div",{className:"document-outline","data-testid":"outline",children:f.map(y=>{const k=y.level===1?hr:y.level===2?mr:yr;return l.jsxs("div",{className:`outline-item outline-level-${y.level}`,style:{marginLeft:`${(y.level-1)*12}px`},children:[l.jsx(k,{size:12,className:"outline-icon"}),l.jsx("span",{className:"outline-text",children:y.text}),l.jsxs("span",{className:"outline-page",children:["p.",y.page]})]},y.id)})})]}),l.jsxs("div",{className:"sidebar-section",children:[l.jsx("h3",{children:"Document"}),l.jsx("p",{children:"HTML Editor"}),l.jsx("p",{children:"Multi-page support"})]})]})]})};class Jt{constructor(t="Editor"){this.namespace=t}_format(t,o,r){return`[${new Date().toISOString()}] [${this.namespace}] [${t}] ${o}`}info(t,o){}warn(t,o){}error(t,o){}debug(t,o){}}const Qt=new Jt("Editor"),Re=({currentFormat:e,onFormatText:t,onAddPageBreak:o})=>{const r=async i=>{try{if(!["image/png","image/jpeg","image/gif","image/webp"].includes(i.type)){alert("Invalid image format. Supported: PNG, JPEG, GIF, WEBP");return}if(i.size>5242880){alert("Image exceeds maximum size of 5MB");return}const n=await Gt(i),s=await Ut(n);if(s){const b=`<img src="${s}" data-key="${n}" alt="Inserted image" />`;document.execCommand("insertHTML",!1,b),Qt.info("Image inserted",{key:n})}const m=document.getElementById("image-upload");m&&(m.value="")}catch(a){Qt.error("Error uploading image",a)}};return l.jsxs("div",{className:"editor-toolbar",children:[l.jsx("button",{onClick:()=>t("undo"),title:"Undo",children:l.jsx(Nr,{size:16})}),l.jsx("button",{onClick:()=>t("redo"),title:"Redo",children:l.jsx(Pr,{size:16})}),l.jsx("div",{className:"toolbar-separator"}),l.jsx("button",{onClick:()=>t("bold"),className:e.bold?"active":"",title:"Bold",children:l.jsx(ur,{size:16})}),l.jsx("button",{onClick:()=>t("italic"),className:e.italic?"active":"",title:"Italic",children:l.jsx(vr,{size:16})}),l.jsx("button",{onClick:()=>t("underline"),className:e.underline?"active":"",title:"Underline",children:l.jsx(Sr,{size:16})}),l.jsx("button",{onClick:()=>t("strikethrough"),className:e.strikethrough?"active":"",title:"Strikethrough",children:l.jsx(wr,{size:16})}),l.jsx("div",{className:"toolbar-separator"}),l.jsx("button",{onClick:()=>t("justifyLeft"),className:e.alignLeft?"active":"",title:"Align Left",children:l.jsx(Kt,{size:16})}),l.jsx("button",{onClick:()=>t("justifyCenter"),className:e.alignCenter?"active":"",title:"Align Center",children:l.jsx(Yt,{size:16})}),l.jsx("button",{onClick:()=>t("justifyRight"),className:e.alignRight?"active":"",title:"Align Right",children:l.jsx(Vt,{size:16})}),l.jsx("button",{onClick:()=>t("justifyFull"),className:e.alignJustify?"active":"",title:"Justify",children:l.jsx(Cr,{size:16})}),l.jsx("div",{className:"toolbar-separator"}),l.jsxs("select",{onChange:i=>t("fontName",i.target.value),defaultValue:"Arial",title:"Font Family",children:[l.jsx("option",{value:"Arial",children:"Arial"}),l.jsx("option",{value:"Times New Roman",children:"Times New Roman"}),l.jsx("option",{value:"Courier New",children:"Courier New"}),l.jsx("option",{value:"Georgia",children:"Georgia"}),l.jsx("option",{value:"Verdana",children:"Verdana"})]}),l.jsx("select",{onChange:i=>t("fontSize",i.target.value),defaultValue:Me,title:"Font Size",children:Ct.map(({value:i,label:a})=>l.jsx("option",{value:i,children:a},i))}),l.jsxs("select",{onChange:i=>t("formatBlock",i.target.value),value:e.headingLevel||"p",title:"Heading Level",children:[l.jsx("option",{value:"p",children:"Normal"}),l.jsx("option",{value:"h1",children:"Heading 1"}),l.jsx("option",{value:"h2",children:"Heading 2"}),l.jsx("option",{value:"h3",children:"Heading 3"}),l.jsx("option",{value:"h4",children:"Heading 4"}),l.jsx("option",{value:"h5",children:"Heading 5"}),l.jsx("option",{value:"h6",children:"Heading 6"})]}),l.jsx("div",{className:"toolbar-separator"}),l.jsx("button",{onClick:()=>t("insertUnorderedList"),title:"Bullet List",children:l.jsx(Zt,{size:16})}),l.jsx("button",{onClick:()=>t("insertOrderedList"),title:"Numbered List",children:l.jsx(xr,{size:16})}),l.jsx("div",{className:"toolbar-separator"}),l.jsx("button",{onClick:()=>{const i=prompt("Enter URL:");i&&t("createLink",i)},title:"Insert Link",children:l.jsx(Tr,{size:16})}),l.jsx("button",{onClick:()=>t("insertHTML",'<table border="1"><tr><td>Cell 1</td><td>Cell 2</td></tr><tr><td>Cell 3</td><td>Cell 4</td></tr></table>'),title:"Insert Table",children:l.jsx(Or,{size:16})}),o&&l.jsx("button",{onClick:o,title:"Insert Page Break",children:l.jsx(Ne,{size:16})}),l.jsx("div",{className:"toolbar-separator"}),l.jsx("input",{type:"file",accept:"image/*",onChange:i=>i.target.files[0]&&r(i.target.files[0]),style:{display:"none"},id:"image-upload"}),l.jsx("button",{onClick:()=>document.getElementById("image-upload").click(),title:"Insert Image",children:l.jsx(Er,{size:16})})]})};Re.propTypes={currentFormat:x.shape({bold:x.bool,italic:x.bool,underline:x.bool,strikethrough:x.bool,alignLeft:x.bool,alignCenter:x.bool,alignRight:x.bool,alignJustify:x.bool,fontFamily:x.string,fontSize:x.string,headingLevel:x.string}).isRequired,onFormatText:x.func.isRequired,onAddPageBreak:x.func},Re.defaultProps={onAddPageBreak:void 0};const Ie=({content:e,dimensions:t,pageSize:o,pageBoundaries:r=[],editorRef:i,onInput:a,onKeyDown:n,onClick:s,onScroll:m,zoomLevel:b=100,pageMargins:h=fe})=>{const p=gt(h),f=b/100,T=(P,C)=>{if(!P)return!1;const N=P.getBoundingClientRect(),u=C-N.top;return u<p.top||u>N.height-p.bottom},E=P=>P?P.nodeType===Node.ELEMENT_NODE?P.tagName==="PAGE-BREAK"||P.getAttribute("data-page-break")==="true":P.parentElement&&E(P.parentElement):!1,y=P=>{const C=window.getSelection();if(!C||C.rangeCount===0)return;const N=C.getRangeAt(0),{startContainer:u,endContainer:d}=N;if((E(u)||E(d))&&(P.key.length===1||P.key==="Enter"||P.key===" "))return P.preventDefault(),!1;if(P.key==="Tab")return P.preventDefault(),document.execCommand("insertHTML",!1,"&nbsp;&nbsp;&nbsp;&nbsp;"),!1;if((P.key==="Backspace"||P.key==="Delete")&&(E(u)||E(d)))return P.preventDefault(),!1;n&&n(P)},k=P=>{if(!i.current)return;const C=P.target;if(E(C)){P.preventDefault();return}if(T(i.current,P.clientY)){P.preventDefault();const N=i.current.getBoundingClientRect();if(P.clientY-N.top<p.top){const d=i.current.firstElementChild;if(d&&d.tagName!=="PAGE-BREAK"){const A=document.createRange(),R=window.getSelection();A.setStart(d,0),A.collapse(!0),R.removeAllRanges(),R.addRange(A)}}else{const d=i.current.lastElementChild;if(d&&d.tagName!=="PAGE-BREAK"){const A=document.createRange(),R=window.getSelection();A.selectNodeContents(d),A.collapse(!1),R.removeAllRanges(),R.addRange(A)}}return}s&&s(P)},j=P=>{const C=window.getSelection();if(!C||C.rangeCount===0)return;const N=C.getRangeAt(0),{startContainer:u}=N;if(E(u))return P.preventDefault(),!1};return l.jsx("div",{className:"continuous-page-container",style:{position:"relative",width:"100%",maxWidth:`${t.width}px`,margin:"40px auto",backgroundColor:"transparent",minHeight:"100vh",transform:`scale(${f})`,transformOrigin:"top center",transition:"transform 0.2s ease-out"},children:l.jsx("div",{ref:i,contentEditable:!0,suppressContentEditableWarning:!0,className:"continuous-content",style:{position:"relative",zIndex:1,minHeight:`${t.height}px`,width:`${t.width}px`,backgroundColor:"white",padding:`${p.top}px ${p.right}px ${p.bottom}px ${p.left}px`,boxSizing:"border-box",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",outline:"none",cursor:"text",fontFamily:"Arial, sans-serif",fontSize:Me,lineHeight:"1.3",color:"#333",wordWrap:"break-word",whiteSpace:"pre-wrap",overflowWrap:"break-word",border:"1px solid #e0e0e0"},onInput:a,onKeyDown:y,onBeforeInput:j,onClick:k,onScroll:m,"data-testid":"continuous-editor"})})};Ie.propTypes={content:x.string.isRequired,dimensions:x.shape({width:x.number.isRequired,height:x.number.isRequired}).isRequired,pageSize:x.oneOf(["A4","Letter","Legal"]).isRequired,pageBoundaries:x.arrayOf(x.shape({id:x.string.isRequired,pageNumber:x.number.isRequired,top:x.number,height:x.number})),editorRef:x.shape({current:x.instanceOf(typeof Element<"u"?Element:Object)}).isRequired,onInput:x.func.isRequired,onKeyDown:x.func,onClick:x.func,onScroll:x.func,zoomLevel:x.number,pageMargins:x.string},Ie.defaultProps={pageBoundaries:[],onKeyDown:void 0,onClick:void 0,onScroll:void 0,zoomLevel:100,pageMargins:fe};const at=({pageBoundaries:e=[{id:"page-0",pageNumber:1}],activePage:t=0,pageSize:o="A4",pageMargins:r=fe,zoomLevel:i=100,canZoomIn:a=!0,canZoomOut:n=!0,onNavigate:s,onAddPage:m,onDeletePage:b,onPageSizeChange:h,onPageMarginsChange:p,onZoomIn:f,onZoomOut:T,onZoomReset:E}={})=>{const y=Math.max(e?.length||0,1),k=u=>{s&&s(u)},j=()=>{m&&m()},P=u=>{if(y<=1){console.warn("[PageManager] Cannot delete the only page");return}b&&b(u)},C=u=>{h&&h(u)},N=u=>{p&&p(u)};return l.jsxs("div",{className:"page-manager",children:[l.jsxs("div",{className:"page-settings-group",children:[l.jsxs("div",{className:"page-settings-header",children:[l.jsx(kr,{size:14,style:{marginRight:"4px",verticalAlign:"middle"}}),"Page Settings"]}),l.jsxs("div",{className:"page-settings-controls",children:[l.jsxs("div",{className:"page-setting-item",children:[l.jsx("label",{htmlFor:"page-size-selector",children:"Size:"}),l.jsxs("select",{id:"page-size-selector",role:"combobox","aria-label":"Page size selector",value:o,onChange:u=>C(u.target.value),children:[l.jsx("option",{value:"A4",children:"A4"}),l.jsx("option",{value:"Letter",children:"Letter"}),l.jsx("option",{value:"Legal",children:"Legal"})]})]}),l.jsxs("div",{className:"page-setting-item",children:[l.jsx("label",{htmlFor:"page-margins-selector",children:"Margins:"}),l.jsx("select",{id:"page-margins-selector",role:"combobox","aria-label":"Page margins selector",value:r,onChange:u=>N(u.target.value),children:dn().map(u=>l.jsx("option",{value:u,children:fn(u)},u))})]})]})]}),l.jsxs("div",{className:"zoom-controls-compact",children:[l.jsx("button",{type:"button",className:"zoom-button-compact",onClick:T,disabled:!n,"aria-label":"Zoom out",title:"Zoom out (Ctrl + -)",children:l.jsx(jr,{size:12})}),l.jsxs("span",{className:"zoom-level-display",children:[i,"%"]}),l.jsx("button",{type:"button",className:"zoom-button-compact",onClick:f,disabled:!a,"aria-label":"Zoom in",title:"Zoom in (Ctrl + +)",children:l.jsx(Ir,{size:12})}),l.jsx("button",{type:"button",className:"zoom-reset-compact",onClick:E,"aria-label":"Reset zoom",title:"Reset zoom to 100% (Ctrl + 0)",children:"Reset"})]}),l.jsx("div",{className:"page-list",children:(e&&e.length>0?e:[{id:"page-0",pageNumber:1}]).map((u,d)=>l.jsxs("div",{className:"page-item",children:[l.jsxs("button",{type:"button",className:`page-button ${d===t?"active":""}`,onClick:()=>k(d),"aria-label":`Go to page ${d+1}`,"aria-current":d===t?"page":void 0,children:[l.jsx(Ne,{size:14}),l.jsxs("span",{children:["Page ",d+1]})]}),y>1&&l.jsx("button",{type:"button",className:"delete-page-button",onClick:A=>{A.stopPropagation(),P(d)},"aria-label":`Delete page ${d+1}`,title:"Delete this page and its content",children:l.jsx(Rr,{size:14})})]},u.id||`page-${d}`))}),l.jsxs("button",{type:"button",className:"add-page-button",onClick:j,"aria-label":"Add new page",title:"Add new page at end",children:[l.jsx(_r,{size:16}),l.jsx("span",{children:"Add Page"})]})]})};at.propTypes={pageBoundaries:x.arrayOf(x.shape({id:x.string.isRequired,pageNumber:x.number.isRequired,top:x.number,height:x.number})),activePage:x.number,pageSize:x.oneOf(["A4","Letter","Legal"]),pageMargins:x.string,zoomLevel:x.number,canZoomIn:x.bool,canZoomOut:x.bool,onNavigate:x.func,onAddPage:x.func,onDeletePage:x.func,onPageSizeChange:x.func,onPageMarginsChange:x.func,onZoomIn:x.func,onZoomOut:x.func,onZoomReset:x.func},at.defaultProps={pageBoundaries:[{id:"page-0",pageNumber:1}],activePage:0,pageSize:"A4",pageMargins:fe,zoomLevel:100,canZoomIn:!0,canZoomOut:!0,onNavigate:void 0,onAddPage:void 0,onDeletePage:void 0,onPageSizeChange:void 0,onPageMarginsChange:void 0,onZoomIn:void 0,onZoomOut:void 0,onZoomReset:void 0};const en=g.memo(at),je=({editorRef:e,onImageResize:t,onImageSelect:o,onImageDeselect:r,resizeOptions:i=de})=>{const a=g.useRef(null),n=g.useRef(null),s=g.useRef(null),m=g.useRef(null),b=g.useRef(i),h=g.useRef(!1);g.useEffect(()=>{b.current=i},[i]);const p=g.useCallback(d=>{if(!le(d))return;a.current&&(ge(a.current),a.current=null),d.classList.add("selected");const A=ot(d,b.current);A&&(a.current=A,n.current=d,document.body.appendChild(A),A.querySelectorAll(".resize-handler").forEach(D=>{D.addEventListener("mousedown",T)}),o&&(console.log("Image selected, calling onImageSelect callback"),o(d)))},[o]),f=g.useCallback(()=>{n.current&&(n.current.classList.remove("selected"),n.current=null),a.current&&(ge(a.current),a.current=null),s.current=null,m.current=null,h.current=!1,r&&r()},[r]),T=g.useCallback(d=>{if(d.preventDefault(),d.stopPropagation(),!n.current)return;const A=d.currentTarget.dataset.handler,R=n.current.getBoundingClientRect(),D=window.pageYOffset||document.documentElement.scrollTop,K=window.pageXOffset||document.documentElement.scrollLeft;s.current={x:d.clientX,y:d.clientY,width:n.current.offsetWidth,height:n.current.offsetHeight,offsetX:d.clientX-R.left-K,offsetY:d.clientY-R.top-D},m.current=A,h.current=!0,document.body.classList.add("resize-in-progress"),document.body.style.cursor=C(A),document.addEventListener("mousemove",E),document.addEventListener("mouseup",y)},[]),E=g.useCallback(d=>{if(!h.current||!n.current||!s.current||!m.current)return;d.preventDefault(),d.stopPropagation();const{x:A,y:R,width:D,height:K}=s.current,Y=m.current,te=d.clientX,H=d.clientY,Q=N({handler:Y,startX:A,startY:R,currentX:te,currentY:H,startWidth:D,startHeight:K,options:b.current});u(n.current,Q),a.current&&Se(a.current,n.current)},[]),y=g.useCallback(d=>{if(h.current&&(d.preventDefault(),d.stopPropagation(),s.current=null,m.current=null,h.current=!1,document.removeEventListener("mousemove",E),document.removeEventListener("mouseup",y),document.body.classList.remove("resize-in-progress"),document.body.style.cursor="",n.current)){const A=new Event("input",{bubbles:!0,cancelable:!0});n.current.dispatchEvent(A),t&&t(n.current,{width:n.current.offsetWidth,height:n.current.offsetHeight})}},[t]),k=g.useCallback(d=>{console.log("handleEditorClick called with target:",d.target),a.current&&!a.current.contains(d.target)&&(console.log("Clicking outside image, clearing selection"),f());const A=d.target;if(le(A)){if(console.log("Clicked on a resizable image"),A===n.current){console.log("Image already selected, not reselecting");return}console.log("Selecting new image"),p(A)}else console.log("Clicked on non-image element")},[p,f]),j=g.useCallback(d=>{if((d.key==="Delete"||d.key==="Backspace")&&n.current&&!h.current){d.preventDefault();const A=n.current;if(A.parentNode){A.parentNode.removeChild(A),f();const R=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(R)}}if(d.key==="Escape"&&n.current&&f(),n.current&&!h.current){if((d.ctrlKey||d.metaKey)&&d.shiftKey&&d.key===">"){d.preventDefault();const A=n.current.offsetWidth,R=Math.min(b.current.maxWidth||800,A+10);u(n.current,{width:R,height:n.current.offsetHeight});const D=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(D)}if((d.ctrlKey||d.metaKey)&&d.shiftKey&&d.key==="<"){d.preventDefault();const A=n.current.offsetWidth,R=Math.max(b.current.minWidth||50,A-10);u(n.current,{width:R,height:n.current.offsetHeight});const D=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(D)}if((d.ctrlKey||d.metaKey)&&d.shiftKey&&d.key==="+"){d.preventDefault();const A=n.current.offsetHeight,R=Math.min(b.current.maxHeight||600,A+10);u(n.current,{width:n.current.offsetWidth,height:R});const D=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(D)}if((d.ctrlKey||d.metaKey)&&d.shiftKey&&d.key==="-"){d.preventDefault();const A=n.current.offsetHeight,R=Math.max(b.current.minHeight||50,A-10);u(n.current,{width:n.current.offsetWidth,height:R});const D=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(D)}if((d.ctrlKey||d.metaKey)&&d.key==="r"){d.preventDefault(),u(n.current,{width:300,height:200});const A=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(A)}}},[e,f]),P=g.useCallback(()=>{a.current&&n.current&&Se(a.current,n.current)},[]);g.useEffect(()=>{if(!e.current)return;const A=e.current.closest(".editor-viewport");return A&&(A.addEventListener("scroll",P),window.addEventListener("scroll",P)),()=>{A&&A.removeEventListener("scroll",P),window.removeEventListener("scroll",P)}},[e,P]),g.useEffect(()=>{if(!e.current)return;const d=e.current;d.addEventListener("click",k),d.addEventListener("keydown",j);const A=d.closest(".editor-viewport");return A&&A.addEventListener("scroll",P),window.addEventListener("resize",P),()=>{d.removeEventListener("click",k),d.removeEventListener("keydown",j),A&&A.removeEventListener("scroll",P),window.removeEventListener("resize",P),h.current&&(document.removeEventListener("mousemove",E),document.removeEventListener("mouseup",y),document.body.classList.remove("resize-in-progress"),document.body.style.cursor=""),a.current&&ge(a.current)}},[e,k,j,P,E,y]),g.useEffect(()=>{if(!e.current)return;const d=new MutationObserver(A=>{A.forEach(R=>{R.type==="childList"&&(R.removedNodes.length>0&&R.removedNodes.forEach(D=>{D.nodeType===Node.ELEMENT_NODE&&le(D)&&D===n.current&&f()}),R.addedNodes.length>0&&R.addedNodes.forEach(D=>{if(D.nodeType===Node.ELEMENT_NODE)if(le(D))setTimeout(()=>{p(D)},50);else{const K=D.querySelectorAll?D.querySelectorAll("img"):[];K.length>0&&setTimeout(()=>{p(K[0])},50)}}))})});return d.observe(e.current,{childList:!0,subtree:!0}),()=>{d.disconnect()}},[e,f,p]);function C(d){switch(d){case _.TOP_LEFT:case _.BOTTOM_RIGHT:return"nwse-resize";case _.TOP_RIGHT:case _.BOTTOM_LEFT:return"nesw-resize";case _.TOP:case _.BOTTOM:return"ns-resize";case _.LEFT:case _.RIGHT:return"ew-resize";default:return"default"}}function N({handler:d,startX:A,startY:R,currentX:D,currentY:K,startWidth:Y,startHeight:te,options:H=de}){const Q=D-A,ee=K-R;let z=Y,W=te;switch(d){case _.TOP_LEFT:z=Math.max(H.minWidth,Y-Q),W=Math.max(H.minHeight,te-ee);break;case _.TOP_RIGHT:z=Math.max(H.minWidth,Y+Q),W=Math.max(H.minHeight,te-ee);break;case _.BOTTOM_LEFT:z=Math.max(H.minWidth,Y-Q),W=Math.max(H.minHeight,te+ee);break;case _.BOTTOM_RIGHT:z=Math.max(H.minWidth,Y+Q),W=Math.max(H.minHeight,te+ee);break;case _.TOP:W=Math.max(H.minHeight,te-ee);break;case _.BOTTOM:W=Math.max(H.minHeight,te+ee);break;case _.LEFT:z=Math.max(H.minWidth,Y-Q);break;case _.RIGHT:z=Math.max(H.minWidth,Y+Q);break;default:return{width:z,height:W}}if(H.preserveAspectRatio&&H.aspectRatio){const ne=Y/te;[_.TOP_LEFT,_.TOP_RIGHT,_.BOTTOM_LEFT,_.BOTTOM_RIGHT].includes(d)?z/ne>W?W=Math.max(H.minHeight,z/ne):z=Math.max(H.minWidth,W*ne):[_.TOP,_.BOTTOM].includes(d)?z=W*ne:[_.LEFT,_.RIGHT].includes(d)&&(W=z/ne)}return H.maxWidth&&z>H.maxWidth&&(z=H.maxWidth,H.preserveAspectRatio&&H.aspectRatio&&(W=z/(Y/te))),H.maxHeight&&W>H.maxHeight&&(W=H.maxHeight,H.preserveAspectRatio&&H.aspectRatio&&(z=W*(Y/te))),z=Math.max(H.minWidth,z),W=Math.max(H.minHeight,W),{width:Math.round(z),height:Math.round(W)}}function u(d,{width:A,height:R}){le(d)&&(d.tagName==="IMG"?(d.style.width=`${A}px`,d.style.height=`${R}px`,d.width=A,d.height=R):d.tagName==="DIV"&&(d.style.width=`${A}px`,d.style.height=`${R}px`))}return null};je.propTypes={editorRef:x.shape({current:x.instanceOf(typeof Element<"u"?Element:Object)}).isRequired,onImageResize:x.func,onImageSelect:x.func,onImageDeselect:x.func,resizeOptions:x.shape({minWidth:x.number,minHeight:x.number,maxWidth:x.number,maxHeight:x.number,aspectRatio:x.bool,preserveAspectRatio:x.bool,defaultWidth:x.number,defaultHeight:x.number})},je.defaultProps={onImageResize:void 0,onImageSelect:void 0,onImageDeselect:void 0,resizeOptions:de};const it=({imageElement:e,onAlignChange:t,onAspectRatioToggle:o,onDelete:r,onClose:i,initialPreserveAspectRatio:a=!0})=>{const[n,s]=g.useState({top:0,left:0}),[m,b]=g.useState(!1),[h,p]=g.useState("top"),[f,T]=g.useState(a),E=g.useRef(null),y=g.useRef(null),k=()=>{if(!e)return"left";const R=window.getComputedStyle(e);return R.float||R.display==="block"?"left":R.display==="flex"&&R.justifyContent==="center"?"center":R.float==="right"?"right":"left"},[j,P]=g.useState(k());g.useEffect(()=>()=>{console.log("ImageTooltipMenu unmounted")},[e]),g.useEffect(()=>{if(e){let R=e.closest(".editor-viewport")||e.closest(".continuous-scroll");R&&(y.current=R)}},[e]),g.useLayoutEffect(()=>{if(!e||!E.current)return;const R=()=>{const K=e.getBoundingClientRect(),Y=E.current.getBoundingClientRect();y.current;const te=window.visualViewport?window.visualViewport:{width:window.innerWidth,height:window.innerHeight},H=K.bottom>=0&&K.top<=te.height&&K.right>=0&&K.left<=te.width;let Q="top",ee=0,z=0;if(H){const c=K.top-Y.height-10,w=te.height-K.bottom-Y.height-10;w>c&&w>0?(Q="bottom",ee=K.bottom+10):(Q="top",ee=K.top-Y.height-10)}else Q="top",ee=10;z=K.left+K.width/2-Y.width/2;const W=window.innerWidth,ne=window.innerHeight;let ie=z,v=ee;z<10?ie=10:z+Y.width>W-10&&(ie=W-Y.width-10),ee<10?v=10:ee+Y.height>ne-10&&(v=ne-Y.height-10),s({top:v,left:ie}),p(Q),b(!0)};R();const D=()=>{R()};return y.current&&y.current.addEventListener("scroll",D),window.addEventListener("scroll",D),window.addEventListener("resize",D),()=>{y.current&&y.current.removeEventListener("scroll",D),window.removeEventListener("scroll",D),window.removeEventListener("resize",D),b(!1)}},[e]),g.useEffect(()=>{const R=D=>{E.current&&!E.current.contains(D.target)&&D.target!==e&&i()};return document.addEventListener("mousedown",R),()=>{document.removeEventListener("mousedown",R)}},[e,i]);const C=()=>{e&&(e.style.float="left",e.style.margin="0 10px 10px 0",e.style.display="block",P("left"),t&&t("left"))},N=()=>{e&&(e.style.float="none",e.style.margin="10px auto",e.style.display="block",P("center"),t&&t("center"))},u=()=>{e&&(e.style.float="right",e.style.margin="0 0 10px 10px",e.style.display="block",P("right"),t&&t("right"))},d=()=>{e&&e.parentNode&&(e.parentNode.removeChild(e),r&&r(),i())},A=()=>{const R=!f;T(R),o&&o(R)};return!e||typeof document>"u"?null:rn.createPortal(l.jsxs("div",{ref:E,className:"image-tooltip-menu","data-menu-position":h,"aria-hidden":!m,style:{position:"fixed",top:`${n.top}px`,left:`${n.left}px`,zIndex:999,background:"#fff",border:"1px solid #ddd",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",padding:"8px",display:"flex",gap:"2px",alignItems:"center",pointerEvents:m?"auto":"none",minWidth:"140px",minHeight:"32px",opacity:m?1:0,visibility:m?"visible":"hidden",transition:"opacity 0.15s ease, visibility 0.15s ease"},children:[l.jsx("button",{className:`tooltip-button aspect-ratio-toggle ${f?"":"active"}`,onClick:A,title:`Toggle aspect ratio preservation (currently ${f?"ON":"OFF"})`,children:f?l.jsx(Ar,{size:14}):l.jsx(br,{size:14})}),l.jsx("button",{className:`tooltip-button ${j==="left"?"active":""}`,onClick:C,title:"Align Left",style:{background:j==="left"?"#007bff":"transparent",color:j==="left"?"#fff":"#333",border:"1px solid #ccc",borderRadius:"4px",padding:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"28px",height:"28px"},children:l.jsx(Kt,{size:14})}),l.jsx("button",{className:`tooltip-button ${j==="center"?"active":""}`,onClick:N,title:"Align Center",style:{background:j==="center"?"#007bff":"transparent",color:j==="center"?"#fff":"#333",border:"1px solid #ccc",borderRadius:"4px",padding:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"28px",height:"28px"},children:l.jsx(Yt,{size:14})}),l.jsx("button",{className:`tooltip-button ${j==="right"?"active":""}`,onClick:u,title:"Align Right",style:{background:j==="right"?"#007bff":"transparent",color:j==="right"?"#fff":"#333",border:"1px solid #ccc",borderRadius:"4px",padding:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"28px",height:"28px"},children:l.jsx(Vt,{size:14})}),l.jsx("button",{className:"tooltip-button delete-button",onClick:d,title:"Delete Image",style:{background:"transparent",color:"#dc3545",border:"1px solid #dc3545",borderRadius:"4px",padding:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"28px",height:"28px"},children:l.jsx(Mr,{size:14})})]}),document.body)};it.propTypes={imageElement:x.instanceOf(typeof Element<"u"?Element:Object),onAlignChange:x.func,onAspectRatioToggle:x.func,onDelete:x.func,onClose:x.func.isRequired,initialPreserveAspectRatio:x.bool},it.defaultProps={imageElement:null,onAlignChange:void 0,onAspectRatioToggle:void 0,onDelete:void 0,initialPreserveAspectRatio:!0};const Lr=50,Dr=50,tn=50,zr=100,$r=500,Le=g.forwardRef(({pageManagerComponent:e=null,onNavigatePage:t,onAddPage:o,onDeletePage:r,onPageSizeChange:i,onPageMarginsChange:a,onChange:n,showSidebar:s=!0,showToolbar:m=!0,showPageManager:b=!0},h)=>{const p=Ye(),f=Ve(),{pageSize:T,pageMargins:E,continuousContent:y,pageBoundaries:k,activePage:j,zoomLevel:P}=p,C=g.useRef(null),N=g.useRef(null),{currentFormat:u,formatText:d}=It(),[A,R]=g.useState(!1),[D,K]=g.useState(null),[Y,te]=g.useState(!0),{checkAndUpdateBoundaries:H,getCurrentPage:Q,scrollToPage:ee,updateBoundaries:z,triggerAutoReflow:W,removePageAndContent:ne,insertPageBreakAtBoundary:ie}=Ht(T,N,P,E),v=g.useMemo(()=>ke(T),[T]),[c,w]=g.useState(!1),M=g.useRef(null),S=g.useRef(!1),G=g.useRef(!1),B=g.useRef(!1),I=g.useRef(y);g.useEffect(()=>{if(N.current){if(!B.current){N.current.innerHTML=y,B.current=!0,I.current=y;const $=setTimeout(()=>{z()},Lr);return()=>clearTimeout($)}if(I.current!==y){if(N.current.innerHTML!==y){N.current.innerHTML=y;const re=setTimeout(()=>{if(z(),S.current){S.current=!1;const ue=Math.max(0,k.length-1);f.setActivePage(ue),setTimeout(()=>{ee(ue,C)},tn)}},Dr);return I.current=y,()=>clearTimeout(re)}I.current=y}}},[y,z,k.length,f,ee]),g.useEffect(()=>{n&&B.current&&n(y)},[y,n]),g.useImperativeHandle(h,()=>({getHTMLContent:()=>y,getPlainText:()=>y.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim(),setContent:$=>{f.updateContinuousContent($),N.current&&(N.current.innerHTML=$,setTimeout(()=>{z()},50))}}),[y,f,z]),g.useEffect(()=>{const $=setTimeout(()=>{N.current&&N.current.focus()},200);return()=>clearTimeout($)},[]);const F=g.useCallback($=>{const re=$.currentTarget.innerHTML;f.updateContinuousContent(re),H(),W(200);const ue=Q(C);ue!==j&&f.setActivePage(ue)},[H,f,Q,j,W,C]),Z=g.useCallback($=>{f.updatePageSize($),z({pageSize:$}),i&&i($)},[f,z,i]),q=g.useCallback($=>{f.updatePageMargins($),z({pageMargins:$}),a&&a($)},[f,z,a]),oe=g.useCallback($=>{$<0||$>=k.length||(G.current=!0,f.setActivePage($),ee($,C),setTimeout(()=>{G.current=!1},$r),t&&t($))},[f,ee,t,k.length]),O=g.useCallback(()=>{const $=k.length+1;ie($)&&(S.current=!0,setTimeout(()=>{if(S.current){S.current=!1;const ue=Math.max(0,k.length-1);f.setActivePage(ue),setTimeout(()=>{ee(ue,C)},tn)}},100)),o&&o()},[k.length,ie,f,ee,o]),ce=g.useCallback(()=>{const $=window.getSelection();if($&&$.rangeCount>0){if(!N?.current)return;const ct=`<page-break data-page-break="true" contenteditable="false" data-page-number="${N.current.querySelectorAll('page-break, [data-page-break="true"]').length+2}"></page-break><p><br></p>`;document.execCommand("insertHTML",!1,ct),setTimeout(()=>{z();const lt=Q(C);f.setActivePage(lt)},150)}},[z,Q,f,C]),he=g.useCallback($=>{if(k.length<=1){console.warn("Cannot delete the only page");return}ne($)&&(f.setActivePage(0),r&&r($))},[k.length,ne,f,r]),me=g.useCallback(()=>{f.zoomIn()},[f]),De=g.useCallback(()=>{f.zoomOut()},[f]),ze=g.useCallback(()=>{f.resetZoom()},[f]);g.useEffect(()=>{const $=re=>{if(re.ctrlKey||re.metaKey){["+","=","-","_","0"].includes(re.key)&&re.preventDefault();const ue=document.activeElement===N.current,ct=document.activeElement===C.current,lt=document.activeElement?.tagName==="INPUT"||document.activeElement?.tagName==="TEXTAREA"||document.activeElement?.isContentEditable===!1;if(ue||ct||!lt)switch(re.key){case"+":case"=":me();break;case"-":case"_":De();break;case"0":ze();break}}};return window.addEventListener("keydown",$),()=>{window.removeEventListener("keydown",$)}},[me,De,ze]);const Hr=g.useCallback(()=>{!C.current||!N.current||G.current||(M.current&&clearTimeout(M.current),M.current=setTimeout(()=>{if(G.current){M.current=null;return}const $=Q(C);$!==j&&$>=0&&f.setActivePage($),M.current=null},zr))},[Q,j,f]),Gr=g.useMemo(()=>{if(!y)return 0;const re=y.replace(/<[^>]*>/g," ").match(/\b\w+\b/g);return re?re.length:0},[y]),Ur=k.length||1,Fr=g.useCallback($=>{R(!0),K($)},[]),nn=g.useCallback(()=>{R(!1),K(null)},[]),qr=g.useCallback(($,re)=>{},[]);return g.useEffect(()=>()=>{M.current&&clearTimeout(M.current)},[]),l.jsxs("div",{className:"multi-page-editor",children:[m&&l.jsx(Re,{currentFormat:{...u,imageSelected:A},onFormatText:d,onAddPageBreak:ce}),l.jsxs("div",{className:"editor-container",children:[s&&l.jsx(Xt,{editorView:null,isCollapsed:c,onToggle:()=>w($=>!$),wordCount:Gr,pageCount:Ur}),l.jsx("div",{className:"editor-viewport continuous-scroll",ref:C,onScroll:Hr,children:l.jsx(Ie,{content:y,dimensions:v,pageSize:T,pageMargins:E,pageBoundaries:k,editorRef:N,onInput:F,onClick:()=>N.current?.focus(),zoomLevel:P})}),l.jsx(je,{editorRef:N,onImageSelect:Fr,onImageDeselect:nn,onImageResize:qr,resizeOptions:{...de,preserveAspectRatio:Y,aspectRatio:Y}}),A&&D&&l.jsx(it,{imageElement:D,initialPreserveAspectRatio:Y,onAlignChange:$=>{},onAspectRatioToggle:$=>{te($)},onDelete:()=>{if(D){const $=D.getAttribute("data-key");$&&Ft($).catch(re=>{console.error("Failed to delete image from IndexedDB:",re)})}},onClose:nn}),b&&l.jsx("div",{className:"page-manager-sidebar",children:e?g.cloneElement(e,{onNavigate:oe,onAddPage:O,onDeletePage:he,onPageSizeChange:Z,onPageMarginsChange:q,zoomLevel:P,canZoomIn:Ue(P),canZoomOut:Fe(P),onZoomIn:me,onZoomOut:De,onZoomReset:ze}):l.jsx(en,{pageBoundaries:k,activePage:j,pageSize:T,pageMargins:E,zoomLevel:P,canZoomIn:Ue(P),canZoomOut:Fe(P),onNavigate:oe,onAddPage:O,onDeletePage:he,onPageSizeChange:Z,onPageMarginsChange:q,onZoomIn:me,onZoomOut:De,onZoomReset:ze})})]})]})});Le.displayName="HtmlEditor",Le.propTypes={pageManagerComponent:x.element,onNavigatePage:x.func,onAddPage:x.func,onDeletePage:x.func,onPageSizeChange:x.func,onPageMarginsChange:x.func,onChange:x.func,showSidebar:x.bool,showToolbar:x.bool,showPageManager:x.bool},Le.defaultProps={pageManagerComponent:null,onNavigatePage:void 0,onAddPage:void 0,onDeletePage:void 0,onPageSizeChange:void 0,onPageMarginsChange:void 0,onChange:void 0,showSidebar:!0,showToolbar:!0,showPageManager:!0};class st extends g.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,o){console.error("[ErrorBoundary] Caught error:",t),console.error("[ErrorBoundary] Error info:",o),this.setState({error:t,errorInfo:o}),this.props.onError&&this.props.onError(t,o)}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null}),this.props.onReset&&this.props.onReset()};render(){return this.state.hasError?this.props.fallback?this.props.fallback:l.jsxs("div",{style:{padding:"20px",margin:"20px",border:"2px solid #f44336",borderRadius:"4px",backgroundColor:"#ffebee",color:"#c62828"},children:[l.jsx("h2",{style:{marginTop:0},children:" Something went wrong"}),l.jsx("p",{children:"The editor encountered an unexpected error and couldn't continue."}),this.props.showDetails&&this.state.error&&l.jsxs("details",{style:{marginTop:"10px",padding:"10px",backgroundColor:"white",borderRadius:"4px",fontSize:"12px",fontFamily:"monospace"},children:[l.jsx("summary",{style:{cursor:"pointer",fontWeight:"bold"},children:"Error Details"}),l.jsxs("pre",{style:{marginTop:"10px",overflow:"auto",maxHeight:"200px"},children:[this.state.error.toString(),this.state.errorInfo&&this.state.errorInfo.componentStack]})]}),l.jsx("button",{onClick:this.handleReset,style:{marginTop:"15px",padding:"8px 16px",backgroundColor:"#f44336",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold"},children:"Try Again"})]}):this.props.children}}st.propTypes={children:x.node.isRequired,fallback:x.node,onError:x.func,onReset:x.func,showDetails:x.bool},st.defaultProps={fallback:null,onError:void 0,onReset:void 0,showDetails:process.env.NODE_ENV==="development"};const Br={A4:{width:ae.A4.width,height:ae.A4.height},Letter:{width:ae.Letter.width,height:ae.Letter.height},Legal:{width:ae.Legal.width,height:ae.Legal.height}};L.COMMON_FONT_SIZES=Ct,L.DEFAULT_FONT_SIZE=Me,L.DEFAULT_IMAGE_RESIZE_OPTIONS=de,L.DEFAULT_PAGE_SIZE=qe,L.DocumentProvider=bn,L.EditorToolbar=Re,L.ErrorBoundary=st,L.FONT_SIZE_MAP=rt,L.HtmlEditor=Le,L.ImageResizeHandlers=je,L.PAGE_DIMENSIONS=Br,L.PAGE_SIZES=ae,L.PageManager=en,L.PageView=Ie,L.RESIZE_HANDLERS=_,L.Sidebar=Xt,L.applyImageDimensions=Nn,L.calculateResizeDimensions=Mn,L.clearImages=rr,L.createResizeOverlay=ot,L.deleteImage=Ft,L.getAllImageKeys=or,L.getAvailablePageSizes=gn,L.getImage=Ut,L.getImageDimensions=Sn,L.getPageDimensions=ke,L.getPixelValue=wn,L.getPointValue=On,L.isResizableImage=le,L.isValidFontSize=Cn,L.isValidPageSize=pn,L.logger=Jt,L.pixelsToPoints=St,L.pointsToPixels=Mt,L.removeResizeOverlay=ge,L.saveImage=Gt,L.updateResizeOverlay=Se,L.useContinuousReflow=Ht,L.useDocument=Ze,L.useDocumentActions=Ve,L.useDocumentState=Ye,L.useFormatting=It,Object.defineProperty(L,Symbol.toStringTag,{value:"Module"})}));
//# sourceMappingURL=htmleditor.umd.cjs.map
