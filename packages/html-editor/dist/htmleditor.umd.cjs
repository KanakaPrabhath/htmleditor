(function(z,m){typeof exports=="object"&&typeof module<"u"?m(exports,require("react"),require("uuid"),require("react-dom")):typeof define=="function"&&define.amd?define(["exports","react","uuid","react-dom"],m):(z=typeof globalThis<"u"?globalThis:z||self,m(z.HTMLEditor={},z.React,z.uuid,z.ReactDOM))})(this,(function(z,m,Ue,pn){"use strict";function gn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ae={exports:{}},be={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mt;function hn(){if(mt)return be;mt=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function a(n,i,o){var r=null;if(o!==void 0&&(r=""+o),i.key!==void 0&&(r=""+i.key),"key"in i){o={};for(var s in i)s!=="key"&&(o[s]=i[s])}else o=i;return i=o.ref,{$$typeof:e,type:n,key:r,ref:i!==void 0?i:null,props:o}}return be.Fragment=t,be.jsx=a,be.jsxs=a,be}var Ee={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yt;function mn(){return yt||(yt=1,process.env.NODE_ENV!=="production"&&(function(){function e(c){if(c==null)return null;if(typeof c=="function")return c.$$typeof===q?null:c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case E:return"Fragment";case j:return"Profiler";case M:return"StrictMode";case C:return"Suspense";case y:return"SuspenseList";case w:return"Activity"}if(typeof c=="object")switch(typeof c.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),c.$$typeof){case d:return"Portal";case x:return c.displayName||"Context";case k:return(c._context.displayName||"Context")+".Consumer";case u:var A=c.render;return c=c.displayName,c||(c=A.displayName||A.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case P:return A=c.displayName||null,A!==null?A:e(c.type)||"Memo";case D:A=c._payload,c=c._init;try{return e(c(A))}catch{}}return null}function t(c){return""+c}function a(c){try{t(c);var A=!1}catch{A=!0}if(A){A=console;var I=A.error,R=typeof Symbol=="function"&&Symbol.toStringTag&&c[Symbol.toStringTag]||c.constructor.name||"Object";return I.call(A,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",R),t(c)}}function n(c){if(c===E)return"<>";if(typeof c=="object"&&c!==null&&c.$$typeof===D)return"<...>";try{var A=e(c);return A?"<"+A+">":"<...>"}catch{return"<...>"}}function i(){var c=K.A;return c===null?null:c.getOwner()}function o(){return Error("react-stack-top-frame")}function r(c){if(J.call(c,"key")){var A=Object.getOwnPropertyDescriptor(c,"key").get;if(A&&A.isReactWarning)return!1}return c.key!==void 0}function s(c,A){function I(){Q||(Q=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",A))}I.isReactWarning=!0,Object.defineProperty(c,"key",{get:I,configurable:!0})}function f(){var c=e(this.type);return F[c]||(F[c]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),c=this.props.ref,c!==void 0?c:null}function b(c,A,I,R,U,B){var L=I.ref;return c={$$typeof:S,type:c,key:A,props:I,_owner:R},(L!==void 0?L:null)!==null?Object.defineProperty(c,"ref",{enumerable:!1,get:f}):Object.defineProperty(c,"ref",{enumerable:!1,value:null}),c._store={},Object.defineProperty(c._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(c,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(c,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:U}),Object.defineProperty(c,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:B}),Object.freeze&&(Object.freeze(c.props),Object.freeze(c)),c}function p(c,A,I,R,U,B){var L=A.children;if(L!==void 0)if(R)if(G(L)){for(R=0;R<L.length;R++)h(L[R]);Object.freeze&&Object.freeze(L)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else h(L);if(J.call(A,"key")){L=e(c);var Z=Object.keys(A).filter(function(Y){return Y!=="key"});R=0<Z.length?"{key: someKey, "+Z.join(": ..., ")+": ...}":"{key: someKey}",T[L+R]||(Z=0<Z.length?"{"+Z.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,R,L,Z,L),T[L+R]=!0)}if(L=null,I!==void 0&&(a(I),L=""+I),r(A)&&(a(A.key),L=""+A.key),"key"in A){I={};for(var V in A)V!=="key"&&(I[V]=A[V])}else I=A;return L&&s(I,typeof c=="function"?c.displayName||c.name||"Unknown":c),b(c,L,I,i(),U,B)}function h(c){g(c)?c._store&&(c._store.validated=1):typeof c=="object"&&c!==null&&c.$$typeof===D&&(c._payload.status==="fulfilled"?g(c._payload.value)&&c._payload.value._store&&(c._payload.value._store.validated=1):c._store&&(c._store.validated=1))}function g(c){return typeof c=="object"&&c!==null&&c.$$typeof===S}var O=m,S=Symbol.for("react.transitional.element"),d=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),k=Symbol.for("react.consumer"),x=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),y=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),w=Symbol.for("react.activity"),q=Symbol.for("react.client.reference"),K=O.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J=Object.prototype.hasOwnProperty,G=Array.isArray,re=console.createTask?console.createTask:function(){return null};O={react_stack_bottom_frame:function(c){return c()}};var Q,F={},W=O.react_stack_bottom_frame.bind(O,o)(),oe=re(n(o)),T={};Ee.Fragment=E,Ee.jsx=function(c,A,I){var R=1e4>K.recentlyCreatedOwnerStacks++;return p(c,A,I,!1,R?Error("react-stack-top-frame"):W,R?re(n(c)):oe)},Ee.jsxs=function(c,A,I){var R=1e4>K.recentlyCreatedOwnerStacks++;return p(c,A,I,!0,R?Error("react-stack-top-frame"):W,R?re(n(c)):oe)}})()),Ee}var bt;function yn(){return bt||(bt=1,process.env.NODE_ENV==="production"?Ae.exports=hn():Ae.exports=mn()),Ae.exports}var l=yn();const Fe=100,We=50,qe=200,Et=5,Ze=e=>e<qe,Ve=e=>e>We,bn=96,ke=e=>Math.round(e*bn),Pe={NORMAL:{name:"Normal",label:'Normal (1")',top:1,bottom:1,left:1,right:1},NARROW:{name:"Narrow",label:'Narrow (0.5")',top:.5,bottom:.5,left:.5,right:.5},MODERATE:{name:"Moderate",label:'Moderate (1" / 0.75")',top:1,bottom:1,left:.75,right:.75},WIDE:{name:"Wide",label:'Wide (1" / 2")',top:1,bottom:1,left:2,right:2},OFFICE_2003:{name:"Office 2003",label:'Office 2003 (1" / 1.25")',top:1,bottom:1,left:1.25,right:1.25}},fe="NORMAL",Tt=(e=fe)=>{const t=Pe[e]||Pe[fe];return{top:ke(t.top),bottom:ke(t.bottom),left:ke(t.left),right:ke(t.right)}},En=(e=fe)=>{const t=Tt(e);return t.top+t.bottom},Tn=()=>Object.keys(Pe),vn=e=>{const t=Pe[e];return t?t.label:"Unknown"},ie={A4:{name:"A4",width:794,height:1123,widthMm:210,heightMm:297,widthIn:8.27,heightIn:11.69},Letter:{name:"Letter",width:816,height:1056,widthMm:216,heightMm:279,widthIn:8.5,heightIn:11},Legal:{name:"Legal",width:816,height:1344,widthMm:216,heightMm:356,widthIn:8.5,heightIn:14}},Ye="A4",we=e=>{const t=ie[e]||ie[Ye];return{width:t.width,height:t.height}},xn=e=>Object.keys(ie).includes(e),_n=()=>Object.keys(ie),Te=Ye,pe="<p><br></p>",An="continuous",ve=(e,t=Te)=>({id:Ue.v4(),index:e,size:t,content:pe,images:[],isBreakPoint:!1}),Oe=e=>typeof e!="string"||e.trim()===""?pe:e,vt=(e,t=Te)=>(e.length>0?e:[ve(0,t)]).map((n,i)=>({id:n.id||Ue.v4(),index:i,size:n.size||t,content:Oe(n.content),images:n.images||[],isBreakPoint:!!n.isBreakPoint})),kn=(e=Te)=>[{id:"page-0",pageNumber:1,top:0,height:we(e).height}],Ke=(e={})=>{const t=new Date().toISOString(),a=e.pageSize||Te,n=vt(e.pages||[ve(0,a)],a);return{id:Ue.v4(),title:e.title||"Untitled Document",createdAt:t,updatedAt:t,pageSize:a,pages:n,activePage:e.activePage&&e.activePage<n.length?e.activePage:0,pageBreaks:e.pageBreaks||[],totalPages:n.length,editorMode:e.editorMode||An,continuousContent:e.continuousContent||pe,pageBoundaries:e.pageBoundaries||kn(a),zoomLevel:e.zoomLevel||Fe,pageMargins:e.pageMargins||fe,undoStack:[],redoStack:[],canUndo:!1,canRedo:!1}},H={INITIALIZE_DOCUMENT:"INITIALIZE_DOCUMENT",UPDATE_TITLE:"UPDATE_TITLE",UPDATE_PAGE_CONTENT:"UPDATE_PAGE_CONTENT",UPDATE_PAGES:"UPDATE_PAGES",ADD_PAGE:"ADD_PAGE",DELETE_PAGE:"DELETE_PAGE",SET_ACTIVE_PAGE:"SET_ACTIVE_PAGE",UPDATE_PAGE_SIZE:"UPDATE_PAGE_SIZE",RESET_DOCUMENT:"RESET_DOCUMENT",UPDATE_CONTINUOUS_CONTENT:"UPDATE_CONTINUOUS_CONTENT",UPDATE_PAGE_BOUNDARIES:"UPDATE_PAGE_BOUNDARIES",ADD_PAGE_BREAK:"ADD_PAGE_BREAK",REMOVE_PAGE_BREAK:"REMOVE_PAGE_BREAK",SET_EDITOR_MODE:"SET_EDITOR_MODE",INSERT_PAGE_AT:"INSERT_PAGE_AT",MOVE_PAGE_TO:"MOVE_PAGE_TO",DUPLICATE_PAGE:"DUPLICATE_PAGE",SET_ZOOM_LEVEL:"SET_ZOOM_LEVEL",ZOOM_IN:"ZOOM_IN",ZOOM_OUT:"ZOOM_OUT",RESET_ZOOM:"RESET_ZOOM",UPDATE_PAGE_MARGINS:"UPDATE_PAGE_MARGINS",RECORD_OPERATION:"RECORD_OPERATION",UNDO:"UNDO",REDO:"REDO",CLEAR_UNDO_REDO:"CLEAR_UNDO_REDO"},Xe=(e,t)=>{const a=new Date().toISOString();switch(t.type){case H.INITIALIZE_DOCUMENT:{const{initialContent:n=pe,pageSize:i=Te}=t.payload||{},o={...ve(0,i),content:Oe(n)};return Ke({title:e.title,pageSize:i,pages:[o]})}case H.UPDATE_TITLE:return{...e,title:t.payload,updatedAt:a};case H.UPDATE_PAGE_CONTENT:{const{pageIndex:n,content:i}=t.payload;if(n<0||n>=e.pages.length)return e;const o=[...e.pages];return o[n]={...o[n],content:Oe(i)},{...e,pages:o,updatedAt:a}}case H.UPDATE_PAGES:{const n=Array.isArray(t.payload)?{pages:t.payload}:t.payload||{},i=vt(n.pages||[],e.pageSize),o=Array.isArray(n.pageBreaks)?n.pageBreaks:i.slice(0,-1).map((r,s)=>({id:`auto-break-${s}`,pageNumber:s+1}));return{...e,pages:i,activePage:Math.min(e.activePage,i.length-1),pageBreaks:o,totalPages:i.length,updatedAt:a}}case H.ADD_PAGE:{const n=typeof t.payload?.index=="number"?Math.min(Math.max(t.payload.index,0),e.pages.length):e.pages.length,i=[...e.pages];i.splice(n,0,ve(n,e.pageSize));const o=i.map((s,f)=>({...s,index:f,size:e.pageSize})),r=o.slice(0,-1).map((s,f)=>({id:`auto-break-${f}`,pageNumber:f+1}));return{...e,pages:o,activePage:n,pageBreaks:r,totalPages:o.length,updatedAt:a}}case H.DELETE_PAGE:{const n=t.payload;if(e.pages.length<=1)return e;const i=[...e.pages];i.splice(n,1);const o=i.map((f,b)=>({...f,index:b,size:e.pageSize}));let r=e.activePage;r>=o.length?r=o.length-1:n<=r&&r>0&&(r-=1);const s=o.slice(0,-1).map((f,b)=>({id:`auto-break-${b}`,pageNumber:b+1}));return{...e,pages:o,activePage:r,pageBreaks:s,totalPages:o.length,updatedAt:a}}case H.SET_ACTIVE_PAGE:{const n=t.payload;if(n===e.activePage)return e;const i=e.editorMode==="continuous"?e.pageBoundaries.length:e.pages.length;return n<0||n>=i?e:{...e,activePage:n,updatedAt:a}}case H.UPDATE_PAGE_SIZE:{const n=t.payload;if(n===e.pageSize)return e;try{we(n)}catch{return console.warn(`Invalid page size: ${n}`),e}const i=e.pages.map((r,s)=>({...r,index:s,size:n})),o=i.slice(0,-1).map((r,s)=>({id:`auto-break-${s}`,pageNumber:s+1}));return{...e,pageSize:n,pages:i,pageBreaks:o,updatedAt:a}}case H.RESET_DOCUMENT:return Ke();case H.UPDATE_CONTINUOUS_CONTENT:{const n=Oe(t.payload);return n===e.continuousContent?e:{...e,continuousContent:n,updatedAt:a}}case H.UPDATE_PAGE_BOUNDARIES:{const n=Array.isArray(t.payload)?t.payload:[];if(n.length===e.pageBoundaries.length&&n.length>0&&n[0].id===e.pageBoundaries[0]?.id&&n[n.length-1].id===e.pageBoundaries[n.length-1]?.id)return e;const i=e.activePage>=n.length?Math.max(0,n.length-1):e.activePage;return{...e,pageBoundaries:n,totalPages:n.length,activePage:i,updatedAt:a}}case H.ADD_PAGE_BREAK:{const{position:n="end",pageIndex:i}=t.payload||{},o='<page-break data-page-break="true" style="display: block; height: 20px; border-top: 2px dashed #ccc; margin: 20px 0; page-break-after: always;"></page-break>';let r=e.continuousContent;if(n==="end")r=r+o+"<p><br></p>";else if(typeof n=="number"){const s=r.substring(0,n),f=r.substring(n);r=s+o+f}else if(typeof i=="number"&&typeof document<"u"){const s=document.createElement("div");s.innerHTML=r;const f=s.querySelectorAll('page-break, [data-page-break="true"]');if(i===0&&f.length===0)r=r+o+"<p><br></p>";else if(i<f.length){const b=f[i],p=document.createElement("page-break");p.setAttribute("data-page-break","true"),p.setAttribute("style","display: block; height: 20px; border-top: 2px dashed #ccc; margin: 20px 0; page-break-after: always;");const h=document.createElement("p");h.innerHTML="<br>",b.parentNode.insertBefore(p,b.nextSibling),p.parentNode.insertBefore(h,p.nextSibling),r=s.innerHTML}else r=r+o+"<p><br></p>"}return{...e,continuousContent:r,updatedAt:a}}case H.REMOVE_PAGE_BREAK:{const{pageIndex:n}=t.payload||{};if(typeof n!="number"||typeof document>"u")return e;const i=document.createElement("div");i.innerHTML=e.continuousContent;const o=i.querySelectorAll('page-break, [data-page-break="true"]');return o[n]&&o[n].remove(),i.querySelectorAll('page-break, [data-page-break="true"]').forEach((s,f)=>{s.setAttribute("data-page-number",String(f+2))}),{...e,continuousContent:i.innerHTML,updatedAt:a}}case H.SET_EDITOR_MODE:{const n=t.payload;if(n===e.editorMode)return e;let i=e.continuousContent,o=e.pages;return n==="continuous"?i=e.pages.map(s=>s.content).filter(s=>s&&s!==pe).join(`
`)||pe:e.continuousContent&&e.continuousContent!==pe&&(o=[{...ve(0,e.pageSize),content:e.continuousContent}]),{...e,editorMode:n,continuousContent:i,pages:o,updatedAt:a}}case H.SET_ZOOM_LEVEL:{const n=t.payload;return n<We||n>qe?(console.warn(`Invalid zoom level: ${n}. Must be between ${We} and ${qe}.`),e):n===e.zoomLevel?e:{...e,zoomLevel:n,updatedAt:a}}case H.ZOOM_IN:{if(!Ze(e.zoomLevel))return e;const n=e.zoomLevel+Et;return{...e,zoomLevel:n,updatedAt:a}}case H.ZOOM_OUT:{if(!Ve(e.zoomLevel))return e;const n=e.zoomLevel-Et;return{...e,zoomLevel:n,updatedAt:a}}case H.RESET_ZOOM:return e.zoomLevel===Fe?e:{...e,zoomLevel:Fe,updatedAt:a};case H.UPDATE_PAGE_MARGINS:{const n=t.payload;return n===e.pageMargins?e:{...e,pageMargins:n,updatedAt:a}}case H.RECORD_OPERATION:{const{operation:n,inverseOperation:i}=t.payload;return{...e,undoStack:[...e.undoStack,{operation:n,inverseOperation:i}],redoStack:[],canUndo:!0,canRedo:!1,updatedAt:a}}case H.UNDO:{if(e.undoStack.length===0)return e;const n=e.undoStack[e.undoStack.length-1],i=e.undoStack.slice(0,-1);let o=e;return n.inverseOperation&&(o=Xe(e,n.inverseOperation)),{...o,undoStack:i,redoStack:[...e.redoStack,n],canUndo:i.length>0,canRedo:!0,updatedAt:a}}case H.REDO:{if(e.redoStack.length===0)return e;const n=e.redoStack[e.redoStack.length-1],i=e.redoStack.slice(0,-1);let o=e;return n.operation&&(o=Xe(e,n.operation)),{...o,undoStack:[...e.undoStack,n],redoStack:i,canUndo:!0,canRedo:i.length>0,updatedAt:a}}case H.CLEAR_UNDO_REDO:return{...e,undoStack:[],redoStack:[],canUndo:!1,canRedo:!1,updatedAt:a};case"IMAGE_ALIGN":{const{element:n,state:i}=t.payload;return n&&i&&(n.style.float=i.float,n.style.margin=i.margin,n.style.display=i.display,i.width&&(n.style.width=i.width),i.height&&(n.style.height=i.height)),e}case"IMAGE_DELETE":{const{element:n}=t.payload;return n&&n.parentNode&&n.parentNode.removeChild(n),e}case"IMAGE_REINSERT":{const{state:n}=t.payload;return n&&n.parent&&n.element&&(n.nextSibling?n.parent.insertBefore(n.element,n.nextSibling):n.parent.appendChild(n.element)),e}case"IMAGE_ASPECT_RATIO":return e;case"IMAGE_RESIZE":{const{element:n,state:i}=t.payload;return n&&i&&(i.width&&(n.style.width=i.width),i.height&&(n.style.height=i.height)),e}default:return e}},xt=m.createContext(null),Pn=({children:e,initialState:t={}})=>{const[a,n]=m.useReducer(Xe,Ke(t)),i=m.useMemo(()=>({initializeDocument:r=>n({type:H.INITIALIZE_DOCUMENT,payload:r}),updateTitle:r=>n({type:H.UPDATE_TITLE,payload:r}),updatePageContent:r=>n({type:H.UPDATE_PAGE_CONTENT,payload:r}),updatePages:r=>n({type:H.UPDATE_PAGES,payload:r}),addPage:r=>n({type:H.ADD_PAGE,payload:r}),deletePage:r=>n({type:H.DELETE_PAGE,payload:r}),setActivePage:r=>n({type:H.SET_ACTIVE_PAGE,payload:r}),updatePageSize:r=>n({type:H.UPDATE_PAGE_SIZE,payload:r}),resetDocument:()=>n({type:H.RESET_DOCUMENT}),updateContinuousContent:r=>n({type:H.UPDATE_CONTINUOUS_CONTENT,payload:r}),updatePageBoundaries:r=>n({type:H.UPDATE_PAGE_BOUNDARIES,payload:r}),addPageBreak:r=>n({type:H.ADD_PAGE_BREAK,payload:r}),removePageBreak:r=>n({type:H.REMOVE_PAGE_BREAK,payload:r}),setEditorMode:r=>n({type:H.SET_EDITOR_MODE,payload:r}),insertPageAt:r=>n({type:H.INSERT_PAGE_AT,payload:r}),movePageTo:r=>n({type:H.MOVE_PAGE_TO,payload:r}),duplicatePage:r=>n({type:H.DUPLICATE_PAGE,payload:r}),setZoomLevel:r=>n({type:H.SET_ZOOM_LEVEL,payload:r}),zoomIn:()=>n({type:H.ZOOM_IN}),zoomOut:()=>n({type:H.ZOOM_OUT}),resetZoom:()=>n({type:H.RESET_ZOOM}),updatePageMargins:r=>n({type:H.UPDATE_PAGE_MARGINS,payload:r}),recordOperation:(r,s)=>n({type:H.RECORD_OPERATION,payload:{operation:r,inverseOperation:s}}),undo:()=>n({type:H.UNDO}),redo:()=>n({type:H.REDO}),clearUndoRedo:()=>n({type:H.CLEAR_UNDO_REDO})}),[]),o=m.useMemo(()=>({state:a,actions:i,dispatch:n}),[a,i]);return l.jsx(xt.Provider,{value:o,children:e})},Je=()=>{const e=m.useContext(xt);if(!e)throw new Error("useDocument must be used within a DocumentProvider");return e},Qe=()=>{const{state:e}=Je();return e},me=()=>{const{actions:e}=Je();return e};var Se={exports:{}},Ne={exports:{}},ee={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _t;function wn(){if(_t)return ee;_t=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,a=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,i=e?Symbol.for("react.strict_mode"):60108,o=e?Symbol.for("react.profiler"):60114,r=e?Symbol.for("react.provider"):60109,s=e?Symbol.for("react.context"):60110,f=e?Symbol.for("react.async_mode"):60111,b=e?Symbol.for("react.concurrent_mode"):60111,p=e?Symbol.for("react.forward_ref"):60112,h=e?Symbol.for("react.suspense"):60113,g=e?Symbol.for("react.suspense_list"):60120,O=e?Symbol.for("react.memo"):60115,S=e?Symbol.for("react.lazy"):60116,d=e?Symbol.for("react.block"):60121,E=e?Symbol.for("react.fundamental"):60117,M=e?Symbol.for("react.responder"):60118,j=e?Symbol.for("react.scope"):60119;function k(u){if(typeof u=="object"&&u!==null){var C=u.$$typeof;switch(C){case t:switch(u=u.type,u){case f:case b:case n:case o:case i:case h:return u;default:switch(u=u&&u.$$typeof,u){case s:case p:case S:case O:case r:return u;default:return C}}case a:return C}}}function x(u){return k(u)===b}return ee.AsyncMode=f,ee.ConcurrentMode=b,ee.ContextConsumer=s,ee.ContextProvider=r,ee.Element=t,ee.ForwardRef=p,ee.Fragment=n,ee.Lazy=S,ee.Memo=O,ee.Portal=a,ee.Profiler=o,ee.StrictMode=i,ee.Suspense=h,ee.isAsyncMode=function(u){return x(u)||k(u)===f},ee.isConcurrentMode=x,ee.isContextConsumer=function(u){return k(u)===s},ee.isContextProvider=function(u){return k(u)===r},ee.isElement=function(u){return typeof u=="object"&&u!==null&&u.$$typeof===t},ee.isForwardRef=function(u){return k(u)===p},ee.isFragment=function(u){return k(u)===n},ee.isLazy=function(u){return k(u)===S},ee.isMemo=function(u){return k(u)===O},ee.isPortal=function(u){return k(u)===a},ee.isProfiler=function(u){return k(u)===o},ee.isStrictMode=function(u){return k(u)===i},ee.isSuspense=function(u){return k(u)===h},ee.isValidElementType=function(u){return typeof u=="string"||typeof u=="function"||u===n||u===b||u===o||u===i||u===h||u===g||typeof u=="object"&&u!==null&&(u.$$typeof===S||u.$$typeof===O||u.$$typeof===r||u.$$typeof===s||u.$$typeof===p||u.$$typeof===E||u.$$typeof===M||u.$$typeof===j||u.$$typeof===d)},ee.typeOf=k,ee}var te={};/** @license React v16.13.1
 * react-is.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var At;function On(){return At||(At=1,process.env.NODE_ENV!=="production"&&(function(){var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,a=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,i=e?Symbol.for("react.strict_mode"):60108,o=e?Symbol.for("react.profiler"):60114,r=e?Symbol.for("react.provider"):60109,s=e?Symbol.for("react.context"):60110,f=e?Symbol.for("react.async_mode"):60111,b=e?Symbol.for("react.concurrent_mode"):60111,p=e?Symbol.for("react.forward_ref"):60112,h=e?Symbol.for("react.suspense"):60113,g=e?Symbol.for("react.suspense_list"):60120,O=e?Symbol.for("react.memo"):60115,S=e?Symbol.for("react.lazy"):60116,d=e?Symbol.for("react.block"):60121,E=e?Symbol.for("react.fundamental"):60117,M=e?Symbol.for("react.responder"):60118,j=e?Symbol.for("react.scope"):60119;function k(N){return typeof N=="string"||typeof N=="function"||N===n||N===b||N===o||N===i||N===h||N===g||typeof N=="object"&&N!==null&&(N.$$typeof===S||N.$$typeof===O||N.$$typeof===r||N.$$typeof===s||N.$$typeof===p||N.$$typeof===E||N.$$typeof===M||N.$$typeof===j||N.$$typeof===d)}function x(N){if(typeof N=="object"&&N!==null){var se=N.$$typeof;switch(se){case t:var he=N.type;switch(he){case f:case b:case n:case o:case i:case h:return he;default:var ze=he&&he.$$typeof;switch(ze){case s:case p:case S:case O:case r:return ze;default:return se}}case a:return se}}}var u=f,C=b,y=s,P=r,D=t,w=p,q=n,K=S,J=O,G=a,re=o,Q=i,F=h,W=!1;function oe(N){return W||(W=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),T(N)||x(N)===f}function T(N){return x(N)===b}function c(N){return x(N)===s}function A(N){return x(N)===r}function I(N){return typeof N=="object"&&N!==null&&N.$$typeof===t}function R(N){return x(N)===p}function U(N){return x(N)===n}function B(N){return x(N)===S}function L(N){return x(N)===O}function Z(N){return x(N)===a}function V(N){return x(N)===o}function Y(N){return x(N)===i}function ae(N){return x(N)===h}te.AsyncMode=u,te.ConcurrentMode=C,te.ContextConsumer=y,te.ContextProvider=P,te.Element=D,te.ForwardRef=w,te.Fragment=q,te.Lazy=K,te.Memo=J,te.Portal=G,te.Profiler=re,te.StrictMode=Q,te.Suspense=F,te.isAsyncMode=oe,te.isConcurrentMode=T,te.isContextConsumer=c,te.isContextProvider=A,te.isElement=I,te.isForwardRef=R,te.isFragment=U,te.isLazy=B,te.isMemo=L,te.isPortal=Z,te.isProfiler=V,te.isStrictMode=Y,te.isSuspense=ae,te.isValidElementType=k,te.typeOf=x})()),te}var kt;function Pt(){return kt||(kt=1,process.env.NODE_ENV==="production"?Ne.exports=wn():Ne.exports=On()),Ne.exports}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var et,wt;function Sn(){if(wt)return et;wt=1;var e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function n(o){if(o==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(o)}function i(){try{if(!Object.assign)return!1;var o=new String("abc");if(o[5]="de",Object.getOwnPropertyNames(o)[0]==="5")return!1;for(var r={},s=0;s<10;s++)r["_"+String.fromCharCode(s)]=s;var f=Object.getOwnPropertyNames(r).map(function(p){return r[p]});if(f.join("")!=="0123456789")return!1;var b={};return"abcdefghijklmnopqrst".split("").forEach(function(p){b[p]=p}),Object.keys(Object.assign({},b)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}return et=i()?Object.assign:function(o,r){for(var s,f=n(o),b,p=1;p<arguments.length;p++){s=Object(arguments[p]);for(var h in s)t.call(s,h)&&(f[h]=s[h]);if(e){b=e(s);for(var g=0;g<b.length;g++)a.call(s,b[g])&&(f[b[g]]=s[b[g]])}}return f},et}var tt,Ot;function nt(){if(Ot)return tt;Ot=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return tt=e,tt}var rt,St;function Nt(){return St||(St=1,rt=Function.call.bind(Object.prototype.hasOwnProperty)),rt}var ot,Ct;function Nn(){if(Ct)return ot;Ct=1;var e=function(){};if(process.env.NODE_ENV!=="production"){var t=nt(),a={},n=Nt();e=function(o){var r="Warning: "+o;typeof console<"u"&&console.error(r);try{throw new Error(r)}catch{}}}function i(o,r,s,f,b){if(process.env.NODE_ENV!=="production"){for(var p in o)if(n(o,p)){var h;try{if(typeof o[p]!="function"){var g=Error((f||"React class")+": "+s+" type `"+p+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof o[p]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw g.name="Invariant Violation",g}h=o[p](r,p,f,s,null,t)}catch(S){h=S}if(h&&!(h instanceof Error)&&e((f||"React class")+": type specification of "+s+" `"+p+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof h+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),h instanceof Error&&!(h.message in a)){a[h.message]=!0;var O=b?b():"";e("Failed "+s+" type: "+h.message+(O??""))}}}}return i.resetWarningCache=function(){process.env.NODE_ENV!=="production"&&(a={})},ot=i,ot}var at,Mt;function Cn(){if(Mt)return at;Mt=1;var e=Pt(),t=Sn(),a=nt(),n=Nt(),i=Nn(),o=function(){};process.env.NODE_ENV!=="production"&&(o=function(s){var f="Warning: "+s;typeof console<"u"&&console.error(f);try{throw new Error(f)}catch{}});function r(){return null}return at=function(s,f){var b=typeof Symbol=="function"&&Symbol.iterator,p="@@iterator";function h(T){var c=T&&(b&&T[b]||T[p]);if(typeof c=="function")return c}var g="<<anonymous>>",O={array:M("array"),bigint:M("bigint"),bool:M("boolean"),func:M("function"),number:M("number"),object:M("object"),string:M("string"),symbol:M("symbol"),any:j(),arrayOf:k,element:x(),elementType:u(),instanceOf:C,node:w(),objectOf:P,oneOf:y,oneOfType:D,shape:K,exact:J};function S(T,c){return T===c?T!==0||1/T===1/c:T!==T&&c!==c}function d(T,c){this.message=T,this.data=c&&typeof c=="object"?c:{},this.stack=""}d.prototype=Error.prototype;function E(T){if(process.env.NODE_ENV!=="production")var c={},A=0;function I(U,B,L,Z,V,Y,ae){if(Z=Z||g,Y=Y||L,ae!==a){if(f){var N=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw N.name="Invariant Violation",N}else if(process.env.NODE_ENV!=="production"&&typeof console<"u"){var se=Z+":"+L;!c[se]&&A<3&&(o("You are manually calling a React.PropTypes validation function for the `"+Y+"` prop on `"+Z+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),c[se]=!0,A++)}}return B[L]==null?U?B[L]===null?new d("The "+V+" `"+Y+"` is marked as required "+("in `"+Z+"`, but its value is `null`.")):new d("The "+V+" `"+Y+"` is marked as required in "+("`"+Z+"`, but its value is `undefined`.")):null:T(B,L,Z,V,Y)}var R=I.bind(null,!1);return R.isRequired=I.bind(null,!0),R}function M(T){function c(A,I,R,U,B,L){var Z=A[I],V=Q(Z);if(V!==T){var Y=F(Z);return new d("Invalid "+U+" `"+B+"` of type "+("`"+Y+"` supplied to `"+R+"`, expected ")+("`"+T+"`."),{expectedType:T})}return null}return E(c)}function j(){return E(r)}function k(T){function c(A,I,R,U,B){if(typeof T!="function")return new d("Property `"+B+"` of component `"+R+"` has invalid PropType notation inside arrayOf.");var L=A[I];if(!Array.isArray(L)){var Z=Q(L);return new d("Invalid "+U+" `"+B+"` of type "+("`"+Z+"` supplied to `"+R+"`, expected an array."))}for(var V=0;V<L.length;V++){var Y=T(L,V,R,U,B+"["+V+"]",a);if(Y instanceof Error)return Y}return null}return E(c)}function x(){function T(c,A,I,R,U){var B=c[A];if(!s(B)){var L=Q(B);return new d("Invalid "+R+" `"+U+"` of type "+("`"+L+"` supplied to `"+I+"`, expected a single ReactElement."))}return null}return E(T)}function u(){function T(c,A,I,R,U){var B=c[A];if(!e.isValidElementType(B)){var L=Q(B);return new d("Invalid "+R+" `"+U+"` of type "+("`"+L+"` supplied to `"+I+"`, expected a single ReactElement type."))}return null}return E(T)}function C(T){function c(A,I,R,U,B){if(!(A[I]instanceof T)){var L=T.name||g,Z=oe(A[I]);return new d("Invalid "+U+" `"+B+"` of type "+("`"+Z+"` supplied to `"+R+"`, expected ")+("instance of `"+L+"`."))}return null}return E(c)}function y(T){if(!Array.isArray(T))return process.env.NODE_ENV!=="production"&&(arguments.length>1?o("Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z])."):o("Invalid argument supplied to oneOf, expected an array.")),r;function c(A,I,R,U,B){for(var L=A[I],Z=0;Z<T.length;Z++)if(S(L,T[Z]))return null;var V=JSON.stringify(T,function(ae,N){var se=F(N);return se==="symbol"?String(N):N});return new d("Invalid "+U+" `"+B+"` of value `"+String(L)+"` "+("supplied to `"+R+"`, expected one of "+V+"."))}return E(c)}function P(T){function c(A,I,R,U,B){if(typeof T!="function")return new d("Property `"+B+"` of component `"+R+"` has invalid PropType notation inside objectOf.");var L=A[I],Z=Q(L);if(Z!=="object")return new d("Invalid "+U+" `"+B+"` of type "+("`"+Z+"` supplied to `"+R+"`, expected an object."));for(var V in L)if(n(L,V)){var Y=T(L,V,R,U,B+"."+V,a);if(Y instanceof Error)return Y}return null}return E(c)}function D(T){if(!Array.isArray(T))return process.env.NODE_ENV!=="production"&&o("Invalid argument supplied to oneOfType, expected an instance of array."),r;for(var c=0;c<T.length;c++){var A=T[c];if(typeof A!="function")return o("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+W(A)+" at index "+c+"."),r}function I(R,U,B,L,Z){for(var V=[],Y=0;Y<T.length;Y++){var ae=T[Y],N=ae(R,U,B,L,Z,a);if(N==null)return null;N.data&&n(N.data,"expectedType")&&V.push(N.data.expectedType)}var se=V.length>0?", expected one of type ["+V.join(", ")+"]":"";return new d("Invalid "+L+" `"+Z+"` supplied to "+("`"+B+"`"+se+"."))}return E(I)}function w(){function T(c,A,I,R,U){return G(c[A])?null:new d("Invalid "+R+" `"+U+"` supplied to "+("`"+I+"`, expected a ReactNode."))}return E(T)}function q(T,c,A,I,R){return new d((T||"React class")+": "+c+" type `"+A+"."+I+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+R+"`.")}function K(T){function c(A,I,R,U,B){var L=A[I],Z=Q(L);if(Z!=="object")return new d("Invalid "+U+" `"+B+"` of type `"+Z+"` "+("supplied to `"+R+"`, expected `object`."));for(var V in T){var Y=T[V];if(typeof Y!="function")return q(R,U,B,V,F(Y));var ae=Y(L,V,R,U,B+"."+V,a);if(ae)return ae}return null}return E(c)}function J(T){function c(A,I,R,U,B){var L=A[I],Z=Q(L);if(Z!=="object")return new d("Invalid "+U+" `"+B+"` of type `"+Z+"` "+("supplied to `"+R+"`, expected `object`."));var V=t({},A[I],T);for(var Y in V){var ae=T[Y];if(n(T,Y)&&typeof ae!="function")return q(R,U,B,Y,F(ae));if(!ae)return new d("Invalid "+U+" `"+B+"` key `"+Y+"` supplied to `"+R+"`.\nBad object: "+JSON.stringify(A[I],null,"  ")+`
Valid keys: `+JSON.stringify(Object.keys(T),null,"  "));var N=ae(L,Y,R,U,B+"."+Y,a);if(N)return N}return null}return E(c)}function G(T){switch(typeof T){case"number":case"string":case"undefined":return!0;case"boolean":return!T;case"object":if(Array.isArray(T))return T.every(G);if(T===null||s(T))return!0;var c=h(T);if(c){var A=c.call(T),I;if(c!==T.entries){for(;!(I=A.next()).done;)if(!G(I.value))return!1}else for(;!(I=A.next()).done;){var R=I.value;if(R&&!G(R[1]))return!1}}else return!1;return!0;default:return!1}}function re(T,c){return T==="symbol"?!0:c?c["@@toStringTag"]==="Symbol"||typeof Symbol=="function"&&c instanceof Symbol:!1}function Q(T){var c=typeof T;return Array.isArray(T)?"array":T instanceof RegExp?"object":re(c,T)?"symbol":c}function F(T){if(typeof T>"u"||T===null)return""+T;var c=Q(T);if(c==="object"){if(T instanceof Date)return"date";if(T instanceof RegExp)return"regexp"}return c}function W(T){var c=F(T);switch(c){case"array":case"object":return"an "+c;case"boolean":case"date":case"regexp":return"a "+c;default:return c}}function oe(T){return!T.constructor||!T.constructor.name?g:T.constructor.name}return O.checkPropTypes=i,O.resetWarningCache=i.resetWarningCache,O.PropTypes=O,O},at}var it,Rt;function Mn(){if(Rt)return it;Rt=1;var e=nt();function t(){}function a(){}return a.resetWarningCache=t,it=function(){function n(r,s,f,b,p,h){if(h!==e){var g=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw g.name="Invariant Violation",g}}n.isRequired=n;function i(){return n}var o={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:i,element:n,elementType:n,instanceOf:i,node:n,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:a,resetWarningCache:t};return o.PropTypes=o,o},it}var It;function Rn(){if(It)return Se.exports;if(It=1,process.env.NODE_ENV!=="production"){var e=Pt(),t=!0;Se.exports=Cn()(e.isElement,t)}else Se.exports=Mn()();return Se.exports}var In=Rn();const v=gn(In),st={"7.5pt":{pt:7.5,px:10,label:"7.5"},"9pt":{pt:9,px:12,label:"9"},"10pt":{pt:10,px:13,label:"10"},"11pt":{pt:11,px:15,label:"11"},"12pt":{pt:12,px:16,label:"12"},"14pt":{pt:14,px:19,label:"14"},"16pt":{pt:16,px:21,label:"16"},"18pt":{pt:18,px:24,label:"18"},"20pt":{pt:20,px:27,label:"20"},"22pt":{pt:22,px:29,label:"22"},"24pt":{pt:24,px:32,label:"24"},"26pt":{pt:26,px:35,label:"26"},"28pt":{pt:28,px:37,label:"28"},"36pt":{pt:36,px:48,label:"36"},"48pt":{pt:48,px:64,label:"48"},"72pt":{pt:72,px:96,label:"72"}},jt=[{value:"10px",label:"7.5",pt:7.5},{value:"12px",label:"9",pt:9},{value:"13px",label:"10",pt:10},{value:"15px",label:"11",pt:11},{value:"16px",label:"12",pt:12},{value:"19px",label:"14",pt:14},{value:"21px",label:"16",pt:16},{value:"24px",label:"18",pt:18},{value:"27px",label:"20",pt:20},{value:"32px",label:"24",pt:24},{value:"37px",label:"28",pt:28},{value:"48px",label:"36",pt:36},{value:"64px",label:"48",pt:48},{value:"96px",label:"72",pt:72}],Ce="16px",Lt=e=>Math.round(e*96/72),Dt=e=>Math.round(e*72/96*2)/2,jn=e=>{const t=Object.values(st).find(a=>a.pt===e);return t?`${t.px}px`:`${Lt(e)}px`},Ln=e=>{const t=parseInt(e),a=Object.values(st).find(n=>n.px===t);return a?a.pt:Dt(t)},Dn=e=>{if(!e)return!1;if(e.endsWith("px")){const t=parseInt(e);return t>=8&&t<=144}if(e.endsWith("pt")){const t=parseFloat(e);return t>=6&&t<=108}return!1},de={minWidth:50,minHeight:50,maxWidth:800,maxHeight:600,aspectRatio:!0,preserveAspectRatio:!0,defaultWidth:300,defaultHeight:200},_={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP:"top",BOTTOM:"bottom",LEFT:"left",RIGHT:"right"};function $n({handler:e,startX:t,startY:a,currentX:n,currentY:i,startWidth:o,startHeight:r,options:s=de}){const f=n-t,b=i-a;let p=o,h=r;switch(e){case _.TOP_LEFT:p=Math.max(s.minWidth,o-f),h=Math.max(s.minHeight,r-b);break;case _.TOP_RIGHT:p=Math.max(s.minWidth,o+f),h=Math.max(s.minHeight,r-b);break;case _.BOTTOM_LEFT:p=Math.max(s.minWidth,o-f),h=Math.max(s.minHeight,r+b);break;case _.BOTTOM_RIGHT:p=Math.max(s.minWidth,o+f),h=Math.max(s.minHeight,r+b);break;case _.TOP:h=Math.max(s.minHeight,r-b);break;case _.BOTTOM:h=Math.max(s.minHeight,r+b);break;case _.LEFT:p=Math.max(s.minWidth,o-f);break;case _.RIGHT:p=Math.max(s.minWidth,o+f);break;default:return{width:p,height:h}}if(s.preserveAspectRatio&&s.aspectRatio){const g=o/r;[_.TOP_LEFT,_.TOP_RIGHT,_.BOTTOM_LEFT,_.BOTTOM_RIGHT].includes(e)?p/g>h?h=Math.max(s.minHeight,p/g):p=Math.max(s.minWidth,h*g):[_.TOP,_.BOTTOM].includes(e)?p=h*g:[_.LEFT,_.RIGHT].includes(e)&&(h=p/g)}return s.maxWidth&&p>s.maxWidth&&(p=s.maxWidth,s.preserveAspectRatio&&s.aspectRatio&&(h=p/(o/r))),s.maxHeight&&h>s.maxHeight&&(h=s.maxHeight,s.preserveAspectRatio&&s.aspectRatio&&(p=h*(o/r))),p=Math.max(s.minWidth,p),h=Math.max(s.minHeight,h),{width:Math.round(p),height:Math.round(h)}}function le(e){return e?e.tagName==="IMG"?(console.log("Element is an IMG tag, returning true"),!0):!!(e.tagName==="DIV"&&e.style.backgroundImage&&e.style.backgroundImage!=="none"):!1}function zn(e){return le(e)?{width:e.offsetWidth,height:e.offsetHeight}:{width:0,height:0}}function Hn(e,{width:t,height:a}){le(e)&&(e.tagName==="IMG"?(e.style.width=`${t}px`,e.style.height=`${a}px`,e.width=t,e.height=a):e.tagName==="DIV"&&(e.style.width=`${t}px`,e.style.height=`${a}px`))}function ct(e,t=de){if(!le(e))return null;const a=document.createElement("div");a.className="image-resize-overlay",a.style.position="fixed",a.style.zIndex="1000",a.style.pointerEvents="none";const n=e.getBoundingClientRect();return a.style.top=`${n.top}px`,a.style.left=`${n.left}px`,a.style.width=`${n.width}px`,a.style.height=`${n.height}px`,Object.values(_).forEach(o=>{const r=document.createElement("div");r.className=`resize-handler resize-handler-${o}`,r.dataset.handler=o,r.style.position="absolute",r.style.width="10px",r.style.height="10px",r.style.backgroundColor="#007bff",r.style.border="2px solid white",r.style.borderRadius="50%",r.style.boxShadow="0 0 3px rgba(0,0,0,0.3)",r.style.cursor=Bn(o),r.style.pointerEvents="all",$t(r,o,n.width,n.height),a.appendChild(r)}),a}function Bn(e){switch(e){case _.TOP_LEFT:case _.BOTTOM_RIGHT:return"nwse-resize";case _.TOP_RIGHT:case _.BOTTOM_LEFT:return"nesw-resize";case _.TOP:case _.BOTTOM:return"ns-resize";case _.LEFT:case _.RIGHT:return"ew-resize";default:return"default"}}function $t(e,t,a,n){switch(t){case _.TOP_LEFT:e.style.top="-5px",e.style.left="-5px";break;case _.TOP_RIGHT:e.style.top="-5px",e.style.right="-5px";break;case _.BOTTOM_LEFT:e.style.bottom="-5px",e.style.left="-5px";break;case _.BOTTOM_RIGHT:e.style.bottom="-5px",e.style.right="-5px";break;case _.TOP:e.style.top="-5px",e.style.left=`${a/2+-5}px`;break;case _.BOTTOM:e.style.bottom="-5px",e.style.left=`${a/2+-5}px`;break;case _.LEFT:e.style.top=`${n/2+-5}px`,e.style.left="-5px";break;case _.RIGHT:e.style.top=`${n/2+-5}px`,e.style.right="-5px";break}}function Me(e,t){if(!e||!t)return;const a=t.getBoundingClientRect();e.style.top=`${a.top}px`,e.style.left=`${a.left}px`,e.style.width=`${a.width}px`,e.style.height=`${a.height}px`,e.querySelectorAll(".resize-handler").forEach(i=>{const o=i.dataset.handler;$t(i,o,a.width,a.height)})}function ge(e){e&&e.parentNode&&e.parentNode.removeChild(e)}const Gn={"10px":"1","12px":"2","13px":"2","15px":"3","16px":"3","19px":"4","21px":"4","24px":"5","27px":"5","32px":"6","37px":"6","48px":"6","64px":"7","96px":"7"},zt={bold:!1,italic:!1,underline:!1,strikethrough:!1,alignLeft:!1,alignCenter:!1,alignRight:!1,alignJustify:!1,fontFamily:"Arial",fontSize:Ce,headingLevel:"p",imageSelected:!1,imageResizeOptions:de,preserveAspectRatio:!0},Ht=()=>{const[e,t]=m.useState(zt),a=me(),n=m.useCallback(d=>{t(E=>({...E,alignLeft:d==="left",alignCenter:d==="center",alignRight:d==="right",alignJustify:d==="justify"}))},[]),i=m.useCallback(d=>{try{const E=window.getSelection();if(!E||E.rangeCount===0)return!1;const M=E.getRangeAt(0);if(!M.toString())return t(k=>({...k,fontFamily:d})),!1;try{const k=document.createElement("span");k.style.fontFamily=d;const x=M.extractContents();return k.appendChild(x),M.insertNode(k),M.selectNodeContents(k),E.removeAllRanges(),E.addRange(M),t(u=>({...u,fontFamily:d})),!0}catch{return document.execCommand("fontName",!1,d),t(x=>({...x,fontFamily:d})),!0}}catch(E){return console.warn("[useFormatting] Font family change failed:",E),!1}},[]),o=m.useCallback(d=>{try{const E=window.getSelection();if(!E||E.rangeCount===0)return!1;const M=E.getRangeAt(0);if(!M.toString())return t(k=>({...k,fontSize:d})),!1;try{const k=document.createElement("span");k.style.fontSize=d;const x=M.extractContents();return k.appendChild(x),M.insertNode(k),M.selectNodeContents(k),E.removeAllRanges(),E.addRange(M),t(u=>({...u,fontSize:d})),!0}catch{const x=Gn[d]||"3";return document.execCommand("fontSize",!1,x),t(u=>({...u,fontSize:d})),!0}}catch(E){return console.warn("[useFormatting] Font size change failed:",E),!1}},[]),r=m.useCallback((d,E=null)=>{try{if(d==="undo"){a.undo();return}if(d==="redo"){a.redo();return}if(typeof document.execCommand!="function"){console.warn("[useFormatting] execCommand not supported");return}if(d==="fontSize"){o(E);return}if(d==="fontName"){i(E);return}switch(document.execCommand(d,!1,E)||console.warn(`[useFormatting] Command "${d}" failed`),d){case"bold":t(j=>({...j,bold:!j.bold}));break;case"italic":t(j=>({...j,italic:!j.italic}));break;case"underline":t(j=>({...j,underline:!j.underline}));break;case"strikethrough":t(j=>({...j,strikethrough:!j.strikethrough}));break;case"justifyLeft":n("left");break;case"justifyCenter":n("center");break;case"justifyRight":n("right");break;case"justifyFull":n("justify");break;case"fontName":t(j=>({...j,fontFamily:E}));break;case"formatBlock":t(j=>({...j,headingLevel:E}));break;default:break}}catch(M){console.warn(`[useFormatting] Error executing command "${d}":`,M)}},[o,i,n,a]),s=m.useRef(null),f=m.useRef(null),b=m.useRef(null),p=m.useRef(null),h=m.useRef(de);m.useCallback(d=>{if(!le(d))return;s.current&&(ge(s.current),s.current=null),d.classList.add("selected");const E=ct(d);E&&(s.current=E,f.current=d,document.body.appendChild(E),t(M=>({...M,imageSelected:!0,preserveAspectRatio:h.current.preserveAspectRatio})))},[]);const g=m.useCallback(()=>{f.current&&(f.current.classList.remove("selected"),f.current=null),s.current&&(ge(s.current),s.current=null),b.current=null,p.current=null,t(d=>({...d,imageSelected:!1}))},[]),O=m.useCallback(()=>{const d=!h.current.preserveAspectRatio;h.current={...h.current,preserveAspectRatio:d,aspectRatio:d},t(E=>({...E,preserveAspectRatio:d}))},[]);m.useCallback((d,E,M)=>{f.current&&(b.current={x:E,y:M,width:f.current.offsetWidth,height:f.current.offsetHeight},p.current=d,document.body.classList.add("resize-in-progress"),document.body.style.cursor=Un(d))},[]),m.useCallback((d,E)=>{if(!f.current||!b.current||!p.current)return;const{x:M,y:j,width:k,height:x}=b.current,u=p.current,C=Fn({handler:u,startX:M,startY:j,currentX:d,currentY:E,startWidth:k,startHeight:x,options:h.current});Wn(f.current,C),s.current&&Me(s.current,f.current)},[]),m.useCallback(()=>{if(b.current=null,p.current=null,document.body.classList.remove("resize-in-progress"),document.body.style.cursor="",f.current){const d=new Event("input",{bubbles:!0,cancelable:!0});f.current.dispatchEvent(d)}},[]);const S=m.useCallback(()=>{g(),t(zt)},[g]);return m.useEffect(()=>()=>{s.current&&ge(s.current)},[]),{currentFormat:e,formatText:r,resetFormat:S,toggleAspectRatio:O}};function Un(e){switch(e){case _.TOP_LEFT:case _.BOTTOM_RIGHT:return"nwse-resize";case _.TOP_RIGHT:case _.BOTTOM_LEFT:return"nesw-resize";case RESIZE_HANDLRES.TOP:case _.BOTTOM:return"ns-resize";case _.LEFT:case _.RIGHT:return"ew-resize";default:return"default"}}function Fn({handler:e,startX:t,startY:a,currentX:n,currentY:i,startWidth:o,startHeight:r,options:s=de}){const f=n-t,b=i-a;let p=o,h=r;switch(e){case _.TOP_LEFT:p=Math.max(s.minWidth,o-f),h=Math.max(s.minHeight,r-b);break;case _.TOP_RIGHT:p=Math.max(s.minWidth,o+f),h=Math.max(s.minHeight,r-b);break;case _.BOTTOM_LEFT:p=Math.max(s.minWidth,o-f),h=Math.max(s.minHeight,r+b);break;case _.BOTTOM_RIGHT:p=Math.max(s.minWidth,o+f),h=Math.max(s.minHeight,r+b);break;case _.TOP:h=Math.max(s.minHeight,r-b);break;case _.BOTTOM:h=Math.max(s.minHeight,r+b);break;case _.LEFT:p=Math.max(s.minWidth,o-f);break;case _.RIGHT:p=Math.max(s.minWidth,o+f);break;default:return{width:p,height:h}}if(s.preserveAspectRatio&&s.aspectRatio){const g=o/r;[_.TOP_LEFT,_.TOP_RIGHT,_.BOTTOM_LEFT,_.BOTTOM_RIGHT].includes(e)?p/g>h?h=Math.max(s.minHeight,p/g):p=Math.max(s.minWidth,h*g):[_.TOP,_.BOTTOM].includes(e)?p=h*g:[_.LEFT,_.RIGHT].includes(e)&&(h=p/g)}return s.maxWidth&&p>s.maxWidth&&(p=s.maxWidth,s.preserveAspectRatio&&s.aspectRatio&&(h=p/(o/r))),s.maxHeight&&h>s.maxHeight&&(h=s.maxHeight,s.preserveAspectRatio&&s.aspectRatio&&(p=h*(o/r))),p=Math.max(s.minWidth,p),h=Math.max(s.minHeight,h),{width:Math.round(p),height:Math.round(h)}}function Wn(e,{width:t,height:a}){le(e)&&(e.tagName==="IMG"?(e.style.width=`${t}px`,e.style.height=`${a}px`,e.width=t,e.height=a):e.tagName==="DIV"&&(e.style.width=`${t}px`,e.style.height=`${a}px`))}const ye='page-break, [data-page-break="true"]',Bt=e=>ie[e]||ie.A4,qn=(e,t={})=>{if(!e||typeof document>"u")return[];const a=t.pageSize||"A4",n=Bt(a),i=e.querySelectorAll(ye),o=[];o.push({id:"page-0",pageNumber:1,top:0,height:n.height});const r=e.getBoundingClientRect(),s=e.scrollTop;return i.forEach((f,b)=>{const h=f.getBoundingClientRect().top-r.top+s;o.push({id:`page-${b+1}`,pageNumber:b+2,top:h,height:n.height})}),o},Gt=(e,t=100,a=fe)=>{const n=Bt(e),i=En(a),o=n.height-i,r=t/100;return o/r},Zn=(e,t)=>{if(!e||!t)return 0;try{const a=t.querySelectorAll(ye);if(a.length===0)return 0;const n=e.getBoundingClientRect(),i=n.top+n.height/2;for(let o=a.length-1;o>=0;o--)if(a[o].getBoundingClientRect().top<i)return o+1;return 0}catch(a){return console.warn("[getCurrentPage] Failed to calculate page:",a),0}},Ut=e=>{if(!e)return[];const t=Array.from(e.children);if(t.length===0)return[];let a=[],n=[];for(const i of t)i.tagName==="PAGE-BREAK"||i.getAttribute("data-page-break")==="true"?n.length>0&&(a.push(n),n=[]):n.push(i);return n.length>0&&a.push(n),a.length===0&&t.length>0&&a.push(t.filter(i=>!(i.tagName==="PAGE-BREAK"||i.getAttribute("data-page-break")==="true"))),a},Vn=e=>{if(!e||!e.getBoundingClientRect)return 0;const t=e.getBoundingClientRect();return e.tagName==="P"?t.height+16:e.tagName==="H1"||e.tagName==="H2"||e.tagName==="H3"||e.tagName==="H4"||e.tagName==="H5"||e.tagName==="H6"?t.height+20:e.tagName==="UL"||e.tagName==="OL"?t.height+16:t.height},Yn=(e,t)=>{if(!e)return!1;try{const a=document.createElement("page-break");return a.setAttribute("data-page-break","true"),a.setAttribute("contenteditable","false"),a.setAttribute("data-page-number",t||"2"),e.parentNode.insertBefore(a,e),!0}catch(a){return console.warn("[insertPageBreakBefore] Failed to insert page break:",a),!1}},Kn=(e,t,a,n,i,o,r)=>{if(!e)return!1;try{const f=Gt(a,n,i)*(t-1),b=Array.from(e.children);let p=0,h=null;for(let g=0;g<b.length;g++){const O=b[g];if(O.tagName==="PAGE-BREAK"||O.getAttribute("data-page-break")==="true")continue;const S=Vn(O);if(p+S>f){h=O;break}p+=S}if(h){const g=document.createElement("page-break");if(g.setAttribute("data-page-break","true"),g.setAttribute("contenteditable","false"),g.setAttribute("data-page-number",String(t)),h.parentNode.insertBefore(g,h),o){const O=e.innerHTML;o(O)}return r&&setTimeout(()=>{r()},50),!0}else{const g=document.createElement("page-break");g.setAttribute("data-page-break","true"),g.setAttribute("contenteditable","false"),g.setAttribute("data-page-number",String(t)),e.appendChild(g);const O=document.createElement("p");if(O.innerHTML="<br>",e.appendChild(O),o){const S=e.innerHTML;o(S)}return r&&setTimeout(()=>{r()},50),!0}}catch(s){return console.error("[insertPageBreakAtBoundary] Failed to insert page break:",s),!1}},Xn=(e,t,a,n,i,o,r)=>{if(!e)return!1;if(a().length<=1)return console.warn("[removePageAndContent] Cannot delete the only page"),!1;try{const f=Array.from(e.querySelectorAll(ye));if(t>f.length)return console.warn("[removePageAndContent] Invalid page index"),!1;const b=window.getSelection();let p=!1,h=[],g=null;if(t===0){const S=f[0];if(!S)return console.warn("[removePageAndContent] No page break found for first page"),!1;let d=e.firstChild;for(;d&&d!==S;)h.push(d),d=d.nextSibling;g=S}else{const S=f[t-1];if(!S)return console.warn("[removePageAndContent] Page break not found"),!1;const d=f[t];let E=S.nextSibling;for(;E&&E!==d;)h.push(E),E=E.nextSibling;g=S}if(b&&b.rangeCount>0){const d=b.getRangeAt(0).startContainer;for(const E of h)if(E.contains(d)||E===d){p=!0;break}}if(g&&g.parentNode&&g.remove(),h.forEach(S=>{S.parentNode&&S.remove()}),e.querySelectorAll(ye).forEach((S,d)=>{S.setAttribute("data-page-number",String(d+2))}),p&&o&&setTimeout(()=>{o(0)},50),n){const S=e.innerHTML;n(S)}return i&&setTimeout(()=>{i(),r&&setTimeout(()=>{r()},150)},100),!0}catch(f){return console.error("[removePageAndContent] Failed to remove page:",f),!1}},Jn=200,Qn=50,Ft=3,er=20,Wt=e=>{if(!e||!e.getBoundingClientRect)return 0;const t=e.getBoundingClientRect();return e.tagName==="P"?t.height+16:e.tagName==="H1"||e.tagName==="H2"||e.tagName==="H3"||e.tagName==="H4"||e.tagName==="H5"||e.tagName==="H6"?t.height+20:e.tagName==="UL"||e.tagName==="OL"?t.height+16:t.height},tr=(e,t)=>{if(!e||e.length===0)return null;let a=0,n=null;for(let i=0;i<e.length;i++){const o=e[i];if(!o||!o.getBoundingClientRect)continue;const r=Wt(o);if(r<1)continue;if(a+r>t)return n===null?i>0?{overflowIndex:i,overflowElement:o,accumulatedHeight:a}:null:{overflowIndex:i,overflowElement:o,accumulatedHeight:a};a+=r,n=o}return null},nr=(e,t,a,n,i,o,r,s)=>{if(!e||r.current)return!1;try{r.current=!0;const f=Gt(t,a,n);let b=Ut(e),p=!1,h=0;for(let g=0;g<b.length&&h<Ft;g++){const O=b[g],S=tr(O,f);if(S&&S.overflowIndex>0){let d=0;for(let k=0;k<O.length;k++){const x=O[k];x&&x.getBoundingClientRect&&(d+=Wt(x))}if(d-f<er)continue;const M=g+2;Yn(S.overflowElement,M)&&(p=!0,h++,b=Ut(e))}}if(p){if(i){const g=e.innerHTML;i(g)}setTimeout(()=>{o&&o(),h>=Ft&&s&&setTimeout(()=>{r.current||s()},100)},Qn)}return p}catch(f){return console.warn("[checkAndReflow] Reflow failed:",f),!1}finally{r.current=!1}},rr=(e,t,a=Jn)=>{t.current&&clearTimeout(t.current),t.current=setTimeout(()=>{t.current=null,e()},a)},or=400,qt=(e,t)=>{if(e){e.focus();try{let a=null,n=0;if(t===0)a=e.firstChild,n=0;else{const o=e.querySelectorAll(ye)[t-1];o&&o.nextSibling&&(a=o.nextSibling,n=0)}if(a){const i=document.createRange(),o=window.getSelection();a.nodeType===Node.TEXT_NODE?i.setStart(a,n):i.setStart(a,0),i.collapse(!0),o.removeAllRanges(),o.addRange(i)}}catch(a){console.warn("[positionCursorAtPage] Failed to position cursor:",a)}}},ar=(e,t,a,n)=>{if(!e||!t){console.warn("[scrollToPage] Missing refs");return}try{let i=null;if(a===0)i=t;else{const r=t.querySelectorAll(ye)[a-1];if(r)i=r;else{console.warn("[scrollToPage] Page break not found for page",a);return}}if(i){const o=i.getBoundingClientRect(),r=e.getBoundingClientRect(),s=e.scrollTop+(o.top-r.top);console.log("[scrollToPage] Scrolling to page",a,"scrollTop:",s),e.scrollTo({top:s,behavior:"smooth"}),setTimeout(()=>{n?n(a):qt(t,a)},or)}}catch(i){console.error("[scrollToPage] Error:",i)}},ir=(e,t,a={},n=300)=>{t.current&&clearTimeout(t.current),t.current=setTimeout(()=>{t.current=null,e(a)},Math.max(0,n))},sr=300,Zt=(e,t,a=100,n="NARROW")=>{const i=me(),o=m.useRef(null),r=m.useRef(null),s=m.useRef(e),f=m.useRef(a),b=m.useRef(n),p=m.useRef(!1);m.useEffect(()=>{s.current=e},[e]),m.useEffect(()=>{f.current=a},[a]),m.useEffect(()=>{b.current=n},[n]),m.useEffect(()=>()=>{o.current&&clearTimeout(o.current),r.current&&clearTimeout(r.current)},[]);const h=m.useCallback((u={})=>t?.current?qn(t.current,u):[],[t]),g=m.useCallback((u={})=>{const C=h(u);return i.updatePageBoundaries(C),C},[h,i]),O=m.useCallback(async u=>{if(!t?.current)return!1;const C=s.current||"A4",y=f.current||100,P=b.current||"NARROW";return Kn(t.current,u,C,y,P,i.updateContinuousContent,g)},[t,i,g]),S=m.useCallback(()=>{if(!t?.current)return;const u=s.current||"A4",C=f.current||100,y=b.current||"NARROW";nr(t.current,u,C,y,i.updateContinuousContent,g,p,S)},[t,i,g]),d=m.useCallback(u=>{rr(S,r,u)},[S]),E=m.useCallback((u={})=>{const C=typeof u.delay=="number"?u.delay:sr;ir(g,o,u,C)},[g]),M=m.useCallback(u=>!u?.current||!t?.current?0:Zn(u.current,t.current),[t]),j=m.useCallback(u=>{t?.current&&qt(t.current,u)},[t]),k=m.useCallback((u,C)=>{if(!C?.current||!t?.current){console.warn("[scrollToPage] Missing refs");return}ar(C.current,t.current,u,j)},[t,j]),x=m.useCallback(u=>t?.current?Xn(t.current,u,h,i.updateContinuousContent,g,j,S):!1,[t,h,i,g,j,S]);return{calculatePageBoundaries:h,checkAndUpdateBoundaries:E,updateBoundaries:g,getCurrentPage:M,scrollToPage:k,positionCursorAtPage:j,checkAndReflow:S,triggerAutoReflow:d,removePageAndContent:x,insertPageBreakAtBoundary:O,boundaryTimeoutRef:o,reflowTimeoutRef:r}},cr="html-editor-storage",lr=1,ce="images";function ur(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function xe(){return new Promise((e,t)=>{const a=indexedDB.open(cr,lr);a.onerror=()=>{t(new Error("Failed to open IndexedDB database"))},a.onsuccess=()=>{e(a.result)},a.onupgradeneeded=n=>{const i=n.target.result;i.objectStoreNames.contains(ce)||i.createObjectStore(ce,{keyPath:"key"}).createIndex("timestamp","timestamp",{unique:!1})}})}function Vt(e){return new Promise((t,a)=>{if(!["image/png","image/jpeg","image/gif","image/webp"].includes(e.type)){a(new Error("Invalid image format. Supported formats: png, jpeg, gif, webp"));return}if(e.size>5*1024*1024){a(new Error("Image exceeds maximum size of 5MB"));return}const i=new FileReader;i.onload=async o=>{const r=o.target.result,f=r.split(",")[1].length*3/4;if(f>5*1024*1024){a(new Error("Image exceeds maximum size of 5MB"));return}try{const b=await xe(),p=`editor-image-${ur()}`,g=b.transaction([ce],"readwrite").objectStore(ce),O={key:p,dataUrl:r,size:f,type:e.type,timestamp:Date.now()},S=g.add(O);S.onsuccess=()=>{b.close(),t(p)},S.onerror=()=>{b.close(),a(new Error("Failed to save image to IndexedDB"))}}catch(b){a(b)}},i.onerror=()=>{a(new Error("Error reading image file"))},i.readAsDataURL(e)})}async function Yt(e){try{const t=await xe();return new Promise((a,n)=>{const r=t.transaction([ce],"readonly").objectStore(ce).get(e);r.onsuccess=()=>{t.close();const s=r.result;a(s?s.dataUrl:null)},r.onerror=()=>{t.close(),n(new Error("Failed to retrieve image from IndexedDB"))}})}catch(t){return console.error("Error getting image:",t),null}}async function Kt(e){try{const t=await xe();return new Promise((a,n)=>{const r=t.transaction([ce],"readwrite").objectStore(ce).delete(e);r.onsuccess=()=>{t.close(),a()},r.onerror=()=>{t.close(),n(new Error("Failed to delete image from IndexedDB"))}})}catch(t){console.error("Error deleting image:",t)}}async function dr(){try{const e=await xe();return new Promise((t,a)=>{const o=e.transaction([ce],"readwrite").objectStore(ce).clear();o.onsuccess=()=>{e.close(),t()},o.onerror=()=>{e.close(),a(new Error("Failed to clear images from IndexedDB"))}})}catch(e){console.error("Error clearing images:",e)}}async function fr(){try{const e=await xe();return new Promise((t,a)=>{const o=e.transaction([ce],"readonly").objectStore(ce).getAllKeys();o.onsuccess=()=>{e.close(),t(o.result||[])},o.onerror=()=>{e.close(),a(new Error("Failed to get image keys from IndexedDB"))}})}catch(e){return console.error("Error getting image keys:",e),[]}}function pr(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}function Xt(e){const t=[];for(let a=0;a<e.attributes.length;a++){const n=e.attributes[a];t.push(` ${n.name}="${n.value}"`)}return t.join("")}function gr(e){if(!e||typeof e!="string")return"<p><br></p>";const t=e.trim();if(!t)return"<p><br></p>";const a=document.createElement("div");return a.innerHTML=t,Re(a)}function Re(e){const t=[],a=Array.from(e.childNodes);for(let n=0;n<a.length;n++){const i=a[n];if(i.nodeType===Node.TEXT_NODE){const o=i.textContent.trim();o&&t.push(`<p>${pr(o)}</p>`)}else if(i.nodeType===Node.ELEMENT_NODE){const o=i;if(o.tagName==="DIV"){const r=Re(o);r.trim()?t.push(r):t.push("<p><br></p>")}else if(o.tagName==="P")t.push(o.outerHTML);else if(o.tagName==="BR")t.push("<p><br></p>");else if(["SPAN","STRONG","EM","B","I","U","A"].includes(o.tagName)){const r=Re(o),s=o.tagName.toLowerCase(),f=Xt(o);t.push(`<${s}${f}>${r}</${s}>`)}else if(o.tagName==="PAGE-BREAK"||o.getAttribute("data-page-break")==="true")t.push(o.outerHTML);else{const r=Re(o),s=o.tagName.toLowerCase(),f=Xt(o);t.push(`<${s}${f}>${r}</${s}>`)}}}return t.length===0?"<p><br></p>":t.join("")}/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hr=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),mr=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,a,n)=>n?n.toUpperCase():a.toLowerCase()),Jt=e=>{const t=mr(e);return t.charAt(0).toUpperCase()+t.slice(1)},Qt=(...e)=>e.filter((t,a,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===a).join(" ").trim(),yr=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var br={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Er=m.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:n,className:i="",children:o,iconNode:r,...s},f)=>m.createElement("svg",{ref:f,...br,width:t,height:t,stroke:e,strokeWidth:n?Number(a)*24/Number(t):a,className:Qt("lucide",i),...!o&&!yr(s)&&{"aria-hidden":"true"},...s},[...r.map(([b,p])=>m.createElement(b,p)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=(e,t)=>{const a=m.forwardRef(({className:n,...i},o)=>m.createElement(Er,{ref:o,iconNode:t,className:Qt(`lucide-${hr(Jt(e))}`,`lucide-${e}`,n),...i}));return a.displayName=Jt(e),a};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tr=X("bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vr=X("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xr=X("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _r=X("file-check",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=X("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ar=X("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kr=X("heading-1",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pr=X("heading-2",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=X("heading-3",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17.5 10.5c1.7-1 3.5 0 3.5 1.5a2 2 0 0 1-2 2",key:"68ncm8"}],["path",{d:"M17 17.5c2 1.5 4 .3 4-1.5a2 2 0 0 0-2-2",key:"1ejuhz"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Or=X("image-upscale",[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M17 21h2a2 2 0 0 0 2-2",key:"130fy9"}],["path",{d:"M21 12v3",key:"1wzk3p"}],["path",{d:"m21 3-5 5",key:"1g5oa7"}],["path",{d:"M3 7V5a2 2 0 0 1 2-2",key:"kk3yz1"}],["path",{d:"m5 21 4.144-4.144a1.21 1.21 0 0 1 1.712 0L13 19",key:"fyekpt"}],["path",{d:"M9 3h3",key:"d52fa"}],["rect",{x:"3",y:"11",width:"10",height:"10",rx:"1",key:"1wpmix"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=X("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nr=X("italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cr=X("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=X("list-indent-decrease",[["path",{d:"M21 5H11",key:"us1j55"}],["path",{d:"M21 12H11",key:"wd7e0v"}],["path",{d:"M21 19H11",key:"saa85w"}],["path",{d:"m7 8-4 4 4 4",key:"o5hrat"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rr=X("list-indent-increase",[["path",{d:"M21 5H11",key:"us1j55"}],["path",{d:"M21 12H11",key:"wd7e0v"}],["path",{d:"M21 19H11",key:"saa85w"}],["path",{d:"m3 8 4 4-4 4",key:"1a3j6y"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ir=X("list-ordered",[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const en=X("list",[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jr=X("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lr=X("redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dr=X("scaling",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M14 15H9v-5",key:"pi4jk9"}],["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M21 3 9 15",key:"15kdhq"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $r=X("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=X("strikethrough",[["path",{d:"M16 4H9a3 3 0 0 0-2.83 4",key:"43sutm"}],["path",{d:"M14 12a4 4 0 0 1 0 8H6",key:"nlfj13"}],["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hr=X("table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tn=X("text-align-center",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 19H5",key:"vjpgq2"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nn=X("text-align-end",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 19H7",key:"4cu937"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Br=X("text-align-justify",[["path",{d:"M3 5h18",key:"1u36vt"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 19h18",key:"awlh7x"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=X("text-align-start",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=X("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ur=X("underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fr=X("undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wr=X("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qr=X("zoom-in",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zr=X("zoom-out",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),on=({editorView:e,isCollapsed:t,onToggle:a,wordCount:n,pageCount:i})=>{const o=Qe(),{pages:r,activePage:s,continuousContent:f,editorMode:b}=o,[p,h]=m.useState(0),[g,O]=m.useState([]);m.useEffect(()=>{if(n!==void 0&&i!==void 0){if(h(n),f){const M=document.createElement("div");M.innerHTML=f;const j=M.querySelectorAll("h1, h2, h3, h4, h5, h6"),k=Array.from(j).map((x,u)=>{const C=parseInt(x.tagName.charAt(1)),y=x.textContent.trim();return y?{id:`heading-${u}`,level:C,text:y,page:1}:null}).filter(Boolean);O(k)}return}let d=0;const E=[];r.forEach((M,j)=>{if(M.content){const k=document.createElement("div");k.innerHTML=M.content;const u=(k.textContent||k.innerText||"").trim().split(/\s+/).filter(y=>y.length>0);d+=u.length,k.querySelectorAll("h1, h2, h3, h4, h5, h6").forEach((y,P)=>{const D=parseInt(y.tagName.charAt(1)),w=y.textContent.trim();w&&E.push({id:`heading-${j}-${P}`,level:D,text:w,page:j+1})})}}),h(d),O(E)},[r,n,i,f]);const S=i!==void 0?i:r.length;return l.jsxs("aside",{className:`sidebar ${t?"collapsed":""}`,role:"complementary","aria-label":"Document information","data-testid":"sidebar",children:[l.jsxs("div",{className:"sidebar-header",children:[l.jsxs("div",{className:"sidebar-title",children:[l.jsx(Ie,{size:18}),l.jsx("h2",{children:"Document Info"})]}),l.jsx("button",{className:"sidebar-toggle",onClick:a,"aria-label":t?"Expand sidebar":"Collapse sidebar",title:t?"Expand sidebar":"Collapse sidebar",children:t?l.jsx(xr,{size:16}):l.jsx(vr,{size:16})})]}),!t&&l.jsxs("div",{className:"sidebar-content",children:[l.jsxs("div",{className:"sidebar-section",children:[l.jsx("h3",{children:"Statistics"}),l.jsxs("div",{className:"stat-item",children:[l.jsxs("div",{className:"stat-label",children:[l.jsx(_r,{size:14}),l.jsx("span",{children:"Pages:"})]}),l.jsx("span",{className:"stat-value",children:S})]}),l.jsxs("div",{className:"stat-item","data-testid":"word-count",children:[l.jsxs("div",{className:"stat-label",children:[l.jsx(Ar,{size:14}),l.jsx("span",{children:"Words:"})]}),l.jsx("span",{className:"stat-value",children:p.toLocaleString()})]}),l.jsxs("div",{className:"stat-item",children:[l.jsxs("div",{className:"stat-label",children:[l.jsx(Ie,{size:14}),l.jsx("span",{children:"Active Page:"})]}),l.jsx("span",{className:"stat-value",children:s+1})]})]}),g.length>0&&l.jsxs("div",{className:"sidebar-section",children:[l.jsxs("h3",{children:[l.jsx(en,{size:14,style:{display:"inline-block",marginRight:"6px",verticalAlign:"middle"}}),"Document Outline"]}),l.jsx("div",{className:"document-outline","data-testid":"outline",children:g.map(d=>{const E=d.level===1?kr:d.level===2?Pr:wr;return l.jsxs("div",{className:`outline-item outline-level-${d.level}`,style:{marginLeft:`${(d.level-1)*12}px`},children:[l.jsx(E,{size:12,className:"outline-icon"}),l.jsx("span",{className:"outline-text",children:d.text}),l.jsxs("span",{className:"outline-page",children:["p.",d.page]})]},d.id)})})]}),l.jsxs("div",{className:"sidebar-section",children:[l.jsx("h3",{children:"Document"}),l.jsx("p",{children:"HTML Editor"}),l.jsx("p",{children:"Multi-page support"})]})]})]})};class an{constructor(t="Editor"){this.namespace=t}_format(t,a,n){return`[${new Date().toISOString()}] [${this.namespace}] [${t}] ${a}`}info(t,a){}warn(t,a){}error(t,a){}debug(t,a){}}const sn=new an("Editor");function Vr(){const e=window.getSelection();if(!e||e.rangeCount===0)return[];const t=e.getRangeAt(0),a=new Set;let n=t.commonAncestorContainer;for(n.nodeType===Node.TEXT_NODE&&(n=n.parentElement);n&&n.contentEditable!=="true";)n=n.parentElement;return n?(n.querySelectorAll("p, div, h1, h2, h3, h4, h5, h6, li, blockquote, pre, table").forEach(o=>{document.createRange().selectNodeContents(o),t.intersectsNode(o)&&a.add(o)}),a.size===0&&n.querySelectorAll("img").forEach(r=>{if(document.createRange().selectNode(r),t.intersectsNode(r)){let f=r.parentElement;for(;f&&f!==f;){if(["P","DIV","H1","H2","H3","H4","H5","H6","LI","BLOCKQUOTE","PRE"].includes(f.tagName)){a.add(f);break}f=f.parentElement}}}),Array.from(a)):[]}function Yr(e){if(e.innerHTML.startsWith("&nbsp;&nbsp;&nbsp;&nbsp;")){e.innerHTML=e.innerHTML.replace(/^(&nbsp;){4}/,"");return}try{const t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null);let a=t.nextNode();for(;a;){const n=a.textContent;if(n.startsWith("")){a.textContent=n.substring(4);break}a=t.nextNode()}}catch{e.innerHTML=e.innerHTML.replace(/^(&nbsp;){4}/,"")}}function lt(e=!1){const t=Vr();if(t.length===0)return!1;const a=window.getSelection();if(!a||a.rangeCount===0)return!1;a.getRangeAt(0);const n=t[0],i=t[t.length-1];t.map(o=>{let r=0,s=o.previousSibling;for(;s;)r++,s=s.previousSibling;return{block:o,index:r,parent:o.parentElement}}),t.forEach(o=>{e?Yr(o):o.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;"+o.innerHTML});try{const o=document.createRange(),r=p=>p.nodeType===Node.TEXT_NODE?p:document.createTreeWalker(p,NodeFilter.SHOW_TEXT,null).nextNode(),s=p=>{if(p.nodeType===Node.TEXT_NODE)return p;const h=document.createTreeWalker(p,NodeFilter.SHOW_TEXT,null);let g=null,O=h.nextNode();for(;O;)g=O,O=h.nextNode();return g},f=r(n);f?o.setStart(f,0):o.setStart(n,0);const b=s(i);b?o.setEnd(b,b.length):o.setEnd(i,i.childNodes.length),a.removeAllRanges(),a.addRange(o)}catch{try{const r=document.createRange();r.setStartBefore(n),r.setEndAfter(i),a.removeAllRanges(),a.addRange(r)}catch(r){console.warn("Could not restore selection after indentation:",r)}}return!0}function Kr(e){if(e.key!=="Tab")return!1;e.preventDefault();const t=e.shiftKey,a=window.getSelection();return a&&a.rangeCount>0&&!a.getRangeAt(0).collapsed&&lt(t)||t||document.execCommand("insertHTML",!1,"&nbsp;&nbsp;&nbsp;&nbsp;"),!0}const je=({currentFormat:e,onFormatText:t,onAddPageBreak:a,canUndo:n=!1,canRedo:i=!1})=>{const o=async r=>{try{if(!["image/png","image/jpeg","image/gif","image/webp"].includes(r.type)){alert("Invalid image format. Supported: PNG, JPEG, GIF, WEBP");return}if(r.size>5242880){alert("Image exceeds maximum size of 5MB");return}const f=await Vt(r),b=await Yt(f);if(b){const h=`<img src="${b}" data-key="${f}" alt="Inserted image" />`;document.execCommand("insertHTML",!1,h),sn.info("Image inserted",{key:f})}const p=document.getElementById("image-upload");p&&(p.value="")}catch(s){sn.error("Error uploading image",s)}};return l.jsxs("div",{className:"editor-toolbar",children:[l.jsx("button",{onClick:()=>t("undo"),disabled:!n,title:"Undo",style:{opacity:n?1:.5},children:l.jsx(Fr,{size:16})}),l.jsx("button",{onClick:()=>t("redo"),disabled:!i,title:"Redo",style:{opacity:i?1:.5},children:l.jsx(Lr,{size:16})}),l.jsx("div",{className:"toolbar-separator"}),l.jsx("button",{onClick:()=>t("bold"),className:e.bold?"active":"",title:"Bold",children:l.jsx(Tr,{size:16})}),l.jsx("button",{onClick:()=>t("italic"),className:e.italic?"active":"",title:"Italic",children:l.jsx(Nr,{size:16})}),l.jsx("button",{onClick:()=>t("underline"),className:e.underline?"active":"",title:"Underline",children:l.jsx(Ur,{size:16})}),l.jsx("button",{onClick:()=>t("strikethrough"),className:e.strikethrough?"active":"",title:"Strikethrough",children:l.jsx(zr,{size:16})}),l.jsx("div",{className:"toolbar-separator"}),l.jsx("button",{onClick:()=>t("justifyLeft"),className:e.alignLeft?"active":"",title:"Align Left",children:l.jsx(rn,{size:16})}),l.jsx("button",{onClick:()=>t("justifyCenter"),className:e.alignCenter?"active":"",title:"Align Center",children:l.jsx(tn,{size:16})}),l.jsx("button",{onClick:()=>t("justifyRight"),className:e.alignRight?"active":"",title:"Align Right",children:l.jsx(nn,{size:16})}),l.jsx("button",{onClick:()=>t("justifyFull"),className:e.alignJustify?"active":"",title:"Justify",children:l.jsx(Br,{size:16})}),l.jsx("div",{className:"toolbar-separator"}),l.jsxs("select",{onChange:r=>t("fontName",r.target.value),defaultValue:"Segoe UI",title:"Font Family",children:[l.jsx("option",{value:"Segoe UI",children:"Segoe UI "}),l.jsx("option",{value:"Arial",children:"Arial "}),l.jsx("option",{value:"Times New Roman",children:"Times New Roman "}),l.jsx("option",{value:"Courier New",children:"Courier New "}),l.jsx("option",{value:"Georgia",children:"Georgia "}),l.jsx("option",{value:"Verdana",children:"Verdana "}),l.jsx("option",{value:"Noto Sans Sinhala",children:"Noto Sans Sinhala ()"}),l.jsx("option",{value:"Iskoola Pota",children:"Iskoola Pota ()"}),l.jsx("option",{value:"Noto Sans Tamil",children:"Noto Sans Tamil ()"}),l.jsx("option",{value:"Noto Sans",children:"Noto Sans (Unicode)"})]}),l.jsx("select",{onChange:r=>t("fontSize",r.target.value),defaultValue:Ce,title:"Font Size",children:jt.map(({value:r,label:s})=>l.jsx("option",{value:r,children:s},r))}),l.jsxs("select",{onChange:r=>t("formatBlock",r.target.value),value:e.headingLevel||"p",title:"Heading Level",children:[l.jsx("option",{value:"p",children:"Normal"}),l.jsx("option",{value:"h1",children:"Heading 1"}),l.jsx("option",{value:"h2",children:"Heading 2"}),l.jsx("option",{value:"h3",children:"Heading 3"}),l.jsx("option",{value:"h4",children:"Heading 4"}),l.jsx("option",{value:"h5",children:"Heading 5"}),l.jsx("option",{value:"h6",children:"Heading 6"})]}),l.jsx("div",{className:"toolbar-separator"}),l.jsx("button",{onClick:()=>t("insertUnorderedList"),title:"Bullet List",children:l.jsx(en,{size:16})}),l.jsx("button",{onClick:()=>t("insertOrderedList"),title:"Numbered List",children:l.jsx(Ir,{size:16})}),l.jsx("div",{className:"toolbar-separator"}),l.jsx("button",{onClick:()=>{lt(!1)||document.execCommand("insertHTML",!1,"&nbsp;&nbsp;&nbsp;&nbsp;")},title:"Increase Indent (Tab)",children:l.jsx(Rr,{size:16})}),l.jsx("button",{onClick:()=>{lt(!0)},title:"Decrease Indent (Shift+Tab)",children:l.jsx(Mr,{size:16})}),l.jsx("div",{className:"toolbar-separator"}),l.jsx("button",{onClick:()=>{const r=prompt("Enter URL:");r&&t("createLink",r)},title:"Insert Link",children:l.jsx(Cr,{size:16})}),l.jsx("button",{onClick:()=>t("insertHTML",'<table border="1"><tr><td>Cell 1</td><td>Cell 2</td></tr><tr><td>Cell 3</td><td>Cell 4</td></tr></table>'),title:"Insert Table",children:l.jsx(Hr,{size:16})}),a&&l.jsx("button",{onClick:a,title:"Insert Page Break",children:l.jsx(Ie,{size:16})}),l.jsx("div",{className:"toolbar-separator"}),l.jsx("input",{type:"file",accept:"image/*",onChange:r=>r.target.files[0]&&o(r.target.files[0]),style:{display:"none"},id:"image-upload"}),l.jsx("button",{onClick:()=>document.getElementById("image-upload").click(),title:"Insert Image",children:l.jsx(Sr,{size:16})})]})};je.propTypes={currentFormat:v.shape({bold:v.bool,italic:v.bool,underline:v.bool,strikethrough:v.bool,alignLeft:v.bool,alignCenter:v.bool,alignRight:v.bool,alignJustify:v.bool,fontFamily:v.string,fontSize:v.string,headingLevel:v.string}).isRequired,onFormatText:v.func.isRequired,onAddPageBreak:v.func,canUndo:v.bool,canRedo:v.bool},je.defaultProps={onAddPageBreak:void 0,canUndo:!1,canRedo:!1};function Xr(e){if(!e||typeof e!="string")return e;const t=document.createElement("div");return t.innerHTML=e,_e(t)}function _e(e){const t=[],a=Array.from(e.childNodes);for(let n=0;n<a.length;n++){const i=a[n];if(i.nodeType===Node.TEXT_NODE){const o=i.textContent.trim();if(o)if(o.match(/^\s*$/)&&o.includes(`
`)){const r=o.split(`
`).filter(s=>s.trim());r.length>0?r.forEach(s=>{s.trim()&&t.push(`<p>${ut(s.trim())}</p>`)}):t.push("<p><br></p>")}else t.push(`<p>${ut(o)}</p>`)}else if(i.nodeType===Node.ELEMENT_NODE){const o=i;if(o.tagName==="DIV"){const r=_e(o);r.trim()?t.push(`<p>${r}</p>`):t.push("<p><br></p>")}else if(o.tagName==="P"){const r=_e(o);t.push(`<p>${r}</p>`)}else if(o.tagName==="BR")t.push("<p><br></p>");else if(["SPAN","STRONG","EM","B","I","U","A"].includes(o.tagName)){const r=_e(o),s=o.tagName.toLowerCase(),f=cn(o);t.push(`<${s}${f}>${r}</${s}>`)}else{const r=_e(o),s=o.tagName.toLowerCase(),f=cn(o);t.push(`<${s}${f}>${r}</${s}>`)}}}return t.join("")}function cn(e){const t=[];for(let a=0;a<e.attributes.length;a++){const n=e.attributes[a];t.push(` ${n.name}="${n.value}"`)}return t.join("")}function ut(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}function Jr(e){e.preventDefault();const t=e.clipboardData||window.clipboardData;if(!t)return null;let a=t.getData("text/html")||t.getData("text/plain");return a?(t.getData("text/html")?a=Xr(a):a=Qr(a),document.execCommand("insertHTML",!1,a),a):null}function Qr(e){if(!e)return"";const t=e.split(/\n\s*\n/).filter(a=>a.trim());return t.length===0?"<p><br></p>":t.map(a=>{const n=a.split(`
`).filter(o=>o.trim());return n.length===0?"<p><br></p>":`<p>${n.map(o=>ut(o.trim())).join("<br>")}</p>`}).join("")}const Le=({content:e,dimensions:t,pageSize:a,pageBoundaries:n=[],editorRef:i,onInput:o,onKeyDown:r,onClick:s,onScroll:f,onPaste:b,zoomLevel:p=100,pageMargins:h=fe})=>{const g=Tt(h),O=p/100,S=(x,u)=>{if(!x)return!1;const C=x.getBoundingClientRect(),y=u-C.top;return y<g.top||y>C.height-g.bottom},d=x=>x?x.nodeType===Node.ELEMENT_NODE?x.tagName==="PAGE-BREAK"||x.getAttribute("data-page-break")==="true":x.parentElement&&d(x.parentElement):!1,E=x=>{const u=window.getSelection();if(!u||u.rangeCount===0)return;const C=u.getRangeAt(0),{startContainer:y,endContainer:P}=C;if((d(y)||d(P))&&(x.key.length===1||x.key==="Enter"||x.key===" "))return x.preventDefault(),!1;if(Kr(x))return!1;if((x.key==="Backspace"||x.key==="Delete")&&(d(y)||d(P)))return x.preventDefault(),!1;r&&r(x)},M=x=>{if(!i.current)return;const u=x.target;if(d(u)){x.preventDefault();return}if(S(i.current,x.clientY)){x.preventDefault();const C=i.current.getBoundingClientRect();if(x.clientY-C.top<g.top){const P=i.current.firstElementChild;if(P&&P.tagName!=="PAGE-BREAK"){const D=document.createRange(),w=window.getSelection();D.setStart(P,0),D.collapse(!0),w.removeAllRanges(),w.addRange(D)}}else{const P=i.current.lastElementChild;if(P&&P.tagName!=="PAGE-BREAK"){const D=document.createRange(),w=window.getSelection();D.selectNodeContents(P),D.collapse(!1),w.removeAllRanges(),w.addRange(D)}}return}s&&s(x)},j=x=>{const u=window.getSelection();if(!u||u.rangeCount===0)return;const C=u.getRangeAt(0),{startContainer:y}=C;if(d(y))return x.preventDefault(),!1},k=x=>{const u=Jr(x);b&&b(x,u)};return l.jsx("div",{className:"continuous-page-container",style:{position:"relative",width:"100%",maxWidth:`${t.width}px`,margin:"40px auto",backgroundColor:"transparent",minHeight:"100vh",transform:`scale(${O})`,transformOrigin:"top center",transition:"transform 0.2s ease-out"},children:l.jsx("div",{ref:i,contentEditable:!0,suppressContentEditableWarning:!0,className:"continuous-content",style:{position:"relative",zIndex:1,minHeight:`${t.height}px`,width:`${t.width}px`,backgroundColor:"white",padding:`${g.top}px ${g.right}px ${g.bottom}px ${g.left}px`,boxSizing:"border-box",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",outline:"none",cursor:"text",fontFamily:'"Segoe UI", "Noto Sans Sinhala", "Noto Sans", "Malithi Web", "Iskoola Pota", "Kaputa Unicode", "Helvetica Neue", Arial, "Hiragino Sans GB", "WenQuanYi Micro Hei", "Microsoft YaHei", sans-serif',fontSize:Ce,lineHeight:"1.3",color:"#333",wordWrap:"break-word",whiteSpace:"pre-wrap",overflowWrap:"break-word",border:"1px solid #e0e0e0"},onInput:o,onKeyDown:E,onBeforeInput:j,onClick:M,onScroll:f,onPaste:k,"data-testid":"continuous-editor"})})};Le.propTypes={content:v.string.isRequired,dimensions:v.shape({width:v.number.isRequired,height:v.number.isRequired}).isRequired,pageSize:v.oneOf(["A4","Letter","Legal"]).isRequired,pageBoundaries:v.arrayOf(v.shape({id:v.string.isRequired,pageNumber:v.number.isRequired,top:v.number,height:v.number})),editorRef:v.shape({current:v.instanceOf(typeof Element<"u"?Element:Object)}).isRequired,onInput:v.func.isRequired,onKeyDown:v.func,onClick:v.func,onScroll:v.func,onPaste:v.func,zoomLevel:v.number,pageMargins:v.string},Le.defaultProps={pageBoundaries:[],onKeyDown:void 0,onClick:void 0,onScroll:void 0,onPaste:void 0,zoomLevel:100,pageMargins:fe};const dt=({pageBoundaries:e=[{id:"page-0",pageNumber:1}],activePage:t=0,pageSize:a="A4",pageMargins:n=fe,zoomLevel:i=100,canZoomIn:o=!0,canZoomOut:r=!0,onNavigate:s,onAddPage:f,onDeletePage:b,onPageSizeChange:p,onPageMarginsChange:h,onZoomIn:g,onZoomOut:O,onZoomReset:S}={})=>{const d=Math.max(e?.length||0,1),E=u=>{s&&s(u)},M=()=>{f&&f()},j=u=>{if(d<=1){console.warn("[PageManager] Cannot delete the only page");return}b&&b(u)},k=u=>{p&&p(u)},x=u=>{h&&h(u)};return l.jsxs("div",{className:"page-manager",children:[l.jsxs("div",{className:"page-settings-group",children:[l.jsxs("div",{className:"page-settings-header",children:[l.jsx($r,{size:14,style:{marginRight:"4px",verticalAlign:"middle"}}),"Page Settings"]}),l.jsxs("div",{className:"page-settings-controls",children:[l.jsxs("div",{className:"page-setting-item",children:[l.jsx("label",{htmlFor:"page-size-selector",children:"Size:"}),l.jsxs("select",{id:"page-size-selector",role:"combobox","aria-label":"Page size selector",value:a,onChange:u=>k(u.target.value),children:[l.jsx("option",{value:"A4",children:"A4"}),l.jsx("option",{value:"Letter",children:"Letter"}),l.jsx("option",{value:"Legal",children:"Legal"})]})]}),l.jsxs("div",{className:"page-setting-item",children:[l.jsx("label",{htmlFor:"page-margins-selector",children:"Margins:"}),l.jsx("select",{id:"page-margins-selector",role:"combobox","aria-label":"Page margins selector",value:n,onChange:u=>x(u.target.value),children:Tn().map(u=>l.jsx("option",{value:u,children:vn(u)},u))})]})]})]}),l.jsxs("div",{className:"zoom-controls-compact",children:[l.jsx("button",{type:"button",className:"zoom-button-compact",onClick:O,disabled:!r,"aria-label":"Zoom out",title:"Zoom out (Ctrl + -)",children:l.jsx(Zr,{size:12})}),l.jsxs("span",{className:"zoom-level-display",children:[i,"%"]}),l.jsx("button",{type:"button",className:"zoom-button-compact",onClick:g,disabled:!o,"aria-label":"Zoom in",title:"Zoom in (Ctrl + +)",children:l.jsx(qr,{size:12})}),l.jsx("button",{type:"button",className:"zoom-reset-compact",onClick:S,"aria-label":"Reset zoom",title:"Reset zoom to 100% (Ctrl + 0)",children:"Reset"})]}),l.jsx("div",{className:"page-list",children:(e&&e.length>0?e:[{id:"page-0",pageNumber:1}]).map((u,C)=>l.jsxs("div",{className:"page-item",children:[l.jsxs("button",{type:"button",className:`page-button ${C===t?"active":""}`,onClick:()=>E(C),"aria-label":`Go to page ${C+1}`,"aria-current":C===t?"page":void 0,children:[l.jsx(Ie,{size:14}),l.jsxs("span",{children:["Page ",C+1]})]}),d>1&&l.jsx("button",{type:"button",className:"delete-page-button",onClick:y=>{y.stopPropagation(),j(C)},"aria-label":`Delete page ${C+1}`,title:"Delete this page and its content",children:l.jsx(Wr,{size:14})})]},u.id||`page-${C}`))}),l.jsxs("button",{type:"button",className:"add-page-button",onClick:M,"aria-label":"Add new page",title:"Add new page at end",children:[l.jsx(jr,{size:16}),l.jsx("span",{children:"Add Page"})]})]})};dt.propTypes={pageBoundaries:v.arrayOf(v.shape({id:v.string.isRequired,pageNumber:v.number.isRequired,top:v.number,height:v.number})),activePage:v.number,pageSize:v.oneOf(["A4","Letter","Legal"]),pageMargins:v.string,zoomLevel:v.number,canZoomIn:v.bool,canZoomOut:v.bool,onNavigate:v.func,onAddPage:v.func,onDeletePage:v.func,onPageSizeChange:v.func,onPageMarginsChange:v.func,onZoomIn:v.func,onZoomOut:v.func,onZoomReset:v.func},dt.defaultProps={pageBoundaries:[{id:"page-0",pageNumber:1}],activePage:0,pageSize:"A4",pageMargins:fe,zoomLevel:100,canZoomIn:!0,canZoomOut:!0,onNavigate:void 0,onAddPage:void 0,onDeletePage:void 0,onPageSizeChange:void 0,onPageMarginsChange:void 0,onZoomIn:void 0,onZoomOut:void 0,onZoomReset:void 0};const ln=m.memo(dt),De=({editorRef:e,onImageResize:t,onImageSelect:a,onImageDeselect:n,resizeOptions:i=de})=>{const o=m.useRef(null),r=m.useRef(null),s=m.useRef(null),f=m.useRef(null),b=m.useRef(i),p=m.useRef(!1),h=me();m.useEffect(()=>{b.current=i},[i]);const g=m.useCallback(y=>{if(!le(y))return;o.current&&(ge(o.current),o.current=null),y.classList.add("selected");const P=ct(y,b.current);P&&(o.current=P,r.current=y,document.body.appendChild(P),P.querySelectorAll(".resize-handler").forEach(w=>{w.addEventListener("mousedown",S)}),a&&(console.log("Image selected, calling onImageSelect callback"),a(y)))},[a]),O=m.useCallback(()=>{r.current&&(r.current.classList.remove("selected"),r.current=null),o.current&&(ge(o.current),o.current=null),s.current=null,f.current=null,p.current=!1,n&&n()},[n]),S=m.useCallback(y=>{if(y.preventDefault(),y.stopPropagation(),!r.current)return;const P=y.currentTarget.dataset.handler,D=r.current.getBoundingClientRect(),w=window.pageYOffset||document.documentElement.scrollTop,q=window.pageXOffset||document.documentElement.scrollLeft;s.current={x:y.clientX,y:y.clientY,width:r.current.offsetWidth,height:r.current.offsetHeight,originalWidth:r.current.offsetWidth,originalHeight:r.current.offsetHeight,offsetX:y.clientX-D.left-q,offsetY:y.clientY-D.top-w},f.current=P,p.current=!0,document.body.classList.add("resize-in-progress"),document.body.style.cursor=x(P),document.addEventListener("mousemove",d),document.addEventListener("mouseup",E)},[]),d=m.useCallback(y=>{if(!p.current||!r.current||!s.current||!f.current)return;y.preventDefault(),y.stopPropagation();const{x:P,y:D,width:w,height:q}=s.current,K=f.current,J=y.clientX,G=y.clientY,re=u({handler:K,startX:P,startY:D,currentX:J,currentY:G,startWidth:w,startHeight:q,options:b.current});C(r.current,re),o.current&&Me(o.current,r.current)},[]),E=m.useCallback(y=>{if(p.current){if(y.preventDefault(),y.stopPropagation(),r.current&&s.current){const P={width:s.current.originalWidth,height:s.current.originalHeight},D={width:r.current.offsetWidth,height:r.current.offsetHeight};(P.width!==D.width||P.height!==D.height)&&h.recordOperation({type:"IMAGE_RESIZE",payload:{element:r.current,state:D}},{type:"IMAGE_RESIZE",payload:{element:r.current,state:P}})}if(s.current=null,f.current=null,p.current=!1,document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",E),document.body.classList.remove("resize-in-progress"),document.body.style.cursor="",r.current){const P=new Event("input",{bubbles:!0,cancelable:!0});r.current.dispatchEvent(P),t&&t(r.current,{width:r.current.offsetWidth,height:r.current.offsetHeight})}}},[t,h]),M=m.useCallback(y=>{o.current&&!o.current.contains(y.target)&&O();const P=y.target;if(le(P)){if(P===r.current)return;g(P)}else console.log("Clicked on non-image element")},[g,O]),j=m.useCallback(y=>{if((y.key==="Delete"||y.key==="Backspace")&&r.current&&!p.current){y.preventDefault();const P=r.current;if(P.parentNode){P.parentNode.removeChild(P),O();const D=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(D)}}if(y.key==="Escape"&&r.current&&O(),r.current&&!p.current){if((y.ctrlKey||y.metaKey)&&y.shiftKey&&y.key===">"){y.preventDefault();const P=r.current.offsetWidth,D=Math.min(b.current.maxWidth||800,P+10);C(r.current,{width:D,height:r.current.offsetHeight});const w=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(w)}if((y.ctrlKey||y.metaKey)&&y.shiftKey&&y.key==="<"){y.preventDefault();const P=r.current.offsetWidth,D=Math.max(b.current.minWidth||50,P-10);C(r.current,{width:D,height:r.current.offsetHeight});const w=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(w)}if((y.ctrlKey||y.metaKey)&&y.shiftKey&&y.key==="+"){y.preventDefault();const P=r.current.offsetHeight,D=Math.min(b.current.maxHeight||600,P+10);C(r.current,{width:r.current.offsetWidth,height:D});const w=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(w)}if((y.ctrlKey||y.metaKey)&&y.shiftKey&&y.key==="-"){y.preventDefault();const P=r.current.offsetHeight,D=Math.max(b.current.minHeight||50,P-10);C(r.current,{width:r.current.offsetWidth,height:D});const w=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(w)}if((y.ctrlKey||y.metaKey)&&y.key==="r"){y.preventDefault(),C(r.current,{width:300,height:200});const P=new Event("input",{bubbles:!0,cancelable:!0});e.current.dispatchEvent(P)}}},[e,O]),k=m.useCallback(()=>{o.current&&r.current&&Me(o.current,r.current)},[]);m.useEffect(()=>{if(!e.current)return;const P=e.current.closest(".editor-viewport");return P&&(P.addEventListener("scroll",k),window.addEventListener("scroll",k)),()=>{P&&P.removeEventListener("scroll",k),window.removeEventListener("scroll",k)}},[e,k]),m.useEffect(()=>{if(!e.current)return;const y=e.current;y.addEventListener("click",M),y.addEventListener("keydown",j);const P=y.closest(".editor-viewport");return P&&P.addEventListener("scroll",k),window.addEventListener("resize",k),()=>{y.removeEventListener("click",M),y.removeEventListener("keydown",j),P&&P.removeEventListener("scroll",k),window.removeEventListener("resize",k),p.current&&(document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",E),document.body.classList.remove("resize-in-progress"),document.body.style.cursor=""),o.current&&ge(o.current)}},[e,M,j,k,d,E]),m.useEffect(()=>{if(!e.current)return;const y=new MutationObserver(P=>{P.forEach(D=>{D.type==="childList"&&(D.removedNodes.length>0&&D.removedNodes.forEach(w=>{w.nodeType===Node.ELEMENT_NODE&&le(w)&&w===r.current&&O()}),D.addedNodes.length>0&&D.addedNodes.forEach(w=>{if(w.nodeType===Node.ELEMENT_NODE)if(le(w))setTimeout(()=>{g(w)},50);else{const q=w.querySelectorAll?w.querySelectorAll("img"):[];q.length>0&&setTimeout(()=>{g(q[0])},50)}}))})});return y.observe(e.current,{childList:!0,subtree:!0}),()=>{y.disconnect()}},[e,O,g]);function x(y){switch(y){case _.TOP_LEFT:case _.BOTTOM_RIGHT:return"nwse-resize";case _.TOP_RIGHT:case _.BOTTOM_LEFT:return"nesw-resize";case _.TOP:case _.BOTTOM:return"ns-resize";case _.LEFT:case _.RIGHT:return"ew-resize";default:return"default"}}function u({handler:y,startX:P,startY:D,currentX:w,currentY:q,startWidth:K,startHeight:J,options:G=de}){const re=w-P,Q=q-D;let F=K,W=J;switch(y){case _.TOP_LEFT:F=Math.max(G.minWidth,K-re),W=Math.max(G.minHeight,J-Q);break;case _.TOP_RIGHT:F=Math.max(G.minWidth,K+re),W=Math.max(G.minHeight,J-Q);break;case _.BOTTOM_LEFT:F=Math.max(G.minWidth,K-re),W=Math.max(G.minHeight,J+Q);break;case _.BOTTOM_RIGHT:F=Math.max(G.minWidth,K+re),W=Math.max(G.minHeight,J+Q);break;case _.TOP:W=Math.max(G.minHeight,J-Q);break;case _.BOTTOM:W=Math.max(G.minHeight,J+Q);break;case _.LEFT:F=Math.max(G.minWidth,K-re);break;case _.RIGHT:F=Math.max(G.minWidth,K+re);break;default:return{width:F,height:W}}if(G.preserveAspectRatio&&G.aspectRatio){const oe=K/J;[_.TOP_LEFT,_.TOP_RIGHT,_.BOTTOM_LEFT,_.BOTTOM_RIGHT].includes(y)?F/oe>W?W=Math.max(G.minHeight,F/oe):F=Math.max(G.minWidth,W*oe):[_.TOP,_.BOTTOM].includes(y)?F=W*oe:[_.LEFT,_.RIGHT].includes(y)&&(W=F/oe)}return G.maxWidth&&F>G.maxWidth&&(F=G.maxWidth,G.preserveAspectRatio&&G.aspectRatio&&(W=F/(K/J))),G.maxHeight&&W>G.maxHeight&&(W=G.maxHeight,G.preserveAspectRatio&&G.aspectRatio&&(F=W*(K/J))),F=Math.max(G.minWidth,F),W=Math.max(G.minHeight,W),{width:Math.round(F),height:Math.round(W)}}function C(y,{width:P,height:D}){le(y)&&(y.tagName==="IMG"?(y.style.width=`${P}px`,y.style.height=`${D}px`,y.width=P,y.height=D):y.tagName==="DIV"&&(y.style.width=`${P}px`,y.style.height=`${D}px`))}return null};De.propTypes={editorRef:v.shape({current:v.instanceOf(typeof Element<"u"?Element:Object)}).isRequired,onImageResize:v.func,onImageSelect:v.func,onImageDeselect:v.func,resizeOptions:v.shape({minWidth:v.number,minHeight:v.number,maxWidth:v.number,maxHeight:v.number,aspectRatio:v.bool,preserveAspectRatio:v.bool,defaultWidth:v.number,defaultHeight:v.number})},De.defaultProps={onImageResize:void 0,onImageSelect:void 0,onImageDeselect:void 0,resizeOptions:de};const ft=({imageElement:e,onAlignChange:t,onAspectRatioToggle:a,onDelete:n,onClose:i,initialPreserveAspectRatio:o=!0})=>{const[r,s]=m.useState({top:0,left:0}),[f,b]=m.useState(!1),[p,h]=m.useState("top"),[g,O]=m.useState(o),S=m.useRef(null),d=m.useRef(null),E=me(),M=w=>{if(!w)return null;const q=window.getComputedStyle(w);return{float:q.float||"none",margin:w.style.margin||"",display:q.display||"inline",width:w.style.width||w.width||"",height:w.style.height||w.height||"",aspectRatio:g}},j=()=>{if(!e)return"left";const w=window.getComputedStyle(e);return w.float||w.display==="block"?"left":w.display==="flex"&&w.justifyContent==="center"?"center":w.float==="right"?"right":"left"},[k,x]=m.useState(j());m.useEffect(()=>()=>{console.log("ImageTooltipMenu unmounted")},[e]),m.useEffect(()=>{if(e){let w=e.closest(".editor-viewport")||e.closest(".continuous-scroll");w&&(d.current=w)}},[e]),m.useLayoutEffect(()=>{if(!e||!S.current)return;const w=()=>{const K=e.getBoundingClientRect(),J=S.current.getBoundingClientRect();d.current;const G=window.visualViewport?window.visualViewport:{width:window.innerWidth,height:window.innerHeight},re=K.bottom>=0&&K.top<=G.height&&K.right>=0&&K.left<=G.width;let Q="top",F=0,W=0;if(re){const I=K.top-J.height-10,R=G.height-K.bottom-J.height-10;R>I&&R>0?(Q="bottom",F=K.bottom+10):(Q="top",F=K.top-J.height-10)}else Q="top",F=10;W=K.left+K.width/2-J.width/2;const oe=window.innerWidth,T=window.innerHeight;let c=W,A=F;W<10?c=10:W+J.width>oe-10&&(c=oe-J.width-10),F<10?A=10:F+J.height>T-10&&(A=T-J.height-10),s({top:A,left:c}),h(Q),b(!0)};w();const q=()=>{w()};return d.current&&d.current.addEventListener("scroll",q),window.addEventListener("scroll",q),window.addEventListener("resize",q),()=>{d.current&&d.current.removeEventListener("scroll",q),window.removeEventListener("scroll",q),window.removeEventListener("resize",q),b(!1)}},[e]),m.useEffect(()=>{const w=q=>{S.current&&!S.current.contains(q.target)&&q.target!==e&&i()};return document.addEventListener("mousedown",w),()=>{document.removeEventListener("mousedown",w)}},[e,i]);const u=()=>{if(e){const w=M(e);e.style.float="left",e.style.margin="0 10px 10px 0",e.style.display="block",x("left");const q=M(e);E.recordOperation({type:"IMAGE_ALIGN",payload:{element:e,alignment:"left",state:q}},{type:"IMAGE_ALIGN",payload:{element:e,alignment:j(),state:w}}),t&&t("left")}},C=()=>{if(e){const w=M(e);e.style.float="none",e.style.margin="10px auto",e.style.display="block",x("center");const q=M(e);E.recordOperation({type:"IMAGE_ALIGN",payload:{element:e,alignment:"center",state:q}},{type:"IMAGE_ALIGN",payload:{element:e,alignment:j(),state:w}}),t&&t("center")}},y=()=>{if(e){const w=M(e);e.style.float="right",e.style.margin="0 0 10px 10px",e.style.display="block",x("right");const q=M(e);E.recordOperation({type:"IMAGE_ALIGN",payload:{element:e,alignment:"right",state:q}},{type:"IMAGE_ALIGN",payload:{element:e,alignment:j(),state:w}}),t&&t("right")}},P=()=>{if(e&&e.parentNode){const w={element:e,parent:e.parentNode,nextSibling:e.nextSibling};E.recordOperation({type:"IMAGE_DELETE",payload:{element:e}},{type:"IMAGE_REINSERT",payload:{state:w}}),e.parentNode.removeChild(e),n&&n(),i()}},D=()=>{const w=g,q=!g;O(q),E.recordOperation({type:"IMAGE_ASPECT_RATIO",payload:{element:e,preserveAspectRatio:q}},{type:"IMAGE_ASPECT_RATIO",payload:{element:e,preserveAspectRatio:w}}),a&&a(q)};return!e||typeof document>"u"?null:pn.createPortal(l.jsxs("div",{ref:S,className:"image-tooltip-menu","data-menu-position":p,"aria-hidden":!f,style:{position:"fixed",top:`${r.top}px`,left:`${r.left}px`,zIndex:999,background:"#fff",border:"1px solid #ddd",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",padding:"8px",display:"flex",gap:"2px",alignItems:"center",pointerEvents:f?"auto":"none",minWidth:"140px",minHeight:"32px",opacity:f?1:0,visibility:f?"visible":"hidden",transition:"opacity 0.15s ease, visibility 0.15s ease"},children:[l.jsx("button",{className:`tooltip-button aspect-ratio-toggle ${g?"":"active"}`,onClick:D,title:`Toggle aspect ratio preservation (currently ${g?"ON":"OFF"})`,children:g?l.jsx(Dr,{size:14}):l.jsx(Or,{size:14})}),l.jsx("button",{className:`tooltip-button ${k==="left"?"active":""}`,onClick:u,title:"Align Left",style:{background:k==="left"?"#007bff":"transparent",color:k==="left"?"#fff":"#333",border:"1px solid #ccc",borderRadius:"4px",padding:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"28px",height:"28px"},children:l.jsx(rn,{size:14})}),l.jsx("button",{className:`tooltip-button ${k==="center"?"active":""}`,onClick:C,title:"Align Center",style:{background:k==="center"?"#007bff":"transparent",color:k==="center"?"#fff":"#333",border:"1px solid #ccc",borderRadius:"4px",padding:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"28px",height:"28px"},children:l.jsx(tn,{size:14})}),l.jsx("button",{className:`tooltip-button ${k==="right"?"active":""}`,onClick:y,title:"Align Right",style:{background:k==="right"?"#007bff":"transparent",color:k==="right"?"#fff":"#333",border:"1px solid #ccc",borderRadius:"4px",padding:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"28px",height:"28px"},children:l.jsx(nn,{size:14})}),l.jsx("button",{className:"tooltip-button delete-button",onClick:P,title:"Delete Image",style:{background:"transparent",color:"#dc3545",border:"1px solid #dc3545",borderRadius:"4px",padding:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"28px",height:"28px"},children:l.jsx(Gr,{size:14})})]}),document.body)};ft.propTypes={imageElement:v.instanceOf(typeof Element<"u"?Element:Object),onAlignChange:v.func,onAspectRatioToggle:v.func,onDelete:v.func,onClose:v.func.isRequired,initialPreserveAspectRatio:v.bool},ft.defaultProps={imageElement:null,onAlignChange:void 0,onAspectRatioToggle:void 0,onDelete:void 0,initialPreserveAspectRatio:!0};const eo=50,to=50,un=50,no=100,ro=500,$e=m.forwardRef(({pageManagerComponent:e=null,onNavigatePage:t,onAddPage:a,onDeletePage:n,onPageSizeChange:i,onPageMarginsChange:o,onChange:r,showSidebar:s=!0,showToolbar:f=!0,showPageManager:b=!0},p)=>{const h=Qe(),g=me(),{pageSize:O,pageMargins:S,continuousContent:d,pageBoundaries:E,activePage:M,zoomLevel:j,canUndo:k,canRedo:x}=h,u=m.useRef(null),C=m.useRef(null),{currentFormat:y,formatText:P}=Ht(),[D,w]=m.useState(!1),[q,K]=m.useState(null),[J,G]=m.useState(!0),{checkAndUpdateBoundaries:re,getCurrentPage:Q,scrollToPage:F,updateBoundaries:W,triggerAutoReflow:oe,removePageAndContent:T,insertPageBreakAtBoundary:c}=Zt(O,C,j,S),A=m.useMemo(()=>we(O),[O]),[I,R]=m.useState(!1),U=m.useRef(null),B=m.useRef(!1),L=m.useRef(!1),Z=m.useRef(!1),V=m.useRef(d);m.useEffect(()=>{if(C.current){if(!Z.current){C.current.innerHTML=d,Z.current=!0,V.current=d;const $=setTimeout(()=>{W()},eo);return()=>clearTimeout($)}if(V.current!==d){if(C.current.innerHTML!==d){C.current.innerHTML=d;const ne=setTimeout(()=>{if(W(),B.current){B.current=!1;const ue=Math.max(0,E.length-1);g.setActivePage(ue),setTimeout(()=>{F(ue,u)},un)}},to);return V.current=d,()=>clearTimeout(ne)}V.current=d}}},[d,W,E.length,g,F]),m.useEffect(()=>{r&&Z.current&&r(d)},[d,r]),m.useImperativeHandle(p,()=>({getHTMLContent:()=>d,getPlainText:()=>d.replace(/<[^>]*>/g," ").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/\s+/g," ").trim(),setContent:$=>{g.updateContinuousContent($),C.current&&(C.current.innerHTML=$,setTimeout(()=>{W()},50))}}),[d,g,W]),m.useEffect(()=>{const $=setTimeout(()=>{C.current&&C.current.focus()},200);return()=>clearTimeout($)},[]);const Y=m.useCallback($=>{let ne=$.currentTarget.innerHTML;ne=gr(ne),ne!==$.currentTarget.innerHTML&&($.currentTarget.innerHTML=ne),g.updateContinuousContent(ne),re(),oe(200);const ue=Q(u);ue!==M&&g.setActivePage(ue)},[re,g,Q,M,oe,u]),ae=m.useCallback($=>{g.updatePageSize($),W({pageSize:$}),i&&i($)},[g,W,i]),N=m.useCallback($=>{g.updatePageMargins($),W({pageMargins:$}),o&&o($)},[g,W,o]),se=m.useCallback($=>{$<0||$>=E.length||(L.current=!0,g.setActivePage($),F($,u),setTimeout(()=>{L.current=!1},ro),t&&t($))},[g,F,t,E.length]),he=m.useCallback(()=>{const $=E.length+1;c($)&&(B.current=!0,setTimeout(()=>{if(B.current){B.current=!1;const ue=Math.max(0,E.length-1);g.setActivePage(ue),setTimeout(()=>{F(ue,u)},un)}},100)),a&&a()},[E.length,c,g,F,a]),ze=m.useCallback(()=>{const $=window.getSelection();if($&&$.rangeCount>0){if(!C?.current)return;const gt=`<page-break data-page-break="true" contenteditable="false" data-page-number="${C.current.querySelectorAll('page-break, [data-page-break="true"]').length+2}"></page-break><p><br></p>`;document.execCommand("insertHTML",!1,gt),setTimeout(()=>{W();const ht=Q(u);g.setActivePage(ht)},150)}},[W,Q,g,u]),dn=m.useCallback($=>{if(E.length<=1){console.warn("Cannot delete the only page");return}T($)&&(g.setActivePage(0),n&&n($))},[E.length,T,g,n]),He=m.useCallback(()=>{g.zoomIn()},[g]),Be=m.useCallback(()=>{g.zoomOut()},[g]),Ge=m.useCallback(()=>{g.resetZoom()},[g]);m.useEffect(()=>{const $=ne=>{if(ne.ctrlKey||ne.metaKey){["+","=","-","_","0"].includes(ne.key)&&ne.preventDefault();const ue=document.activeElement===C.current,gt=document.activeElement===u.current,ht=document.activeElement?.tagName==="INPUT"||document.activeElement?.tagName==="TEXTAREA"||document.activeElement?.isContentEditable===!1;if(ue||gt||!ht)switch(ne.key){case"+":case"=":He();break;case"-":case"_":Be();break;case"0":Ge();break}}};return window.addEventListener("keydown",$),()=>{window.removeEventListener("keydown",$)}},[He,Be,Ge]);const ao=m.useCallback(()=>{!u.current||!C.current||L.current||(U.current&&clearTimeout(U.current),U.current=setTimeout(()=>{if(L.current){U.current=null;return}const $=Q(u);$!==M&&$>=0&&g.setActivePage($),U.current=null},no))},[Q,M,g]),io=m.useMemo(()=>{if(!d)return 0;const ne=d.replace(/<[^>]*>/g," ").match(new RegExp("\\p{L}+","gu"));return ne?ne.length:0},[d]),so=E.length||1,co=m.useCallback($=>{w(!0),K($)},[]),fn=m.useCallback(()=>{w(!1),K(null)},[]),lo=m.useCallback(($,ne)=>{},[]);return m.useEffect(()=>()=>{U.current&&clearTimeout(U.current)},[]),l.jsxs("div",{className:"multi-page-editor",children:[f&&l.jsx(je,{currentFormat:{...y,imageSelected:D},onFormatText:P,onAddPageBreak:ze,canUndo:k,canRedo:x}),l.jsxs("div",{className:"editor-container",children:[s&&l.jsx(on,{editorView:null,isCollapsed:I,onToggle:()=>R($=>!$),wordCount:io,pageCount:so}),l.jsx("div",{className:"editor-viewport continuous-scroll",ref:u,onScroll:ao,children:l.jsx(Le,{content:d,dimensions:A,pageSize:O,pageMargins:S,pageBoundaries:E,editorRef:C,onInput:Y,onClick:()=>C.current?.focus(),zoomLevel:j})}),l.jsx(De,{editorRef:C,onImageSelect:co,onImageDeselect:fn,onImageResize:lo,resizeOptions:{...de,preserveAspectRatio:J,aspectRatio:J}}),D&&q&&l.jsx(ft,{imageElement:q,initialPreserveAspectRatio:J,onAlignChange:$=>{},onAspectRatioToggle:$=>{G($)},onDelete:()=>{if(q){const $=q.getAttribute("data-key");$&&Kt($).catch(ne=>{console.error("Failed to delete image from IndexedDB:",ne)})}},onClose:fn}),b&&l.jsx("div",{className:"page-manager-sidebar",children:e?m.cloneElement(e,{onNavigate:se,onAddPage:he,onDeletePage:dn,onPageSizeChange:ae,onPageMarginsChange:N,zoomLevel:j,canZoomIn:Ze(j),canZoomOut:Ve(j),onZoomIn:He,onZoomOut:Be,onZoomReset:Ge}):l.jsx(ln,{pageBoundaries:E,activePage:M,pageSize:O,pageMargins:S,zoomLevel:j,canZoomIn:Ze(j),canZoomOut:Ve(j),onNavigate:se,onAddPage:he,onDeletePage:dn,onPageSizeChange:ae,onPageMarginsChange:N,onZoomIn:He,onZoomOut:Be,onZoomReset:Ge})})]})]})});$e.displayName="HtmlEditor",$e.propTypes={pageManagerComponent:v.element,onNavigatePage:v.func,onAddPage:v.func,onDeletePage:v.func,onPageSizeChange:v.func,onPageMarginsChange:v.func,onChange:v.func,showSidebar:v.bool,showToolbar:v.bool,showPageManager:v.bool},$e.defaultProps={pageManagerComponent:null,onNavigatePage:void 0,onAddPage:void 0,onDeletePage:void 0,onPageSizeChange:void 0,onPageMarginsChange:void 0,onChange:void 0,showSidebar:!0,showToolbar:!0,showPageManager:!0};class pt extends m.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,a){console.error("[ErrorBoundary] Caught error:",t),console.error("[ErrorBoundary] Error info:",a),this.setState({error:t,errorInfo:a}),this.props.onError&&this.props.onError(t,a)}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null}),this.props.onReset&&this.props.onReset()};render(){return this.state.hasError?this.props.fallback?this.props.fallback:l.jsxs("div",{style:{padding:"20px",margin:"20px",border:"2px solid #f44336",borderRadius:"4px",backgroundColor:"#ffebee",color:"#c62828"},children:[l.jsx("h2",{style:{marginTop:0},children:" Something went wrong"}),l.jsx("p",{children:"The editor encountered an unexpected error and couldn't continue."}),this.props.showDetails&&this.state.error&&l.jsxs("details",{style:{marginTop:"10px",padding:"10px",backgroundColor:"white",borderRadius:"4px",fontSize:"12px",fontFamily:"monospace"},children:[l.jsx("summary",{style:{cursor:"pointer",fontWeight:"bold"},children:"Error Details"}),l.jsxs("pre",{style:{marginTop:"10px",overflow:"auto",maxHeight:"200px"},children:[this.state.error.toString(),this.state.errorInfo&&this.state.errorInfo.componentStack]})]}),l.jsx("button",{onClick:this.handleReset,style:{marginTop:"15px",padding:"8px 16px",backgroundColor:"#f44336",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold"},children:"Try Again"})]}):this.props.children}}pt.propTypes={children:v.node.isRequired,fallback:v.node,onError:v.func,onReset:v.func,showDetails:v.bool},pt.defaultProps={fallback:null,onError:void 0,onReset:void 0,showDetails:process.env.NODE_ENV==="development"};const oo={A4:{width:ie.A4.width,height:ie.A4.height},Letter:{width:ie.Letter.width,height:ie.Letter.height},Legal:{width:ie.Legal.width,height:ie.Legal.height}};z.COMMON_FONT_SIZES=jt,z.DEFAULT_FONT_SIZE=Ce,z.DEFAULT_IMAGE_RESIZE_OPTIONS=de,z.DEFAULT_PAGE_SIZE=Ye,z.DocumentProvider=Pn,z.EditorToolbar=je,z.ErrorBoundary=pt,z.FONT_SIZE_MAP=st,z.HtmlEditor=$e,z.ImageResizeHandlers=De,z.PAGE_DIMENSIONS=oo,z.PAGE_SIZES=ie,z.PageManager=ln,z.PageView=Le,z.RESIZE_HANDLERS=_,z.Sidebar=on,z.applyImageDimensions=Hn,z.calculateResizeDimensions=$n,z.clearImages=dr,z.createResizeOverlay=ct,z.deleteImage=Kt,z.getAllImageKeys=fr,z.getAvailablePageSizes=_n,z.getImage=Yt,z.getImageDimensions=zn,z.getPageDimensions=we,z.getPixelValue=jn,z.getPointValue=Ln,z.isResizableImage=le,z.isValidFontSize=Dn,z.isValidPageSize=xn,z.logger=an,z.pixelsToPoints=Dt,z.pointsToPixels=Lt,z.removeResizeOverlay=ge,z.saveImage=Vt,z.updateResizeOverlay=Me,z.useContinuousReflow=Zt,z.useDocument=Je,z.useDocumentActions=me,z.useDocumentState=Qe,z.useFormatting=Ht,Object.defineProperty(z,Symbol.toStringTag,{value:"Module"})}));
//# sourceMappingURL=htmleditor.umd.cjs.map
