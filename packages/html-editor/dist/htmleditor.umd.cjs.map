{"version":3,"file":"htmleditor.umd.cjs","sources":["../../../node_modules/react/cjs/react-jsx-runtime.production.js","../../../node_modules/react/cjs/react-jsx-runtime.development.js","../../../node_modules/react/jsx-runtime.js","../src/lib/editor/zoom-utils.js","../src/lib/editor/margin-utils.js","../src/lib/editor/page-sizes.js","../src/context/DocumentContext.jsx","../../../node_modules/prop-types/node_modules/react-is/cjs/react-is.production.min.js","../../../node_modules/prop-types/node_modules/react-is/cjs/react-is.development.js","../../../node_modules/prop-types/node_modules/react-is/index.js","../../../node_modules/object-assign/index.js","../../../node_modules/prop-types/lib/ReactPropTypesSecret.js","../../../node_modules/prop-types/lib/has.js","../../../node_modules/prop-types/checkPropTypes.js","../../../node_modules/prop-types/factoryWithTypeCheckers.js","../../../node_modules/prop-types/factoryWithThrowingShims.js","../../../node_modules/prop-types/index.js","../src/lib/editor/font-sizes.js","../src/lib/editor/image-resize-utils.js","../src/hooks/useFormatting.js","../src/lib/editor/page-boundary-utils.js","../src/lib/editor/page-break-utils.js","../src/lib/editor/content-reflow-utils.js","../src/lib/editor/cursor-scroll-utils.js","../src/hooks/useContinuousReflow.js","../src/lib/storage/index-db.js","../../../node_modules/lucide-react/dist/esm/shared/src/utils.js","../../../node_modules/lucide-react/dist/esm/defaultAttributes.js","../../../node_modules/lucide-react/dist/esm/Icon.js","../../../node_modules/lucide-react/dist/esm/createLucideIcon.js","../../../node_modules/lucide-react/dist/esm/icons/bold.js","../../../node_modules/lucide-react/dist/esm/icons/chevron-left.js","../../../node_modules/lucide-react/dist/esm/icons/chevron-right.js","../../../node_modules/lucide-react/dist/esm/icons/file-check.js","../../../node_modules/lucide-react/dist/esm/icons/file-text.js","../../../node_modules/lucide-react/dist/esm/icons/hash.js","../../../node_modules/lucide-react/dist/esm/icons/heading-1.js","../../../node_modules/lucide-react/dist/esm/icons/heading-2.js","../../../node_modules/lucide-react/dist/esm/icons/heading-3.js","../../../node_modules/lucide-react/dist/esm/icons/image.js","../../../node_modules/lucide-react/dist/esm/icons/italic.js","../../../node_modules/lucide-react/dist/esm/icons/link.js","../../../node_modules/lucide-react/dist/esm/icons/list-ordered.js","../../../node_modules/lucide-react/dist/esm/icons/list.js","../../../node_modules/lucide-react/dist/esm/icons/plus.js","../../../node_modules/lucide-react/dist/esm/icons/redo.js","../../../node_modules/lucide-react/dist/esm/icons/settings.js","../../../node_modules/lucide-react/dist/esm/icons/strikethrough.js","../../../node_modules/lucide-react/dist/esm/icons/table.js","../../../node_modules/lucide-react/dist/esm/icons/text-align-center.js","../../../node_modules/lucide-react/dist/esm/icons/text-align-end.js","../../../node_modules/lucide-react/dist/esm/icons/text-align-justify.js","../../../node_modules/lucide-react/dist/esm/icons/text-align-start.js","../../../node_modules/lucide-react/dist/esm/icons/trash-2.js","../../../node_modules/lucide-react/dist/esm/icons/underline.js","../../../node_modules/lucide-react/dist/esm/icons/undo.js","../../../node_modules/lucide-react/dist/esm/icons/x.js","../../../node_modules/lucide-react/dist/esm/icons/zoom-in.js","../../../node_modules/lucide-react/dist/esm/icons/zoom-out.js","../src/components/editor/Sidebar.jsx","../src/lib/editor/utils/logger.js","../src/components/editor/EditorToolbar.jsx","../src/components/editor/PageView.jsx","../src/components/editor/PageManager.jsx","../src/components/editor/ImageResizeHandlers.jsx","../src/components/editor/ImageTooltipMenu.jsx","../src/components/editor/HtmlEditor.jsx","../src/components/ErrorBoundary.jsx","../src/index.js"],"sourcesContent":["/**\n * @license React\n * react-jsx-runtime.production.js\n *\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\"use strict\";\nvar REACT_ELEMENT_TYPE = Symbol.for(\"react.transitional.element\"),\n  REACT_FRAGMENT_TYPE = Symbol.for(\"react.fragment\");\nfunction jsxProd(type, config, maybeKey) {\n  var key = null;\n  void 0 !== maybeKey && (key = \"\" + maybeKey);\n  void 0 !== config.key && (key = \"\" + config.key);\n  if (\"key\" in config) {\n    maybeKey = {};\n    for (var propName in config)\n      \"key\" !== propName && (maybeKey[propName] = config[propName]);\n  } else maybeKey = config;\n  config = maybeKey.ref;\n  return {\n    $$typeof: REACT_ELEMENT_TYPE,\n    type: type,\n    key: key,\n    ref: void 0 !== config ? config : null,\n    props: maybeKey\n  };\n}\nexports.Fragment = REACT_FRAGMENT_TYPE;\nexports.jsx = jsxProd;\nexports.jsxs = jsxProd;\n","/**\n * @license React\n * react-jsx-runtime.development.js\n *\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\"use strict\";\n\"production\" !== process.env.NODE_ENV &&\n  (function () {\n    function getComponentNameFromType(type) {\n      if (null == type) return null;\n      if (\"function\" === typeof type)\n        return type.$$typeof === REACT_CLIENT_REFERENCE\n          ? null\n          : type.displayName || type.name || null;\n      if (\"string\" === typeof type) return type;\n      switch (type) {\n        case REACT_FRAGMENT_TYPE:\n          return \"Fragment\";\n        case REACT_PROFILER_TYPE:\n          return \"Profiler\";\n        case REACT_STRICT_MODE_TYPE:\n          return \"StrictMode\";\n        case REACT_SUSPENSE_TYPE:\n          return \"Suspense\";\n        case REACT_SUSPENSE_LIST_TYPE:\n          return \"SuspenseList\";\n        case REACT_ACTIVITY_TYPE:\n          return \"Activity\";\n      }\n      if (\"object\" === typeof type)\n        switch (\n          (\"number\" === typeof type.tag &&\n            console.error(\n              \"Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue.\"\n            ),\n          type.$$typeof)\n        ) {\n          case REACT_PORTAL_TYPE:\n            return \"Portal\";\n          case REACT_CONTEXT_TYPE:\n            return type.displayName || \"Context\";\n          case REACT_CONSUMER_TYPE:\n            return (type._context.displayName || \"Context\") + \".Consumer\";\n          case REACT_FORWARD_REF_TYPE:\n            var innerType = type.render;\n            type = type.displayName;\n            type ||\n              ((type = innerType.displayName || innerType.name || \"\"),\n              (type = \"\" !== type ? \"ForwardRef(\" + type + \")\" : \"ForwardRef\"));\n            return type;\n          case REACT_MEMO_TYPE:\n            return (\n              (innerType = type.displayName || null),\n              null !== innerType\n                ? innerType\n                : getComponentNameFromType(type.type) || \"Memo\"\n            );\n          case REACT_LAZY_TYPE:\n            innerType = type._payload;\n            type = type._init;\n            try {\n              return getComponentNameFromType(type(innerType));\n            } catch (x) {}\n        }\n      return null;\n    }\n    function testStringCoercion(value) {\n      return \"\" + value;\n    }\n    function checkKeyStringCoercion(value) {\n      try {\n        testStringCoercion(value);\n        var JSCompiler_inline_result = !1;\n      } catch (e) {\n        JSCompiler_inline_result = !0;\n      }\n      if (JSCompiler_inline_result) {\n        JSCompiler_inline_result = console;\n        var JSCompiler_temp_const = JSCompiler_inline_result.error;\n        var JSCompiler_inline_result$jscomp$0 =\n          (\"function\" === typeof Symbol &&\n            Symbol.toStringTag &&\n            value[Symbol.toStringTag]) ||\n          value.constructor.name ||\n          \"Object\";\n        JSCompiler_temp_const.call(\n          JSCompiler_inline_result,\n          \"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.\",\n          JSCompiler_inline_result$jscomp$0\n        );\n        return testStringCoercion(value);\n      }\n    }\n    function getTaskName(type) {\n      if (type === REACT_FRAGMENT_TYPE) return \"<>\";\n      if (\n        \"object\" === typeof type &&\n        null !== type &&\n        type.$$typeof === REACT_LAZY_TYPE\n      )\n        return \"<...>\";\n      try {\n        var name = getComponentNameFromType(type);\n        return name ? \"<\" + name + \">\" : \"<...>\";\n      } catch (x) {\n        return \"<...>\";\n      }\n    }\n    function getOwner() {\n      var dispatcher = ReactSharedInternals.A;\n      return null === dispatcher ? null : dispatcher.getOwner();\n    }\n    function UnknownOwner() {\n      return Error(\"react-stack-top-frame\");\n    }\n    function hasValidKey(config) {\n      if (hasOwnProperty.call(config, \"key\")) {\n        var getter = Object.getOwnPropertyDescriptor(config, \"key\").get;\n        if (getter && getter.isReactWarning) return !1;\n      }\n      return void 0 !== config.key;\n    }\n    function defineKeyPropWarningGetter(props, displayName) {\n      function warnAboutAccessingKey() {\n        specialPropKeyWarningShown ||\n          ((specialPropKeyWarningShown = !0),\n          console.error(\n            \"%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)\",\n            displayName\n          ));\n      }\n      warnAboutAccessingKey.isReactWarning = !0;\n      Object.defineProperty(props, \"key\", {\n        get: warnAboutAccessingKey,\n        configurable: !0\n      });\n    }\n    function elementRefGetterWithDeprecationWarning() {\n      var componentName = getComponentNameFromType(this.type);\n      didWarnAboutElementRef[componentName] ||\n        ((didWarnAboutElementRef[componentName] = !0),\n        console.error(\n          \"Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.\"\n        ));\n      componentName = this.props.ref;\n      return void 0 !== componentName ? componentName : null;\n    }\n    function ReactElement(type, key, props, owner, debugStack, debugTask) {\n      var refProp = props.ref;\n      type = {\n        $$typeof: REACT_ELEMENT_TYPE,\n        type: type,\n        key: key,\n        props: props,\n        _owner: owner\n      };\n      null !== (void 0 !== refProp ? refProp : null)\n        ? Object.defineProperty(type, \"ref\", {\n            enumerable: !1,\n            get: elementRefGetterWithDeprecationWarning\n          })\n        : Object.defineProperty(type, \"ref\", { enumerable: !1, value: null });\n      type._store = {};\n      Object.defineProperty(type._store, \"validated\", {\n        configurable: !1,\n        enumerable: !1,\n        writable: !0,\n        value: 0\n      });\n      Object.defineProperty(type, \"_debugInfo\", {\n        configurable: !1,\n        enumerable: !1,\n        writable: !0,\n        value: null\n      });\n      Object.defineProperty(type, \"_debugStack\", {\n        configurable: !1,\n        enumerable: !1,\n        writable: !0,\n        value: debugStack\n      });\n      Object.defineProperty(type, \"_debugTask\", {\n        configurable: !1,\n        enumerable: !1,\n        writable: !0,\n        value: debugTask\n      });\n      Object.freeze && (Object.freeze(type.props), Object.freeze(type));\n      return type;\n    }\n    function jsxDEVImpl(\n      type,\n      config,\n      maybeKey,\n      isStaticChildren,\n      debugStack,\n      debugTask\n    ) {\n      var children = config.children;\n      if (void 0 !== children)\n        if (isStaticChildren)\n          if (isArrayImpl(children)) {\n            for (\n              isStaticChildren = 0;\n              isStaticChildren < children.length;\n              isStaticChildren++\n            )\n              validateChildKeys(children[isStaticChildren]);\n            Object.freeze && Object.freeze(children);\n          } else\n            console.error(\n              \"React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.\"\n            );\n        else validateChildKeys(children);\n      if (hasOwnProperty.call(config, \"key\")) {\n        children = getComponentNameFromType(type);\n        var keys = Object.keys(config).filter(function (k) {\n          return \"key\" !== k;\n        });\n        isStaticChildren =\n          0 < keys.length\n            ? \"{key: someKey, \" + keys.join(\": ..., \") + \": ...}\"\n            : \"{key: someKey}\";\n        didWarnAboutKeySpread[children + isStaticChildren] ||\n          ((keys =\n            0 < keys.length ? \"{\" + keys.join(\": ..., \") + \": ...}\" : \"{}\"),\n          console.error(\n            'A props object containing a \"key\" prop is being spread into JSX:\\n  let props = %s;\\n  <%s {...props} />\\nReact keys must be passed directly to JSX without using spread:\\n  let props = %s;\\n  <%s key={someKey} {...props} />',\n            isStaticChildren,\n            children,\n            keys,\n            children\n          ),\n          (didWarnAboutKeySpread[children + isStaticChildren] = !0));\n      }\n      children = null;\n      void 0 !== maybeKey &&\n        (checkKeyStringCoercion(maybeKey), (children = \"\" + maybeKey));\n      hasValidKey(config) &&\n        (checkKeyStringCoercion(config.key), (children = \"\" + config.key));\n      if (\"key\" in config) {\n        maybeKey = {};\n        for (var propName in config)\n          \"key\" !== propName && (maybeKey[propName] = config[propName]);\n      } else maybeKey = config;\n      children &&\n        defineKeyPropWarningGetter(\n          maybeKey,\n          \"function\" === typeof type\n            ? type.displayName || type.name || \"Unknown\"\n            : type\n        );\n      return ReactElement(\n        type,\n        children,\n        maybeKey,\n        getOwner(),\n        debugStack,\n        debugTask\n      );\n    }\n    function validateChildKeys(node) {\n      isValidElement(node)\n        ? node._store && (node._store.validated = 1)\n        : \"object\" === typeof node &&\n          null !== node &&\n          node.$$typeof === REACT_LAZY_TYPE &&\n          (\"fulfilled\" === node._payload.status\n            ? isValidElement(node._payload.value) &&\n              node._payload.value._store &&\n              (node._payload.value._store.validated = 1)\n            : node._store && (node._store.validated = 1));\n    }\n    function isValidElement(object) {\n      return (\n        \"object\" === typeof object &&\n        null !== object &&\n        object.$$typeof === REACT_ELEMENT_TYPE\n      );\n    }\n    var React = require(\"react\"),\n      REACT_ELEMENT_TYPE = Symbol.for(\"react.transitional.element\"),\n      REACT_PORTAL_TYPE = Symbol.for(\"react.portal\"),\n      REACT_FRAGMENT_TYPE = Symbol.for(\"react.fragment\"),\n      REACT_STRICT_MODE_TYPE = Symbol.for(\"react.strict_mode\"),\n      REACT_PROFILER_TYPE = Symbol.for(\"react.profiler\"),\n      REACT_CONSUMER_TYPE = Symbol.for(\"react.consumer\"),\n      REACT_CONTEXT_TYPE = Symbol.for(\"react.context\"),\n      REACT_FORWARD_REF_TYPE = Symbol.for(\"react.forward_ref\"),\n      REACT_SUSPENSE_TYPE = Symbol.for(\"react.suspense\"),\n      REACT_SUSPENSE_LIST_TYPE = Symbol.for(\"react.suspense_list\"),\n      REACT_MEMO_TYPE = Symbol.for(\"react.memo\"),\n      REACT_LAZY_TYPE = Symbol.for(\"react.lazy\"),\n      REACT_ACTIVITY_TYPE = Symbol.for(\"react.activity\"),\n      REACT_CLIENT_REFERENCE = Symbol.for(\"react.client.reference\"),\n      ReactSharedInternals =\n        React.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,\n      hasOwnProperty = Object.prototype.hasOwnProperty,\n      isArrayImpl = Array.isArray,\n      createTask = console.createTask\n        ? console.createTask\n        : function () {\n            return null;\n          };\n    React = {\n      react_stack_bottom_frame: function (callStackForError) {\n        return callStackForError();\n      }\n    };\n    var specialPropKeyWarningShown;\n    var didWarnAboutElementRef = {};\n    var unknownOwnerDebugStack = React.react_stack_bottom_frame.bind(\n      React,\n      UnknownOwner\n    )();\n    var unknownOwnerDebugTask = createTask(getTaskName(UnknownOwner));\n    var didWarnAboutKeySpread = {};\n    exports.Fragment = REACT_FRAGMENT_TYPE;\n    exports.jsx = function (type, config, maybeKey) {\n      var trackActualOwner =\n        1e4 > ReactSharedInternals.recentlyCreatedOwnerStacks++;\n      return jsxDEVImpl(\n        type,\n        config,\n        maybeKey,\n        !1,\n        trackActualOwner\n          ? Error(\"react-stack-top-frame\")\n          : unknownOwnerDebugStack,\n        trackActualOwner ? createTask(getTaskName(type)) : unknownOwnerDebugTask\n      );\n    };\n    exports.jsxs = function (type, config, maybeKey) {\n      var trackActualOwner =\n        1e4 > ReactSharedInternals.recentlyCreatedOwnerStacks++;\n      return jsxDEVImpl(\n        type,\n        config,\n        maybeKey,\n        !0,\n        trackActualOwner\n          ? Error(\"react-stack-top-frame\")\n          : unknownOwnerDebugStack,\n        trackActualOwner ? createTask(getTaskName(type)) : unknownOwnerDebugTask\n      );\n    };\n  })();\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n","/**\r\n * Zoom utilities for the HTML editor\r\n * Provides constants and helper functions for zoom functionality\r\n */\r\n\r\n/**\r\n * Allowed zoom levels in percentage\r\n * Range: 50% to 200% in 5% increments\r\n */\r\nexport const ZOOM_LEVELS = [\r\n  50, 55, 60, 65, 70, 75, 80, 85, 90, 95,\r\n  100, 105, 110, 115, 120, 125, 130, 135, 140, 145,\r\n  150, 155, 160, 165, 170, 175, 180, 185, 190, 195, 200\r\n];\r\n\r\n/**\r\n * Default zoom level\r\n */\r\nexport const DEFAULT_ZOOM = 100;\r\n\r\n/**\r\n * Minimum zoom level\r\n */\r\nexport const MIN_ZOOM = 50;\r\n\r\n/**\r\n * Maximum zoom level\r\n */\r\nexport const MAX_ZOOM = 200;\r\n\r\n/**\r\n * Zoom increment/decrement step\r\n */\r\nexport const ZOOM_STEP = 5;\r\n\r\n/**\r\n * Check if zoom can be increased\r\n * @param {number} currentZoom - Current zoom level\r\n * @returns {boolean} True if zoom can be increased\r\n */\r\nexport const canZoomIn = (currentZoom) => {\r\n  return currentZoom < MAX_ZOOM;\r\n};\r\n\r\n/**\r\n * Check if zoom can be decreased\r\n * @param {number} currentZoom - Current zoom level\r\n * @returns {boolean} True if zoom can be decreased\r\n */\r\nexport const canZoomOut = (currentZoom) => {\r\n  return currentZoom > MIN_ZOOM;\r\n};\r\n\r\n/**\r\n * Get next zoom level (zoom in)\r\n * @param {number} currentZoom - Current zoom level\r\n * @returns {number} Next zoom level or current if at max\r\n */\r\nexport const getNextZoomLevel = (currentZoom) => {\r\n  if (!canZoomIn(currentZoom)) return currentZoom;\r\n  \r\n  const nextLevel = currentZoom + ZOOM_STEP;\r\n  return nextLevel <= MAX_ZOOM ? nextLevel : currentZoom;\r\n};\r\n\r\n/**\r\n * Get previous zoom level (zoom out)\r\n * @param {number} currentZoom - Current zoom level\r\n * @returns {number} Previous zoom level or current if at min\r\n */\r\nexport const getPreviousZoomLevel = (currentZoom) => {\r\n  if (!canZoomOut(currentZoom)) return currentZoom;\r\n  \r\n  const prevLevel = currentZoom - ZOOM_STEP;\r\n  return prevLevel >= MIN_ZOOM ? prevLevel : currentZoom;\r\n};\r\n\r\n/**\r\n * Validate if a zoom level is allowed\r\n * @param {number} zoom - Zoom level to validate\r\n * @returns {boolean} True if zoom level is valid\r\n */\r\nexport const isValidZoomLevel = (zoom) => {\r\n  return zoom >= MIN_ZOOM && zoom <= MAX_ZOOM;\r\n};\r\n\r\n/**\r\n * Get zoom as decimal multiplier\r\n * @param {number} zoom - Zoom percentage\r\n * @returns {number} Decimal multiplier (e.g., 100 -> 1.0, 150 -> 1.5)\r\n */\r\nexport const getZoomMultiplier = (zoom) => {\r\n  return zoom / 100;\r\n};\r\n","/**\r\n * Page Margin Utilities\r\n * \r\n * Provides margin presets and conversion utilities for page margins.\r\n * Margins are defined in inches and converted to pixels at 96 DPI (CSS standard).\r\n * \r\n * DPI Conversion: 1 inch = 96 pixels (CSS/Web standard)\r\n * \r\n * Common margin presets similar to Microsoft Word:\r\n * - Normal: 1\" all sides (most common)\r\n * - Narrow: 0.5\" all sides (minimal margins)\r\n * - Moderate: 1\" top/bottom, 0.75\" left/right\r\n * - Wide: 1\" top/bottom, 2\" left/right\r\n * - Mirrored: For two-sided printing\r\n */\r\n\r\n// DPI constant for CSS/Web (96 DPI is the standard)\r\nexport const CSS_DPI = 96;\r\n\r\n// Convert inches to pixels at 96 DPI\r\nexport const inchesToPixels = (inches) => Math.round(inches * CSS_DPI);\r\n\r\n// Convert pixels to inches\r\nexport const pixelsToInches = (pixels) => pixels / CSS_DPI;\r\n\r\n// Margin preset definitions (in inches)\r\nexport const MARGIN_PRESETS = {\r\n  NORMAL: {\r\n    name: 'Normal',\r\n    label: 'Normal (1\")',\r\n    top: 1,\r\n    bottom: 1,\r\n    left: 1,\r\n    right: 1\r\n  },\r\n  NARROW: {\r\n    name: 'Narrow',\r\n    label: 'Narrow (0.5\")',\r\n    top: 0.5,\r\n    bottom: 0.5,\r\n    left: 0.5,\r\n    right: 0.5\r\n  },\r\n  MODERATE: {\r\n    name: 'Moderate',\r\n    label: 'Moderate (1\" / 0.75\")',\r\n    top: 1,\r\n    bottom: 1,\r\n    left: 0.75,\r\n    right: 0.75\r\n  },\r\n  WIDE: {\r\n    name: 'Wide',\r\n    label: 'Wide (1\" / 2\")',\r\n    top: 1,\r\n    bottom: 1,\r\n    left: 2,\r\n    right: 2\r\n  },\r\n  OFFICE_2003: {\r\n    name: 'Office 2003',\r\n    label: 'Office 2003 (1\" / 1.25\")',\r\n    top: 1,\r\n    bottom: 1,\r\n    left: 1.25,\r\n    right: 1.25\r\n  }\r\n};\r\n\r\n// Default margin preset\r\nexport const DEFAULT_MARGIN_PRESET = 'NORMAL';\r\n\r\n/**\r\n * Convert margin preset to pixel values\r\n * @param {string} presetName - Name of the preset (e.g., 'NORMAL', 'NARROW')\r\n * @returns {Object} Margin object with top, bottom, left, right in pixels\r\n */\r\nexport const getMarginPixels = (presetName = DEFAULT_MARGIN_PRESET) => {\r\n  const preset = MARGIN_PRESETS[presetName] || MARGIN_PRESETS[DEFAULT_MARGIN_PRESET];\r\n  \r\n  return {\r\n    top: inchesToPixels(preset.top),\r\n    bottom: inchesToPixels(preset.bottom),\r\n    left: inchesToPixels(preset.left),\r\n    right: inchesToPixels(preset.right)\r\n  };\r\n};\r\n\r\n/**\r\n * Get total vertical margins (top + bottom)\r\n * @param {string} presetName - Name of the preset\r\n * @returns {number} Total vertical margins in pixels\r\n */\r\nexport const getTotalVerticalMargins = (presetName = DEFAULT_MARGIN_PRESET) => {\r\n  const margins = getMarginPixels(presetName);\r\n  return margins.top + margins.bottom;\r\n};\r\n\r\n/**\r\n * Get total horizontal margins (left + right)\r\n * @param {string} presetName - Name of the preset\r\n * @returns {number} Total horizontal margins in pixels\r\n */\r\nexport const getTotalHorizontalMargins = (presetName = DEFAULT_MARGIN_PRESET) => {\r\n  const margins = getMarginPixels(presetName);\r\n  return margins.left + margins.right;\r\n};\r\n\r\n/**\r\n * Get all available margin preset names\r\n * @returns {Array<string>} Array of preset names\r\n */\r\nexport const getMarginPresetNames = () => {\r\n  return Object.keys(MARGIN_PRESETS);\r\n};\r\n\r\n/**\r\n * Get margin preset label for display\r\n * @param {string} presetName - Name of the preset\r\n * @returns {string} Display label\r\n */\r\nexport const getMarginPresetLabel = (presetName) => {\r\n  const preset = MARGIN_PRESETS[presetName];\r\n  return preset ? preset.label : 'Unknown';\r\n};\r\n\r\n/**\r\n * Validate if a preset name exists\r\n * @param {string} presetName - Name to validate\r\n * @returns {boolean} True if valid\r\n */\r\nexport const isValidMarginPreset = (presetName) => {\r\n  return presetName in MARGIN_PRESETS;\r\n};\r\n\r\nexport default {\r\n  CSS_DPI,\r\n  inchesToPixels,\r\n  pixelsToInches,\r\n  MARGIN_PRESETS,\r\n  DEFAULT_MARGIN_PRESET,\r\n  getMarginPixels,\r\n  getTotalVerticalMargins,\r\n  getTotalHorizontalMargins,\r\n  getMarginPresetNames,\r\n  getMarginPresetLabel,\r\n  isValidMarginPreset\r\n};\r\n","/**\r\n * Page size constants with real-world dimensions\r\n * Dimensions calculated at 96 DPI (Microsoft Word standard for screen display)\r\n */\r\n\r\n/**\r\n * Page size configurations\r\n * All dimensions in pixels at 96 DPI (matching Microsoft Word)\r\n * \r\n * Conversion: 1 inch = 96 pixels, 1 mm = 96/25.4 pixels\r\n */\r\nexport const PAGE_SIZES = {\r\n  A4: {\r\n    name: 'A4',\r\n    width: 794,  // 210mm = 210 * 96 / 25.4 ≈ 794px (Word A4 width)\r\n    height: 1123, // 297mm = 297 * 96 / 25.4 ≈ 1123px (Word A4 height)\r\n    widthMm: 210,\r\n    heightMm: 297,\r\n    widthIn: 8.27,\r\n    heightIn: 11.69\r\n  },\r\n  Letter: {\r\n    name: 'Letter',\r\n    width: 816,  // 8.5 inches = 8.5 * 96 = 816px (Word Letter width)\r\n    height: 1056, // 11 inches = 11 * 96 = 1056px (Word Letter height)\r\n    widthMm: 216,\r\n    heightMm: 279,\r\n    widthIn: 8.5,\r\n    heightIn: 11\r\n  },\r\n  Legal: {\r\n    name: 'Legal',\r\n    width: 816,  // 8.5 inches = 8.5 * 96 = 816px (Word Legal width)\r\n    height: 1344, // 14 inches = 14 * 96 = 1344px (Word Legal height)\r\n    widthMm: 216,\r\n    heightMm: 356,\r\n    widthIn: 8.5,\r\n    heightIn: 14\r\n  }\r\n};\r\n\r\n/**\r\n * Default page size\r\n */\r\nexport const DEFAULT_PAGE_SIZE = 'A4';\r\n\r\n/**\r\n * Get page dimensions for a given size\r\n * @param {string} size - Page size ('A4', 'Letter', 'Legal')\r\n * @returns {Object} Dimensions object with width and height\r\n */\r\nexport const getPageDimensions = (size) => {\r\n  const pageSize = PAGE_SIZES[size] || PAGE_SIZES[DEFAULT_PAGE_SIZE];\r\n  return {\r\n    width: pageSize.width,\r\n    height: pageSize.height\r\n  };\r\n};\r\n\r\n/**\r\n * Validate if a page size is supported\r\n * @param {string} size - Page size to validate\r\n * @returns {boolean} True if page size is valid\r\n */\r\nexport const isValidPageSize = (size) => {\r\n  return Object.keys(PAGE_SIZES).includes(size);\r\n};\r\n\r\n/**\r\n * Get all available page sizes\r\n * @returns {string[]} Array of page size names\r\n */\r\nexport const getAvailablePageSizes = () => {\r\n  return Object.keys(PAGE_SIZES);\r\n};\r\n","import React, { createContext, useContext, useReducer, useCallback, useMemo } from 'react';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport { DEFAULT_ZOOM, MIN_ZOOM, MAX_ZOOM, ZOOM_STEP, canZoomIn as checkCanZoomIn, canZoomOut as checkCanZoomOut } from '../lib/editor/zoom-utils.js';\r\nimport { DEFAULT_MARGIN_PRESET } from '../lib/editor/margin-utils.js';\r\nimport { getPageDimensions, DEFAULT_PAGE_SIZE as PAGE_SIZE_DEFAULT } from '../lib/editor/page-sizes.js';\r\n\r\n// Constants moved outside for performance\r\nconst DEFAULT_PAGE_SIZE = PAGE_SIZE_DEFAULT;\r\nconst EMPTY_PARAGRAPH = '<p><br></p>';\r\nconst DEFAULT_EDITOR_MODE = 'continuous';\r\n\r\n// Helper functions moved outside reducer for better performance and reusability\r\nconst createEmptyPage = (index, size = DEFAULT_PAGE_SIZE) => ({\r\n  id: uuidv4(),\r\n  index,\r\n  size,\r\n  content: EMPTY_PARAGRAPH,\r\n  images: [],\r\n  isBreakPoint: false\r\n});\r\n\r\nconst sanitizeContent = (html) => {\r\n  if (typeof html !== 'string' || html.trim() === '') {\r\n    return EMPTY_PARAGRAPH;\r\n  }\r\n  return html;\r\n};\r\n\r\nconst withMinimumPage = (pages, pageSize = DEFAULT_PAGE_SIZE) => {\r\n  const nextPages = pages.length > 0 ? pages : [createEmptyPage(0, pageSize)];\r\n  return nextPages.map((page, index) => ({\r\n    id: page.id || uuidv4(),\r\n    index,\r\n    size: page.size || pageSize,\r\n    content: sanitizeContent(page.content),\r\n    images: page.images || [],\r\n    isBreakPoint: Boolean(page.isBreakPoint)\r\n  }));\r\n};\r\n\r\nconst createDefaultBoundary = (pageSize = DEFAULT_PAGE_SIZE) => {\r\n  const dimensions = getPageDimensions(pageSize);\r\n  return [{\r\n    id: 'page-0',\r\n    pageNumber: 1,\r\n    top: 0,\r\n    height: dimensions.height\r\n  }];\r\n};\r\n\r\nconst buildInitialState = (overrides = {}) => {\r\n  const now = new Date().toISOString();\r\n  const pageSize = overrides.pageSize || DEFAULT_PAGE_SIZE;\r\n  const pages = withMinimumPage(overrides.pages || [createEmptyPage(0, pageSize)], pageSize);\r\n\r\n  return {\r\n    id: uuidv4(),\r\n    title: overrides.title || 'Untitled Document',\r\n    createdAt: now,\r\n    updatedAt: now,\r\n    pageSize,\r\n    pages,\r\n    activePage: overrides.activePage && overrides.activePage < pages.length ? overrides.activePage : 0,\r\n    pageBreaks: overrides.pageBreaks || [],\r\n    totalPages: pages.length,\r\n    editorMode: overrides.editorMode || DEFAULT_EDITOR_MODE,\r\n    continuousContent: overrides.continuousContent || EMPTY_PARAGRAPH,\r\n    pageBoundaries: overrides.pageBoundaries || createDefaultBoundary(pageSize),\r\n    zoomLevel: overrides.zoomLevel || DEFAULT_ZOOM,\r\n    pageMargins: overrides.pageMargins || DEFAULT_MARGIN_PRESET\r\n  };\r\n};\r\n\r\n// Action types\r\nconst ActionTypes = {\r\n  INITIALIZE_DOCUMENT: 'INITIALIZE_DOCUMENT',\r\n  UPDATE_TITLE: 'UPDATE_TITLE',\r\n  UPDATE_PAGE_CONTENT: 'UPDATE_PAGE_CONTENT',\r\n  UPDATE_PAGES: 'UPDATE_PAGES',\r\n  ADD_PAGE: 'ADD_PAGE',\r\n  DELETE_PAGE: 'DELETE_PAGE',\r\n  SET_ACTIVE_PAGE: 'SET_ACTIVE_PAGE',\r\n  UPDATE_PAGE_SIZE: 'UPDATE_PAGE_SIZE',\r\n  RESET_DOCUMENT: 'RESET_DOCUMENT',\r\n  UPDATE_CONTINUOUS_CONTENT: 'UPDATE_CONTINUOUS_CONTENT',\r\n  UPDATE_PAGE_BOUNDARIES: 'UPDATE_PAGE_BOUNDARIES',\r\n  ADD_PAGE_BREAK: 'ADD_PAGE_BREAK',\r\n  REMOVE_PAGE_BREAK: 'REMOVE_PAGE_BREAK',\r\n  SET_EDITOR_MODE: 'SET_EDITOR_MODE',\r\n  INSERT_PAGE_AT: 'INSERT_PAGE_AT',\r\n  MOVE_PAGE_TO: 'MOVE_PAGE_TO',\r\n  DUPLICATE_PAGE: 'DUPLICATE_PAGE',\r\n  SET_ZOOM_LEVEL: 'SET_ZOOM_LEVEL',\r\n  ZOOM_IN: 'ZOOM_IN',\r\n  ZOOM_OUT: 'ZOOM_OUT',\r\n  RESET_ZOOM: 'RESET_ZOOM',\r\n  UPDATE_PAGE_MARGINS: 'UPDATE_PAGE_MARGINS'\r\n};\r\n\r\n// Reducer\r\nconst documentReducer = (state, action) => {\r\n  const now = new Date().toISOString();\r\n\r\n  switch (action.type) {\r\n    case ActionTypes.INITIALIZE_DOCUMENT: {\r\n      const { initialContent = EMPTY_PARAGRAPH, pageSize = DEFAULT_PAGE_SIZE } = action.payload || {};\r\n      const page = { ...createEmptyPage(0, pageSize), content: sanitizeContent(initialContent) };\r\n      return buildInitialState({\r\n        title: state.title,\r\n        pageSize,\r\n        pages: [page]\r\n      });\r\n    }\r\n\r\n    case ActionTypes.UPDATE_TITLE:\r\n      return {\r\n        ...state,\r\n        title: action.payload,\r\n        updatedAt: now\r\n      };\r\n\r\n    case ActionTypes.UPDATE_PAGE_CONTENT: {\r\n      const { pageIndex, content } = action.payload;\r\n      if (pageIndex < 0 || pageIndex >= state.pages.length) {\r\n        return state;\r\n      }\r\n\r\n      const newPages = [...state.pages];\r\n      newPages[pageIndex] = {\r\n        ...newPages[pageIndex],\r\n        content: sanitizeContent(content)\r\n      };\r\n\r\n      return {\r\n        ...state,\r\n        pages: newPages,\r\n        updatedAt: now\r\n      };\r\n    }\r\n\r\n    case ActionTypes.UPDATE_PAGES: {\r\n      const payload = Array.isArray(action.payload)\r\n        ? { pages: action.payload }\r\n        : action.payload || {};\r\n\r\n      const nextPages = withMinimumPage(payload.pages || [], state.pageSize);\r\n      const pageBreaks = Array.isArray(payload.pageBreaks)\r\n        ? payload.pageBreaks\r\n        : nextPages.slice(0, -1).map((_, index) => ({\r\n            id: `auto-break-${index}`,\r\n            pageNumber: index + 1\r\n          }));\r\n\r\n      return {\r\n        ...state,\r\n        pages: nextPages,\r\n        activePage: Math.min(state.activePage, nextPages.length - 1),\r\n        pageBreaks,\r\n        totalPages: nextPages.length,\r\n        updatedAt: now\r\n      };\r\n    }\r\n\r\n    case ActionTypes.ADD_PAGE: {\r\n      const insertIndex = typeof action.payload?.index === 'number'\r\n        ? Math.min(Math.max(action.payload.index, 0), state.pages.length)\r\n        : state.pages.length;\r\n\r\n      const newPages = [...state.pages];\r\n      newPages.splice(insertIndex, 0, createEmptyPage(insertIndex, state.pageSize));\r\n      \r\n      const updatedPages = newPages.map((page, index) => ({\r\n        ...page,\r\n        index,\r\n        size: state.pageSize\r\n      }));\r\n\r\n      const pageBreaks = updatedPages.slice(0, -1).map((_, index) => ({\r\n        id: `auto-break-${index}`,\r\n        pageNumber: index + 1\r\n      }));\r\n\r\n      return {\r\n        ...state,\r\n        pages: updatedPages,\r\n        activePage: insertIndex,\r\n        pageBreaks,\r\n        totalPages: updatedPages.length,\r\n        updatedAt: now\r\n      };\r\n    }\r\n\r\n    case ActionTypes.DELETE_PAGE: {\r\n      const pageIndex = action.payload;\r\n      if (state.pages.length <= 1) {\r\n        return state;\r\n      }\r\n\r\n      const newPages = [...state.pages];\r\n      newPages.splice(pageIndex, 1);\r\n      \r\n      const updatedPages = newPages.map((page, index) => ({\r\n        ...page,\r\n        index,\r\n        size: state.pageSize\r\n      }));\r\n\r\n      let newActivePage = state.activePage;\r\n      if (newActivePage >= updatedPages.length) {\r\n        newActivePage = updatedPages.length - 1;\r\n      } else if (pageIndex <= newActivePage && newActivePage > 0) {\r\n        newActivePage -= 1;\r\n      }\r\n\r\n      const pageBreaks = updatedPages.slice(0, -1).map((_, index) => ({\r\n        id: `auto-break-${index}`,\r\n        pageNumber: index + 1\r\n      }));\r\n\r\n      return {\r\n        ...state,\r\n        pages: updatedPages,\r\n        activePage: newActivePage,\r\n        pageBreaks,\r\n        totalPages: updatedPages.length,\r\n        updatedAt: now\r\n      };\r\n    }\r\n\r\n    case ActionTypes.SET_ACTIVE_PAGE: {\r\n      const pageIndex = action.payload;\r\n      \r\n      // Early exit if same page\r\n      if (pageIndex === state.activePage) {\r\n        return state;\r\n      }\r\n      \r\n      const maxPage = state.editorMode === 'continuous' \r\n        ? state.pageBoundaries.length \r\n        : state.pages.length;\r\n      \r\n      // Validate page index\r\n      if (pageIndex < 0 || pageIndex >= maxPage) {\r\n        return state;\r\n      }\r\n      \r\n      return {\r\n        ...state,\r\n        activePage: pageIndex,\r\n        updatedAt: now\r\n      };\r\n    }\r\n\r\n    case ActionTypes.UPDATE_PAGE_SIZE: {\r\n      const newSize = action.payload;\r\n      \r\n      // Early exit if size hasn't changed\r\n      if (newSize === state.pageSize) {\r\n        return state;\r\n      }\r\n      \r\n      // Validate page size using getPageDimensions\r\n      try {\r\n        getPageDimensions(newSize);\r\n      } catch {\r\n        console.warn(`Invalid page size: ${newSize}`);\r\n        return state;\r\n      }\r\n      \r\n      const updatedPages = state.pages.map((page, index) => ({\r\n        ...page,\r\n        index,\r\n        size: newSize\r\n      }));\r\n\r\n      const pageBreaks = updatedPages.slice(0, -1).map((_, index) => ({\r\n        id: `auto-break-${index}`,\r\n        pageNumber: index + 1\r\n      }));\r\n\r\n      return {\r\n        ...state,\r\n        pageSize: newSize,\r\n        pages: updatedPages,\r\n        pageBreaks,\r\n        updatedAt: now\r\n      };\r\n    }\r\n\r\n    case ActionTypes.RESET_DOCUMENT:\r\n      return buildInitialState();\r\n\r\n    case ActionTypes.UPDATE_CONTINUOUS_CONTENT: {\r\n      const newContent = sanitizeContent(action.payload);\r\n      // Early exit if content hasn't changed\r\n      if (newContent === state.continuousContent) {\r\n        return state;\r\n      }\r\n      return {\r\n        ...state,\r\n        continuousContent: newContent,\r\n        updatedAt: now\r\n      };\r\n    }\r\n\r\n    case ActionTypes.UPDATE_PAGE_BOUNDARIES: {\r\n      const boundaries = Array.isArray(action.payload) ? action.payload : [];\r\n      \r\n      // Early exit if boundaries haven't changed (deep comparison on length and first/last)\r\n      if (boundaries.length === state.pageBoundaries.length && \r\n          boundaries.length > 0 &&\r\n          boundaries[0].id === state.pageBoundaries[0]?.id &&\r\n          boundaries[boundaries.length - 1].id === state.pageBoundaries[boundaries.length - 1]?.id) {\r\n        return state;\r\n      }\r\n      \r\n      const newActivePage = state.activePage >= boundaries.length \r\n        ? Math.max(0, boundaries.length - 1)\r\n        : state.activePage;\r\n\r\n      return {\r\n        ...state,\r\n        pageBoundaries: boundaries,\r\n        totalPages: boundaries.length,\r\n        activePage: newActivePage,\r\n        updatedAt: now\r\n      };\r\n    }\r\n\r\n    case ActionTypes.ADD_PAGE_BREAK: {\r\n      const { position = 'end', pageIndex } = action.payload || {};\r\n      const pageBreakTag = '<page-break data-page-break=\"true\" style=\"display: block; height: 20px; border-top: 2px dashed #ccc; margin: 20px 0; page-break-after: always;\"></page-break>';\r\n      \r\n      let newContent = state.continuousContent;\r\n\r\n      if (position === 'end') {\r\n        newContent = newContent + pageBreakTag + '<p><br></p>';\r\n      } else if (typeof position === 'number') {\r\n        const before = newContent.substring(0, position);\r\n        const after = newContent.substring(position);\r\n        newContent = before + pageBreakTag + after;\r\n      } else if (typeof pageIndex === 'number' && typeof document !== 'undefined') {\r\n        const tempDiv = document.createElement('div');\r\n        tempDiv.innerHTML = newContent;\r\n        \r\n        const pageBreaks = tempDiv.querySelectorAll('page-break, [data-page-break=\"true\"]');\r\n        \r\n        if (pageIndex === 0 && pageBreaks.length === 0) {\r\n          newContent = newContent + pageBreakTag + '<p><br></p>';\r\n        } else if (pageIndex < pageBreaks.length) {\r\n          const targetBreak = pageBreaks[pageIndex];\r\n          const newBreak = document.createElement('page-break');\r\n          newBreak.setAttribute('data-page-break', 'true');\r\n          newBreak.setAttribute('style', 'display: block; height: 20px; border-top: 2px dashed #ccc; margin: 20px 0; page-break-after: always;');\r\n          \r\n          const newParagraph = document.createElement('p');\r\n          newParagraph.innerHTML = '<br>';\r\n          \r\n          targetBreak.parentNode.insertBefore(newBreak, targetBreak.nextSibling);\r\n          newBreak.parentNode.insertBefore(newParagraph, newBreak.nextSibling);\r\n          \r\n          newContent = tempDiv.innerHTML;\r\n        } else {\r\n          newContent = newContent + pageBreakTag + '<p><br></p>';\r\n        }\r\n      }\r\n      \r\n      return {\r\n        ...state,\r\n        continuousContent: newContent,\r\n        updatedAt: now\r\n      };\r\n    }\r\n\r\n    case ActionTypes.REMOVE_PAGE_BREAK: {\r\n      const { pageIndex } = action.payload || {};\r\n      \r\n      if (typeof pageIndex !== 'number' || typeof document === 'undefined') {\r\n        return state;\r\n      }\r\n      \r\n      const tempDiv = document.createElement('div');\r\n      tempDiv.innerHTML = state.continuousContent;\r\n      \r\n      const pageBreaks = tempDiv.querySelectorAll('page-break, [data-page-break=\"true\"]');\r\n      \r\n      if (pageBreaks[pageIndex]) {\r\n        pageBreaks[pageIndex].remove();\r\n      }\r\n      \r\n      const remainingBreaks = tempDiv.querySelectorAll('page-break, [data-page-break=\"true\"]');\r\n      remainingBreaks.forEach((breakEl, index) => {\r\n        breakEl.setAttribute('data-page-number', String(index + 2));\r\n      });\r\n      \r\n      return {\r\n        ...state,\r\n        continuousContent: tempDiv.innerHTML,\r\n        updatedAt: now\r\n      };\r\n    }\r\n\r\n    case ActionTypes.SET_EDITOR_MODE: {\r\n      const newMode = action.payload;\r\n      if (newMode === state.editorMode) {\r\n        return state;\r\n      }\r\n\r\n      let newContent = state.continuousContent;\r\n      let newPages = state.pages;\r\n\r\n      if (newMode === 'continuous') {\r\n        const allContent = state.pages\r\n          .map(page => page.content)\r\n          .filter(content => content && content !== EMPTY_PARAGRAPH)\r\n          .join('\\n');\r\n        newContent = allContent || EMPTY_PARAGRAPH;\r\n      } else {\r\n        if (state.continuousContent && state.continuousContent !== EMPTY_PARAGRAPH) {\r\n          newPages = [{ ...createEmptyPage(0, state.pageSize), content: state.continuousContent }];\r\n        }\r\n      }\r\n      \r\n      return {\r\n        ...state,\r\n        editorMode: newMode,\r\n        continuousContent: newContent,\r\n        pages: newPages,\r\n        updatedAt: now\r\n      };\r\n    }\r\n\r\n    case ActionTypes.SET_ZOOM_LEVEL: {\r\n      const newZoomLevel = action.payload;\r\n      \r\n      // Validate zoom level is within bounds\r\n      if (newZoomLevel < MIN_ZOOM || newZoomLevel > MAX_ZOOM) {\r\n        console.warn(`Invalid zoom level: ${newZoomLevel}. Must be between ${MIN_ZOOM} and ${MAX_ZOOM}.`);\r\n        return state;\r\n      }\r\n      \r\n      // Early exit if zoom hasn't changed\r\n      if (newZoomLevel === state.zoomLevel) {\r\n        return state;\r\n      }\r\n      \r\n      return {\r\n        ...state,\r\n        zoomLevel: newZoomLevel,\r\n        updatedAt: now\r\n      };\r\n    }\r\n\r\n    case ActionTypes.ZOOM_IN: {\r\n      if (!checkCanZoomIn(state.zoomLevel)) {\r\n        return state;\r\n      }\r\n      \r\n      const newZoomLevel = state.zoomLevel + ZOOM_STEP;\r\n      return {\r\n        ...state,\r\n        zoomLevel: newZoomLevel,\r\n        updatedAt: now\r\n      };\r\n    }\r\n\r\n    case ActionTypes.ZOOM_OUT: {\r\n      if (!checkCanZoomOut(state.zoomLevel)) {\r\n        return state;\r\n      }\r\n      \r\n      const newZoomLevel = state.zoomLevel - ZOOM_STEP;\r\n      return {\r\n        ...state,\r\n        zoomLevel: newZoomLevel,\r\n        updatedAt: now\r\n      };\r\n    }\r\n\r\n    case ActionTypes.RESET_ZOOM: {\r\n      if (state.zoomLevel === DEFAULT_ZOOM) {\r\n        return state;\r\n      }\r\n      \r\n      return {\r\n        ...state,\r\n        zoomLevel: DEFAULT_ZOOM,\r\n        updatedAt: now\r\n      };\r\n    }\r\n\r\n    case ActionTypes.UPDATE_PAGE_MARGINS: {\r\n      const newMargins = action.payload;\r\n      \r\n      // Early exit if margins haven't changed\r\n      if (newMargins === state.pageMargins) {\r\n        return state;\r\n      }\r\n      \r\n      return {\r\n        ...state,\r\n        pageMargins: newMargins,\r\n        updatedAt: now\r\n      };\r\n    }\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\n// Context\r\nconst DocumentContext = createContext(null);\r\n\r\n// Provider Component\r\nexport const DocumentProvider = ({ children, initialState = {} }) => {\r\n  const [state, dispatch] = useReducer(documentReducer, buildInitialState(initialState));\r\n\r\n  // Action creators wrapped in useCallback for performance\r\n  const actions = useMemo(() => ({\r\n    initializeDocument: (payload) => dispatch({ type: ActionTypes.INITIALIZE_DOCUMENT, payload }),\r\n    updateTitle: (title) => dispatch({ type: ActionTypes.UPDATE_TITLE, payload: title }),\r\n    updatePageContent: (payload) => dispatch({ type: ActionTypes.UPDATE_PAGE_CONTENT, payload }),\r\n    updatePages: (payload) => dispatch({ type: ActionTypes.UPDATE_PAGES, payload }),\r\n    addPage: (payload) => dispatch({ type: ActionTypes.ADD_PAGE, payload }),\r\n    deletePage: (pageIndex) => dispatch({ type: ActionTypes.DELETE_PAGE, payload: pageIndex }),\r\n    setActivePage: (pageIndex) => dispatch({ type: ActionTypes.SET_ACTIVE_PAGE, payload: pageIndex }),\r\n    updatePageSize: (size) => dispatch({ type: ActionTypes.UPDATE_PAGE_SIZE, payload: size }),\r\n    resetDocument: () => dispatch({ type: ActionTypes.RESET_DOCUMENT }),\r\n    updateContinuousContent: (content) => dispatch({ type: ActionTypes.UPDATE_CONTINUOUS_CONTENT, payload: content }),\r\n    updatePageBoundaries: (boundaries) => dispatch({ type: ActionTypes.UPDATE_PAGE_BOUNDARIES, payload: boundaries }),\r\n    addPageBreak: (payload) => dispatch({ type: ActionTypes.ADD_PAGE_BREAK, payload }),\r\n    removePageBreak: (payload) => dispatch({ type: ActionTypes.REMOVE_PAGE_BREAK, payload }),\r\n    setEditorMode: (mode) => dispatch({ type: ActionTypes.SET_EDITOR_MODE, payload: mode }),\r\n    insertPageAt: (payload) => dispatch({ type: ActionTypes.INSERT_PAGE_AT, payload }),\r\n    movePageTo: (payload) => dispatch({ type: ActionTypes.MOVE_PAGE_TO, payload }),\r\n    duplicatePage: (payload) => dispatch({ type: ActionTypes.DUPLICATE_PAGE, payload }),\r\n    setZoomLevel: (level) => dispatch({ type: ActionTypes.SET_ZOOM_LEVEL, payload: level }),\r\n    zoomIn: () => dispatch({ type: ActionTypes.ZOOM_IN }),\r\n    zoomOut: () => dispatch({ type: ActionTypes.ZOOM_OUT }),\r\n    resetZoom: () => dispatch({ type: ActionTypes.RESET_ZOOM }),\r\n    updatePageMargins: (margins) => dispatch({ type: ActionTypes.UPDATE_PAGE_MARGINS, payload: margins })\r\n  }), []);\r\n\r\n  const value = useMemo(() => ({\r\n    state,\r\n    actions,\r\n    dispatch\r\n  }), [state, actions]);\r\n\r\n  return (\r\n    <DocumentContext.Provider value={value}>\r\n      {children}\r\n    </DocumentContext.Provider>\r\n  );\r\n};\r\n\r\n// Custom hook to use document context\r\nexport const useDocument = () => {\r\n  const context = useContext(DocumentContext);\r\n  if (!context) {\r\n    throw new Error('useDocument must be used within a DocumentProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\n// Selector hooks for specific state values\r\nexport const useDocumentState = () => {\r\n  const { state } = useDocument();\r\n  return state;\r\n};\r\n\r\nexport const useDocumentActions = () => {\r\n  const { actions } = useDocument();\r\n  return actions;\r\n};\r\n\r\nexport default DocumentContext;\r\n","/** @license React v16.13.1\n * react-is.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';var b=\"function\"===typeof Symbol&&Symbol.for,c=b?Symbol.for(\"react.element\"):60103,d=b?Symbol.for(\"react.portal\"):60106,e=b?Symbol.for(\"react.fragment\"):60107,f=b?Symbol.for(\"react.strict_mode\"):60108,g=b?Symbol.for(\"react.profiler\"):60114,h=b?Symbol.for(\"react.provider\"):60109,k=b?Symbol.for(\"react.context\"):60110,l=b?Symbol.for(\"react.async_mode\"):60111,m=b?Symbol.for(\"react.concurrent_mode\"):60111,n=b?Symbol.for(\"react.forward_ref\"):60112,p=b?Symbol.for(\"react.suspense\"):60113,q=b?\nSymbol.for(\"react.suspense_list\"):60120,r=b?Symbol.for(\"react.memo\"):60115,t=b?Symbol.for(\"react.lazy\"):60116,v=b?Symbol.for(\"react.block\"):60121,w=b?Symbol.for(\"react.fundamental\"):60117,x=b?Symbol.for(\"react.responder\"):60118,y=b?Symbol.for(\"react.scope\"):60119;\nfunction z(a){if(\"object\"===typeof a&&null!==a){var u=a.$$typeof;switch(u){case c:switch(a=a.type,a){case l:case m:case e:case g:case f:case p:return a;default:switch(a=a&&a.$$typeof,a){case k:case n:case t:case r:case h:return a;default:return u}}case d:return u}}}function A(a){return z(a)===m}exports.AsyncMode=l;exports.ConcurrentMode=m;exports.ContextConsumer=k;exports.ContextProvider=h;exports.Element=c;exports.ForwardRef=n;exports.Fragment=e;exports.Lazy=t;exports.Memo=r;exports.Portal=d;\nexports.Profiler=g;exports.StrictMode=f;exports.Suspense=p;exports.isAsyncMode=function(a){return A(a)||z(a)===l};exports.isConcurrentMode=A;exports.isContextConsumer=function(a){return z(a)===k};exports.isContextProvider=function(a){return z(a)===h};exports.isElement=function(a){return\"object\"===typeof a&&null!==a&&a.$$typeof===c};exports.isForwardRef=function(a){return z(a)===n};exports.isFragment=function(a){return z(a)===e};exports.isLazy=function(a){return z(a)===t};\nexports.isMemo=function(a){return z(a)===r};exports.isPortal=function(a){return z(a)===d};exports.isProfiler=function(a){return z(a)===g};exports.isStrictMode=function(a){return z(a)===f};exports.isSuspense=function(a){return z(a)===p};\nexports.isValidElementType=function(a){return\"string\"===typeof a||\"function\"===typeof a||a===e||a===m||a===g||a===f||a===p||a===q||\"object\"===typeof a&&null!==a&&(a.$$typeof===t||a.$$typeof===r||a.$$typeof===h||a.$$typeof===k||a.$$typeof===n||a.$$typeof===w||a.$$typeof===x||a.$$typeof===y||a.$$typeof===v)};exports.typeOf=z;\n","/** @license React v16.13.1\n * react-is.development.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\n\n\nif (process.env.NODE_ENV !== \"production\") {\n  (function() {\n'use strict';\n\n// The Symbol used to tag the ReactElement-like types. If there is no native Symbol\n// nor polyfill, then a plain number is used for performance.\nvar hasSymbol = typeof Symbol === 'function' && Symbol.for;\nvar REACT_ELEMENT_TYPE = hasSymbol ? Symbol.for('react.element') : 0xeac7;\nvar REACT_PORTAL_TYPE = hasSymbol ? Symbol.for('react.portal') : 0xeaca;\nvar REACT_FRAGMENT_TYPE = hasSymbol ? Symbol.for('react.fragment') : 0xeacb;\nvar REACT_STRICT_MODE_TYPE = hasSymbol ? Symbol.for('react.strict_mode') : 0xeacc;\nvar REACT_PROFILER_TYPE = hasSymbol ? Symbol.for('react.profiler') : 0xead2;\nvar REACT_PROVIDER_TYPE = hasSymbol ? Symbol.for('react.provider') : 0xeacd;\nvar REACT_CONTEXT_TYPE = hasSymbol ? Symbol.for('react.context') : 0xeace; // TODO: We don't use AsyncMode or ConcurrentMode anymore. They were temporary\n// (unstable) APIs that have been removed. Can we remove the symbols?\n\nvar REACT_ASYNC_MODE_TYPE = hasSymbol ? Symbol.for('react.async_mode') : 0xeacf;\nvar REACT_CONCURRENT_MODE_TYPE = hasSymbol ? Symbol.for('react.concurrent_mode') : 0xeacf;\nvar REACT_FORWARD_REF_TYPE = hasSymbol ? Symbol.for('react.forward_ref') : 0xead0;\nvar REACT_SUSPENSE_TYPE = hasSymbol ? Symbol.for('react.suspense') : 0xead1;\nvar REACT_SUSPENSE_LIST_TYPE = hasSymbol ? Symbol.for('react.suspense_list') : 0xead8;\nvar REACT_MEMO_TYPE = hasSymbol ? Symbol.for('react.memo') : 0xead3;\nvar REACT_LAZY_TYPE = hasSymbol ? Symbol.for('react.lazy') : 0xead4;\nvar REACT_BLOCK_TYPE = hasSymbol ? Symbol.for('react.block') : 0xead9;\nvar REACT_FUNDAMENTAL_TYPE = hasSymbol ? Symbol.for('react.fundamental') : 0xead5;\nvar REACT_RESPONDER_TYPE = hasSymbol ? Symbol.for('react.responder') : 0xead6;\nvar REACT_SCOPE_TYPE = hasSymbol ? Symbol.for('react.scope') : 0xead7;\n\nfunction isValidElementType(type) {\n  return typeof type === 'string' || typeof type === 'function' || // Note: its typeof might be other than 'symbol' or 'number' if it's a polyfill.\n  type === REACT_FRAGMENT_TYPE || type === REACT_CONCURRENT_MODE_TYPE || type === REACT_PROFILER_TYPE || type === REACT_STRICT_MODE_TYPE || type === REACT_SUSPENSE_TYPE || type === REACT_SUSPENSE_LIST_TYPE || typeof type === 'object' && type !== null && (type.$$typeof === REACT_LAZY_TYPE || type.$$typeof === REACT_MEMO_TYPE || type.$$typeof === REACT_PROVIDER_TYPE || type.$$typeof === REACT_CONTEXT_TYPE || type.$$typeof === REACT_FORWARD_REF_TYPE || type.$$typeof === REACT_FUNDAMENTAL_TYPE || type.$$typeof === REACT_RESPONDER_TYPE || type.$$typeof === REACT_SCOPE_TYPE || type.$$typeof === REACT_BLOCK_TYPE);\n}\n\nfunction typeOf(object) {\n  if (typeof object === 'object' && object !== null) {\n    var $$typeof = object.$$typeof;\n\n    switch ($$typeof) {\n      case REACT_ELEMENT_TYPE:\n        var type = object.type;\n\n        switch (type) {\n          case REACT_ASYNC_MODE_TYPE:\n          case REACT_CONCURRENT_MODE_TYPE:\n          case REACT_FRAGMENT_TYPE:\n          case REACT_PROFILER_TYPE:\n          case REACT_STRICT_MODE_TYPE:\n          case REACT_SUSPENSE_TYPE:\n            return type;\n\n          default:\n            var $$typeofType = type && type.$$typeof;\n\n            switch ($$typeofType) {\n              case REACT_CONTEXT_TYPE:\n              case REACT_FORWARD_REF_TYPE:\n              case REACT_LAZY_TYPE:\n              case REACT_MEMO_TYPE:\n              case REACT_PROVIDER_TYPE:\n                return $$typeofType;\n\n              default:\n                return $$typeof;\n            }\n\n        }\n\n      case REACT_PORTAL_TYPE:\n        return $$typeof;\n    }\n  }\n\n  return undefined;\n} // AsyncMode is deprecated along with isAsyncMode\n\nvar AsyncMode = REACT_ASYNC_MODE_TYPE;\nvar ConcurrentMode = REACT_CONCURRENT_MODE_TYPE;\nvar ContextConsumer = REACT_CONTEXT_TYPE;\nvar ContextProvider = REACT_PROVIDER_TYPE;\nvar Element = REACT_ELEMENT_TYPE;\nvar ForwardRef = REACT_FORWARD_REF_TYPE;\nvar Fragment = REACT_FRAGMENT_TYPE;\nvar Lazy = REACT_LAZY_TYPE;\nvar Memo = REACT_MEMO_TYPE;\nvar Portal = REACT_PORTAL_TYPE;\nvar Profiler = REACT_PROFILER_TYPE;\nvar StrictMode = REACT_STRICT_MODE_TYPE;\nvar Suspense = REACT_SUSPENSE_TYPE;\nvar hasWarnedAboutDeprecatedIsAsyncMode = false; // AsyncMode should be deprecated\n\nfunction isAsyncMode(object) {\n  {\n    if (!hasWarnedAboutDeprecatedIsAsyncMode) {\n      hasWarnedAboutDeprecatedIsAsyncMode = true; // Using console['warn'] to evade Babel and ESLint\n\n      console['warn']('The ReactIs.isAsyncMode() alias has been deprecated, ' + 'and will be removed in React 17+. Update your code to use ' + 'ReactIs.isConcurrentMode() instead. It has the exact same API.');\n    }\n  }\n\n  return isConcurrentMode(object) || typeOf(object) === REACT_ASYNC_MODE_TYPE;\n}\nfunction isConcurrentMode(object) {\n  return typeOf(object) === REACT_CONCURRENT_MODE_TYPE;\n}\nfunction isContextConsumer(object) {\n  return typeOf(object) === REACT_CONTEXT_TYPE;\n}\nfunction isContextProvider(object) {\n  return typeOf(object) === REACT_PROVIDER_TYPE;\n}\nfunction isElement(object) {\n  return typeof object === 'object' && object !== null && object.$$typeof === REACT_ELEMENT_TYPE;\n}\nfunction isForwardRef(object) {\n  return typeOf(object) === REACT_FORWARD_REF_TYPE;\n}\nfunction isFragment(object) {\n  return typeOf(object) === REACT_FRAGMENT_TYPE;\n}\nfunction isLazy(object) {\n  return typeOf(object) === REACT_LAZY_TYPE;\n}\nfunction isMemo(object) {\n  return typeOf(object) === REACT_MEMO_TYPE;\n}\nfunction isPortal(object) {\n  return typeOf(object) === REACT_PORTAL_TYPE;\n}\nfunction isProfiler(object) {\n  return typeOf(object) === REACT_PROFILER_TYPE;\n}\nfunction isStrictMode(object) {\n  return typeOf(object) === REACT_STRICT_MODE_TYPE;\n}\nfunction isSuspense(object) {\n  return typeOf(object) === REACT_SUSPENSE_TYPE;\n}\n\nexports.AsyncMode = AsyncMode;\nexports.ConcurrentMode = ConcurrentMode;\nexports.ContextConsumer = ContextConsumer;\nexports.ContextProvider = ContextProvider;\nexports.Element = Element;\nexports.ForwardRef = ForwardRef;\nexports.Fragment = Fragment;\nexports.Lazy = Lazy;\nexports.Memo = Memo;\nexports.Portal = Portal;\nexports.Profiler = Profiler;\nexports.StrictMode = StrictMode;\nexports.Suspense = Suspense;\nexports.isAsyncMode = isAsyncMode;\nexports.isConcurrentMode = isConcurrentMode;\nexports.isContextConsumer = isContextConsumer;\nexports.isContextProvider = isContextProvider;\nexports.isElement = isElement;\nexports.isForwardRef = isForwardRef;\nexports.isFragment = isFragment;\nexports.isLazy = isLazy;\nexports.isMemo = isMemo;\nexports.isPortal = isPortal;\nexports.isProfiler = isProfiler;\nexports.isStrictMode = isStrictMode;\nexports.isSuspense = isSuspense;\nexports.isValidElementType = isValidElementType;\nexports.typeOf = typeOf;\n  })();\n}\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-is.production.min.js');\n} else {\n  module.exports = require('./cjs/react-is.development.js');\n}\n","/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n\nmodule.exports = ReactPropTypesSecret;\n","module.exports = Function.call.bind(Object.prototype.hasOwnProperty);\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar printWarning = function() {};\n\nif (process.env.NODE_ENV !== 'production') {\n  var ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\n  var loggedTypeFailures = {};\n  var has = require('./lib/has');\n\n  printWarning = function(text) {\n    var message = 'Warning: ' + text;\n    if (typeof console !== 'undefined') {\n      console.error(message);\n    }\n    try {\n      // --- Welcome to debugging React ---\n      // This error was thrown as a convenience so that you can use this stack\n      // to find the callsite that caused this warning to fire.\n      throw new Error(message);\n    } catch (x) { /**/ }\n  };\n}\n\n/**\n * Assert that the values match with the type specs.\n * Error messages are memorized and will only be shown once.\n *\n * @param {object} typeSpecs Map of name to a ReactPropType\n * @param {object} values Runtime values that need to be type-checked\n * @param {string} location e.g. \"prop\", \"context\", \"child context\"\n * @param {string} componentName Name of the component for error messages.\n * @param {?Function} getStack Returns the component stack.\n * @private\n */\nfunction checkPropTypes(typeSpecs, values, location, componentName, getStack) {\n  if (process.env.NODE_ENV !== 'production') {\n    for (var typeSpecName in typeSpecs) {\n      if (has(typeSpecs, typeSpecName)) {\n        var error;\n        // Prop type validation may throw. In case they do, we don't want to\n        // fail the render phase where it didn't fail before. So we log it.\n        // After these have been cleaned up, we'll let them throw.\n        try {\n          // This is intentionally an invariant that gets caught. It's the same\n          // behavior as without this statement except with a better message.\n          if (typeof typeSpecs[typeSpecName] !== 'function') {\n            var err = Error(\n              (componentName || 'React class') + ': ' + location + ' type `' + typeSpecName + '` is invalid; ' +\n              'it must be a function, usually from the `prop-types` package, but received `' + typeof typeSpecs[typeSpecName] + '`.' +\n              'This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.'\n            );\n            err.name = 'Invariant Violation';\n            throw err;\n          }\n          error = typeSpecs[typeSpecName](values, typeSpecName, componentName, location, null, ReactPropTypesSecret);\n        } catch (ex) {\n          error = ex;\n        }\n        if (error && !(error instanceof Error)) {\n          printWarning(\n            (componentName || 'React class') + ': type specification of ' +\n            location + ' `' + typeSpecName + '` is invalid; the type checker ' +\n            'function must return `null` or an `Error` but returned a ' + typeof error + '. ' +\n            'You may have forgotten to pass an argument to the type checker ' +\n            'creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and ' +\n            'shape all require an argument).'\n          );\n        }\n        if (error instanceof Error && !(error.message in loggedTypeFailures)) {\n          // Only monitor this failure once because there tends to be a lot of the\n          // same error.\n          loggedTypeFailures[error.message] = true;\n\n          var stack = getStack ? getStack() : '';\n\n          printWarning(\n            'Failed ' + location + ' type: ' + error.message + (stack != null ? stack : '')\n          );\n        }\n      }\n    }\n  }\n}\n\n/**\n * Resets warning cache when testing.\n *\n * @private\n */\ncheckPropTypes.resetWarningCache = function() {\n  if (process.env.NODE_ENV !== 'production') {\n    loggedTypeFailures = {};\n  }\n}\n\nmodule.exports = checkPropTypes;\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactIs = require('react-is');\nvar assign = require('object-assign');\n\nvar ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\nvar has = require('./lib/has');\nvar checkPropTypes = require('./checkPropTypes');\n\nvar printWarning = function() {};\n\nif (process.env.NODE_ENV !== 'production') {\n  printWarning = function(text) {\n    var message = 'Warning: ' + text;\n    if (typeof console !== 'undefined') {\n      console.error(message);\n    }\n    try {\n      // --- Welcome to debugging React ---\n      // This error was thrown as a convenience so that you can use this stack\n      // to find the callsite that caused this warning to fire.\n      throw new Error(message);\n    } catch (x) {}\n  };\n}\n\nfunction emptyFunctionThatReturnsNull() {\n  return null;\n}\n\nmodule.exports = function(isValidElement, throwOnDirectAccess) {\n  /* global Symbol */\n  var ITERATOR_SYMBOL = typeof Symbol === 'function' && Symbol.iterator;\n  var FAUX_ITERATOR_SYMBOL = '@@iterator'; // Before Symbol spec.\n\n  /**\n   * Returns the iterator method function contained on the iterable object.\n   *\n   * Be sure to invoke the function with the iterable as context:\n   *\n   *     var iteratorFn = getIteratorFn(myIterable);\n   *     if (iteratorFn) {\n   *       var iterator = iteratorFn.call(myIterable);\n   *       ...\n   *     }\n   *\n   * @param {?object} maybeIterable\n   * @return {?function}\n   */\n  function getIteratorFn(maybeIterable) {\n    var iteratorFn = maybeIterable && (ITERATOR_SYMBOL && maybeIterable[ITERATOR_SYMBOL] || maybeIterable[FAUX_ITERATOR_SYMBOL]);\n    if (typeof iteratorFn === 'function') {\n      return iteratorFn;\n    }\n  }\n\n  /**\n   * Collection of methods that allow declaration and validation of props that are\n   * supplied to React components. Example usage:\n   *\n   *   var Props = require('ReactPropTypes');\n   *   var MyArticle = React.createClass({\n   *     propTypes: {\n   *       // An optional string prop named \"description\".\n   *       description: Props.string,\n   *\n   *       // A required enum prop named \"category\".\n   *       category: Props.oneOf(['News','Photos']).isRequired,\n   *\n   *       // A prop named \"dialog\" that requires an instance of Dialog.\n   *       dialog: Props.instanceOf(Dialog).isRequired\n   *     },\n   *     render: function() { ... }\n   *   });\n   *\n   * A more formal specification of how these methods are used:\n   *\n   *   type := array|bool|func|object|number|string|oneOf([...])|instanceOf(...)\n   *   decl := ReactPropTypes.{type}(.isRequired)?\n   *\n   * Each and every declaration produces a function with the same signature. This\n   * allows the creation of custom validation functions. For example:\n   *\n   *  var MyLink = React.createClass({\n   *    propTypes: {\n   *      // An optional string or URI prop named \"href\".\n   *      href: function(props, propName, componentName) {\n   *        var propValue = props[propName];\n   *        if (propValue != null && typeof propValue !== 'string' &&\n   *            !(propValue instanceof URI)) {\n   *          return new Error(\n   *            'Expected a string or an URI for ' + propName + ' in ' +\n   *            componentName\n   *          );\n   *        }\n   *      }\n   *    },\n   *    render: function() {...}\n   *  });\n   *\n   * @internal\n   */\n\n  var ANONYMOUS = '<<anonymous>>';\n\n  // Important!\n  // Keep this list in sync with production version in `./factoryWithThrowingShims.js`.\n  var ReactPropTypes = {\n    array: createPrimitiveTypeChecker('array'),\n    bigint: createPrimitiveTypeChecker('bigint'),\n    bool: createPrimitiveTypeChecker('boolean'),\n    func: createPrimitiveTypeChecker('function'),\n    number: createPrimitiveTypeChecker('number'),\n    object: createPrimitiveTypeChecker('object'),\n    string: createPrimitiveTypeChecker('string'),\n    symbol: createPrimitiveTypeChecker('symbol'),\n\n    any: createAnyTypeChecker(),\n    arrayOf: createArrayOfTypeChecker,\n    element: createElementTypeChecker(),\n    elementType: createElementTypeTypeChecker(),\n    instanceOf: createInstanceTypeChecker,\n    node: createNodeChecker(),\n    objectOf: createObjectOfTypeChecker,\n    oneOf: createEnumTypeChecker,\n    oneOfType: createUnionTypeChecker,\n    shape: createShapeTypeChecker,\n    exact: createStrictShapeTypeChecker,\n  };\n\n  /**\n   * inlined Object.is polyfill to avoid requiring consumers ship their own\n   * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is\n   */\n  /*eslint-disable no-self-compare*/\n  function is(x, y) {\n    // SameValue algorithm\n    if (x === y) {\n      // Steps 1-5, 7-10\n      // Steps 6.b-6.e: +0 != -0\n      return x !== 0 || 1 / x === 1 / y;\n    } else {\n      // Step 6.a: NaN == NaN\n      return x !== x && y !== y;\n    }\n  }\n  /*eslint-enable no-self-compare*/\n\n  /**\n   * We use an Error-like object for backward compatibility as people may call\n   * PropTypes directly and inspect their output. However, we don't use real\n   * Errors anymore. We don't inspect their stack anyway, and creating them\n   * is prohibitively expensive if they are created too often, such as what\n   * happens in oneOfType() for any type before the one that matched.\n   */\n  function PropTypeError(message, data) {\n    this.message = message;\n    this.data = data && typeof data === 'object' ? data: {};\n    this.stack = '';\n  }\n  // Make `instanceof Error` still work for returned errors.\n  PropTypeError.prototype = Error.prototype;\n\n  function createChainableTypeChecker(validate) {\n    if (process.env.NODE_ENV !== 'production') {\n      var manualPropTypeCallCache = {};\n      var manualPropTypeWarningCount = 0;\n    }\n    function checkType(isRequired, props, propName, componentName, location, propFullName, secret) {\n      componentName = componentName || ANONYMOUS;\n      propFullName = propFullName || propName;\n\n      if (secret !== ReactPropTypesSecret) {\n        if (throwOnDirectAccess) {\n          // New behavior only for users of `prop-types` package\n          var err = new Error(\n            'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +\n            'Use `PropTypes.checkPropTypes()` to call them. ' +\n            'Read more at http://fb.me/use-check-prop-types'\n          );\n          err.name = 'Invariant Violation';\n          throw err;\n        } else if (process.env.NODE_ENV !== 'production' && typeof console !== 'undefined') {\n          // Old behavior for people using React.PropTypes\n          var cacheKey = componentName + ':' + propName;\n          if (\n            !manualPropTypeCallCache[cacheKey] &&\n            // Avoid spamming the console because they are often not actionable except for lib authors\n            manualPropTypeWarningCount < 3\n          ) {\n            printWarning(\n              'You are manually calling a React.PropTypes validation ' +\n              'function for the `' + propFullName + '` prop on `' + componentName + '`. This is deprecated ' +\n              'and will throw in the standalone `prop-types` package. ' +\n              'You may be seeing this warning due to a third-party PropTypes ' +\n              'library. See https://fb.me/react-warning-dont-call-proptypes ' + 'for details.'\n            );\n            manualPropTypeCallCache[cacheKey] = true;\n            manualPropTypeWarningCount++;\n          }\n        }\n      }\n      if (props[propName] == null) {\n        if (isRequired) {\n          if (props[propName] === null) {\n            return new PropTypeError('The ' + location + ' `' + propFullName + '` is marked as required ' + ('in `' + componentName + '`, but its value is `null`.'));\n          }\n          return new PropTypeError('The ' + location + ' `' + propFullName + '` is marked as required in ' + ('`' + componentName + '`, but its value is `undefined`.'));\n        }\n        return null;\n      } else {\n        return validate(props, propName, componentName, location, propFullName);\n      }\n    }\n\n    var chainedCheckType = checkType.bind(null, false);\n    chainedCheckType.isRequired = checkType.bind(null, true);\n\n    return chainedCheckType;\n  }\n\n  function createPrimitiveTypeChecker(expectedType) {\n    function validate(props, propName, componentName, location, propFullName, secret) {\n      var propValue = props[propName];\n      var propType = getPropType(propValue);\n      if (propType !== expectedType) {\n        // `propValue` being instance of, say, date/regexp, pass the 'object'\n        // check, but we can offer a more precise error message here rather than\n        // 'of type `object`'.\n        var preciseType = getPreciseType(propValue);\n\n        return new PropTypeError(\n          'Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + preciseType + '` supplied to `' + componentName + '`, expected ') + ('`' + expectedType + '`.'),\n          {expectedType: expectedType}\n        );\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createAnyTypeChecker() {\n    return createChainableTypeChecker(emptyFunctionThatReturnsNull);\n  }\n\n  function createArrayOfTypeChecker(typeChecker) {\n    function validate(props, propName, componentName, location, propFullName) {\n      if (typeof typeChecker !== 'function') {\n        return new PropTypeError('Property `' + propFullName + '` of component `' + componentName + '` has invalid PropType notation inside arrayOf.');\n      }\n      var propValue = props[propName];\n      if (!Array.isArray(propValue)) {\n        var propType = getPropType(propValue);\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + propType + '` supplied to `' + componentName + '`, expected an array.'));\n      }\n      for (var i = 0; i < propValue.length; i++) {\n        var error = typeChecker(propValue, i, componentName, location, propFullName + '[' + i + ']', ReactPropTypesSecret);\n        if (error instanceof Error) {\n          return error;\n        }\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createElementTypeChecker() {\n    function validate(props, propName, componentName, location, propFullName) {\n      var propValue = props[propName];\n      if (!isValidElement(propValue)) {\n        var propType = getPropType(propValue);\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + propType + '` supplied to `' + componentName + '`, expected a single ReactElement.'));\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createElementTypeTypeChecker() {\n    function validate(props, propName, componentName, location, propFullName) {\n      var propValue = props[propName];\n      if (!ReactIs.isValidElementType(propValue)) {\n        var propType = getPropType(propValue);\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + propType + '` supplied to `' + componentName + '`, expected a single ReactElement type.'));\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createInstanceTypeChecker(expectedClass) {\n    function validate(props, propName, componentName, location, propFullName) {\n      if (!(props[propName] instanceof expectedClass)) {\n        var expectedClassName = expectedClass.name || ANONYMOUS;\n        var actualClassName = getClassName(props[propName]);\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + actualClassName + '` supplied to `' + componentName + '`, expected ') + ('instance of `' + expectedClassName + '`.'));\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createEnumTypeChecker(expectedValues) {\n    if (!Array.isArray(expectedValues)) {\n      if (process.env.NODE_ENV !== 'production') {\n        if (arguments.length > 1) {\n          printWarning(\n            'Invalid arguments supplied to oneOf, expected an array, got ' + arguments.length + ' arguments. ' +\n            'A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z]).'\n          );\n        } else {\n          printWarning('Invalid argument supplied to oneOf, expected an array.');\n        }\n      }\n      return emptyFunctionThatReturnsNull;\n    }\n\n    function validate(props, propName, componentName, location, propFullName) {\n      var propValue = props[propName];\n      for (var i = 0; i < expectedValues.length; i++) {\n        if (is(propValue, expectedValues[i])) {\n          return null;\n        }\n      }\n\n      var valuesString = JSON.stringify(expectedValues, function replacer(key, value) {\n        var type = getPreciseType(value);\n        if (type === 'symbol') {\n          return String(value);\n        }\n        return value;\n      });\n      return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of value `' + String(propValue) + '` ' + ('supplied to `' + componentName + '`, expected one of ' + valuesString + '.'));\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createObjectOfTypeChecker(typeChecker) {\n    function validate(props, propName, componentName, location, propFullName) {\n      if (typeof typeChecker !== 'function') {\n        return new PropTypeError('Property `' + propFullName + '` of component `' + componentName + '` has invalid PropType notation inside objectOf.');\n      }\n      var propValue = props[propName];\n      var propType = getPropType(propValue);\n      if (propType !== 'object') {\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + propType + '` supplied to `' + componentName + '`, expected an object.'));\n      }\n      for (var key in propValue) {\n        if (has(propValue, key)) {\n          var error = typeChecker(propValue, key, componentName, location, propFullName + '.' + key, ReactPropTypesSecret);\n          if (error instanceof Error) {\n            return error;\n          }\n        }\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createUnionTypeChecker(arrayOfTypeCheckers) {\n    if (!Array.isArray(arrayOfTypeCheckers)) {\n      process.env.NODE_ENV !== 'production' ? printWarning('Invalid argument supplied to oneOfType, expected an instance of array.') : void 0;\n      return emptyFunctionThatReturnsNull;\n    }\n\n    for (var i = 0; i < arrayOfTypeCheckers.length; i++) {\n      var checker = arrayOfTypeCheckers[i];\n      if (typeof checker !== 'function') {\n        printWarning(\n          'Invalid argument supplied to oneOfType. Expected an array of check functions, but ' +\n          'received ' + getPostfixForTypeWarning(checker) + ' at index ' + i + '.'\n        );\n        return emptyFunctionThatReturnsNull;\n      }\n    }\n\n    function validate(props, propName, componentName, location, propFullName) {\n      var expectedTypes = [];\n      for (var i = 0; i < arrayOfTypeCheckers.length; i++) {\n        var checker = arrayOfTypeCheckers[i];\n        var checkerResult = checker(props, propName, componentName, location, propFullName, ReactPropTypesSecret);\n        if (checkerResult == null) {\n          return null;\n        }\n        if (checkerResult.data && has(checkerResult.data, 'expectedType')) {\n          expectedTypes.push(checkerResult.data.expectedType);\n        }\n      }\n      var expectedTypesMessage = (expectedTypes.length > 0) ? ', expected one of type [' + expectedTypes.join(', ') + ']': '';\n      return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` supplied to ' + ('`' + componentName + '`' + expectedTypesMessage + '.'));\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createNodeChecker() {\n    function validate(props, propName, componentName, location, propFullName) {\n      if (!isNode(props[propName])) {\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` supplied to ' + ('`' + componentName + '`, expected a ReactNode.'));\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function invalidValidatorError(componentName, location, propFullName, key, type) {\n    return new PropTypeError(\n      (componentName || 'React class') + ': ' + location + ' type `' + propFullName + '.' + key + '` is invalid; ' +\n      'it must be a function, usually from the `prop-types` package, but received `' + type + '`.'\n    );\n  }\n\n  function createShapeTypeChecker(shapeTypes) {\n    function validate(props, propName, componentName, location, propFullName) {\n      var propValue = props[propName];\n      var propType = getPropType(propValue);\n      if (propType !== 'object') {\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type `' + propType + '` ' + ('supplied to `' + componentName + '`, expected `object`.'));\n      }\n      for (var key in shapeTypes) {\n        var checker = shapeTypes[key];\n        if (typeof checker !== 'function') {\n          return invalidValidatorError(componentName, location, propFullName, key, getPreciseType(checker));\n        }\n        var error = checker(propValue, key, componentName, location, propFullName + '.' + key, ReactPropTypesSecret);\n        if (error) {\n          return error;\n        }\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createStrictShapeTypeChecker(shapeTypes) {\n    function validate(props, propName, componentName, location, propFullName) {\n      var propValue = props[propName];\n      var propType = getPropType(propValue);\n      if (propType !== 'object') {\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type `' + propType + '` ' + ('supplied to `' + componentName + '`, expected `object`.'));\n      }\n      // We need to check all keys in case some are required but missing from props.\n      var allKeys = assign({}, props[propName], shapeTypes);\n      for (var key in allKeys) {\n        var checker = shapeTypes[key];\n        if (has(shapeTypes, key) && typeof checker !== 'function') {\n          return invalidValidatorError(componentName, location, propFullName, key, getPreciseType(checker));\n        }\n        if (!checker) {\n          return new PropTypeError(\n            'Invalid ' + location + ' `' + propFullName + '` key `' + key + '` supplied to `' + componentName + '`.' +\n            '\\nBad object: ' + JSON.stringify(props[propName], null, '  ') +\n            '\\nValid keys: ' + JSON.stringify(Object.keys(shapeTypes), null, '  ')\n          );\n        }\n        var error = checker(propValue, key, componentName, location, propFullName + '.' + key, ReactPropTypesSecret);\n        if (error) {\n          return error;\n        }\n      }\n      return null;\n    }\n\n    return createChainableTypeChecker(validate);\n  }\n\n  function isNode(propValue) {\n    switch (typeof propValue) {\n      case 'number':\n      case 'string':\n      case 'undefined':\n        return true;\n      case 'boolean':\n        return !propValue;\n      case 'object':\n        if (Array.isArray(propValue)) {\n          return propValue.every(isNode);\n        }\n        if (propValue === null || isValidElement(propValue)) {\n          return true;\n        }\n\n        var iteratorFn = getIteratorFn(propValue);\n        if (iteratorFn) {\n          var iterator = iteratorFn.call(propValue);\n          var step;\n          if (iteratorFn !== propValue.entries) {\n            while (!(step = iterator.next()).done) {\n              if (!isNode(step.value)) {\n                return false;\n              }\n            }\n          } else {\n            // Iterator will provide entry [k,v] tuples rather than values.\n            while (!(step = iterator.next()).done) {\n              var entry = step.value;\n              if (entry) {\n                if (!isNode(entry[1])) {\n                  return false;\n                }\n              }\n            }\n          }\n        } else {\n          return false;\n        }\n\n        return true;\n      default:\n        return false;\n    }\n  }\n\n  function isSymbol(propType, propValue) {\n    // Native Symbol.\n    if (propType === 'symbol') {\n      return true;\n    }\n\n    // falsy value can't be a Symbol\n    if (!propValue) {\n      return false;\n    }\n\n    // 19.4.3.5 Symbol.prototype[@@toStringTag] === 'Symbol'\n    if (propValue['@@toStringTag'] === 'Symbol') {\n      return true;\n    }\n\n    // Fallback for non-spec compliant Symbols which are polyfilled.\n    if (typeof Symbol === 'function' && propValue instanceof Symbol) {\n      return true;\n    }\n\n    return false;\n  }\n\n  // Equivalent of `typeof` but with special handling for array and regexp.\n  function getPropType(propValue) {\n    var propType = typeof propValue;\n    if (Array.isArray(propValue)) {\n      return 'array';\n    }\n    if (propValue instanceof RegExp) {\n      // Old webkits (at least until Android 4.0) return 'function' rather than\n      // 'object' for typeof a RegExp. We'll normalize this here so that /bla/\n      // passes PropTypes.object.\n      return 'object';\n    }\n    if (isSymbol(propType, propValue)) {\n      return 'symbol';\n    }\n    return propType;\n  }\n\n  // This handles more types than `getPropType`. Only used for error messages.\n  // See `createPrimitiveTypeChecker`.\n  function getPreciseType(propValue) {\n    if (typeof propValue === 'undefined' || propValue === null) {\n      return '' + propValue;\n    }\n    var propType = getPropType(propValue);\n    if (propType === 'object') {\n      if (propValue instanceof Date) {\n        return 'date';\n      } else if (propValue instanceof RegExp) {\n        return 'regexp';\n      }\n    }\n    return propType;\n  }\n\n  // Returns a string that is postfixed to a warning about an invalid type.\n  // For example, \"undefined\" or \"of type array\"\n  function getPostfixForTypeWarning(value) {\n    var type = getPreciseType(value);\n    switch (type) {\n      case 'array':\n      case 'object':\n        return 'an ' + type;\n      case 'boolean':\n      case 'date':\n      case 'regexp':\n        return 'a ' + type;\n      default:\n        return type;\n    }\n  }\n\n  // Returns class name of the object, if any.\n  function getClassName(propValue) {\n    if (!propValue.constructor || !propValue.constructor.name) {\n      return ANONYMOUS;\n    }\n    return propValue.constructor.name;\n  }\n\n  ReactPropTypes.checkPropTypes = checkPropTypes;\n  ReactPropTypes.resetWarningCache = checkPropTypes.resetWarningCache;\n  ReactPropTypes.PropTypes = ReactPropTypes;\n\n  return ReactPropTypes;\n};\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\n\nfunction emptyFunction() {}\nfunction emptyFunctionWithReset() {}\nemptyFunctionWithReset.resetWarningCache = emptyFunction;\n\nmodule.exports = function() {\n  function shim(props, propName, componentName, location, propFullName, secret) {\n    if (secret === ReactPropTypesSecret) {\n      // It is still safe when called from React.\n      return;\n    }\n    var err = new Error(\n      'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +\n      'Use PropTypes.checkPropTypes() to call them. ' +\n      'Read more at http://fb.me/use-check-prop-types'\n    );\n    err.name = 'Invariant Violation';\n    throw err;\n  };\n  shim.isRequired = shim;\n  function getShim() {\n    return shim;\n  };\n  // Important!\n  // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.\n  var ReactPropTypes = {\n    array: shim,\n    bigint: shim,\n    bool: shim,\n    func: shim,\n    number: shim,\n    object: shim,\n    string: shim,\n    symbol: shim,\n\n    any: shim,\n    arrayOf: getShim,\n    element: shim,\n    elementType: shim,\n    instanceOf: getShim,\n    node: shim,\n    objectOf: getShim,\n    oneOf: getShim,\n    oneOfType: getShim,\n    shape: getShim,\n    exact: getShim,\n\n    checkPropTypes: emptyFunctionWithReset,\n    resetWarningCache: emptyFunction\n  };\n\n  ReactPropTypes.PropTypes = ReactPropTypes;\n\n  return ReactPropTypes;\n};\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nif (process.env.NODE_ENV !== 'production') {\n  var ReactIs = require('react-is');\n\n  // By explicitly using `prop-types` you are opting into new development behavior.\n  // http://fb.me/prop-types-in-prod\n  var throwOnDirectAccess = true;\n  module.exports = require('./factoryWithTypeCheckers')(ReactIs.isElement, throwOnDirectAccess);\n} else {\n  // By explicitly using `prop-types` you are opting into new production behavior.\n  // http://fb.me/prop-types-in-prod\n  module.exports = require('./factoryWithThrowingShims')();\n}\n","/**\r\n * Font size constants and conversions\r\n * Approximate conversions from Points (pt) to Pixels (px) at 96 DPI\r\n * \r\n * Standard conversion: 1 pt = 1.333... px (at 96 DPI)\r\n * These values match Microsoft Word's font size rendering\r\n */\r\n\r\n/**\r\n * Font size mapping from points to pixels\r\n * Based on 96 DPI (Microsoft Word standard)\r\n */\r\nexport const FONT_SIZE_MAP = {\r\n  '7.5pt': { pt: 7.5, px: 10, label: '7.5' },\r\n  '9pt': { pt: 9, px: 12, label: '9' },\r\n  '10pt': { pt: 10, px: 13, label: '10' },\r\n  '11pt': { pt: 11, px: 15, label: '11' },\r\n  '12pt': { pt: 12, px: 16, label: '12' },\r\n  '14pt': { pt: 14, px: 19, label: '14' },\r\n  '16pt': { pt: 16, px: 21, label: '16' },\r\n  '18pt': { pt: 18, px: 24, label: '18' },\r\n  '20pt': { pt: 20, px: 27, label: '20' },\r\n  '22pt': { pt: 22, px: 29, label: '22' },\r\n  '24pt': { pt: 24, px: 32, label: '24' },\r\n  '26pt': { pt: 26, px: 35, label: '26' },\r\n  '28pt': { pt: 28, px: 37, label: '28' },\r\n  '36pt': { pt: 36, px: 48, label: '36' },\r\n  '48pt': { pt: 48, px: 64, label: '48' },\r\n  '72pt': { pt: 72, px: 96, label: '72' }\r\n};\r\n\r\n/**\r\n * Common font sizes for editor dropdown\r\n * Values in pixels matching Word's point sizes\r\n */\r\nexport const COMMON_FONT_SIZES = [\r\n  { value: '10px', label: '7.5', pt: 7.5 },   // 7.5 pt ≈ 10 px\r\n  { value: '12px', label: '9', pt: 9 },       // 9 pt ≈ 12 px\r\n  { value: '13px', label: '10', pt: 10 },     // 10 pt ≈ 13 px\r\n  { value: '15px', label: '11', pt: 11 },     // 11 pt ≈ 15 px (default in Word)\r\n  { value: '16px', label: '12', pt: 12 },     // 12 pt ≈ 16 px\r\n  { value: '19px', label: '14', pt: 14 },     // 14 pt ≈ 19 px\r\n  { value: '21px', label: '16', pt: 16 },     // 16 pt ≈ 21 px\r\n  { value: '24px', label: '18', pt: 18 },     // 18 pt ≈ 24 px\r\n  { value: '27px', label: '20', pt: 20 },     // 20 pt ≈ 27 px\r\n  { value: '32px', label: '24', pt: 24 },     // 24 pt ≈ 32 px\r\n  { value: '37px', label: '28', pt: 28 },     // 28 pt ≈ 37 px\r\n  { value: '48px', label: '36', pt: 36 },     // 36 pt ≈ 48 px\r\n  { value: '64px', label: '48', pt: 48 },     // 48 pt ≈ 64 px\r\n  { value: '96px', label: '72', pt: 72 }      // 72 pt ≈ 96 px\r\n];\r\n\r\n/**\r\n * Default font size (9 pt in Word, which is 12px at 96 DPI)\r\n */\r\nexport const DEFAULT_FONT_SIZE = '16px';\r\n\r\n/**\r\n * Convert points to pixels at 96 DPI\r\n * @param {number} points - Font size in points\r\n * @returns {number} Font size in pixels\r\n */\r\nexport const pointsToPixels = (points) => {\r\n  return Math.round(points * 96 / 72);\r\n};\r\n\r\n/**\r\n * Convert pixels to points at 96 DPI\r\n * @param {number} pixels - Font size in pixels\r\n * @returns {number} Font size in points\r\n */\r\nexport const pixelsToPoints = (pixels) => {\r\n  return Math.round((pixels * 72 / 96) * 2) / 2; // Round to nearest 0.5\r\n};\r\n\r\n/**\r\n * Get pixel value from point size\r\n * @param {number} pt - Point size\r\n * @returns {string} Pixel value with 'px' suffix\r\n */\r\nexport const getPixelValue = (pt) => {\r\n  const fontSize = Object.values(FONT_SIZE_MAP).find(size => size.pt === pt);\r\n  return fontSize ? `${fontSize.px}px` : `${pointsToPixels(pt)}px`;\r\n};\r\n\r\n/**\r\n * Get point value from pixel size\r\n * @param {string} px - Pixel size (e.g., '16px')\r\n * @returns {number} Point value\r\n */\r\nexport const getPointValue = (px) => {\r\n  const pixelValue = parseInt(px);\r\n  const fontSize = Object.values(FONT_SIZE_MAP).find(size => size.px === pixelValue);\r\n  return fontSize ? fontSize.pt : pixelsToPoints(pixelValue);\r\n};\r\n\r\n/**\r\n * Validate if a font size is valid\r\n * @param {string} size - Font size to validate (e.g., '16px' or '12pt')\r\n * @returns {boolean} True if valid\r\n */\r\nexport const isValidFontSize = (size) => {\r\n  if (!size) return false;\r\n  \r\n  if (size.endsWith('px')) {\r\n    const px = parseInt(size);\r\n    return px >= 8 && px <= 144; // Min 6pt, Max 108pt\r\n  }\r\n  \r\n  if (size.endsWith('pt')) {\r\n    const pt = parseFloat(size);\r\n    return pt >= 6 && pt <= 108;\r\n  }\r\n  \r\n  return false;\r\n};\r\n","/**\r\n * Image Resize Utilities for HTML Editor\r\n * Provides functionality for resizing images with handlers\r\n */\r\n\r\n/**\r\n * Default image resize options\r\n */\r\nexport const DEFAULT_IMAGE_RESIZE_OPTIONS = {\r\n  minWidth: 50,\r\n  minHeight: 50,\r\n  maxWidth: 800,\r\n  maxHeight: 600,\r\n  aspectRatio: true,\r\n  preserveAspectRatio: true,\r\n  defaultWidth: 300,\r\n  defaultHeight: 200\r\n};\r\n\r\n/**\r\n * Image resize handler positions\r\n */\r\nexport const RESIZE_HANDLERS = {\r\n  TOP_LEFT: 'top-left',\r\n  TOP_RIGHT: 'top-right',\r\n  BOTTOM_LEFT: 'bottom-left',\r\n  BOTTOM_RIGHT: 'bottom-right',\r\n  TOP: 'top',\r\n  BOTTOM: 'bottom',\r\n  LEFT: 'left',\r\n  RIGHT: 'right'\r\n};\r\n\r\n/**\r\n * Calculate new dimensions based on resize handler and mouse movement\r\n * @param {Object} params - Resize parameters\r\n * @param {string} params.handler - Resize handler position\r\n * @param {number} params.startX - Initial mouse X position\r\n * @param {number} params.startY - Initial mouse Y position\r\n * @param {number} params.currentX - Current mouse X position\r\n * @param {number} params.currentY - Current mouse Y position\r\n * @param {number} params.startWidth - Initial image width\r\n * @param {number} params.startHeight - Initial image height\r\n * @param {Object} params.options - Resize options\r\n * @returns {Object} New width and height\r\n */\r\nexport function calculateResizeDimensions({\r\n  handler,\r\n  startX,\r\n  startY,\r\n  currentX,\r\n  currentY,\r\n  startWidth,\r\n  startHeight,\r\n  options = DEFAULT_IMAGE_RESIZE_OPTIONS\r\n}) {\r\n  const deltaX = currentX - startX;\r\n  const deltaY = currentY - startY;\r\n  \r\n  let newWidth = startWidth;\r\n  let newHeight = startHeight;\r\n  \r\n  // Calculate based on handler position\r\n  switch (handler) {\r\n    case RESIZE_HANDLERS.TOP_LEFT:\r\n      newWidth = Math.max(options.minWidth, startWidth - deltaX);\r\n      newHeight = Math.max(options.minHeight, startHeight - deltaY);\r\n      break;\r\n      \r\n    case RESIZE_HANDLERS.TOP_RIGHT:\r\n      newWidth = Math.max(options.minWidth, startWidth + deltaX);\r\n      newHeight = Math.max(options.minHeight, startHeight - deltaY);\r\n      break;\r\n      \r\n    case RESIZE_HANDLERS.BOTTOM_LEFT:\r\n      newWidth = Math.max(options.minWidth, startWidth - deltaX);\r\n      newHeight = Math.max(options.minHeight, startHeight + deltaY);\r\n      break;\r\n      \r\n    case RESIZE_HANDLERS.BOTTOM_RIGHT:\r\n      newWidth = Math.max(options.minWidth, startWidth + deltaX);\r\n      newHeight = Math.max(options.minHeight, startHeight + deltaY);\r\n      break;\r\n      \r\n    case RESIZE_HANDLERS.TOP:\r\n      newHeight = Math.max(options.minHeight, startHeight - deltaY);\r\n      break;\r\n      \r\n    case RESIZE_HANDLERS.BOTTOM:\r\n      newHeight = Math.max(options.minHeight, startHeight + deltaY);\r\n      break;\r\n      \r\n    case RESIZE_HANDLERS.LEFT:\r\n      newWidth = Math.max(options.minWidth, startWidth - deltaX);\r\n      break;\r\n      \r\n    case RESIZE_HANDLERS.RIGHT:\r\n      newWidth = Math.max(options.minWidth, startWidth + deltaX);\r\n      break;\r\n      \r\n    default:\r\n      return { width: newWidth, height: newHeight };\r\n  }\r\n  \r\n  // Apply aspect ratio if needed\r\n  if (options.preserveAspectRatio && options.aspectRatio) {\r\n    const aspectRatio = startWidth / startHeight;\r\n    \r\n    // For corner handlers, maintain aspect ratio\r\n    if ([RESIZE_HANDLERS.TOP_LEFT, RESIZE_HANDLERS.TOP_RIGHT, \r\n         RESIZE_HANDLERS.BOTTOM_LEFT, RESIZE_HANDLERS.BOTTOM_RIGHT].includes(handler)) {\r\n      // Use the larger dimension to maintain aspect ratio\r\n      if (newWidth / aspectRatio > newHeight) {\r\n        newHeight = Math.max(options.minHeight, newWidth / aspectRatio);\r\n      } else {\r\n        newWidth = Math.max(options.minWidth, newHeight * aspectRatio);\r\n      }\r\n    }\r\n    // For edge handlers, maintain aspect ratio\r\n    else if ([RESIZE_HANDLERS.TOP, RESIZE_HANDLERS.BOTTOM].includes(handler)) {\r\n      newWidth = newHeight * aspectRatio;\r\n    } else if ([RESIZE_HANDLERS.LEFT, RESIZE_HANDLERS.RIGHT].includes(handler)) {\r\n      newHeight = newWidth / aspectRatio;\r\n    }\r\n  }\r\n  \r\n  // Apply max dimensions\r\n  if (options.maxWidth && newWidth > options.maxWidth) {\r\n    newWidth = options.maxWidth;\r\n    if (options.preserveAspectRatio && options.aspectRatio) {\r\n      newHeight = newWidth / (startWidth / startHeight);\r\n    }\r\n  }\r\n  \r\n  if (options.maxHeight && newHeight > options.maxHeight) {\r\n    newHeight = options.maxHeight;\r\n    if (options.preserveAspectRatio && options.aspectRatio) {\r\n      newWidth = newHeight * (startWidth / startHeight);\r\n    }\r\n  }\r\n  \r\n  // Ensure minimum dimensions\r\n  newWidth = Math.max(options.minWidth, newWidth);\r\n  newHeight = Math.max(options.minHeight, newHeight);\r\n  \r\n  return {\r\n    width: Math.round(newWidth),\r\n    height: Math.round(newHeight)\r\n  };\r\n}\r\n\r\n/**\r\n * Check if an element is an image that can be resized\r\n * @param {HTMLElement} element - Element to check\r\n * @returns {boolean} Whether the element is a resizable image\r\n */\r\nexport function isResizableImage(element) {\r\n  if (!element) return false;\r\n  \r\n  console.log('Checking if element is resizable image:', element, 'tagName:', element.tagName);\r\n  \r\n  // Check if it's an img element\r\n  if (element.tagName === 'IMG') {\r\n    console.log('Element is an IMG tag, returning true');\r\n    return true;\r\n  }\r\n  \r\n  // Check if it's a div with background image that should be resizable\r\n  if (element.tagName === 'DIV' &&\r\n      element.style.backgroundImage &&\r\n      element.style.backgroundImage !== 'none') {\r\n    console.log('Element is a DIV with background image, returning true');\r\n    return true;\r\n  }\r\n  \r\n  console.log('Element is not a resizable image, returning false');\r\n  return false;\r\n}\r\n\r\n/**\r\n * Get image dimensions from an element\r\n * @param {HTMLElement} element - Image element\r\n * @returns {Object} Width and height\r\n */\r\nexport function getImageDimensions(element) {\r\n  if (!isResizableImage(element)) {\r\n    return { width: 0, height: 0 };\r\n  }\r\n  \r\n  return {\r\n    width: element.offsetWidth,\r\n    height: element.offsetHeight\r\n  };\r\n}\r\n\r\n/**\r\n * Apply image dimensions to an element\r\n * @param {HTMLElement} element - Image element\r\n * @param {Object} dimensions - Width and height\r\n * @param {number} dimensions.width - New width\r\n * @param {number} dimensions.height - New height\r\n */\r\nexport function applyImageDimensions(element, { width, height }) {\r\n  if (!isResizableImage(element)) return;\r\n  \r\n  // For img elements\r\n  if (element.tagName === 'IMG') {\r\n    element.style.width = `${width}px`;\r\n    element.style.height = `${height}px`;\r\n    element.width = width;\r\n    element.height = height;\r\n  }\r\n  // For div elements with background images\r\n  else if (element.tagName === 'DIV') {\r\n    element.style.width = `${width}px`;\r\n    element.style.height = `${height}px`;\r\n  }\r\n}\r\n\r\n/**\r\n * Create resize overlay for an image\r\n * @param {HTMLElement} imageElement - Image element to resize\r\n * @param {Object} options - Resize options\r\n * @returns {HTMLElement} Resize overlay element\r\n */\r\nexport function createResizeOverlay(imageElement, options = DEFAULT_IMAGE_RESIZE_OPTIONS) {\r\n  if (!isResizableImage(imageElement)) return null;\r\n  \r\n  // Create overlay container\r\n  const overlay = document.createElement('div');\r\n  overlay.className = 'image-resize-overlay';\r\n  overlay.style.position = 'fixed'; // Changed to fixed for viewport positioning\r\n  overlay.style.zIndex = '1000';\r\n  overlay.style.pointerEvents = 'none';\r\n  \r\n  // Position overlay over the image using viewport coordinates\r\n  const rect = imageElement.getBoundingClientRect();\r\n  \r\n  overlay.style.top = `${rect.top}px`;\r\n  overlay.style.left = `${rect.left}px`;\r\n  overlay.style.width = `${rect.width}px`;\r\n  overlay.style.height = `${rect.height}px`;\r\n  \r\n  // Create resize handlers\r\n  const handlers = Object.values(RESIZE_HANDLERS);\r\n  handlers.forEach(handler => {\r\n    const handlerElement = document.createElement('div');\r\n    handlerElement.className = `resize-handler resize-handler-${handler}`;\r\n    handlerElement.dataset.handler = handler;\r\n    handlerElement.style.position = 'absolute';\r\n    handlerElement.style.width = '10px';\r\n    handlerElement.style.height = '10px';\r\n    handlerElement.style.backgroundColor = '#007bff';\r\n    handlerElement.style.border = '2px solid white';\r\n    handlerElement.style.borderRadius = '50%';\r\n    handlerElement.style.boxShadow = '0 0 3px rgba(0,0,0,0.3)';\r\n    handlerElement.style.cursor = getCursorForHandler(handler);\r\n    handlerElement.style.pointerEvents = 'all';\r\n    \r\n    // Position handler\r\n    positionHandler(handlerElement, handler, rect.width, rect.height);\r\n    \r\n    overlay.appendChild(handlerElement);\r\n  });\r\n  \r\n  return overlay;\r\n}\r\n\r\n/**\r\n * Get cursor style for a resize handler\r\n * @param {string} handler - Handler position\r\n * @returns {string} CSS cursor value\r\n */\r\nfunction getCursorForHandler(handler) {\r\n  switch (handler) {\r\n    case RESIZE_HANDLERS.TOP_LEFT:\r\n    case RESIZE_HANDLERS.BOTTOM_RIGHT:\r\n      return 'nwse-resize';\r\n    case RESIZE_HANDLERS.TOP_RIGHT:\r\n    case RESIZE_HANDLERS.BOTTOM_LEFT:\r\n      return 'nesw-resize';\r\n    case RESIZE_HANDLERS.TOP:\r\n    case RESIZE_HANDLERS.BOTTOM:\r\n      return 'ns-resize';\r\n    case RESIZE_HANDLERS.LEFT:\r\n    case RESIZE_HANDLERS.RIGHT:\r\n      return 'ew-resize';\r\n    default:\r\n      return 'default';\r\n  }\r\n}\r\n\r\n/**\r\n * Position a resize handler\r\n * @param {HTMLElement} handler - Handler element\r\n * @param {string} position - Handler position\r\n * @param {number} width - Container width\r\n * @param {number} height - Container height\r\n */\r\nfunction positionHandler(handler, position, width, height) {\r\n  const offset = -5; // Half of handler size to center it\r\n  \r\n  switch (position) {\r\n    case RESIZE_HANDLERS.TOP_LEFT:\r\n      handler.style.top = `${offset}px`;\r\n      handler.style.left = `${offset}px`;\r\n      break;\r\n    case RESIZE_HANDLERS.TOP_RIGHT:\r\n      handler.style.top = `${offset}px`;\r\n      handler.style.right = `${offset}px`;\r\n      break;\r\n    case RESIZE_HANDLERS.BOTTOM_LEFT:\r\n      handler.style.bottom = `${offset}px`;\r\n      handler.style.left = `${offset}px`;\r\n      break;\r\n    case RESIZE_HANDLERS.BOTTOM_RIGHT:\r\n      handler.style.bottom = `${offset}px`;\r\n      handler.style.right = `${offset}px`;\r\n      break;\r\n    case RESIZE_HANDLERS.TOP:\r\n      handler.style.top = `${offset}px`;\r\n      handler.style.left = `${width / 2 + offset}px`;\r\n      break;\r\n    case RESIZE_HANDLERS.BOTTOM:\r\n      handler.style.bottom = `${offset}px`;\r\n      handler.style.left = `${width / 2 + offset}px`;\r\n      break;\r\n    case RESIZE_HANDLERS.LEFT:\r\n      handler.style.top = `${height / 2 + offset}px`;\r\n      handler.style.left = `${offset}px`;\r\n      break;\r\n    case RESIZE_HANDLERS.RIGHT:\r\n      handler.style.top = `${height / 2 + offset}px`;\r\n      handler.style.right = `${offset}px`;\r\n      break;\r\n  }\r\n}\r\n\r\n/**\r\n * Update resize overlay position and size\r\n * @param {HTMLElement} overlay - Resize overlay\r\n * @param {HTMLElement} imageElement - Image element\r\n */\r\nexport function updateResizeOverlay(overlay, imageElement) {\r\n  if (!overlay || !imageElement) return;\r\n  \r\n  const rect = imageElement.getBoundingClientRect();\r\n  \r\n  overlay.style.top = `${rect.top}px`;\r\n  overlay.style.left = `${rect.left}px`;\r\n  overlay.style.width = `${rect.width}px`;\r\n  overlay.style.height = `${rect.height}px`;\r\n  \r\n  // Update handler positions\r\n  const handlers = overlay.querySelectorAll('.resize-handler');\r\n  handlers.forEach(handler => {\r\n    const position = handler.dataset.handler;\r\n    positionHandler(handler, position, rect.width, rect.height);\r\n  });\r\n}\r\n\r\n/**\r\n * Remove resize overlay\r\n * @param {HTMLElement} overlay - Resize overlay to remove\r\n */\r\nexport function removeResizeOverlay(overlay) {\r\n  if (overlay && overlay.parentNode) {\r\n    overlay.parentNode.removeChild(overlay);\r\n  }\r\n}\r\n","import { useState, useCallback, useRef, useEffect } from 'react';\r\nimport { DEFAULT_FONT_SIZE } from '../lib/editor/font-sizes';\r\nimport {\r\n  isResizableImage,\r\n  createResizeOverlay,\r\n  removeResizeOverlay,\r\n  updateResizeOverlay,\r\n  RESIZE_HANDLERS,\r\n  DEFAULT_IMAGE_RESIZE_OPTIONS\r\n} from '../lib/editor/image-resize-utils';\r\n\r\n// Constants for better maintainability\r\n// Font size mapping for execCommand (legacy HTML font sizes 1-7)\r\nconst FONT_SIZE_MAP = {\r\n  '10px': '1',   // 7.5 pt\r\n  '12px': '2',   // 9 pt\r\n  '13px': '2',   // 10 pt\r\n  '15px': '3',   // 11 pt (Word default)\r\n  '16px': '3',   // 12 pt\r\n  '19px': '4',   // 14 pt\r\n  '21px': '4',   // 16 pt\r\n  '24px': '5',   // 18 pt\r\n  '27px': '5',   // 20 pt\r\n  '32px': '6',   // 24 pt\r\n  '37px': '6',   // 28 pt\r\n  '48px': '6',   // 36 pt\r\n  '64px': '7',   // 48 pt\r\n  '96px': '7'    // 72 pt\r\n};\r\n\r\nconst DEFAULT_FORMAT = {\r\n  bold: false,\r\n  italic: false,\r\n  underline: false,\r\n  strikethrough: false,\r\n  alignLeft: false,\r\n  alignCenter: false,\r\n  alignRight: false,\r\n  alignJustify: false,\r\n  fontFamily: 'Arial',\r\n  fontSize: DEFAULT_FONT_SIZE,\r\n  headingLevel: 'p', // Add heading level tracking\r\n  // Image resize state\r\n  imageSelected: false,\r\n  imageResizeOptions: DEFAULT_IMAGE_RESIZE_OPTIONS,\r\n  preserveAspectRatio: true\r\n};\r\n\r\n/**\r\n * useFormatting - Hook for managing text formatting state and commands\r\n * Handles document.execCommand for rich text formatting\r\n * Optimized with better selection handling and error recovery\r\n */\r\nexport const useFormatting = () => {\r\n  const [currentFormat, setCurrentFormat] = useState(DEFAULT_FORMAT);\r\n\r\n  /**\r\n   * Update alignment state helper\r\n   */\r\n  const updateAlignment = useCallback((align) => {\r\n    setCurrentFormat(prev => ({\r\n      ...prev,\r\n      alignLeft: align === 'left',\r\n      alignCenter: align === 'center',\r\n      alignRight: align === 'right',\r\n      alignJustify: align === 'justify'\r\n    }));\r\n  }, []);\r\n\r\n  /**\r\n   * Handle font size with improved reliability\r\n   */\r\n  const handleFontSize = useCallback((value) => {\r\n    try {\r\n      // Save current selection\r\n      const selection = window.getSelection();\r\n      if (!selection || selection.rangeCount === 0) {\r\n        return false;\r\n      }\r\n\r\n      const range = selection.getRangeAt(0);\r\n      const selectedText = range.toString();\r\n\r\n      if (!selectedText) {\r\n        // No text selected - just update state for next input\r\n        setCurrentFormat(prev => ({ ...prev, fontSize: value }));\r\n        return false;\r\n      }\r\n\r\n      // Try modern approach first - wrap in span with style\r\n      try {\r\n        const span = document.createElement('span');\r\n        span.style.fontSize = value;\r\n        \r\n        // Extract contents and wrap\r\n        const fragment = range.extractContents();\r\n        span.appendChild(fragment);\r\n        range.insertNode(span);\r\n        \r\n        // Restore selection\r\n        range.selectNodeContents(span);\r\n        selection.removeAllRanges();\r\n        selection.addRange(range);\r\n        \r\n        setCurrentFormat(prev => ({ ...prev, fontSize: value }));\r\n        return true;\r\n      } catch (error) {\r\n        // Fallback to execCommand\r\n        const sizeNumber = FONT_SIZE_MAP[value] || '2';\r\n        document.execCommand('fontSize', false, sizeNumber);\r\n        setCurrentFormat(prev => ({ ...prev, fontSize: value }));\r\n        return true;\r\n      }\r\n    } catch (error) {\r\n      console.warn('[useFormatting] Font size change failed:', error);\r\n      return false;\r\n    }\r\n  }, []);\r\n\r\n  /**\r\n   * Format text using document.execCommand\r\n   * Optimized with better error handling and selection management\r\n   */\r\n  const formatText = useCallback((command, value = null) => {\r\n    try {\r\n      // Check if document.execCommand is supported\r\n      if (typeof document.execCommand !== 'function') {\r\n        console.warn('[useFormatting] execCommand not supported');\r\n        return;\r\n      }\r\n\r\n      // Handle fontSize separately for better control\r\n      if (command === 'fontSize') {\r\n        handleFontSize(value);\r\n        return;\r\n      }\r\n\r\n      // Execute the command\r\n      const success = document.execCommand(command, false, value);\r\n      \r\n      if (!success) {\r\n        console.warn(`[useFormatting] Command \"${command}\" failed`);\r\n      }\r\n\r\n      // Update format state based on command\r\n      switch (command) {\r\n        case 'bold':\r\n          setCurrentFormat(prev => ({ ...prev, bold: !prev.bold }));\r\n          break;\r\n        case 'italic':\r\n          setCurrentFormat(prev => ({ ...prev, italic: !prev.italic }));\r\n          break;\r\n        case 'underline':\r\n          setCurrentFormat(prev => ({ ...prev, underline: !prev.underline }));\r\n          break;\r\n        case 'strikethrough':\r\n          setCurrentFormat(prev => ({ ...prev, strikethrough: !prev.strikethrough }));\r\n        case 'justifyLeft':\r\n          updateAlignment('left');\r\n          break;\r\n        case 'justifyCenter':\r\n          updateAlignment('center');\r\n        case 'justifyRight':\r\n          updateAlignment('right');\r\n        case 'justifyFull':\r\n          updateAlignment('justify');\r\n        case 'fontName':\r\n          setCurrentFormat(prev => ({ ...prev, fontFamily: value }));\r\n        case 'formatBlock':\r\n          setCurrentFormat(prev => ({ ...prev, headingLevel: value }));\r\n        default:\r\n          // Commands like insertUnorderedList, createLink, etc. don't need state updates\r\n          break;\r\n      }\r\n    } catch (error) {\r\n      console.warn(`[useFormatting] Error executing command \"${command}\":`, error);\r\n    }\r\n  }, [handleFontSize, updateAlignment]);\r\n\r\n  // Image resize state and refs\r\n  const resizeOverlayRef = useRef(null);\r\n  const resizeImageRef = useRef(null);\r\n  const resizeStartRef = useRef(null);\r\n  const resizeHandlerRef = useRef(null);\r\n  const resizeOptionsRef = useRef(DEFAULT_IMAGE_RESIZE_OPTIONS);\r\n\r\n  /**\r\n   * Handle image selection\r\n   */\r\n  const handleImageSelection = useCallback((imageElement) => {\r\n    if (!isResizableImage(imageElement)) return;\r\n\r\n    // Clear any existing resize overlay\r\n    if (resizeOverlayRef.current) {\r\n      removeResizeOverlay(resizeOverlayRef.current);\r\n      resizeOverlayRef.current = null;\r\n    }\r\n\r\n    // Mark image as selected\r\n    imageElement.classList.add('selected');\r\n\r\n    // Create resize overlay\r\n    const overlay = createResizeOverlay(imageElement);\r\n    if (overlay) {\r\n      resizeOverlayRef.current = overlay;\r\n      resizeImageRef.current = imageElement;\r\n      \r\n      // Add overlay to document body\r\n      document.body.appendChild(overlay);\r\n      \r\n      // Update format state\r\n      setCurrentFormat(prev => ({\r\n        ...prev,\r\n        imageSelected: true,\r\n        preserveAspectRatio: resizeOptionsRef.current.preserveAspectRatio\r\n      }));\r\n    }\r\n  }, []);\r\n\r\n  /**\r\n   * Clear image selection\r\n   */\r\n  const clearImageSelection = useCallback(() => {\r\n    if (resizeImageRef.current) {\r\n      resizeImageRef.current.classList.remove('selected');\r\n      resizeImageRef.current = null;\r\n    }\r\n\r\n    if (resizeOverlayRef.current) {\r\n      removeResizeOverlay(resizeOverlayRef.current);\r\n      resizeOverlayRef.current = null;\r\n    }\r\n\r\n    resizeStartRef.current = null;\r\n    resizeHandlerRef.current = null;\r\n\r\n    setCurrentFormat(prev => ({\r\n      ...prev,\r\n      imageSelected: false\r\n    }));\r\n  }, []);\r\n\r\n  /**\r\n   * Handle aspect ratio toggle\r\n   */\r\n  const toggleAspectRatio = useCallback(() => {\r\n    const newPreserveRatio = !resizeOptionsRef.current.preserveAspectRatio;\r\n    \r\n    resizeOptionsRef.current = {\r\n      ...resizeOptionsRef.current,\r\n      preserveAspectRatio: newPreserveRatio,\r\n      aspectRatio: newPreserveRatio\r\n    };\r\n\r\n    setCurrentFormat(prev => ({\r\n      ...prev,\r\n      preserveAspectRatio: newPreserveRatio\r\n    }));\r\n  }, []);\r\n\r\n  /**\r\n   * Start image resize operation\r\n   */\r\n  const startImageResize = useCallback((handler, startX, startY) => {\r\n    if (!resizeImageRef.current) return;\r\n\r\n    resizeStartRef.current = {\r\n      x: startX,\r\n      y: startY,\r\n      width: resizeImageRef.current.offsetWidth,\r\n      height: resizeImageRef.current.offsetHeight\r\n    };\r\n\r\n    resizeHandlerRef.current = handler;\r\n\r\n    // Add resize class to prevent text selection\r\n    document.body.classList.add('resize-in-progress');\r\n\r\n    // Update cursor based on handler\r\n    document.body.style.cursor = getCursorForHandler(handler);\r\n  }, []);\r\n\r\n  /**\r\n   * Perform image resize operation\r\n   */\r\n  const performImageResize = useCallback((currentX, currentY) => {\r\n    if (!resizeImageRef.current || !resizeStartRef.current || !resizeHandlerRef.current) return;\r\n\r\n    const { x: startX, y: startY, width: startWidth, height: startHeight } = resizeStartRef.current;\r\n    const handler = resizeHandlerRef.current;\r\n\r\n    // Calculate new dimensions\r\n    const newDimensions = calculateResizeDimensions({\r\n      handler,\r\n      startX,\r\n      startY,\r\n      currentX,\r\n      currentY,\r\n      startWidth,\r\n      startHeight,\r\n      options: resizeOptionsRef.current\r\n    });\r\n\r\n    // Apply new dimensions to the image\r\n    applyImageDimensions(resizeImageRef.current, newDimensions);\r\n\r\n    // Update resize overlay\r\n    if (resizeOverlayRef.current) {\r\n      updateResizeOverlay(resizeOverlayRef.current, resizeImageRef.current);\r\n    }\r\n  }, []);\r\n\r\n  /**\r\n   * End image resize operation\r\n   */\r\n  const endImageResize = useCallback(() => {\r\n    resizeStartRef.current = null;\r\n    resizeHandlerRef.current = null;\r\n\r\n    // Remove resize classes\r\n    document.body.classList.remove('resize-in-progress');\r\n    document.body.style.cursor = '';\r\n\r\n    // Update content in document context\r\n    if (resizeImageRef.current) {\r\n      // Trigger input event to update document state\r\n      const inputEvent = new Event('input', { bubbles: true, cancelable: true });\r\n      resizeImageRef.current.dispatchEvent(inputEvent);\r\n    }\r\n  }, []);\r\n\r\n  /**\r\n   * Reset formatting to default\r\n   */\r\n  const resetFormat = useCallback(() => {\r\n    clearImageSelection();\r\n    setCurrentFormat(DEFAULT_FORMAT);\r\n  }, [clearImageSelection]);\r\n\r\n  // Cleanup on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      if (resizeOverlayRef.current) {\r\n        removeResizeOverlay(resizeOverlayRef.current);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  return {\r\n    currentFormat,\r\n    formatText,\r\n    resetFormat,\r\n    // Image resize functionality - now delegated to ImageResizeHandlers\r\n    toggleAspectRatio\r\n  };\r\n};\r\n\r\n/**\r\n * Helper function to get cursor for resize handler\r\n */\r\nfunction getCursorForHandler(handler) {\r\n  switch (handler) {\r\n    case RESIZE_HANDLERS.TOP_LEFT:\r\n    case RESIZE_HANDLERS.BOTTOM_RIGHT:\r\n      return 'nwse-resize';\r\n    case RESIZE_HANDLERS.TOP_RIGHT:\r\n    case RESIZE_HANDLERS.BOTTOM_LEFT:\r\n      return 'nesw-resize';\r\n    case RESIZE_HANDLRES.TOP:\r\n    case RESIZE_HANDLERS.BOTTOM:\r\n      return 'ns-resize';\r\n    case RESIZE_HANDLERS.LEFT:\r\n    case RESIZE_HANDLERS.RIGHT:\r\n      return 'ew-resize';\r\n    default:\r\n      return 'default';\r\n  }\r\n}\r\n\r\n/**\r\n * Helper function to calculate resize dimensions\r\n */\r\nfunction calculateResizeDimensions({\r\n  handler,\r\n  startX,\r\n  startY,\r\n  currentX,\r\n  currentY,\r\n  startWidth,\r\n  startHeight,\r\n  options = DEFAULT_IMAGE_RESIZE_OPTIONS\r\n}) {\r\n  const deltaX = currentX - startX;\r\n  const deltaY = currentY - startY;\r\n  \r\n  let newWidth = startWidth;\r\n  let newHeight = startHeight;\r\n  \r\n  // Calculate based on handler position\r\n  switch (handler) {\r\n    case RESIZE_HANDLERS.TOP_LEFT:\r\n      newWidth = Math.max(options.minWidth, startWidth - deltaX);\r\n      newHeight = Math.max(options.minHeight, startHeight - deltaY);\r\n      break;\r\n      \r\n    case RESIZE_HANDLERS.TOP_RIGHT:\r\n      newWidth = Math.max(options.minWidth, startWidth + deltaX);\r\n      newHeight = Math.max(options.minHeight, startHeight - deltaY);\r\n      break;\r\n      \r\n    case RESIZE_HANDLERS.BOTTOM_LEFT:\r\n      newWidth = Math.max(options.minWidth, startWidth - deltaX);\r\n      newHeight = Math.max(options.minHeight, startHeight + deltaY);\r\n      break;\r\n      \r\n    case RESIZE_HANDLERS.BOTTOM_RIGHT:\r\n      newWidth = Math.max(options.minWidth, startWidth + deltaX);\r\n      newHeight = Math.max(options.minHeight, startHeight + deltaY);\r\n      break;\r\n      \r\n    case RESIZE_HANDLERS.TOP:\r\n      newHeight = Math.max(options.minHeight, startHeight - deltaY);\r\n      break;\r\n      \r\n    case RESIZE_HANDLERS.BOTTOM:\r\n      newHeight = Math.max(options.minHeight, startHeight + deltaY);\r\n      break;\r\n      \r\n    case RESIZE_HANDLERS.LEFT:\r\n      newWidth = Math.max(options.minWidth, startWidth - deltaX);\r\n      break;\r\n      \r\n    case RESIZE_HANDLERS.RIGHT:\r\n      newWidth = Math.max(options.minWidth, startWidth + deltaX);\r\n      break;\r\n      \r\n    default:\r\n      return { width: newWidth, height: newHeight };\r\n  }\r\n  \r\n  // Apply aspect ratio if needed\r\n  if (options.preserveAspectRatio && options.aspectRatio) {\r\n    const aspectRatio = startWidth / startHeight;\r\n    \r\n    // For corner handlers, maintain aspect ratio\r\n    if ([RESIZE_HANDLERS.TOP_LEFT, RESIZE_HANDLERS.TOP_RIGHT, \r\n         RESIZE_HANDLERS.BOTTOM_LEFT, RESIZE_HANDLERS.BOTTOM_RIGHT].includes(handler)) {\r\n      // Use the larger dimension to maintain aspect ratio\r\n      if (newWidth / aspectRatio > newHeight) {\r\n        newHeight = Math.max(options.minHeight, newWidth / aspectRatio);\r\n      } else {\r\n        newWidth = Math.max(options.minWidth, newHeight * aspectRatio);\r\n      }\r\n    }\r\n    // For edge handlers, maintain aspect ratio\r\n    else if ([RESIZE_HANDLERS.TOP, RESIZE_HANDLERS.BOTTOM].includes(handler)) {\r\n      newWidth = newHeight * aspectRatio;\r\n    } else if ([RESIZE_HANDLERS.LEFT, RESIZE_HANDLERS.RIGHT].includes(handler)) {\r\n      newHeight = newWidth / aspectRatio;\r\n    }\r\n  }\r\n  \r\n  // Apply max dimensions\r\n  if (options.maxWidth && newWidth > options.maxWidth) {\r\n    newWidth = options.maxWidth;\r\n    if (options.preserveAspectRatio && options.aspectRatio) {\r\n      newHeight = newWidth / (startWidth / startHeight);\r\n    }\r\n  }\r\n  \r\n  if (options.maxHeight && newHeight > options.maxHeight) {\r\n    newHeight = options.maxHeight;\r\n    if (options.preserveAspectRatio && options.aspectRatio) {\r\n      newWidth = newHeight * (startWidth / startHeight);\r\n    }\r\n  }\r\n  \r\n  // Ensure minimum dimensions\r\n  newWidth = Math.max(options.minWidth, newWidth);\r\n  newHeight = Math.max(options.minHeight, newHeight);\r\n  \r\n  return {\r\n    width: Math.round(newWidth),\r\n    height: Math.round(newHeight)\r\n  };\r\n}\r\n\r\n/**\r\n * Helper function to apply image dimensions\r\n */\r\nfunction applyImageDimensions(element, { width, height }) {\r\n  if (!isResizableImage(element)) return;\r\n  \r\n  // For img elements\r\n  if (element.tagName === 'IMG') {\r\n    element.style.width = `${width}px`;\r\n    element.style.height = `${height}px`;\r\n    element.width = width;\r\n    element.height = height;\r\n  }\r\n  // For div elements with background images\r\n  else if (element.tagName === 'DIV') {\r\n    element.style.width = `${width}px`;\r\n    element.style.height = `${height}px`;\r\n  }\r\n}\r\n","/**\r\n * Page boundary calculation utilities\r\n * Handles calculating page boundaries based on page breaks and content\r\n */\r\n\r\nimport { PAGE_SIZES } from './page-sizes.js';\r\nimport { getTotalVerticalMargins, DEFAULT_MARGIN_PRESET } from './margin-utils.js';\r\n\r\n// Content padding constants\r\nexport const CONTENT_PADDING = {\r\n  top: 40,\r\n  bottom: 40,\r\n  left: 40,\r\n  right: 40\r\n};\r\n\r\n// Page break selector\r\nexport const PAGE_BREAK_SELECTOR = 'page-break, [data-page-break=\"true\"]';\r\n\r\n/**\r\n * Get page dimensions for a given page size\r\n * @param {string} pageSize - The page size (A4, Letter, Legal)\r\n * @returns {Object} Dimensions object with width and height\r\n */\r\nexport const getPageDimensions = (pageSize) => {\r\n  return PAGE_SIZES[pageSize] || PAGE_SIZES.A4;\r\n};\r\n\r\n/**\r\n * Calculate visual page boundaries based on <page-break> tags in content\r\n * Returns array of boundary objects with top positions\r\n * @param {HTMLElement} editor - The editor element\r\n * @param {Object} options - Options for boundary calculation\r\n * @param {string} options.pageSize - The page size to use\r\n * @returns {Array} Array of boundary objects\r\n */\r\nexport const calculatePageBoundaries = (editor, options = {}) => {\r\n  if (!editor || typeof document === 'undefined') {\r\n    return [];\r\n  }\r\n\r\n  const targetPageSize = options.pageSize || 'A4';\r\n  const dimensions = getPageDimensions(targetPageSize);\r\n  \r\n  // Find all <page-break> elements\r\n  const pageBreakElements = editor.querySelectorAll(PAGE_BREAK_SELECTOR);\r\n  \r\n  const boundaries = [];\r\n  \r\n  // Always have at least one page (page 1)\r\n  boundaries.push({\r\n    id: 'page-0',\r\n    pageNumber: 1,\r\n    top: 0,\r\n    height: dimensions.height\r\n  });\r\n\r\n  // Add boundaries for each page break\r\n  const editorRect = editor.getBoundingClientRect();\r\n  const editorScrollTop = editor.scrollTop;\r\n  \r\n  pageBreakElements.forEach((breakEl, index) => {\r\n    const rect = breakEl.getBoundingClientRect();\r\n    const relativeTop = rect.top - editorRect.top + editorScrollTop;\r\n    \r\n    boundaries.push({\r\n      id: `page-${index + 1}`,\r\n      pageNumber: index + 2,\r\n      top: relativeTop,\r\n      height: dimensions.height\r\n    });\r\n  });\r\n\r\n  return boundaries;\r\n};\r\n\r\n/**\r\n * Calculate maximum content height for a page accounting for zoom and margins\r\n * This is the height available for actual content INSIDE the contenteditable div\r\n * The contenteditable div itself has padding applied via getMarginPixels\r\n * So we need to subtract both the margins AND the padding from the page height\r\n * @param {string} pageSize - The page size\r\n * @param {number} zoomLevel - Current zoom level percentage\r\n * @param {string} pageMargins - The margin preset name\r\n * @returns {number} Maximum content height in pixels (actual content area inside padding)\r\n */\r\nexport const calculateMaxContentHeight = (pageSize, zoomLevel = 100, pageMargins = DEFAULT_MARGIN_PRESET) => {\r\n  const dimensions = getPageDimensions(pageSize);\r\n  const verticalMargins = getTotalVerticalMargins(pageMargins);\r\n  \r\n  // The page has total height = dimensions.height\r\n  // The contenteditable div has padding applied via getMarginPixels (which are the same as margins)\r\n  // So the actual content area height = page height - (top margin + bottom margin) = dimensions.height - verticalMargins\r\n  // This is already the max height for content inside the padding\r\n  const baseMaxHeight = dimensions.height - verticalMargins;\r\n  const zoomMultiplier = zoomLevel / 100;\r\n  return baseMaxHeight / zoomMultiplier;\r\n};\r\n\r\n/**\r\n * Get current page number based on viewport scroll position\r\n * @param {HTMLElement} container - The scroll container element\r\n * @param {HTMLElement} editor - The editor element\r\n * @returns {number} Current page index (0-based)\r\n */\r\nexport const getCurrentPage = (container, editor) => {\r\n  if (!container || !editor) {\r\n    return 0;\r\n  }\r\n\r\n  try {\r\n    // Get all page breaks\r\n    const pageBreaks = editor.querySelectorAll(PAGE_BREAK_SELECTOR);\r\n    \r\n    if (pageBreaks.length === 0) {\r\n      return 0; // Only one page\r\n    }\r\n    \r\n    // Get viewport center position\r\n    const containerRect = container.getBoundingClientRect();\r\n    const viewportCenter = containerRect.top + (containerRect.height / 2);\r\n    \r\n    // Check each page break to find which page we're on\r\n    // Start from the last break and work backwards\r\n    for (let i = pageBreaks.length - 1; i >= 0; i--) {\r\n      const breakElement = pageBreaks[i];\r\n      const breakRect = breakElement.getBoundingClientRect();\r\n      \r\n      // If the break is above the viewport center, we're on the page after it\r\n      if (breakRect.top < viewportCenter) {\r\n        return i + 1; // Page index (0-based)\r\n      }\r\n    }\r\n    \r\n    // If we're above all breaks, we're on page 0\r\n    return 0;\r\n  } catch (error) {\r\n    console.warn('[getCurrentPage] Failed to calculate page:', error);\r\n    return 0;\r\n  }\r\n};\r\n\r\n/**\r\n * Split content into pages based on existing page breaks\r\n * @param {HTMLElement} editor - The editor element\r\n * @returns {Array} Array of page element arrays\r\n */\r\nexport const splitContentIntoPages = (editor) => {\r\n  if (!editor) {\r\n    return [];\r\n  }\r\n\r\n  const allChildren = Array.from(editor.children);\r\n  \r\n  if (allChildren.length === 0) {\r\n    return [];\r\n  }\r\n  \r\n  // Split content into pages based on existing breaks\r\n  let pages = [];\r\n  let currentPage = [];\r\n  \r\n  for (const child of allChildren) {\r\n    if (child.tagName === 'PAGE-BREAK' || child.getAttribute('data-page-break') === 'true') {\r\n      if (currentPage.length > 0) {\r\n        pages.push(currentPage);\r\n        currentPage = [];\r\n      }\r\n    } else {\r\n      currentPage.push(child);\r\n    }\r\n  }\r\n  \r\n  // Add the last page\r\n  if (currentPage.length > 0) {\r\n    pages.push(currentPage);\r\n  }\r\n  \r\n  // If no pages, all elements are on one page\r\n  if (pages.length === 0 && allChildren.length > 0) {\r\n    pages.push(allChildren.filter(el => \r\n      !(el.tagName === 'PAGE-BREAK' || el.getAttribute('data-page-break') === 'true')\r\n    ));\r\n  }\r\n  \r\n  return pages;\r\n};","/**\r\n * Page break utilities\r\n * Handles creating, inserting, and managing page breaks\r\n */\r\n\r\nimport { PAGE_BREAK_SELECTOR, calculateMaxContentHeight } from './page-boundary-utils.js';\r\n\r\n/**\r\n * Get the total height of an element including its margins\r\n * Optimized to use known CSS margins instead of getComputedStyle\r\n * Based on MultiPageEditor.css: .continuous-content p { margin: 0 0 16px 0; }\r\n * @param {HTMLElement} element - The element to measure\r\n * @returns {number} Total height including margins\r\n */\r\nconst getElementTotalHeight = (element) => {\r\n  if (!element || !element.getBoundingClientRect) {\r\n    return 0;\r\n  }\r\n  \r\n  const rect = element.getBoundingClientRect();\r\n  \r\n  // Based on our CSS, paragraph elements have 16px bottom margin\r\n  // .continuous-content p { margin: 0 0 16px 0; }\r\n  if (element.tagName === 'P') {\r\n    return rect.height + 16;  // Add known bottom margin\r\n  }\r\n  \r\n  // For other block elements (headings, lists), use a conservative estimate\r\n  if (element.tagName === 'H1' || element.tagName === 'H2' || element.tagName === 'H3' || \r\n      element.tagName === 'H4' || element.tagName === 'H5' || element.tagName === 'H6') {\r\n    return rect.height + 20;  // Headings typically have larger margins\r\n  }\r\n  \r\n  if (element.tagName === 'UL' || element.tagName === 'OL') {\r\n    return rect.height + 16;  // Lists have similar margins to paragraphs\r\n  }\r\n  \r\n  // For other elements, just return the rect height\r\n  return rect.height;\r\n};\r\n\r\n/**\r\n * Insert a page break element before the specified element\r\n * @param {HTMLElement} targetElement - The element to insert the page break before\r\n * @param {number} pageNumber - The page number for this break\r\n * @returns {boolean} Success status\r\n */\r\nexport const insertPageBreakBefore = (targetElement, pageNumber) => {\r\n  if (!targetElement) {\r\n    return false;\r\n  }\r\n\r\n  try {\r\n    const pageBreak = document.createElement('page-break');\r\n    pageBreak.setAttribute('data-page-break', 'true');\r\n    pageBreak.setAttribute('contenteditable', 'false');\r\n    pageBreak.setAttribute('data-page-number', pageNumber || '2');\r\n    \r\n    // Insert before the target element\r\n    targetElement.parentNode.insertBefore(pageBreak, targetElement);\r\n    \r\n    return true;\r\n  } catch (error) {\r\n    console.warn('[insertPageBreakBefore] Failed to insert page break:', error);\r\n    return false;\r\n  }\r\n};\r\n\r\n/**\r\n * Insert a page break at a specific page boundary based on content height\r\n * @param {HTMLElement} editor - The editor element\r\n * @param {number} pageNumber - The page number where the break should be inserted (1-based)\r\n * @param {string} pageSize - The page size\r\n * @param {number} zoomLevel - Current zoom level percentage\r\n * @param {string} pageMargins - The margin preset name\r\n * @param {Function} updateContentCallback - Callback to update content in context\r\n * @param {Function} updateBoundariesCallback - Callback to update boundaries\r\n * @returns {boolean} Success status\r\n */\r\nexport const insertPageBreakAtBoundary = (\r\n  editor,\r\n  pageNumber,\r\n  pageSize,\r\n  zoomLevel,\r\n  pageMargins,\r\n  updateContentCallback,\r\n  updateBoundariesCallback\r\n) => {\r\n  if (!editor) {\r\n    return false;\r\n  }\r\n\r\n  try {\r\n    // Calculate max content height accounting for zoom, padding, and margins\r\n    const maxHeight = calculateMaxContentHeight(pageSize, zoomLevel, pageMargins);\r\n    \r\n    // Target height for the page break insertion\r\n    const targetHeight = maxHeight * (pageNumber - 1);\r\n    \r\n    // Get all children and find where to insert the break\r\n    const allChildren = Array.from(editor.children);\r\n    let accumulatedHeight = 0;\r\n    let insertBeforeElement = null;\r\n    \r\n    for (let i = 0; i < allChildren.length; i++) {\r\n      const child = allChildren[i];\r\n      \r\n      // Skip existing page breaks\r\n      if (child.tagName === 'PAGE-BREAK' || child.getAttribute('data-page-break') === 'true') {\r\n        continue;\r\n      }\r\n      \r\n      const childHeight = getElementTotalHeight(child);\r\n      \r\n      // Check if adding this element would exceed the target height\r\n      if (accumulatedHeight + childHeight > targetHeight) {\r\n        insertBeforeElement = child;\r\n        break;\r\n      }\r\n      \r\n      accumulatedHeight += childHeight;\r\n    }\r\n    \r\n    // If we found an insertion point, insert the page break\r\n    if (insertBeforeElement) {\r\n      const pageBreak = document.createElement('page-break');\r\n      pageBreak.setAttribute('data-page-break', 'true');\r\n      pageBreak.setAttribute('contenteditable', 'false');\r\n      pageBreak.setAttribute('data-page-number', String(pageNumber));\r\n      \r\n      insertBeforeElement.parentNode.insertBefore(pageBreak, insertBeforeElement);\r\n      \r\n      // Update content in Context\r\n      if (updateContentCallback) {\r\n        const updatedHTML = editor.innerHTML;\r\n        updateContentCallback(updatedHTML);\r\n      }\r\n      \r\n      // Update boundaries\r\n      if (updateBoundariesCallback) {\r\n        setTimeout(() => {\r\n          updateBoundariesCallback();\r\n        }, 50);\r\n      }\r\n      \r\n      return true;\r\n    } else {\r\n      // If no insertion point found, insert at the end\r\n      const pageBreak = document.createElement('page-break');\r\n      pageBreak.setAttribute('data-page-break', 'true');\r\n      pageBreak.setAttribute('contenteditable', 'false');\r\n      pageBreak.setAttribute('data-page-number', String(pageNumber));\r\n      \r\n      editor.appendChild(pageBreak);\r\n      \r\n      // Add an empty paragraph after the break\r\n      const emptyParagraph = document.createElement('p');\r\n      emptyParagraph.innerHTML = '<br>';\r\n      editor.appendChild(emptyParagraph);\r\n      \r\n      // Update content in Context\r\n      if (updateContentCallback) {\r\n        const updatedHTML = editor.innerHTML;\r\n        updateContentCallback(updatedHTML);\r\n      }\r\n      \r\n      // Update boundaries\r\n      if (updateBoundariesCallback) {\r\n        setTimeout(() => {\r\n          updateBoundariesCallback();\r\n        }, 50);\r\n      }\r\n      \r\n      return true;\r\n    }\r\n  } catch (error) {\r\n    console.error('[insertPageBreakAtBoundary] Failed to insert page break:', error);\r\n    return false;\r\n  }\r\n};\r\n\r\n/**\r\n * Remove a page and its content from the continuous editor\r\n * Removes the page break and all content between the page boundaries\r\n * @param {HTMLElement} editor - The editor element\r\n * @param {number} pageIndex - The index of the page to remove (0-based)\r\n * @param {Function} calculateBoundariesCallback - Callback to calculate boundaries\r\n * @param {Function} updateContentCallback - Callback to update content in context\r\n * @param {Function} updateBoundariesCallback - Callback to update boundaries\r\n * @param {Function} positionCursorCallback - Callback to position cursor\r\n * @param {Function} checkReflowCallback - Callback to trigger reflow\r\n * @returns {boolean} Success status\r\n */\r\nexport const removePageAndContent = (\r\n  editor, \r\n  pageIndex, \r\n  calculateBoundariesCallback, \r\n  updateContentCallback, \r\n  updateBoundariesCallback, \r\n  positionCursorCallback, \r\n  checkReflowCallback\r\n) => {\r\n  if (!editor) {\r\n    return false;\r\n  }\r\n\r\n  const boundaries = calculateBoundariesCallback();\r\n\r\n  // Cannot delete if only one page\r\n  if (boundaries.length <= 1) {\r\n    console.warn('[removePageAndContent] Cannot delete the only page');\r\n    return false;\r\n  }\r\n\r\n  try {\r\n    // Find all page breaks in the editor\r\n    const pageBreaks = Array.from(editor.querySelectorAll(PAGE_BREAK_SELECTOR));\r\n    \r\n    if (pageIndex > pageBreaks.length) {\r\n      console.warn('[removePageAndContent] Invalid page index');\r\n      return false;\r\n    }\r\n\r\n    // Save cursor position before deletion\r\n    const selection = window.getSelection();\r\n    let cursorWasInDeletedContent = false;\r\n    \r\n    let nodesToRemove = [];\r\n    let pageBreakToRemove = null;\r\n\r\n    // Special handling for first page (pageIndex === 0)\r\n    if (pageIndex === 0) {\r\n      // For the first page, remove all content before the first page break\r\n      const firstPageBreak = pageBreaks[0];\r\n      \r\n      if (!firstPageBreak) {\r\n        console.warn('[removePageAndContent] No page break found for first page');\r\n        return false;\r\n      }\r\n\r\n      // Collect all nodes before the first page break\r\n      let currentNode = editor.firstChild;\r\n      while (currentNode && currentNode !== firstPageBreak) {\r\n        nodesToRemove.push(currentNode);\r\n        currentNode = currentNode.nextSibling;\r\n      }\r\n\r\n      // The first page break itself should also be removed\r\n      pageBreakToRemove = firstPageBreak;\r\n\r\n    } else {\r\n      // For pages 1 and onwards, remove content between page breaks\r\n      // The page break that starts this page is at index (pageIndex - 1)\r\n      // because page 0 has no break, page 1 has break[0], page 2 has break[1], etc.\r\n      const pageBreakElement = pageBreaks[pageIndex - 1];\r\n      \r\n      if (!pageBreakElement) {\r\n        console.warn('[removePageAndContent] Page break not found');\r\n        return false;\r\n      }\r\n\r\n      // Find the next page break (if any) to determine the end of this page\r\n      const nextPageBreakElement = pageBreaks[pageIndex];\r\n\r\n      // Collect all nodes between the current page break and the next one (or end)\r\n      let currentNode = pageBreakElement.nextSibling;\r\n\r\n      while (currentNode) {\r\n        // Stop if we reach the next page break\r\n        if (currentNode === nextPageBreakElement) {\r\n          break;\r\n        }\r\n        \r\n        nodesToRemove.push(currentNode);\r\n        currentNode = currentNode.nextSibling;\r\n      }\r\n\r\n      pageBreakToRemove = pageBreakElement;\r\n    }\r\n\r\n    // Check if cursor is in the content being deleted\r\n    if (selection && selection.rangeCount > 0) {\r\n      const range = selection.getRangeAt(0);\r\n      const cursorNode = range.startContainer;\r\n      \r\n      for (const node of nodesToRemove) {\r\n        if (node.contains(cursorNode) || node === cursorNode) {\r\n          cursorWasInDeletedContent = true;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    // Remove the page break element\r\n    if (pageBreakToRemove && pageBreakToRemove.parentNode) {\r\n      pageBreakToRemove.remove();\r\n    }\r\n\r\n    // Remove all content nodes\r\n    nodesToRemove.forEach(node => {\r\n      if (node.parentNode) {\r\n        node.remove();\r\n      }\r\n    });\r\n\r\n    // Renumber remaining page breaks\r\n    const remainingBreaks = editor.querySelectorAll(PAGE_BREAK_SELECTOR);\r\n    remainingBreaks.forEach((breakEl, index) => {\r\n      breakEl.setAttribute('data-page-number', String(index + 2));\r\n    });\r\n\r\n    // Position cursor appropriately after deletion\r\n    if (cursorWasInDeletedContent && positionCursorCallback) {\r\n      // Position cursor at the start of the first remaining page (page 0)\r\n      setTimeout(() => {\r\n        positionCursorCallback(0);\r\n      }, 50);\r\n    }\r\n\r\n    // Update content in Context\r\n    if (updateContentCallback) {\r\n      const updatedHTML = editor.innerHTML;\r\n      updateContentCallback(updatedHTML);\r\n    }\r\n\r\n    // Update boundaries after deletion\r\n    if (updateBoundariesCallback) {\r\n      setTimeout(() => {\r\n        updateBoundariesCallback();\r\n        \r\n        // Trigger auto reflow to handle any overflow from content redistribution\r\n        if (checkReflowCallback) {\r\n          setTimeout(() => {\r\n            checkReflowCallback();\r\n          }, 150);\r\n        }\r\n      }, 100);\r\n    }\r\n\r\n    return true;\r\n  } catch (error) {\r\n    console.error('[removePageAndContent] Failed to remove page:', error);\r\n    return false;\r\n  }\r\n};\r\n\r\n/**\r\n * Renumber all page breaks in the editor\r\n * @param {HTMLElement} editor - The editor element\r\n */\r\nexport const renumberPageBreaks = (editor) => {\r\n  if (!editor) {\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const pageBreaks = editor.querySelectorAll(PAGE_BREAK_SELECTOR);\r\n    pageBreaks.forEach((breakEl, index) => {\r\n      breakEl.setAttribute('data-page-number', String(index + 2));\r\n    });\r\n  } catch (error) {\r\n    console.error('[renumberPageBreaks] Failed to renumber page breaks:', error);\r\n  }\r\n};","/**\r\n * Content reflow utilities\r\n * Handles detecting content overflow and managing reflow operations\r\n */\r\n\r\nimport { calculateMaxContentHeight, splitContentIntoPages } from './page-boundary-utils.js';\r\nimport { insertPageBreakBefore } from './page-break-utils.js';\r\n\r\n// Performance constants\r\nexport const DEFAULT_REFLOW_DELAY = 200; // Reduced from 500ms for better typing responsiveness\r\nexport const BOUNDARY_UPDATE_DELAY = 50;\r\nexport const MAX_PAGES_PER_REFLOW = 3; // Process up to 3 pages per reflow cycle\r\nexport const MIN_OVERFLOW_THRESHOLD = 20; // Minimum pixels of overflow before breaking\r\n\r\n/**\r\n * Get the total height of an element including its margins\r\n * Optimized to use known CSS margins instead of getComputedStyle\r\n * Based on MultiPageEditor.css: .continuous-content p { margin: 0 0 16px 0; }\r\n * @param {HTMLElement} element - The element to measure\r\n * @returns {number} Total height including margins\r\n */\r\nconst getElementTotalHeight = (element) => {\r\n  if (!element || !element.getBoundingClientRect) {\r\n    return 0;\r\n  }\r\n  \r\n  const rect = element.getBoundingClientRect();\r\n  \r\n  // Based on our CSS, paragraph elements have 16px bottom margin\r\n  // .continuous-content p { margin: 0 0 16px 0; }\r\n  if (element.tagName === 'P') {\r\n    return rect.height + 16;  // Add known bottom margin\r\n  }\r\n  \r\n  // For other block elements (headings, lists), use a conservative estimate\r\n  if (element.tagName === 'H1' || element.tagName === 'H2' || element.tagName === 'H3' || \r\n      element.tagName === 'H4' || element.tagName === 'H5' || element.tagName === 'H6') {\r\n    return rect.height + 20;  // Headings typically have larger margins\r\n  }\r\n  \r\n  if (element.tagName === 'UL' || element.tagName === 'OL') {\r\n    return rect.height + 16;  // Lists have similar margins to paragraphs\r\n  }\r\n  \r\n  // For other elements, just return the rect height\r\n  return rect.height;\r\n};\r\n\r\n/**\r\n * Check if content in a page section exceeds the maximum height\r\n * Returns the element where overflow occurs\r\n * Optimized for performance with early exit\r\n * @param {Array} pageElements - Array of elements in the page\r\n * @param {number} maxHeight - Maximum height for the page\r\n * @returns {Object|null} Overflow information or null if no overflow\r\n */\r\nexport const findOverflowPoint = (pageElements, maxHeight) => {\r\n  if (!pageElements || pageElements.length === 0) {\r\n    return null;\r\n  }\r\n  \r\n  let currentHeight = 0;\r\n  let lastValidElement = null;\r\n  \r\n  for (let i = 0; i < pageElements.length; i++) {\r\n    const element = pageElements[i];\r\n    if (!element || !element.getBoundingClientRect) {\r\n      continue;\r\n    }\r\n    \r\n    const elementHeight = getElementTotalHeight(element);\r\n    \r\n    // Skip empty elements (like empty <p> tags from Enter key)\r\n    if (elementHeight < 1) {\r\n      continue;\r\n    }\r\n    \r\n    const potentialHeight = currentHeight + elementHeight;\r\n    \r\n    // Check if adding this element would exceed the page height\r\n    if (potentialHeight > maxHeight) {\r\n      // If we haven't added any elements yet (first element is too large)\r\n      if (lastValidElement === null) {\r\n        // Element is larger than page - must break anyway\r\n        // But only if it's not the very first element on the page\r\n        if (i > 0) {\r\n          return { \r\n            overflowIndex: i, \r\n            overflowElement: element, \r\n            accumulatedHeight: currentHeight \r\n          };\r\n        }\r\n        // If it's the first element and it's too large, let it overflow (unbreakable content)\r\n        return null;\r\n      }\r\n      \r\n      // We have overflow - return the current element as the break point\r\n      return { \r\n        overflowIndex: i, \r\n        overflowElement: element, \r\n        accumulatedHeight: currentHeight \r\n      };\r\n    }\r\n    \r\n    // Element fits, add it to current height\r\n    currentHeight += elementHeight;\r\n    lastValidElement = element;\r\n  }\r\n  \r\n  return null; // No overflow\r\n};\r\n\r\n/**\r\n * Automatic reflow: Insert page breaks when content exceeds page height\r\n * Optimized with performance guards and single-page-at-a-time processing\r\n * Accounts for current zoom level and margins when calculating max height\r\n * @param {HTMLElement} editor - The editor element\r\n * @param {string} pageSize - The page size\r\n * @param {number} zoomLevel - Current zoom level percentage\r\n * @param {string} pageMargins - The margin preset name\r\n * @param {Function} updateContentCallback - Callback to update content in context\r\n * @param {Function} updateBoundariesCallback - Callback to update boundaries\r\n * @param {boolean} isReflowingRef - Reference to track if reflow is in progress\r\n * @param {Function} checkAndReflowCallback - Callback to trigger additional reflow if needed\r\n * @returns {boolean} True if reflow was performed, false otherwise\r\n */\r\nexport const checkAndReflow = (\r\n  editor, \r\n  pageSize, \r\n  zoomLevel, \r\n  pageMargins,\r\n  updateContentCallback, \r\n  updateBoundariesCallback, \r\n  isReflowingRef, \r\n  checkAndReflowCallback\r\n) => {\r\n  // Performance guard: prevent concurrent reflows\r\n  if (!editor || isReflowingRef.current) {\r\n    return false;\r\n  }\r\n\r\n  try {\r\n    isReflowingRef.current = true;\r\n    \r\n    const maxHeight = calculateMaxContentHeight(pageSize, zoomLevel, pageMargins);\r\n    \r\n    // Split content into pages based on existing breaks\r\n    let pages = splitContentIntoPages(editor);\r\n    \r\n    // Check each page for overflow (process ALL pages for better typing support)\r\n    let insertedBreaks = false;\r\n    let pagesProcessed = 0;\r\n    \r\n    for (let pageIndex = 0; pageIndex < pages.length && pagesProcessed < MAX_PAGES_PER_REFLOW; pageIndex++) {\r\n      const pageElements = pages[pageIndex];\r\n      const overflow = findOverflowPoint(pageElements, maxHeight);\r\n      \r\n      // Only insert break if we have actual overflow and not on first element\r\n      // Also check that the overflow is significant (not just a pixel or two)\r\n      if (overflow && overflow.overflowIndex > 0) {\r\n        // Calculate actual overflow amount\r\n        let totalPageHeight = 0;\r\n        for (let i = 0; i < pageElements.length; i++) {\r\n          const el = pageElements[i];\r\n          if (el && el.getBoundingClientRect) {\r\n            totalPageHeight += getElementTotalHeight(el);\r\n          }\r\n        }\r\n        \r\n        // Only break if overflow is significant\r\n        const overflowAmount = totalPageHeight - maxHeight;\r\n        if (overflowAmount < MIN_OVERFLOW_THRESHOLD) {\r\n          continue; // Skip this page, overflow is too small\r\n        }\r\n        \r\n        const pageNumber = pageIndex + 2;\r\n        const inserted = insertPageBreakBefore(overflow.overflowElement, pageNumber);\r\n        \r\n        if (inserted) {\r\n          insertedBreaks = true;\r\n          pagesProcessed++;\r\n          \r\n          // Re-query pages after insertion to continue checking\r\n          const updatedPages = splitContentIntoPages(editor);\r\n          pages = updatedPages;\r\n        }\r\n      }\r\n    }\r\n    \r\n    // Update boundaries if we inserted breaks\r\n    if (insertedBreaks) {\r\n      // Trigger content update to Context\r\n      if (updateContentCallback) {\r\n        const html = editor.innerHTML;\r\n        updateContentCallback(html);\r\n      }\r\n      \r\n      // Recalculate boundaries with slight delay for DOM update\r\n      setTimeout(() => {\r\n        if (updateBoundariesCallback) {\r\n          updateBoundariesCallback();\r\n        }\r\n        \r\n        // If we processed the max number of pages, schedule another reflow check\r\n        // to handle any remaining overflows from typing\r\n        if (pagesProcessed >= MAX_PAGES_PER_REFLOW && checkAndReflowCallback) {\r\n          setTimeout(() => {\r\n            if (!isReflowingRef.current) {\r\n              checkAndReflowCallback();\r\n            }\r\n          }, 100);\r\n        }\r\n      }, BOUNDARY_UPDATE_DELAY);\r\n    }\r\n    \r\n    return insertedBreaks;\r\n  } catch (error) {\r\n    console.warn('[checkAndReflow] Reflow failed:', error);\r\n    return false;\r\n  } finally {\r\n    isReflowingRef.current = false;\r\n  }\r\n};\r\n\r\n/**\r\n * Debounced automatic reflow check\r\n * Optimized to prevent excessive reflow operations\r\n * @param {Function} checkAndReflowCallback - The reflow function to call\r\n * @param {Object} timeoutRef - Reference to store the timeout\r\n * @param {number} delay - Delay in milliseconds\r\n */\r\nexport const triggerAutoReflow = (checkAndReflowCallback, timeoutRef, delay = DEFAULT_REFLOW_DELAY) => {\r\n  if (timeoutRef.current) {\r\n    clearTimeout(timeoutRef.current);\r\n  }\r\n\r\n  timeoutRef.current = setTimeout(() => {\r\n    timeoutRef.current = null;\r\n    checkAndReflowCallback();\r\n  }, delay);\r\n};","/**\r\n * Cursor and scroll utilities\r\n * Handles cursor positioning and scroll operations for page navigation\r\n */\r\n\r\nimport { PAGE_BREAK_SELECTOR } from './page-boundary-utils.js';\r\n\r\n// Performance constants\r\nexport const CURSOR_POSITION_DELAY = 400;\r\nexport const SCROLL_POSITION_DELAY = 50;\r\n\r\n/**\r\n * Position cursor at the start of a specific page\r\n * @param {HTMLElement} editor - The editor element\r\n * @param {number} pageNumber - The page number (0-based)\r\n */\r\nexport const positionCursorAtPage = (editor, pageNumber) => {\r\n  if (!editor) {\r\n    return;\r\n  }\r\n\r\n  editor.focus();\r\n\r\n  try {\r\n    let targetNode = null;\r\n    let targetOffset = 0;\r\n\r\n    if (pageNumber === 0) {\r\n      // First page - position at start\r\n      targetNode = editor.firstChild;\r\n      targetOffset = 0;\r\n    } else {\r\n      // Find the page break element for this page\r\n      const pageBreaks = editor.querySelectorAll(PAGE_BREAK_SELECTOR);\r\n      const breakElement = pageBreaks[pageNumber - 1];\r\n      \r\n      if (breakElement && breakElement.nextSibling) {\r\n        targetNode = breakElement.nextSibling;\r\n        targetOffset = 0;\r\n      }\r\n    }\r\n\r\n    if (targetNode) {\r\n      const range = document.createRange();\r\n      const selection = window.getSelection();\r\n      \r\n      // If target is a text node, use it directly\r\n      if (targetNode.nodeType === Node.TEXT_NODE) {\r\n        range.setStart(targetNode, targetOffset);\r\n      } else {\r\n        // If it's an element, position at its start\r\n        range.setStart(targetNode, 0);\r\n      }\r\n      \r\n      range.collapse(true);\r\n      selection.removeAllRanges();\r\n      selection.addRange(range);\r\n    }\r\n  } catch (error) {\r\n    console.warn('[positionCursorAtPage] Failed to position cursor:', error);\r\n  }\r\n};\r\n\r\n/**\r\n * Scroll to a specific page and position cursor at the start of that page\r\n * @param {HTMLElement} container - The scroll container element\r\n * @param {HTMLElement} editor - The editor element\r\n * @param {number} pageNumber - The page number (0-based)\r\n * @param {Function} positionCursorCallback - Callback to position cursor\r\n */\r\nexport const scrollToPage = (container, editor, pageNumber, positionCursorCallback) => {\r\n  if (!container || !editor) {\r\n    console.warn('[scrollToPage] Missing refs');\r\n    return;\r\n  }\r\n  \r\n  try {\r\n    let targetElement = null;\r\n    \r\n    if (pageNumber === 0) {\r\n      // First page - scroll to top of editor\r\n      targetElement = editor;\r\n    } else {\r\n      // Find the page break for this page\r\n      const pageBreaks = editor.querySelectorAll(PAGE_BREAK_SELECTOR);\r\n      const targetBreak = pageBreaks[pageNumber - 1];\r\n      \r\n      if (targetBreak) {\r\n        targetElement = targetBreak;\r\n      } else {\r\n        console.warn('[scrollToPage] Page break not found for page', pageNumber);\r\n        return;\r\n      }\r\n    }\r\n    \r\n    if (targetElement) {\r\n      // Get the element's position relative to the container\r\n      const elementRect = targetElement.getBoundingClientRect();\r\n      const containerRect = container.getBoundingClientRect();\r\n      \r\n      // Calculate scroll position: current scroll + element position relative to container\r\n      const scrollTop = container.scrollTop + (elementRect.top - containerRect.top);\r\n      \r\n      console.log('[scrollToPage] Scrolling to page', pageNumber, 'scrollTop:', scrollTop);\r\n      \r\n      // Scroll to the page\r\n      container.scrollTo({\r\n        top: scrollTop,\r\n        behavior: 'smooth'\r\n      });\r\n      \r\n      // Position cursor after scroll completes\r\n      setTimeout(() => {\r\n        if (positionCursorCallback) {\r\n          positionCursorCallback(pageNumber);\r\n        } else {\r\n          positionCursorAtPage(editor, pageNumber);\r\n        }\r\n      }, CURSOR_POSITION_DELAY);\r\n    }\r\n  } catch (error) {\r\n    console.error('[scrollToPage] Error:', error);\r\n  }\r\n};\r\n\r\n/**\r\n * Debounced boundary calculation\r\n * Triggers after content changes to recalculate page boundaries\r\n * Optimized with configurable delay\r\n * @param {Function} updateBoundariesCallback - Callback to update boundaries\r\n * @param {Object} timeoutRef - Reference to store the timeout\r\n * @param {Object} options - Options for boundary calculation\r\n * @param {number} delay - Delay in milliseconds\r\n */\r\nexport const checkAndUpdateBoundaries = (\r\n  updateBoundariesCallback, \r\n  timeoutRef, \r\n  options = {}, \r\n  delay = 300\r\n) => {\r\n  if (timeoutRef.current) {\r\n    clearTimeout(timeoutRef.current);\r\n  }\r\n\r\n  timeoutRef.current = setTimeout(() => {\r\n    timeoutRef.current = null;\r\n    updateBoundariesCallback(options);\r\n  }, Math.max(0, delay));\r\n};","import { useCallback, useRef, useEffect } from 'react';\r\nimport { useDocumentActions } from '../context/DocumentContext';\r\nimport { \r\n  calculatePageBoundaries, \r\n  getCurrentPage,\r\n  calculateMaxContentHeight\r\n} from '../lib/editor/page-boundary-utils.js';\r\nimport { \r\n  insertPageBreakAtBoundary, \r\n  removePageAndContent \r\n} from '../lib/editor/page-break-utils.js';\r\nimport { \r\n  checkAndReflow, \r\n  triggerAutoReflow \r\n} from '../lib/editor/content-reflow-utils.js';\r\nimport { \r\n  positionCursorAtPage, \r\n  scrollToPage, \r\n  checkAndUpdateBoundaries \r\n} from '../lib/editor/cursor-scroll-utils.js';\r\n\r\n// Performance constants\r\nconst DEFAULT_BOUNDARY_DELAY = 300;\r\n\r\n/**\r\n * useContinuousReflow - Automatically insert page breaks based on content height\r\n * Monitors content height and inserts <page-break> tags when content exceeds page dimensions\r\n * Content remains in a single continuous contenteditable surface\r\n * @param {string} pageSize - The page size (A4, Letter, Legal)\r\n * @param {React.RefObject} editorRef - Reference to the editor element\r\n * @param {number} zoomLevel - Current zoom level percentage (50-200)\r\n * @param {string} pageMargins - The margin preset name\r\n */\r\nexport const useContinuousReflow = (pageSize, editorRef, zoomLevel = 100, pageMargins = 'NARROW') => {\r\n  const actions = useDocumentActions();\r\n  const boundaryTimeoutRef = useRef(null);\r\n  const reflowTimeoutRef = useRef(null);\r\n  const latestPageSizeRef = useRef(pageSize);\r\n  const latestZoomLevelRef = useRef(zoomLevel);\r\n  const latestPageMarginsRef = useRef(pageMargins);\r\n  const isReflowingRef = useRef(false);\r\n\r\n  useEffect(() => {\r\n    latestPageSizeRef.current = pageSize;\r\n  }, [pageSize]);\r\n\r\n  useEffect(() => {\r\n    latestZoomLevelRef.current = zoomLevel;\r\n  }, [zoomLevel]);\r\n\r\n  useEffect(() => {\r\n    latestPageMarginsRef.current = pageMargins;\r\n  }, [pageMargins]);\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      if (boundaryTimeoutRef.current) {\r\n        clearTimeout(boundaryTimeoutRef.current);\r\n      }\r\n      if (reflowTimeoutRef.current) {\r\n        clearTimeout(reflowTimeoutRef.current);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  /**\r\n   * Calculate visual page boundaries based on <page-break> tags in content\r\n   * Returns array of boundary objects with top positions\r\n   * Optimized with cached selectors and better null checks\r\n   */\r\n  const calculatePageBoundariesCallback = useCallback((options = {}) => {\r\n    if (!editorRef?.current) {\r\n      return [];\r\n    }\r\n    return calculatePageBoundaries(editorRef.current, options);\r\n  }, [editorRef]);\r\n\r\n  /**\r\n   * Update page boundaries in Context state\r\n   */\r\n  const updateBoundaries = useCallback((options = {}) => {\r\n    const boundaries = calculatePageBoundariesCallback(options);\r\n    actions.updatePageBoundaries(boundaries);\r\n    return boundaries;\r\n  }, [calculatePageBoundariesCallback, actions]);\r\n\r\n  /**\r\n   * Insert a page break at a specific page boundary based on content height\r\n   * This is used when manually adding pages to insert them at the correct location\r\n   * @param {number} pageNumber - The page number where the break should be inserted (1-based)\r\n   * @returns {Promise<boolean>} - Success status\r\n   */\r\n  const insertPageBreakAtBoundaryCallback = useCallback(async (pageNumber) => {\r\n    if (!editorRef?.current) {\r\n      return false;\r\n    }\r\n\r\n    const targetPageSize = latestPageSizeRef.current || 'A4';\r\n    const currentZoom = latestZoomLevelRef.current || 100;\r\n    const currentMargins = latestPageMarginsRef.current || 'NARROW';\r\n    \r\n    return insertPageBreakAtBoundary(\r\n      editorRef.current,\r\n      pageNumber,\r\n      targetPageSize,\r\n      currentZoom,\r\n      currentMargins,\r\n      actions.updateContinuousContent,\r\n      updateBoundaries\r\n    );\r\n  }, [editorRef, actions, updateBoundaries]);\r\n\r\n  /**\r\n   * Automatic reflow: Insert page breaks when content exceeds page height\r\n   * Optimized with performance guards and single-page-at-a-time processing\r\n   * Accounts for current zoom level and margins when calculating max height\r\n   */\r\n  const checkAndReflowCallback = useCallback(() => {\r\n    if (!editorRef?.current) {\r\n      return;\r\n    }\r\n\r\n    const targetPageSize = latestPageSizeRef.current || 'A4';\r\n    const currentZoom = latestZoomLevelRef.current || 100;\r\n    const currentMargins = latestPageMarginsRef.current || 'NARROW';\r\n    \r\n    checkAndReflow(\r\n      editorRef.current,\r\n      targetPageSize,\r\n      currentZoom,\r\n      currentMargins,\r\n      actions.updateContinuousContent,\r\n      updateBoundaries,\r\n      isReflowingRef,\r\n      checkAndReflowCallback\r\n    );\r\n  }, [editorRef, actions, updateBoundaries]);\r\n\r\n  /**\r\n   * Debounced automatic reflow check\r\n   * Optimized to prevent excessive reflow operations\r\n   */\r\n  const triggerAutoReflowCallback = useCallback((delay) => {\r\n    triggerAutoReflow(checkAndReflowCallback, reflowTimeoutRef, delay);\r\n  }, [checkAndReflowCallback]);\r\n\r\n  /**\r\n   * Debounced boundary calculation\r\n   * Triggers after content changes to recalculate page boundaries\r\n   * Optimized with configurable delay\r\n   */\r\n  const checkAndUpdateBoundariesCallback = useCallback((options = {}) => {\r\n    const delay = typeof options.delay === 'number' ? options.delay : DEFAULT_BOUNDARY_DELAY;\r\n    checkAndUpdateBoundaries(updateBoundaries, boundaryTimeoutRef, options, delay);\r\n  }, [updateBoundaries]);\r\n\r\n  /**\r\n   * Get current page number based on viewport scroll position\r\n   * @param {React.RefObject} containerRef - The scroll container element\r\n   */\r\n  const getCurrentPageCallback = useCallback((containerRef) => {\r\n    if (!containerRef?.current || !editorRef?.current) {\r\n      return 0;\r\n    }\r\n    return getCurrentPage(containerRef.current, editorRef.current);\r\n  }, [editorRef]);\r\n\r\n  /**\r\n   * Position cursor at the start of a specific page\r\n   */\r\n  const positionCursorAtPageCallback = useCallback((pageNumber) => {\r\n    if (!editorRef?.current) {\r\n      return;\r\n    }\r\n    positionCursorAtPage(editorRef.current, pageNumber);\r\n  }, [editorRef]);\r\n\r\n  /**\r\n   * Scroll to a specific page and position cursor at the start of that page\r\n   */\r\n  const scrollToPageCallback = useCallback((pageNumber, containerRef) => {\r\n    if (!containerRef?.current || !editorRef?.current) {\r\n      console.warn('[scrollToPage] Missing refs');\r\n      return;\r\n    }\r\n    scrollToPage(containerRef.current, editorRef.current, pageNumber, positionCursorAtPageCallback);\r\n  }, [editorRef, positionCursorAtPageCallback]);\r\n\r\n  /**\r\n   * Remove a page and its content from the continuous editor\r\n   * Removes the page break and all content between the page boundaries\r\n   * @param {number} pageIndex - The index of the page to remove (0-based)\r\n   */\r\n  const removePageAndContentCallback = useCallback((pageIndex) => {\r\n    if (!editorRef?.current) {\r\n      return false;\r\n    }\r\n\r\n    return removePageAndContent(\r\n      editorRef.current,\r\n      pageIndex,\r\n      calculatePageBoundariesCallback,\r\n      actions.updateContinuousContent,\r\n      updateBoundaries,\r\n      positionCursorAtPageCallback,\r\n      checkAndReflowCallback\r\n    );\r\n  }, [editorRef, calculatePageBoundariesCallback, actions, updateBoundaries, positionCursorAtPageCallback, checkAndReflowCallback]);\r\n\r\n  return {\r\n    calculatePageBoundaries: calculatePageBoundariesCallback,\r\n    checkAndUpdateBoundaries: checkAndUpdateBoundariesCallback,\r\n    updateBoundaries,\r\n    getCurrentPage: getCurrentPageCallback,\r\n    scrollToPage: scrollToPageCallback,\r\n    positionCursorAtPage: positionCursorAtPageCallback,\r\n    checkAndReflow: checkAndReflowCallback,\r\n    triggerAutoReflow: triggerAutoReflowCallback,\r\n    removePageAndContent: removePageAndContentCallback,\r\n    insertPageBreakAtBoundary: insertPageBreakAtBoundaryCallback,\r\n    boundaryTimeoutRef,\r\n    reflowTimeoutRef\r\n  };\r\n};\r\n","/**\r\n * IndexedDB storage service for handling image persistence in the editor\r\n * Stores images as base64 data URLs with better scalability than localStorage\r\n * Supports storing many large images without quota limitations\r\n */\r\n\r\nconst DB_NAME = 'html-editor-storage';\r\nconst DB_VERSION = 1;\r\nconst STORE_NAME = 'images';\r\n\r\n/**\r\n * Generates a UUID v4 string for unique image keys\r\n * @returns {string} UUID string\r\n */\r\nfunction generateUUID() {\r\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {\r\n    const r = Math.random() * 16 | 0;\r\n    const v = c === 'x' ? r : (r & 0x3 | 0x8);\r\n    return v.toString(16);\r\n  });\r\n}\r\n\r\n/**\r\n * Opens the IndexedDB database\r\n * @returns {Promise<IDBDatabase>} Promise resolving to database instance\r\n */\r\nfunction openDatabase() {\r\n  return new Promise((resolve, reject) => {\r\n    const request = indexedDB.open(DB_NAME, DB_VERSION);\r\n\r\n    request.onerror = () => {\r\n      reject(new Error('Failed to open IndexedDB database'));\r\n    };\r\n\r\n    request.onsuccess = () => {\r\n      resolve(request.result);\r\n    };\r\n\r\n    request.onupgradeneeded = (event) => {\r\n      const db = event.target.result;\r\n      \r\n      // Create object store if it doesn't exist\r\n      if (!db.objectStoreNames.contains(STORE_NAME)) {\r\n        const objectStore = db.createObjectStore(STORE_NAME, { keyPath: 'key' });\r\n        objectStore.createIndex('timestamp', 'timestamp', { unique: false });\r\n      }\r\n    };\r\n  });\r\n}\r\n\r\n/**\r\n * Saves an image file to IndexedDB\r\n * @param {File} file - Image file to store\r\n * @returns {Promise<string>} Promise resolving to storage key\r\n * @throws {Error} When image validation fails or storage operation fails\r\n */\r\nexport function saveImage(file) {\r\n  return new Promise((resolve, reject) => {\r\n    // Validate file type\r\n    const validTypes = ['image/png', 'image/jpeg', 'image/gif', 'image/webp'];\r\n    if (!validTypes.includes(file.type)) {\r\n      reject(new Error('Invalid image format. Supported formats: png, jpeg, gif, webp'));\r\n      return;\r\n    }\r\n\r\n    // Check file size (5MB limit per image - can be increased as needed)\r\n    if (file.size > 5 * 1024 * 1024) {\r\n      reject(new Error('Image exceeds maximum size of 5MB'));\r\n      return;\r\n    }\r\n\r\n    const reader = new FileReader();\r\n    \r\n    reader.onload = async (event) => {\r\n      const dataUrl = event.target.result;\r\n      \r\n      // Calculate base64 size (3 bytes for every 4 characters)\r\n      const base64String = dataUrl.split(',')[1];\r\n      const sizeInBytes = (base64String.length * 3) / 4;\r\n      \r\n      if (sizeInBytes > 5 * 1024 * 1024) {\r\n        reject(new Error('Image exceeds maximum size of 5MB'));\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const db = await openDatabase();\r\n        const key = `editor-image-${generateUUID()}`;\r\n        \r\n        const transaction = db.transaction([STORE_NAME], 'readwrite');\r\n        const objectStore = transaction.objectStore(STORE_NAME);\r\n        \r\n        const imageData = {\r\n          key,\r\n          dataUrl,\r\n          size: sizeInBytes,\r\n          type: file.type,\r\n          timestamp: Date.now()\r\n        };\r\n        \r\n        const request = objectStore.add(imageData);\r\n        \r\n        request.onsuccess = () => {\r\n          db.close();\r\n          resolve(key);\r\n        };\r\n        \r\n        request.onerror = () => {\r\n          db.close();\r\n          reject(new Error('Failed to save image to IndexedDB'));\r\n        };\r\n      } catch (error) {\r\n        reject(error);\r\n      }\r\n    };\r\n\r\n    reader.onerror = () => {\r\n      reject(new Error('Error reading image file'));\r\n    };\r\n\r\n    reader.readAsDataURL(file);\r\n  });\r\n}\r\n\r\n/**\r\n * Retrieves an image from IndexedDB by key\r\n * @param {string} key - Storage key for the image\r\n * @returns {Promise<string|null>} Promise resolving to data URL of the image or null if not found\r\n */\r\nexport async function getImage(key) {\r\n  try {\r\n    const db = await openDatabase();\r\n    \r\n    return new Promise((resolve, reject) => {\r\n      const transaction = db.transaction([STORE_NAME], 'readonly');\r\n      const objectStore = transaction.objectStore(STORE_NAME);\r\n      const request = objectStore.get(key);\r\n      \r\n      request.onsuccess = () => {\r\n        db.close();\r\n        const result = request.result;\r\n        resolve(result ? result.dataUrl : null);\r\n      };\r\n      \r\n      request.onerror = () => {\r\n        db.close();\r\n        reject(new Error('Failed to retrieve image from IndexedDB'));\r\n      };\r\n    });\r\n  } catch (error) {\r\n    console.error('Error getting image:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\n/**\r\n * Deletes an image from IndexedDB\r\n * @param {string} key - Storage key for the image\r\n * @returns {Promise<void>}\r\n */\r\nexport async function deleteImage(key) {\r\n  try {\r\n    const db = await openDatabase();\r\n    \r\n    return new Promise((resolve, reject) => {\r\n      const transaction = db.transaction([STORE_NAME], 'readwrite');\r\n      const objectStore = transaction.objectStore(STORE_NAME);\r\n      const request = objectStore.delete(key);\r\n      \r\n      request.onsuccess = () => {\r\n        db.close();\r\n        resolve();\r\n      };\r\n      \r\n      request.onerror = () => {\r\n        db.close();\r\n        reject(new Error('Failed to delete image from IndexedDB'));\r\n      };\r\n    });\r\n  } catch (error) {\r\n    console.error('Error deleting image:', error);\r\n  }\r\n}\r\n\r\n/**\r\n * Clears all editor images from IndexedDB\r\n * @returns {Promise<void>}\r\n */\r\nexport async function clearImages() {\r\n  try {\r\n    const db = await openDatabase();\r\n    \r\n    return new Promise((resolve, reject) => {\r\n      const transaction = db.transaction([STORE_NAME], 'readwrite');\r\n      const objectStore = transaction.objectStore(STORE_NAME);\r\n      const request = objectStore.clear();\r\n      \r\n      request.onsuccess = () => {\r\n        db.close();\r\n        resolve();\r\n      };\r\n      \r\n      request.onerror = () => {\r\n        db.close();\r\n        reject(new Error('Failed to clear images from IndexedDB'));\r\n      };\r\n    });\r\n  } catch (error) {\r\n    console.error('Error clearing images:', error);\r\n  }\r\n}\r\n\r\n/**\r\n * Gets all stored image keys\r\n * @returns {Promise<string[]>} Promise resolving to array of image storage keys\r\n */\r\nexport async function getAllImageKeys() {\r\n  try {\r\n    const db = await openDatabase();\r\n    \r\n    return new Promise((resolve, reject) => {\r\n      const transaction = db.transaction([STORE_NAME], 'readonly');\r\n      const objectStore = transaction.objectStore(STORE_NAME);\r\n      const request = objectStore.getAllKeys();\r\n      \r\n      request.onsuccess = () => {\r\n        db.close();\r\n        resolve(request.result || []);\r\n      };\r\n      \r\n      request.onerror = () => {\r\n        db.close();\r\n        reject(new Error('Failed to get image keys from IndexedDB'));\r\n      };\r\n    });\r\n  } catch (error) {\r\n    console.error('Error getting image keys:', error);\r\n    return [];\r\n  }\r\n}\r\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nconst toKebabCase = (string) => string.replace(/([a-z0-9])([A-Z])/g, \"$1-$2\").toLowerCase();\nconst toCamelCase = (string) => string.replace(\n  /^([A-Z])|[\\s-_]+(\\w)/g,\n  (match, p1, p2) => p2 ? p2.toUpperCase() : p1.toLowerCase()\n);\nconst toPascalCase = (string) => {\n  const camelCase = toCamelCase(string);\n  return camelCase.charAt(0).toUpperCase() + camelCase.slice(1);\n};\nconst mergeClasses = (...classes) => classes.filter((className, index, array) => {\n  return Boolean(className) && className.trim() !== \"\" && array.indexOf(className) === index;\n}).join(\" \").trim();\nconst hasA11yProp = (props) => {\n  for (const prop in props) {\n    if (prop.startsWith(\"aria-\") || prop === \"role\" || prop === \"title\") {\n      return true;\n    }\n  }\n};\n\nexport { hasA11yProp, mergeClasses, toCamelCase, toKebabCase, toPascalCase };\n//# sourceMappingURL=utils.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nvar defaultAttributes = {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: 24,\n  height: 24,\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeWidth: 2,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n};\n\nexport { defaultAttributes as default };\n//# sourceMappingURL=defaultAttributes.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport { forwardRef, createElement } from 'react';\nimport defaultAttributes from './defaultAttributes.js';\nimport { mergeClasses, hasA11yProp } from './shared/src/utils.js';\n\nconst Icon = forwardRef(\n  ({\n    color = \"currentColor\",\n    size = 24,\n    strokeWidth = 2,\n    absoluteStrokeWidth,\n    className = \"\",\n    children,\n    iconNode,\n    ...rest\n  }, ref) => createElement(\n    \"svg\",\n    {\n      ref,\n      ...defaultAttributes,\n      width: size,\n      height: size,\n      stroke: color,\n      strokeWidth: absoluteStrokeWidth ? Number(strokeWidth) * 24 / Number(size) : strokeWidth,\n      className: mergeClasses(\"lucide\", className),\n      ...!children && !hasA11yProp(rest) && { \"aria-hidden\": \"true\" },\n      ...rest\n    },\n    [\n      ...iconNode.map(([tag, attrs]) => createElement(tag, attrs)),\n      ...Array.isArray(children) ? children : [children]\n    ]\n  )\n);\n\nexport { Icon as default };\n//# sourceMappingURL=Icon.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport { forwardRef, createElement } from 'react';\nimport { mergeClasses, toKebabCase, toPascalCase } from './shared/src/utils.js';\nimport Icon from './Icon.js';\n\nconst createLucideIcon = (iconName, iconNode) => {\n  const Component = forwardRef(\n    ({ className, ...props }, ref) => createElement(Icon, {\n      ref,\n      iconNode,\n      className: mergeClasses(\n        `lucide-${toKebabCase(toPascalCase(iconName))}`,\n        `lucide-${iconName}`,\n        className\n      ),\n      ...props\n    })\n  );\n  Component.displayName = toPascalCase(iconName);\n  return Component;\n};\n\nexport { createLucideIcon as default };\n//# sourceMappingURL=createLucideIcon.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    { d: \"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8\", key: \"mg9rjx\" }\n  ]\n];\nconst Bold = createLucideIcon(\"bold\", __iconNode);\n\nexport { __iconNode, Bold as default };\n//# sourceMappingURL=bold.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"path\", { d: \"m15 18-6-6 6-6\", key: \"1wnfg3\" }]];\nconst ChevronLeft = createLucideIcon(\"chevron-left\", __iconNode);\n\nexport { __iconNode, ChevronLeft as default };\n//# sourceMappingURL=chevron-left.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"path\", { d: \"m9 18 6-6-6-6\", key: \"mthhwq\" }]];\nconst ChevronRight = createLucideIcon(\"chevron-right\", __iconNode);\n\nexport { __iconNode, ChevronRight as default };\n//# sourceMappingURL=chevron-right.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z\", key: \"1rqfz7\" }],\n  [\"path\", { d: \"M14 2v4a2 2 0 0 0 2 2h4\", key: \"tnqrlb\" }],\n  [\"path\", { d: \"m9 15 2 2 4-4\", key: \"1grp1n\" }]\n];\nconst FileCheck = createLucideIcon(\"file-check\", __iconNode);\n\nexport { __iconNode, FileCheck as default };\n//# sourceMappingURL=file-check.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z\", key: \"1rqfz7\" }],\n  [\"path\", { d: \"M14 2v4a2 2 0 0 0 2 2h4\", key: \"tnqrlb\" }],\n  [\"path\", { d: \"M10 9H8\", key: \"b1mrlr\" }],\n  [\"path\", { d: \"M16 13H8\", key: \"t4e002\" }],\n  [\"path\", { d: \"M16 17H8\", key: \"z1uh3a\" }]\n];\nconst FileText = createLucideIcon(\"file-text\", __iconNode);\n\nexport { __iconNode, FileText as default };\n//# sourceMappingURL=file-text.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"line\", { x1: \"4\", x2: \"20\", y1: \"9\", y2: \"9\", key: \"4lhtct\" }],\n  [\"line\", { x1: \"4\", x2: \"20\", y1: \"15\", y2: \"15\", key: \"vyu0kd\" }],\n  [\"line\", { x1: \"10\", x2: \"8\", y1: \"3\", y2: \"21\", key: \"1ggp8o\" }],\n  [\"line\", { x1: \"16\", x2: \"14\", y1: \"3\", y2: \"21\", key: \"weycgp\" }]\n];\nconst Hash = createLucideIcon(\"hash\", __iconNode);\n\nexport { __iconNode, Hash as default };\n//# sourceMappingURL=hash.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M4 12h8\", key: \"17cfdx\" }],\n  [\"path\", { d: \"M4 18V6\", key: \"1rz3zl\" }],\n  [\"path\", { d: \"M12 18V6\", key: \"zqpxq5\" }],\n  [\"path\", { d: \"m17 12 3-2v8\", key: \"1hhhft\" }]\n];\nconst Heading1 = createLucideIcon(\"heading-1\", __iconNode);\n\nexport { __iconNode, Heading1 as default };\n//# sourceMappingURL=heading-1.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M4 12h8\", key: \"17cfdx\" }],\n  [\"path\", { d: \"M4 18V6\", key: \"1rz3zl\" }],\n  [\"path\", { d: \"M12 18V6\", key: \"zqpxq5\" }],\n  [\"path\", { d: \"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1\", key: \"9jr5yi\" }]\n];\nconst Heading2 = createLucideIcon(\"heading-2\", __iconNode);\n\nexport { __iconNode, Heading2 as default };\n//# sourceMappingURL=heading-2.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M4 12h8\", key: \"17cfdx\" }],\n  [\"path\", { d: \"M4 18V6\", key: \"1rz3zl\" }],\n  [\"path\", { d: \"M12 18V6\", key: \"zqpxq5\" }],\n  [\"path\", { d: \"M17.5 10.5c1.7-1 3.5 0 3.5 1.5a2 2 0 0 1-2 2\", key: \"68ncm8\" }],\n  [\"path\", { d: \"M17 17.5c2 1.5 4 .3 4-1.5a2 2 0 0 0-2-2\", key: \"1ejuhz\" }]\n];\nconst Heading3 = createLucideIcon(\"heading-3\", __iconNode);\n\nexport { __iconNode, Heading3 as default };\n//# sourceMappingURL=heading-3.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"rect\", { width: \"18\", height: \"18\", x: \"3\", y: \"3\", rx: \"2\", ry: \"2\", key: \"1m3agn\" }],\n  [\"circle\", { cx: \"9\", cy: \"9\", r: \"2\", key: \"af1f0g\" }],\n  [\"path\", { d: \"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21\", key: \"1xmnt7\" }]\n];\nconst Image = createLucideIcon(\"image\", __iconNode);\n\nexport { __iconNode, Image as default };\n//# sourceMappingURL=image.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"line\", { x1: \"19\", x2: \"10\", y1: \"4\", y2: \"4\", key: \"15jd3p\" }],\n  [\"line\", { x1: \"14\", x2: \"5\", y1: \"20\", y2: \"20\", key: \"bu0au3\" }],\n  [\"line\", { x1: \"15\", x2: \"9\", y1: \"4\", y2: \"20\", key: \"uljnxc\" }]\n];\nconst Italic = createLucideIcon(\"italic\", __iconNode);\n\nexport { __iconNode, Italic as default };\n//# sourceMappingURL=italic.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\", key: \"1cjeqo\" }],\n  [\"path\", { d: \"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\", key: \"19qd67\" }]\n];\nconst Link = createLucideIcon(\"link\", __iconNode);\n\nexport { __iconNode, Link as default };\n//# sourceMappingURL=link.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M11 5h10\", key: \"1cz7ny\" }],\n  [\"path\", { d: \"M11 12h10\", key: \"1438ji\" }],\n  [\"path\", { d: \"M11 19h10\", key: \"11t30w\" }],\n  [\"path\", { d: \"M4 4h1v5\", key: \"10yrso\" }],\n  [\"path\", { d: \"M4 9h2\", key: \"r1h2o0\" }],\n  [\"path\", { d: \"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02\", key: \"xtkcd5\" }]\n];\nconst ListOrdered = createLucideIcon(\"list-ordered\", __iconNode);\n\nexport { __iconNode, ListOrdered as default };\n//# sourceMappingURL=list-ordered.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M3 5h.01\", key: \"18ugdj\" }],\n  [\"path\", { d: \"M3 12h.01\", key: \"nlz23k\" }],\n  [\"path\", { d: \"M3 19h.01\", key: \"noohij\" }],\n  [\"path\", { d: \"M8 5h13\", key: \"1pao27\" }],\n  [\"path\", { d: \"M8 12h13\", key: \"1za7za\" }],\n  [\"path\", { d: \"M8 19h13\", key: \"m83p4d\" }]\n];\nconst List = createLucideIcon(\"list\", __iconNode);\n\nexport { __iconNode, List as default };\n//# sourceMappingURL=list.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M5 12h14\", key: \"1ays0h\" }],\n  [\"path\", { d: \"M12 5v14\", key: \"s699le\" }]\n];\nconst Plus = createLucideIcon(\"plus\", __iconNode);\n\nexport { __iconNode, Plus as default };\n//# sourceMappingURL=plus.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M21 7v6h-6\", key: \"3ptur4\" }],\n  [\"path\", { d: \"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7\", key: \"1kgawr\" }]\n];\nconst Redo = createLucideIcon(\"redo\", __iconNode);\n\nexport { __iconNode, Redo as default };\n//# sourceMappingURL=redo.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915\",\n      key: \"1i5ecw\"\n    }\n  ],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"3\", key: \"1v7zrd\" }]\n];\nconst Settings = createLucideIcon(\"settings\", __iconNode);\n\nexport { __iconNode, Settings as default };\n//# sourceMappingURL=settings.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M16 4H9a3 3 0 0 0-2.83 4\", key: \"43sutm\" }],\n  [\"path\", { d: \"M14 12a4 4 0 0 1 0 8H6\", key: \"nlfj13\" }],\n  [\"line\", { x1: \"4\", x2: \"20\", y1: \"12\", y2: \"12\", key: \"1e0a9i\" }]\n];\nconst Strikethrough = createLucideIcon(\"strikethrough\", __iconNode);\n\nexport { __iconNode, Strikethrough as default };\n//# sourceMappingURL=strikethrough.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M12 3v18\", key: \"108xh3\" }],\n  [\"rect\", { width: \"18\", height: \"18\", x: \"3\", y: \"3\", rx: \"2\", key: \"afitv7\" }],\n  [\"path\", { d: \"M3 9h18\", key: \"1pudct\" }],\n  [\"path\", { d: \"M3 15h18\", key: \"5xshup\" }]\n];\nconst Table = createLucideIcon(\"table\", __iconNode);\n\nexport { __iconNode, Table as default };\n//# sourceMappingURL=table.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M21 5H3\", key: \"1fi0y6\" }],\n  [\"path\", { d: \"M17 12H7\", key: \"16if0g\" }],\n  [\"path\", { d: \"M19 19H5\", key: \"vjpgq2\" }]\n];\nconst TextAlignCenter = createLucideIcon(\"text-align-center\", __iconNode);\n\nexport { __iconNode, TextAlignCenter as default };\n//# sourceMappingURL=text-align-center.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M21 5H3\", key: \"1fi0y6\" }],\n  [\"path\", { d: \"M21 12H9\", key: \"dn1m92\" }],\n  [\"path\", { d: \"M21 19H7\", key: \"4cu937\" }]\n];\nconst TextAlignEnd = createLucideIcon(\"text-align-end\", __iconNode);\n\nexport { __iconNode, TextAlignEnd as default };\n//# sourceMappingURL=text-align-end.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M3 5h18\", key: \"1u36vt\" }],\n  [\"path\", { d: \"M3 12h18\", key: \"1i2n21\" }],\n  [\"path\", { d: \"M3 19h18\", key: \"awlh7x\" }]\n];\nconst TextAlignJustify = createLucideIcon(\"text-align-justify\", __iconNode);\n\nexport { __iconNode, TextAlignJustify as default };\n//# sourceMappingURL=text-align-justify.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M21 5H3\", key: \"1fi0y6\" }],\n  [\"path\", { d: \"M15 12H3\", key: \"6jk70r\" }],\n  [\"path\", { d: \"M17 19H3\", key: \"z6ezky\" }]\n];\nconst TextAlignStart = createLucideIcon(\"text-align-start\", __iconNode);\n\nexport { __iconNode, TextAlignStart as default };\n//# sourceMappingURL=text-align-start.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M10 11v6\", key: \"nco0om\" }],\n  [\"path\", { d: \"M14 11v6\", key: \"outv1u\" }],\n  [\"path\", { d: \"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6\", key: \"miytrc\" }],\n  [\"path\", { d: \"M3 6h18\", key: \"d0wm0j\" }],\n  [\"path\", { d: \"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\", key: \"e791ji\" }]\n];\nconst Trash2 = createLucideIcon(\"trash-2\", __iconNode);\n\nexport { __iconNode, Trash2 as default };\n//# sourceMappingURL=trash-2.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M6 4v6a6 6 0 0 0 12 0V4\", key: \"9kb039\" }],\n  [\"line\", { x1: \"4\", x2: \"20\", y1: \"20\", y2: \"20\", key: \"nun2al\" }]\n];\nconst Underline = createLucideIcon(\"underline\", __iconNode);\n\nexport { __iconNode, Underline as default };\n//# sourceMappingURL=underline.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M3 7v6h6\", key: \"1v2h90\" }],\n  [\"path\", { d: \"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13\", key: \"1r6uu6\" }]\n];\nconst Undo = createLucideIcon(\"undo\", __iconNode);\n\nexport { __iconNode, Undo as default };\n//# sourceMappingURL=undo.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M18 6 6 18\", key: \"1bl5f8\" }],\n  [\"path\", { d: \"m6 6 12 12\", key: \"d8bk6v\" }]\n];\nconst X = createLucideIcon(\"x\", __iconNode);\n\nexport { __iconNode, X as default };\n//# sourceMappingURL=x.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"11\", cy: \"11\", r: \"8\", key: \"4ej97u\" }],\n  [\"line\", { x1: \"21\", x2: \"16.65\", y1: \"21\", y2: \"16.65\", key: \"13gj7c\" }],\n  [\"line\", { x1: \"11\", x2: \"11\", y1: \"8\", y2: \"14\", key: \"1vmskp\" }],\n  [\"line\", { x1: \"8\", x2: \"14\", y1: \"11\", y2: \"11\", key: \"durymu\" }]\n];\nconst ZoomIn = createLucideIcon(\"zoom-in\", __iconNode);\n\nexport { __iconNode, ZoomIn as default };\n//# sourceMappingURL=zoom-in.js.map\n","/**\n * @license lucide-react v0.544.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"11\", cy: \"11\", r: \"8\", key: \"4ej97u\" }],\n  [\"line\", { x1: \"21\", x2: \"16.65\", y1: \"21\", y2: \"16.65\", key: \"13gj7c\" }],\n  [\"line\", { x1: \"8\", x2: \"14\", y1: \"11\", y2: \"11\", key: \"durymu\" }]\n];\nconst ZoomOut = createLucideIcon(\"zoom-out\", __iconNode);\n\nexport { __iconNode, ZoomOut as default };\n//# sourceMappingURL=zoom-out.js.map\n","import React, { useState, useEffect } from 'react';\r\nimport { useDocumentState } from '../../context/DocumentContext';\r\nimport { \r\n  FileText, \r\n  Hash, \r\n  FileCheck, \r\n  ChevronLeft, \r\n  ChevronRight,\r\n  Heading1,\r\n  Heading2,\r\n  Heading3,\r\n  List\r\n} from 'lucide-react';\r\nimport './Sidebar.css';\r\n\r\n/**\r\n * Sidebar Component\r\n * Displays document information, outline, and word count\r\n * @param {Object} props\r\n * @param {Object} props.editorView - Editor view instance (not used in contenteditable)\r\n * @param {boolean} props.isCollapsed - Whether sidebar is collapsed\r\n * @param {Function} props.onToggle - Callback for collapse toggle\r\n * @param {number} props.wordCount - Optional word count (for continuous mode)\r\n * @param {number} props.pageCount - Optional page count (for continuous mode)\r\n */\r\nexport const Sidebar = ({ editorView, isCollapsed, onToggle, wordCount: propWordCount, pageCount: propPageCount }) => {\r\n  const documentState = useDocumentState();\r\n  const { pages, activePage, continuousContent, editorMode } = documentState;\r\n  const [wordCount, setWordCount] = useState(0);\r\n  const [outline, setOutline] = useState([]);\r\n\r\n  // Calculate word count and extract outline from content\r\n  useEffect(() => {\r\n    // Use prop values if provided (continuous mode)\r\n    if (propWordCount !== undefined && propPageCount !== undefined) {\r\n      setWordCount(propWordCount);\r\n      \r\n      // Extract outline from continuous content\r\n      if (continuousContent) {\r\n        const tempDiv = document.createElement('div');\r\n        tempDiv.innerHTML = continuousContent;\r\n        const headingElements = tempDiv.querySelectorAll('h1, h2, h3, h4, h5, h6');\r\n        const headings = Array.from(headingElements).map((heading, index) => {\r\n          const level = parseInt(heading.tagName.charAt(1));\r\n          const text = heading.textContent.trim();\r\n          return text ? {\r\n            id: `heading-${index}`,\r\n            level,\r\n            text,\r\n            page: 1 // Continuous mode doesn't have meaningful page numbers for headings\r\n          } : null;\r\n        }).filter(Boolean);\r\n        setOutline(headings);\r\n      }\r\n      return;\r\n    }\r\n\r\n    // Paged mode: Calculate from pages array\r\n    let totalWords = 0;\r\n    const headings = [];\r\n\r\n    pages.forEach((page, pageIndex) => {\r\n      if (page.content) {\r\n        // Extract text content and count words\r\n        const tempDiv = document.createElement('div');\r\n        tempDiv.innerHTML = page.content;\r\n        const text = tempDiv.textContent || tempDiv.innerText || '';\r\n        const words = text.trim().split(/\\s+/).filter(word => word.length > 0);\r\n        totalWords += words.length;\r\n\r\n        // Extract headings for outline\r\n        const headingElements = tempDiv.querySelectorAll('h1, h2, h3, h4, h5, h6');\r\n        headingElements.forEach((heading, index) => {\r\n          const level = parseInt(heading.tagName.charAt(1));\r\n          const text = heading.textContent.trim();\r\n          if (text) {\r\n            headings.push({\r\n              id: `heading-${pageIndex}-${index}`,\r\n              level,\r\n              text,\r\n              page: pageIndex + 1\r\n            });\r\n          }\r\n        });\r\n      }\r\n    });\r\n\r\n    setWordCount(totalWords);\r\n    setOutline(headings);\r\n  }, [pages, propWordCount, propPageCount, continuousContent]);\r\n\r\n  const displayPageCount = propPageCount !== undefined ? propPageCount : pages.length;\r\n\r\n  return (\r\n    <aside \r\n      className={`sidebar ${isCollapsed ? 'collapsed' : ''}`} \r\n      role=\"complementary\"\r\n      aria-label=\"Document information\"\r\n      data-testid=\"sidebar\"\r\n    >\r\n      <div className=\"sidebar-header\">\r\n        <div className=\"sidebar-title\">\r\n          <FileText size={18} />\r\n          <h2>Document Info</h2>\r\n        </div>\r\n        <button\r\n          className=\"sidebar-toggle\"\r\n          onClick={onToggle}\r\n          aria-label={isCollapsed ? \"Expand sidebar\" : \"Collapse sidebar\"}\r\n          title={isCollapsed ? \"Expand sidebar\" : \"Collapse sidebar\"}\r\n        >\r\n          {isCollapsed ? <ChevronRight size={16} /> : <ChevronLeft size={16} />}\r\n        </button>\r\n      </div>\r\n\r\n      {!isCollapsed && (\r\n        <div className=\"sidebar-content\">\r\n          <div className=\"sidebar-section\">\r\n            <h3>Statistics</h3>\r\n            <div className=\"stat-item\">\r\n              <div className=\"stat-label\">\r\n                <FileCheck size={14} />\r\n                <span>Pages:</span>\r\n              </div>\r\n              <span className=\"stat-value\">{displayPageCount}</span>\r\n            </div>\r\n            <div className=\"stat-item\" data-testid=\"word-count\">\r\n              <div className=\"stat-label\">\r\n                <Hash size={14} />\r\n                <span>Words:</span>\r\n              </div>\r\n              <span className=\"stat-value\">{wordCount.toLocaleString()}</span>\r\n            </div>\r\n            <div className=\"stat-item\">\r\n              <div className=\"stat-label\">\r\n                <FileText size={14} />\r\n                <span>Active Page:</span>\r\n              </div>\r\n              <span className=\"stat-value\">{activePage + 1}</span>\r\n            </div>\r\n          </div>\r\n\r\n          {outline.length > 0 && (\r\n            <div className=\"sidebar-section\">\r\n              <h3>\r\n                <List size={14} style={{ display: 'inline-block', marginRight: '6px', verticalAlign: 'middle' }} />\r\n                Document Outline\r\n              </h3>\r\n              <div className=\"document-outline\" data-testid=\"outline\">\r\n                {outline.map((heading) => {\r\n                  const HeadingIcon = heading.level === 1 ? Heading1 : heading.level === 2 ? Heading2 : Heading3;\r\n                  return (\r\n                    <div \r\n                      key={heading.id}\r\n                      className={`outline-item outline-level-${heading.level}`}\r\n                      style={{ marginLeft: `${(heading.level - 1) * 12}px` }}\r\n                    >\r\n                      <HeadingIcon size={12} className=\"outline-icon\" />\r\n                      <span className=\"outline-text\">{heading.text}</span>\r\n                      <span className=\"outline-page\">p.{heading.page}</span>\r\n                    </div>\r\n                  );\r\n                })}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"sidebar-section\">\r\n            <h3>Document</h3>\r\n            <p>HTML Editor</p>\r\n            <p>Multi-page support</p>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </aside>\r\n  );\r\n};\r\n\r\nexport default Sidebar;\r\n","/**\r\n * Logger utility for the editor\r\n * Provides consistent logging across the application\r\n * Disabled in production for performance\r\n */\r\n\r\nconst isDevelopment = import.meta.env.MODE === 'development';\r\n\r\n/**\r\n * Logger class for structured logging\r\n */\r\nclass Logger {\r\n  constructor(namespace = 'Editor') {\r\n    this.namespace = namespace;\r\n  }\r\n\r\n  /**\r\n   * Formats log message with namespace\r\n   * @param {string} level - Log level\r\n   * @param {string} message - Log message\r\n   * @param {any} data - Optional data to log\r\n   * @returns {string} Formatted message\r\n   */\r\n  _format(level, message, data) {\r\n    const timestamp = new Date().toISOString();\r\n    return `[${timestamp}] [${this.namespace}] [${level}] ${message}`;\r\n  }\r\n\r\n  /**\r\n   * Info level logging\r\n   * @param {string} message - Info message\r\n   * @param {any} data - Optional data\r\n   */\r\n  info(message, data) {\r\n    if (!isDevelopment) return;\r\n    \r\n    console.log(this._format('INFO', message));\r\n    if (data) console.log(data);\r\n  }\r\n\r\n  /**\r\n   * Warning level logging\r\n   * @param {string} message - Warning message\r\n   * @param {any} data - Optional data\r\n   */\r\n  warn(message, data) {\r\n    if (!isDevelopment) return;\r\n    \r\n    console.warn(this._format('WARN', message));\r\n    if (data) console.warn(data);\r\n  }\r\n\r\n  /**\r\n   * Error level logging\r\n   * @param {string} message - Error message\r\n   * @param {Error|any} error - Error object or data\r\n   */\r\n  error(message, error) {\r\n    if (!isDevelopment) return;\r\n    \r\n    console.error(this._format('ERROR', message));\r\n    if (error) {\r\n      if (error instanceof Error) {\r\n        console.error(error.message);\r\n        console.error(error.stack);\r\n      } else {\r\n        console.error(error);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Debug level logging\r\n   * @param {string} message - Debug message\r\n   * @param {any} data - Optional data\r\n   */\r\n  debug(message, data) {\r\n    if (!isDevelopment) return;\r\n    \r\n    console.debug(this._format('DEBUG', message));\r\n    if (data) console.debug(data);\r\n  }\r\n}\r\n\r\n// Create default logger instance\r\nexport const logger = new Logger('Editor');\r\n\r\n// Export Logger class for custom instances\r\nexport default Logger;\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { \r\n  Bold, \r\n  Italic, \r\n  Underline, \r\n  Strikethrough,\r\n  AlignLeft,\r\n  AlignCenter,\r\n  AlignRight,\r\n  AlignJustify,\r\n  List,\r\n  ListOrdered,\r\n  Link,\r\n  Table,\r\n  FileText,\r\n  Undo,\r\n  Redo,\r\n  Image as ImageIcon\r\n} from 'lucide-react';\r\nimport { saveImage, getImage } from '../../lib/storage/index-db';\r\nimport { logger } from '../../lib/editor/utils/logger';\r\nimport { COMMON_FONT_SIZES, DEFAULT_FONT_SIZE } from '../../lib/editor/font-sizes';\r\n\r\n/**\r\n * EditorToolbar - Formatting toolbar for the multi-page editor\r\n * Provides text formatting, alignment, lists, links, tables, and image insertion\r\n */\r\nconst EditorToolbar = ({ \r\n  currentFormat, \r\n  onFormatText, \r\n  onAddPageBreak\r\n}) => {\r\n  /**\r\n   * Handle image upload\r\n   */\r\n  const handleImageUpload = async (file) => {\r\n    try {\r\n      const validTypes = ['image/png', 'image/jpeg', 'image/gif', 'image/webp'];\r\n      if (!validTypes.includes(file.type)) {\r\n        alert('Invalid image format. Supported: PNG, JPEG, GIF, WEBP');\r\n        return;\r\n      }\r\n\r\n      if (file.size > 5 * 1024 * 1024) {\r\n        alert('Image exceeds maximum size of 5MB');\r\n        return;\r\n      }\r\n\r\n      const key = await saveImage(file);\r\n      const imageUrl = await getImage(key);\r\n      \r\n      if (imageUrl) {\r\n        // Insert image with data-key attribute to enable deletion from IndexedDB\r\n        const imageHtml = `<img src=\"${imageUrl}\" data-key=\"${key}\" alt=\"Inserted image\" />`;\r\n        document.execCommand('insertHTML', false, imageHtml);\r\n        logger.info('Image inserted', { key });\r\n      }\r\n      \r\n      // Reset the file input to allow uploading the same file again\r\n      const fileInput = document.getElementById('image-upload');\r\n      if (fileInput) {\r\n        fileInput.value = '';\r\n      }\r\n    } catch (error) {\r\n      logger.error('Error uploading image', error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"editor-toolbar\">\r\n      <button \r\n        onClick={() => onFormatText('undo')} \r\n        title=\"Undo\"\r\n      >\r\n        <Undo size={16} />\r\n      </button>\r\n      <button \r\n        onClick={() => onFormatText('redo')} \r\n        title=\"Redo\"\r\n      >\r\n        <Redo size={16} />\r\n      </button>\r\n      \r\n      <div className=\"toolbar-separator\" />\r\n      \r\n      <button \r\n        onClick={() => onFormatText('bold')} \r\n        className={currentFormat.bold ? 'active' : ''} \r\n        title=\"Bold\"\r\n      >\r\n        <Bold size={16} />\r\n      </button>\r\n      <button \r\n        onClick={() => onFormatText('italic')} \r\n        className={currentFormat.italic ? 'active' : ''} \r\n        title=\"Italic\"\r\n      >\r\n        <Italic size={16} />\r\n      </button>\r\n      <button \r\n        onClick={() => onFormatText('underline')} \r\n        className={currentFormat.underline ? 'active' : ''} \r\n        title=\"Underline\"\r\n      >\r\n        <Underline size={16} />\r\n      </button>\r\n      <button \r\n        onClick={() => onFormatText('strikethrough')} \r\n        className={currentFormat.strikethrough ? 'active' : ''} \r\n        title=\"Strikethrough\"\r\n      >\r\n        <Strikethrough size={16} />\r\n      </button>\r\n      \r\n      <div className=\"toolbar-separator\" />\r\n      \r\n      <button \r\n        onClick={() => onFormatText('justifyLeft')} \r\n        className={currentFormat.alignLeft ? 'active' : ''} \r\n        title=\"Align Left\"\r\n      >\r\n        <AlignLeft size={16} />\r\n      </button>\r\n      <button \r\n        onClick={() => onFormatText('justifyCenter')} \r\n        className={currentFormat.alignCenter ? 'active' : ''} \r\n        title=\"Align Center\"\r\n      >\r\n        <AlignCenter size={16} />\r\n      </button>\r\n      <button \r\n        onClick={() => onFormatText('justifyRight')} \r\n        className={currentFormat.alignRight ? 'active' : ''} \r\n        title=\"Align Right\"\r\n      >\r\n        <AlignRight size={16} />\r\n      </button>\r\n      <button \r\n        onClick={() => onFormatText('justifyFull')} \r\n        className={currentFormat.alignJustify ? 'active' : ''} \r\n        title=\"Justify\"\r\n      >\r\n        <AlignJustify size={16} />\r\n      </button>\r\n      \r\n      <div className=\"toolbar-separator\" />\r\n      \r\n      <select \r\n        onChange={(e) => onFormatText('fontName', e.target.value)}\r\n        defaultValue=\"Arial\"\r\n        title=\"Font Family\"\r\n      >\r\n        <option value=\"Arial\">Arial</option>\r\n        <option value=\"Times New Roman\">Times New Roman</option>\r\n        <option value=\"Courier New\">Courier New</option>\r\n        <option value=\"Georgia\">Georgia</option>\r\n        <option value=\"Verdana\">Verdana</option>\r\n      </select>\r\n      \r\n      <select \r\n        onChange={(e) => onFormatText('fontSize', e.target.value)}\r\n        defaultValue={DEFAULT_FONT_SIZE}\r\n        title=\"Font Size\"\r\n      >\r\n        {COMMON_FONT_SIZES.map(({ value, label }) => (\r\n          <option key={value} value={value}>\r\n            {label}\r\n          </option>\r\n        ))}\r\n      </select>\r\n      \r\n      <select \r\n        onChange={(e) => onFormatText('formatBlock', e.target.value)}\r\n        value={currentFormat.headingLevel || 'p'}\r\n        title=\"Heading Level\"\r\n      >\r\n        <option value=\"p\">Normal</option>\r\n        <option value=\"h1\">Heading 1</option>\r\n        <option value=\"h2\">Heading 2</option>\r\n        <option value=\"h3\">Heading 3</option>\r\n        <option value=\"h4\">Heading 4</option>\r\n        <option value=\"h5\">Heading 5</option>\r\n        <option value=\"h6\">Heading 6</option>\r\n      </select>\r\n      \r\n      <div className=\"toolbar-separator\" />\r\n      \r\n      <button \r\n        onClick={() => onFormatText('insertUnorderedList')} \r\n        title=\"Bullet List\"\r\n      >\r\n        <List size={16} />\r\n      </button>\r\n      <button \r\n        onClick={() => onFormatText('insertOrderedList')} \r\n        title=\"Numbered List\"\r\n      >\r\n        <ListOrdered size={16} />\r\n      </button>\r\n      \r\n      <div className=\"toolbar-separator\" />\r\n      \r\n      <button \r\n        onClick={() => {\r\n          const url = prompt('Enter URL:');\r\n          if (url) onFormatText('createLink', url);\r\n        }} \r\n        title=\"Insert Link\"\r\n      >\r\n        <Link size={16} />\r\n      </button>\r\n      <button \r\n        onClick={() => onFormatText('insertHTML', '<table border=\"1\"><tr><td>Cell 1</td><td>Cell 2</td></tr><tr><td>Cell 3</td><td>Cell 4</td></tr></table>')} \r\n        title=\"Insert Table\"\r\n      >\r\n        <Table size={16} />\r\n      </button>\r\n      \r\n      {onAddPageBreak && (\r\n        <button \r\n          onClick={onAddPageBreak} \r\n          title=\"Insert Page Break\"\r\n        >\r\n          <FileText size={16} />\r\n        </button>\r\n      )}\r\n      \r\n      <div className=\"toolbar-separator\" />\r\n      \r\n      <input \r\n        type=\"file\" \r\n        accept=\"image/*\" \r\n        onChange={(e) => e.target.files[0] && handleImageUpload(e.target.files[0])}\r\n        style={{ display: 'none' }}\r\n        id=\"image-upload\"\r\n      />\r\n      <button \r\n        onClick={() => document.getElementById('image-upload').click()} \r\n        title=\"Insert Image\"\r\n      >\r\n        <ImageIcon size={16} />\r\n      </button>\r\n      </div>\r\n  );\r\n};\r\n\r\nEditorToolbar.propTypes = {\r\n  currentFormat: PropTypes.shape({\r\n    bold: PropTypes.bool,\r\n    italic: PropTypes.bool,\r\n    underline: PropTypes.bool,\r\n    strikethrough: PropTypes.bool,\r\n    alignLeft: PropTypes.bool,\r\n    alignCenter: PropTypes.bool,\r\n    alignRight: PropTypes.bool,\r\n    alignJustify: PropTypes.bool,\r\n    fontFamily: PropTypes.string,\r\n    fontSize: PropTypes.string,\r\n    headingLevel: PropTypes.string\r\n  }).isRequired,\r\n  onFormatText: PropTypes.func.isRequired,\r\n  onAddPageBreak: PropTypes.func\r\n};\r\n\r\nEditorToolbar.defaultProps = {\r\n  onAddPageBreak: undefined\r\n};\r\n\r\nexport default EditorToolbar;\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { DEFAULT_FONT_SIZE } from '../../lib/editor/font-sizes';\r\nimport { getMarginPixels, DEFAULT_MARGIN_PRESET } from '../../lib/editor/margin-utils';\r\n\r\n/**\r\n * PageView - MS Word-like continuous contenteditable surface\r\n * Single contenteditable div with manual page breaks using <page-break> tags\r\n * Content flows continuously with explicit page boundaries\r\n * Supports zoom scaling via CSS transform\r\n */\r\nconst PageView = ({ \r\n  content, \r\n  dimensions, \r\n  pageSize,\r\n  pageBoundaries = [],\r\n  editorRef,\r\n  onInput,\r\n  onKeyDown,\r\n  onClick,\r\n  onScroll,\r\n  zoomLevel = 100,\r\n  pageMargins = DEFAULT_MARGIN_PRESET\r\n}) => {\r\n  // Convert margin preset to pixel values\r\n  const padding = getMarginPixels(pageMargins);\r\n\r\n  // Calculate zoom multiplier\r\n  const zoomMultiplier = zoomLevel / 100;\r\n\r\n  // Helper function to check if cursor is in padding area\r\n  const isInPaddingArea = (element, clientY) => {\r\n    if (!element) return false;\r\n    \r\n    const rect = element.getBoundingClientRect();\r\n    const relativeY = clientY - rect.top;\r\n    \r\n    // Check if in top or bottom padding\r\n    if (relativeY < padding.top || relativeY > (rect.height - padding.bottom)) {\r\n      return true;\r\n    }\r\n    \r\n    return false;\r\n  };\r\n\r\n  // Helper function to check if element is or contains a page-break\r\n  const isPageBreakElement = (node) => {\r\n    if (!node) return false;\r\n    if (node.nodeType === Node.ELEMENT_NODE) {\r\n      return node.tagName === 'PAGE-BREAK' || node.getAttribute('data-page-break') === 'true';\r\n    }\r\n    return node.parentElement && isPageBreakElement(node.parentElement);\r\n  };\r\n\r\n  // Prevent deletion of page-break elements and handle Tab key\r\n  const handleKeyDown = (event) => {\r\n    const selection = window.getSelection();\r\n    if (!selection || selection.rangeCount === 0) return;\r\n\r\n    const range = selection.getRangeAt(0);\r\n    const { startContainer, endContainer } = range;\r\n\r\n    // Prevent typing on page-break elements\r\n    if (isPageBreakElement(startContainer) || isPageBreakElement(endContainer)) {\r\n      if (event.key.length === 1 || event.key === 'Enter' || event.key === ' ') {\r\n        event.preventDefault();\r\n        return false;\r\n      }\r\n    }\r\n\r\n    // Handle Tab key to insert tab character\r\n    if (event.key === 'Tab') {\r\n      event.preventDefault();\r\n      document.execCommand('insertHTML', false, '&nbsp;&nbsp;&nbsp;&nbsp;');\r\n      return false;\r\n    }\r\n\r\n    // Prevent deletion of page-break elements\r\n    if (event.key === 'Backspace' || event.key === 'Delete') {\r\n      if (isPageBreakElement(startContainer) || isPageBreakElement(endContainer)) {\r\n        event.preventDefault();\r\n        return false;\r\n      }\r\n    }\r\n\r\n    if (onKeyDown) {\r\n      onKeyDown(event);\r\n    }\r\n  };\r\n\r\n  // Handle click events to prevent cursor placement in padding areas\r\n  const handleClick = (event) => {\r\n    if (!editorRef.current) return;\r\n\r\n    const clickedElement = event.target;\r\n    \r\n    // Prevent clicking on page-break elements\r\n    if (isPageBreakElement(clickedElement)) {\r\n      event.preventDefault();\r\n      return;\r\n    }\r\n\r\n    // Check if click is in padding area\r\n    if (isInPaddingArea(editorRef.current, event.clientY)) {\r\n      event.preventDefault();\r\n      \r\n      // Move cursor to the nearest valid content area\r\n      const rect = editorRef.current.getBoundingClientRect();\r\n      const relativeY = event.clientY - rect.top;\r\n      \r\n      if (relativeY < padding.top) {\r\n        // Click was in top padding - move to first content element\r\n        const firstChild = editorRef.current.firstElementChild;\r\n        if (firstChild && firstChild.tagName !== 'PAGE-BREAK') {\r\n          const range = document.createRange();\r\n          const sel = window.getSelection();\r\n          range.setStart(firstChild, 0);\r\n          range.collapse(true);\r\n          sel.removeAllRanges();\r\n          sel.addRange(range);\r\n        }\r\n      } else {\r\n        // Click was in bottom padding - move to last content element\r\n        const lastChild = editorRef.current.lastElementChild;\r\n        if (lastChild && lastChild.tagName !== 'PAGE-BREAK') {\r\n          const range = document.createRange();\r\n          const sel = window.getSelection();\r\n          range.selectNodeContents(lastChild);\r\n          range.collapse(false);\r\n          sel.removeAllRanges();\r\n          sel.addRange(range);\r\n        }\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (onClick) {\r\n      onClick(event);\r\n    }\r\n  };\r\n\r\n  // Prevent input in padding areas and on page breaks\r\n  const handleBeforeInput = (event) => {\r\n    const selection = window.getSelection();\r\n    if (!selection || selection.rangeCount === 0) return;\r\n\r\n    const range = selection.getRangeAt(0);\r\n    const { startContainer } = range;\r\n\r\n    // Prevent input on page-break elements\r\n    if (isPageBreakElement(startContainer)) {\r\n      event.preventDefault();\r\n      return false;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div \r\n      className=\"continuous-page-container\"\r\n      style={{\r\n        position: 'relative',\r\n        width: '100%',\r\n        maxWidth: `${dimensions.width}px`,\r\n        margin: '40px auto',\r\n        backgroundColor: 'transparent',\r\n        minHeight: '100vh',\r\n        transform: `scale(${zoomMultiplier})`,\r\n        transformOrigin: 'top center',\r\n        transition: 'transform 0.2s ease-out'\r\n      }}\r\n    >\r\n      {/* Continuous contenteditable surface with page styling */}\r\n      <div\r\n        ref={editorRef}\r\n        contentEditable={true}\r\n        suppressContentEditableWarning={true}\r\n        className=\"continuous-content\"\r\n        style={{\r\n          position: 'relative',\r\n          zIndex: 1,\r\n          minHeight: `${dimensions.height}px`,\r\n          width: `${dimensions.width}px`,\r\n          backgroundColor: 'white',\r\n          padding: `${padding.top}px ${padding.right}px ${padding.bottom}px ${padding.left}px`,\r\n          boxSizing: 'border-box',\r\n          boxShadow: '0 2px 8px rgba(0, 0, 0, 0.1)',\r\n          outline: 'none',\r\n          cursor: 'text',\r\n          fontFamily: 'Arial, sans-serif',\r\n          fontSize: DEFAULT_FONT_SIZE,\r\n          lineHeight: '1.3',\r\n          color: '#333',\r\n          wordWrap: 'break-word',\r\n          whiteSpace: 'pre-wrap',\r\n          overflowWrap: 'break-word',\r\n          border: '1px solid #e0e0e0'\r\n        }}\r\n        onInput={onInput}\r\n        onKeyDown={handleKeyDown}\r\n        onBeforeInput={handleBeforeInput}\r\n        onClick={handleClick}\r\n        onScroll={onScroll}\r\n        data-testid=\"continuous-editor\"\r\n      >\r\n        {/* Content is set via innerHTML in parent component */}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nPageView.propTypes = {\r\n  content: PropTypes.string.isRequired,\r\n  dimensions: PropTypes.shape({\r\n    width: PropTypes.number.isRequired,\r\n    height: PropTypes.number.isRequired\r\n  }).isRequired,\r\n  pageSize: PropTypes.oneOf(['A4', 'Letter', 'Legal']).isRequired,\r\n  pageBoundaries: PropTypes.arrayOf(\r\n    PropTypes.shape({\r\n      id: PropTypes.string.isRequired,\r\n      pageNumber: PropTypes.number.isRequired,\r\n      top: PropTypes.number,\r\n      height: PropTypes.number\r\n    })\r\n  ),\r\n  editorRef: PropTypes.shape({\r\n    current: PropTypes.instanceOf(typeof Element !== 'undefined' ? Element : Object)\r\n  }).isRequired,\r\n  onInput: PropTypes.func.isRequired,\r\n  onKeyDown: PropTypes.func,\r\n  onClick: PropTypes.func,\r\n  onScroll: PropTypes.func,\r\n  zoomLevel: PropTypes.number,\r\n  pageMargins: PropTypes.string\r\n};\r\n\r\nPageView.defaultProps = {\r\n  pageBoundaries: [],\r\n  onKeyDown: undefined,\r\n  onClick: undefined,\r\n  onScroll: undefined,\r\n  zoomLevel: 100,\r\n  pageMargins: DEFAULT_MARGIN_PRESET\r\n};\r\n\r\nexport default PageView;\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { FileText, Plus, X, Settings, ZoomIn, ZoomOut } from 'lucide-react';\r\nimport { MARGIN_PRESETS, getMarginPresetNames, getMarginPresetLabel, DEFAULT_MARGIN_PRESET } from '../../lib/editor/margin-utils';\r\n\r\n/**\r\n * PageManager Component - Standalone Component\r\n * \r\n * COMPLETELY INDEPENDENT - can be used with or without the editor\r\n * Accepts all state as props, uses callbacks for all actions\r\n * Perfect for external apps that want to provide their own PageManager UI\r\n * \r\n * @param {Object} props - Component props\r\n * @param {Array} props.pageBoundaries - Array of page boundary objects [{id, pageNumber, top, height}, ...]\r\n * @param {number} props.activePage - Current active page index (0-based)\r\n * @param {string} props.pageSize - Current page size ('A4', 'Letter', or 'Legal')\r\n * @param {string} props.pageMargins - Current page margin preset ('NORMAL', 'NARROW', etc.)\r\n * @param {number} props.zoomLevel - Current zoom level (50-200)\r\n * @param {boolean} props.canZoomIn - Whether zoom in is allowed\r\n * @param {boolean} props.canZoomOut - Whether zoom out is allowed\r\n * @param {Function} props.onNavigate - Callback when page changes (pageIndex)\r\n * @param {Function} props.onAddPage - Callback when page is added\r\n * @param {Function} props.onDeletePage - Callback when page is deleted (pageIndex)\r\n * @param {Function} props.onPageSizeChange - Callback when page size changes (newSize)\r\n * @param {Function} props.onPageMarginsChange - Callback when page margins change (newMargins)\r\n * @param {Function} props.onZoomIn - Callback when zoom in is clicked\r\n * @param {Function} props.onZoomOut - Callback when zoom out is clicked\r\n * @param {Function} props.onZoomReset - Callback when zoom reset is clicked\r\n */\r\nexport const PageManager = ({ \r\n  pageBoundaries = [{ id: 'page-0', pageNumber: 1 }],\r\n  activePage = 0,\r\n  pageSize = 'A4',\r\n  pageMargins = DEFAULT_MARGIN_PRESET,\r\n  zoomLevel = 100,\r\n  canZoomIn = true,\r\n  canZoomOut = true,\r\n  onNavigate, \r\n  onAddPage,\r\n  onDeletePage,\r\n  onPageSizeChange,\r\n  onPageMarginsChange,\r\n  onZoomIn,\r\n  onZoomOut,\r\n  onZoomReset\r\n} = {}) => {\r\n  // Ensure we always have at least one page\r\n  const totalPages = Math.max(pageBoundaries?.length || 0, 1);\r\n\r\n  const handleNavigate = (pageIndex) => {\r\n    // Delegate to parent callback\r\n    if (onNavigate) {\r\n      onNavigate(pageIndex);\r\n    }\r\n  };\r\n\r\n  const handleAddPage = () => {\r\n    // Delegate to parent callback\r\n    if (onAddPage) {\r\n      onAddPage();\r\n    }\r\n  };\r\n\r\n  const handleDeletePage = (pageIndex) => {\r\n    if (totalPages <= 1) {\r\n      console.warn('[PageManager] Cannot delete the only page');\r\n      return;\r\n    }\r\n    \r\n    // Delegate to parent callback\r\n    if (onDeletePage) {\r\n      onDeletePage(pageIndex);\r\n    }\r\n  };\r\n\r\n  const handlePageSizeChange = (newSize) => {\r\n    // Delegate to parent callback\r\n    if (onPageSizeChange) {\r\n      onPageSizeChange(newSize);\r\n    }\r\n  };\r\n\r\n  const handlePageMarginsChange = (newMargins) => {\r\n    // Delegate to parent callback\r\n    if (onPageMarginsChange) {\r\n      onPageMarginsChange(newMargins);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"page-manager\">\r\n      {/* Page Settings Group - Size and Margins together */}\r\n      <div className=\"page-settings-group\">\r\n        <div className=\"page-settings-header\">\r\n          <Settings size={14} style={{ marginRight: '4px', verticalAlign: 'middle' }} />\r\n          Page Settings\r\n        </div>\r\n        <div className=\"page-settings-controls\">\r\n          <div className=\"page-setting-item\">\r\n            <label htmlFor=\"page-size-selector\">Size:</label>\r\n            <select\r\n              id=\"page-size-selector\"\r\n              role=\"combobox\"\r\n              aria-label=\"Page size selector\"\r\n              value={pageSize}\r\n              onChange={(e) => handlePageSizeChange(e.target.value)}\r\n            >\r\n              <option value=\"A4\">A4</option>\r\n              <option value=\"Letter\">Letter</option>\r\n              <option value=\"Legal\">Legal</option>\r\n            </select>\r\n          </div>\r\n          <div className=\"page-setting-item\">\r\n            <label htmlFor=\"page-margins-selector\">Margins:</label>\r\n            <select\r\n              id=\"page-margins-selector\"\r\n              role=\"combobox\"\r\n              aria-label=\"Page margins selector\"\r\n              value={pageMargins}\r\n              onChange={(e) => handlePageMarginsChange(e.target.value)}\r\n            >\r\n              {getMarginPresetNames().map((presetName) => (\r\n                <option key={presetName} value={presetName}>\r\n                  {getMarginPresetLabel(presetName)}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Compact Zoom Controls */}\r\n      <div className=\"zoom-controls-compact\">\r\n        <button\r\n          type=\"button\"\r\n          className=\"zoom-button-compact\"\r\n          onClick={onZoomOut}\r\n          disabled={!canZoomOut}\r\n          aria-label=\"Zoom out\"\r\n          title=\"Zoom out (Ctrl + -)\"\r\n        >\r\n          <ZoomOut size={12} />\r\n        </button>\r\n        <span className=\"zoom-level-display\">{zoomLevel}%</span>\r\n        <button\r\n          type=\"button\"\r\n          className=\"zoom-button-compact\"\r\n          onClick={onZoomIn}\r\n          disabled={!canZoomIn}\r\n          aria-label=\"Zoom in\"\r\n          title=\"Zoom in (Ctrl + +)\"\r\n        >\r\n          <ZoomIn size={12} />\r\n        </button>\r\n        <button\r\n          type=\"button\"\r\n          className=\"zoom-reset-compact\"\r\n          onClick={onZoomReset}\r\n          aria-label=\"Reset zoom\"\r\n          title=\"Reset zoom to 100% (Ctrl + 0)\"\r\n        >\r\n          Reset\r\n        </button>\r\n      </div>\r\n\r\n      {/* Page List */}\r\n      <div className=\"page-list\">\r\n        {(pageBoundaries && pageBoundaries.length > 0 ? pageBoundaries : [{ id: 'page-0', pageNumber: 1 }]).map((boundary, index) => (\r\n          <div key={boundary.id || `page-${index}`} className=\"page-item\">\r\n            <button\r\n              type=\"button\"\r\n              className={`page-button ${index === activePage ? 'active' : ''}`}\r\n              onClick={() => handleNavigate(index)}\r\n              aria-label={`Go to page ${index + 1}`}\r\n              aria-current={index === activePage ? 'page' : undefined}\r\n            >\r\n              <FileText size={14} />\r\n              <span>Page {index + 1}</span>\r\n            </button>\r\n            {/* Show delete button for all pages when more than 1 page exists */}\r\n            {totalPages > 1 && (\r\n              <button\r\n                type=\"button\"\r\n                className=\"delete-page-button\"\r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  handleDeletePage(index);\r\n                }}\r\n                aria-label={`Delete page ${index + 1}`}\r\n                title=\"Delete this page and its content\"\r\n              >\r\n                <X size={14} />\r\n              </button>\r\n            )}\r\n          </div>\r\n        ))}\r\n      </div>\r\n      \r\n      {/* Add Page Button */}\r\n      <button\r\n        type=\"button\"\r\n        className=\"add-page-button\"\r\n        onClick={handleAddPage}\r\n        aria-label=\"Add new page\"\r\n        title=\"Add new page at end\"\r\n      >\r\n        <Plus size={16} />\r\n        <span>Add Page</span>\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n\r\nPageManager.propTypes = {\r\n  pageBoundaries: PropTypes.arrayOf(\r\n    PropTypes.shape({\r\n      id: PropTypes.string.isRequired,\r\n      pageNumber: PropTypes.number.isRequired,\r\n      top: PropTypes.number,\r\n      height: PropTypes.number\r\n    })\r\n  ),\r\n  activePage: PropTypes.number,\r\n  pageSize: PropTypes.oneOf(['A4', 'Letter', 'Legal']),\r\n  pageMargins: PropTypes.string,\r\n  zoomLevel: PropTypes.number,\r\n  canZoomIn: PropTypes.bool,\r\n  canZoomOut: PropTypes.bool,\r\n  onNavigate: PropTypes.func,\r\n  onAddPage: PropTypes.func,\r\n  onDeletePage: PropTypes.func,\r\n  onPageSizeChange: PropTypes.func,\r\n  onPageMarginsChange: PropTypes.func,\r\n  onZoomIn: PropTypes.func,\r\n  onZoomOut: PropTypes.func,\r\n  onZoomReset: PropTypes.func\r\n};\r\n\r\nPageManager.defaultProps = {\r\n  pageBoundaries: [{ id: 'page-0', pageNumber: 1 }],\r\n  activePage: 0,\r\n  pageSize: 'A4',\r\n  pageMargins: DEFAULT_MARGIN_PRESET,\r\n  zoomLevel: 100,\r\n  canZoomIn: true,\r\n  canZoomOut: true,\r\n  onNavigate: undefined,\r\n  onAddPage: undefined,\r\n  onDeletePage: undefined,\r\n  onPageSizeChange: undefined,\r\n  onPageMarginsChange: undefined,\r\n  onZoomIn: undefined,\r\n  onZoomOut: undefined,\r\n  onZoomReset: undefined\r\n};\r\n\r\nexport default React.memo(PageManager);","import React, { useEffect, useRef, useCallback } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {\r\n  isResizableImage,\r\n  createResizeOverlay,\r\n  removeResizeOverlay,\r\n  updateResizeOverlay,\r\n  RESIZE_HANDLERS,\r\n  DEFAULT_IMAGE_RESIZE_OPTIONS\r\n} from '../../lib/editor/image-resize-utils';\r\n\r\n/**\r\n * ImageResizeHandlers - Component for handling image resize operations\r\n * Provides resize handlers, selection, and resize functionality for images\r\n */\r\nconst ImageResizeHandlers = ({\r\n  editorRef,\r\n  onImageResize,\r\n  onImageSelect,\r\n  onImageDeselect,\r\n  resizeOptions = DEFAULT_IMAGE_RESIZE_OPTIONS\r\n}) => {\r\n  const resizeOverlayRef = useRef(null);\r\n  const resizeImageRef = useRef(null);\r\n  const resizeStartRef = useRef(null);\r\n  const resizeHandlerRef = useRef(null);\r\n  const resizeOptionsRef = useRef(resizeOptions);\r\n  const isResizingRef = useRef(false);\r\n\r\n  // Update resize options when they change\r\n  useEffect(() => {\r\n    resizeOptionsRef.current = resizeOptions;\r\n  }, [resizeOptions]);\r\n\r\n  /**\r\n   * Handle image selection\r\n   */\r\n  const handleImageSelection = useCallback((imageElement) => {\r\n    if (!isResizableImage(imageElement)) return;\r\n\r\n    // Clear any existing resize overlay\r\n    if (resizeOverlayRef.current) {\r\n      removeResizeOverlay(resizeOverlayRef.current);\r\n      resizeOverlayRef.current = null;\r\n    }\r\n\r\n    // Mark image as selected\r\n    imageElement.classList.add('selected');\r\n\r\n    // Create resize overlay\r\n    const overlay = createResizeOverlay(imageElement, resizeOptionsRef.current);\r\n    if (overlay) {\r\n      resizeOverlayRef.current = overlay;\r\n      resizeImageRef.current = imageElement;\r\n      \r\n      // Add overlay to document body\r\n      document.body.appendChild(overlay);\r\n      \r\n      // Add event listeners to handlers\r\n      const handlers = overlay.querySelectorAll('.resize-handler');\r\n      handlers.forEach(handler => {\r\n        handler.addEventListener('mousedown', handleResizeStart);\r\n      });\r\n      \r\n      // Notify parent\r\n      if (onImageSelect) {\r\n        console.log('Image selected, calling onImageSelect callback');\r\n        onImageSelect(imageElement);\r\n      }\r\n    }\r\n  }, [onImageSelect]);\r\n\r\n  /**\r\n   * Clear image selection\r\n   */\r\n  const clearImageSelection = useCallback(() => {\r\n    if (resizeImageRef.current) {\r\n      resizeImageRef.current.classList.remove('selected');\r\n      resizeImageRef.current = null;\r\n    }\r\n\r\n    if (resizeOverlayRef.current) {\r\n      removeResizeOverlay(resizeOverlayRef.current);\r\n      resizeOverlayRef.current = null;\r\n    }\r\n\r\n    resizeStartRef.current = null;\r\n    resizeHandlerRef.current = null;\r\n    isResizingRef.current = false;\r\n\r\n    // Notify parent\r\n    if (onImageDeselect) {\r\n      onImageDeselect();\r\n    }\r\n  }, [onImageDeselect]);\r\n\r\n  /**\r\n   * Start image resize operation\r\n   */\r\n  const handleResizeStart = useCallback((event) => {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    \r\n    if (!resizeImageRef.current) return;\r\n\r\n    const handler = event.currentTarget.dataset.handler;\r\n    const rect = resizeImageRef.current.getBoundingClientRect();\r\n    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\r\n    const scrollLeft = window.pageXOffset || document.documentElement.scrollLeft;\r\n\r\n    resizeStartRef.current = {\r\n      x: event.clientX,\r\n      y: event.clientY,\r\n      width: resizeImageRef.current.offsetWidth,\r\n      height: resizeImageRef.current.offsetHeight,\r\n      offsetX: event.clientX - rect.left - scrollLeft,\r\n      offsetY: event.clientY - rect.top - scrollTop\r\n    };\r\n\r\n    resizeHandlerRef.current = handler;\r\n    isResizingRef.current = true;\r\n\r\n    // Add resize class to prevent text selection\r\n    document.body.classList.add('resize-in-progress');\r\n\r\n    // Update cursor based on handler\r\n    document.body.style.cursor = getCursorForHandler(handler);\r\n\r\n    // Add global event listeners\r\n    document.addEventListener('mousemove', handleResizeMove);\r\n    document.addEventListener('mouseup', handleResizeEnd);\r\n  }, []);\r\n\r\n  /**\r\n   * Perform image resize operation\r\n   */\r\n  const handleResizeMove = useCallback((event) => {\r\n    if (!isResizingRef.current || !resizeImageRef.current || !resizeStartRef.current || !resizeHandlerRef.current) return;\r\n\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    const { x: startX, y: startY, width: startWidth, height: startHeight } = resizeStartRef.current;\r\n    const handler = resizeHandlerRef.current;\r\n    const currentX = event.clientX;\r\n    const currentY = event.clientY;\r\n\r\n    // Calculate new dimensions\r\n    const newDimensions = calculateResizeDimensions({\r\n      handler,\r\n      startX,\r\n      startY,\r\n      currentX,\r\n      currentY,\r\n      startWidth,\r\n      startHeight,\r\n      options: resizeOptionsRef.current\r\n    });\r\n\r\n    // Apply new dimensions to the image\r\n    applyImageDimensions(resizeImageRef.current, newDimensions);\r\n\r\n    // Update resize overlay\r\n    if (resizeOverlayRef.current) {\r\n      updateResizeOverlay(resizeOverlayRef.current, resizeImageRef.current);\r\n    }\r\n  }, []);\r\n\r\n  /**\r\n   * End image resize operation\r\n   */\r\n  const handleResizeEnd = useCallback((event) => {\r\n    if (!isResizingRef.current) return;\r\n\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    resizeStartRef.current = null;\r\n    resizeHandlerRef.current = null;\r\n    isResizingRef.current = false;\r\n\r\n    // Remove global event listeners\r\n    document.removeEventListener('mousemove', handleResizeMove);\r\n    document.removeEventListener('mouseup', handleResizeEnd);\r\n\r\n    // Remove resize classes\r\n    document.body.classList.remove('resize-in-progress');\r\n    document.body.style.cursor = '';\r\n\r\n    // Update content in document context\r\n    if (resizeImageRef.current) {\r\n      // Trigger input event to update document state\r\n      const inputEvent = new Event('input', { bubbles: true, cancelable: true });\r\n      resizeImageRef.current.dispatchEvent(inputEvent);\r\n\r\n      // Notify parent about resize\r\n      if (onImageResize) {\r\n        onImageResize(resizeImageRef.current, {\r\n          width: resizeImageRef.current.offsetWidth,\r\n          height: resizeImageRef.current.offsetHeight\r\n        });\r\n      }\r\n    }\r\n  }, [onImageResize]);\r\n\r\n  /**\r\n   * Handle click on editor to select images\r\n   */\r\n  const handleEditorClick = useCallback((event) => {\r\n    console.log('handleEditorClick called with target:', event.target);\r\n    \r\n    // Clear selection if clicking outside an image\r\n    if (resizeOverlayRef.current && !resizeOverlayRef.current.contains(event.target)) {\r\n      console.log('Clicking outside image, clearing selection');\r\n      clearImageSelection();\r\n    }\r\n\r\n    // Check if clicked on an image\r\n    const target = event.target;\r\n    if (isResizableImage(target)) {\r\n      console.log('Clicked on a resizable image');\r\n      // If already selected, don't reselect\r\n      if (target === resizeImageRef.current) {\r\n        console.log('Image already selected, not reselecting');\r\n        return;\r\n      }\r\n      \r\n      // Select the new image\r\n      console.log('Selecting new image');\r\n      handleImageSelection(target);\r\n    } else {\r\n      console.log('Clicked on non-image element');\r\n    }\r\n  }, [handleImageSelection, clearImageSelection]);\r\n\r\n  /**\r\n   * Handle keydown events (for deleting selected images, etc.)\r\n   */\r\n  const handleKeyDown = useCallback((event) => {\r\n    // Delete selected image with Delete or Backspace key\r\n    if ((event.key === 'Delete' || event.key === 'Backspace') && \r\n        resizeImageRef.current && \r\n        !isResizingRef.current) {\r\n      \r\n      // Prevent default behavior\r\n      event.preventDefault();\r\n      \r\n      // Remove the image\r\n      const imageToRemove = resizeImageRef.current;\r\n      if (imageToRemove.parentNode) {\r\n        imageToRemove.parentNode.removeChild(imageToRemove);\r\n        \r\n        // Clear selection\r\n        clearImageSelection();\r\n        \r\n        // Trigger input event to update document state\r\n        const inputEvent = new Event('input', { bubbles: true, cancelable: true });\r\n        editorRef.current.dispatchEvent(inputEvent);\r\n      }\r\n    }\r\n    \r\n    // Escape key to clear selection\r\n    if (event.key === 'Escape' && resizeImageRef.current) {\r\n      clearImageSelection();\r\n    }\r\n    \r\n    // Add keyboard shortcuts for image operations\r\n    if (resizeImageRef.current && !isResizingRef.current) {\r\n      // Ctrl/Cmd + Shift + > - Increase image width by 10px\r\n      if ((event.ctrlKey || event.metaKey) && event.shiftKey && event.key === '>') {\r\n        event.preventDefault();\r\n        const currentWidth = resizeImageRef.current.offsetWidth;\r\n        const newWidth = Math.min(resizeOptionsRef.current.maxWidth || 800, currentWidth + 10);\r\n        applyImageDimensions(resizeImageRef.current, { width: newWidth, height: resizeImageRef.current.offsetHeight });\r\n        \r\n        // Trigger input event to update document state\r\n        const inputEvent = new Event('input', { bubbles: true, cancelable: true });\r\n        editorRef.current.dispatchEvent(inputEvent);\r\n      }\r\n      \r\n      // Ctrl/Cmd + Shift + < - Decrease image width by 10px\r\n      if ((event.ctrlKey || event.metaKey) && event.shiftKey && event.key === '<') {\r\n        event.preventDefault();\r\n        const currentWidth = resizeImageRef.current.offsetWidth;\r\n        const newWidth = Math.max(resizeOptionsRef.current.minWidth || 50, currentWidth - 10);\r\n        applyImageDimensions(resizeImageRef.current, { width: newWidth, height: resizeImageRef.current.offsetHeight });\r\n        \r\n        // Trigger input event to update document state\r\n        const inputEvent = new Event('input', { bubbles: true, cancelable: true });\r\n        editorRef.current.dispatchEvent(inputEvent);\r\n      }\r\n      \r\n      // Ctrl/Cmd + Shift + + - Increase image height by 10px\r\n      if ((event.ctrlKey || event.metaKey) && event.shiftKey && event.key === '+') {\r\n        event.preventDefault();\r\n        const currentHeight = resizeImageRef.current.offsetHeight;\r\n        const newHeight = Math.min(resizeOptionsRef.current.maxHeight || 600, currentHeight + 10);\r\n        applyImageDimensions(resizeImageRef.current, { width: resizeImageRef.current.offsetWidth, height: newHeight });\r\n        \r\n        // Trigger input event to update document state\r\n        const inputEvent = new Event('input', { bubbles: true, cancelable: true });\r\n        editorRef.current.dispatchEvent(inputEvent);\r\n      }\r\n      \r\n      // Ctrl/Cmd + Shift + - - Decrease image height by 10px\r\n      if ((event.ctrlKey || event.metaKey) && event.shiftKey && event.key === '-') {\r\n        event.preventDefault();\r\n        const currentHeight = resizeImageRef.current.offsetHeight;\r\n        const newHeight = Math.max(resizeOptionsRef.current.minHeight || 50, currentHeight - 10);\r\n        applyImageDimensions(resizeImageRef.current, { width: resizeImageRef.current.offsetWidth, height: newHeight });\r\n        \r\n        // Trigger input event to update document state\r\n        const inputEvent = new Event('input', { bubbles: true, cancelable: true });\r\n        editorRef.current.dispatchEvent(inputEvent);\r\n      }\r\n      \r\n      // Ctrl/Cmd + R - Reset image to default size (300x200)\r\n      if ((event.ctrlKey || event.metaKey) && event.key === 'r') {\r\n        event.preventDefault();\r\n        applyImageDimensions(resizeImageRef.current, { width: 300, height: 200 });\r\n        \r\n        // Trigger input event to update document state\r\n        const inputEvent = new Event('input', { bubbles: true, cancelable: true });\r\n        editorRef.current.dispatchEvent(inputEvent);\r\n      }\r\n    }\r\n  }, [editorRef, clearImageSelection]);\r\n\r\n  /**\r\n   * Handle scroll events to update overlay position\r\n   */\r\n  const handleScroll = useCallback(() => {\r\n    if (resizeOverlayRef.current && resizeImageRef.current) {\r\n      updateResizeOverlay(resizeOverlayRef.current, resizeImageRef.current);\r\n    }\r\n  }, []);\r\n\r\n  // Add scroll listener to editor viewport\r\n  useEffect(() => {\r\n    if (!editorRef.current) return;\r\n\r\n    const editor = editorRef.current;\r\n    const viewport = editor.closest('.editor-viewport');\r\n    \r\n    if (viewport) {\r\n      // Add scroll listener to viewport\r\n      viewport.addEventListener('scroll', handleScroll);\r\n      \r\n      // Also listen to window scroll in case of nested scrolling\r\n      window.addEventListener('scroll', handleScroll);\r\n    }\r\n\r\n    // Cleanup\r\n    return () => {\r\n      if (viewport) {\r\n        viewport.removeEventListener('scroll', handleScroll);\r\n      }\r\n      window.removeEventListener('scroll', handleScroll);\r\n    };\r\n  }, [editorRef, handleScroll]);\r\n\r\n  // Add event listeners when editor is available\r\n  useEffect(() => {\r\n    if (!editorRef.current) return;\r\n\r\n    const editor = editorRef.current;\r\n    \r\n    // Add event listeners\r\n    editor.addEventListener('click', handleEditorClick);\r\n    editor.addEventListener('keydown', handleKeyDown);\r\n    \r\n    // Add scroll listener to viewport\r\n    const viewport = editor.closest('.editor-viewport');\r\n    if (viewport) {\r\n      viewport.addEventListener('scroll', handleScroll);\r\n    }\r\n    \r\n    // Add window resize listener\r\n    window.addEventListener('resize', handleScroll);\r\n\r\n    // Cleanup\r\n    return () => {\r\n      editor.removeEventListener('click', handleEditorClick);\r\n      editor.removeEventListener('keydown', handleKeyDown);\r\n      \r\n      if (viewport) {\r\n        viewport.removeEventListener('scroll', handleScroll);\r\n      }\r\n      \r\n      window.removeEventListener('resize', handleScroll);\r\n      \r\n      // Clean up any active resize operations\r\n      if (isResizingRef.current) {\r\n        document.removeEventListener('mousemove', handleResizeMove);\r\n        document.removeEventListener('mouseup', handleResizeEnd);\r\n        document.body.classList.remove('resize-in-progress');\r\n        document.body.style.cursor = '';\r\n      }\r\n      \r\n      // Remove overlay\r\n      if (resizeOverlayRef.current) {\r\n        removeResizeOverlay(resizeOverlayRef.current);\r\n      }\r\n    };\r\n  }, [editorRef, handleEditorClick, handleKeyDown, handleScroll, handleResizeMove, handleResizeEnd]);\r\n\r\n  // Add a mutation observer to detect when images are added/removed\r\n  useEffect(() => {\r\n    if (!editorRef.current) return;\r\n\r\n    const observer = new MutationObserver((mutations) => {\r\n      mutations.forEach((mutation) => {\r\n        if (mutation.type === 'childList') {\r\n          // If an image was removed and we had a selection, clear it\r\n          if (mutation.removedNodes.length > 0) {\r\n            mutation.removedNodes.forEach(node => {\r\n              if (node.nodeType === Node.ELEMENT_NODE && isResizableImage(node)) {\r\n                if (node === resizeImageRef.current) {\r\n                  clearImageSelection();\r\n                }\r\n              }\r\n            });\r\n          }\r\n          \r\n          // If an image was added, automatically select it for immediate resize overlay\r\n          if (mutation.addedNodes.length > 0) {\r\n            mutation.addedNodes.forEach(node => {\r\n              if (node.nodeType === Node.ELEMENT_NODE) {\r\n                // Check if the node itself is an image\r\n                if (isResizableImage(node)) {\r\n                  // Auto-select newly inserted images\r\n                  setTimeout(() => {\r\n                    handleImageSelection(node);\r\n                  }, 50);\r\n                }\r\n                // Check if the node contains images\r\n                else {\r\n                  const images = node.querySelectorAll ? node.querySelectorAll('img') : [];\r\n                  if (images.length > 0) {\r\n                    // Auto-select the first newly inserted image\r\n                    setTimeout(() => {\r\n                      handleImageSelection(images[0]);\r\n                    }, 50);\r\n                  }\r\n                }\r\n              }\r\n            });\r\n          }\r\n        }\r\n      });\r\n    });\r\n\r\n    observer.observe(editorRef.current, {\r\n      childList: true,\r\n      subtree: true\r\n    });\r\n\r\n    return () => {\r\n      observer.disconnect();\r\n    };\r\n  }, [editorRef, clearImageSelection, handleImageSelection]);\r\n\r\n  // Helper function to get cursor for handler\r\n  function getCursorForHandler(handler) {\r\n    switch (handler) {\r\n      case RESIZE_HANDLERS.TOP_LEFT:\r\n      case RESIZE_HANDLERS.BOTTOM_RIGHT:\r\n        return 'nwse-resize';\r\n      case RESIZE_HANDLERS.TOP_RIGHT:\r\n      case RESIZE_HANDLERS.BOTTOM_LEFT:\r\n        return 'nesw-resize';\r\n      case RESIZE_HANDLERS.TOP:\r\n      case RESIZE_HANDLERS.BOTTOM:\r\n        return 'ns-resize';\r\n      case RESIZE_HANDLERS.LEFT:\r\n      case RESIZE_HANDLERS.RIGHT:\r\n        return 'ew-resize';\r\n      default:\r\n        return 'default';\r\n    }\r\n  }\r\n\r\n  // Helper function to calculate resize dimensions\r\n  function calculateResizeDimensions({\r\n    handler,\r\n    startX,\r\n    startY,\r\n    currentX,\r\n    currentY,\r\n    startWidth,\r\n    startHeight,\r\n    options = DEFAULT_IMAGE_RESIZE_OPTIONS\r\n  }) {\r\n    const deltaX = currentX - startX;\r\n    const deltaY = currentY - startY;\r\n    \r\n    let newWidth = startWidth;\r\n    let newHeight = startHeight;\r\n    \r\n    // Calculate based on handler position\r\n    switch (handler) {\r\n      case RESIZE_HANDLERS.TOP_LEFT:\r\n        newWidth = Math.max(options.minWidth, startWidth - deltaX);\r\n        newHeight = Math.max(options.minHeight, startHeight - deltaY);\r\n        break;\r\n        \r\n      case RESIZE_HANDLERS.TOP_RIGHT:\r\n        newWidth = Math.max(options.minWidth, startWidth + deltaX);\r\n        newHeight = Math.max(options.minHeight, startHeight - deltaY);\r\n        break;\r\n        \r\n      case RESIZE_HANDLERS.BOTTOM_LEFT:\r\n        newWidth = Math.max(options.minWidth, startWidth - deltaX);\r\n        newHeight = Math.max(options.minHeight, startHeight + deltaY);\r\n        break;\r\n        \r\n      case RESIZE_HANDLERS.BOTTOM_RIGHT:\r\n        newWidth = Math.max(options.minWidth, startWidth + deltaX);\r\n        newHeight = Math.max(options.minHeight, startHeight + deltaY);\r\n        break;\r\n        \r\n      case RESIZE_HANDLERS.TOP:\r\n        newHeight = Math.max(options.minHeight, startHeight - deltaY);\r\n        break;\r\n        \r\n      case RESIZE_HANDLERS.BOTTOM:\r\n        newHeight = Math.max(options.minHeight, startHeight + deltaY);\r\n        break;\r\n        \r\n      case RESIZE_HANDLERS.LEFT:\r\n        newWidth = Math.max(options.minWidth, startWidth - deltaX);\r\n        break;\r\n        \r\n      case RESIZE_HANDLERS.RIGHT:\r\n        newWidth = Math.max(options.minWidth, startWidth + deltaX);\r\n        break;\r\n        \r\n      default:\r\n        return { width: newWidth, height: newHeight };\r\n    }\r\n    \r\n    // Apply aspect ratio if needed\r\n    if (options.preserveAspectRatio && options.aspectRatio) {\r\n      const aspectRatio = startWidth / startHeight;\r\n      \r\n      // For corner handlers, maintain aspect ratio\r\n      if ([RESIZE_HANDLERS.TOP_LEFT, RESIZE_HANDLERS.TOP_RIGHT, \r\n           RESIZE_HANDLERS.BOTTOM_LEFT, RESIZE_HANDLERS.BOTTOM_RIGHT].includes(handler)) {\r\n        // Use the larger dimension to maintain aspect ratio\r\n        if (newWidth / aspectRatio > newHeight) {\r\n          newHeight = Math.max(options.minHeight, newWidth / aspectRatio);\r\n        } else {\r\n          newWidth = Math.max(options.minWidth, newHeight * aspectRatio);\r\n        }\r\n      }\r\n      // For edge handlers, maintain aspect ratio\r\n      else if ([RESIZE_HANDLERS.TOP, RESIZE_HANDLERS.BOTTOM].includes(handler)) {\r\n        newWidth = newHeight * aspectRatio;\r\n      } else if ([RESIZE_HANDLERS.LEFT, RESIZE_HANDLERS.RIGHT].includes(handler)) {\r\n        newHeight = newWidth / aspectRatio;\r\n      }\r\n    }\r\n    \r\n    // Apply max dimensions\r\n    if (options.maxWidth && newWidth > options.maxWidth) {\r\n      newWidth = options.maxWidth;\r\n      if (options.preserveAspectRatio && options.aspectRatio) {\r\n        newHeight = newWidth / (startWidth / startHeight);\r\n      }\r\n    }\r\n    \r\n    if (options.maxHeight && newHeight > options.maxHeight) {\r\n      newHeight = options.maxHeight;\r\n      if (options.preserveAspectRatio && options.aspectRatio) {\r\n        newWidth = newHeight * (startWidth / startHeight);\r\n      }\r\n    }\r\n    \r\n    // Ensure minimum dimensions\r\n    newWidth = Math.max(options.minWidth, newWidth);\r\n    newHeight = Math.max(options.minHeight, newHeight);\r\n    \r\n    return {\r\n      width: Math.round(newWidth),\r\n      height: Math.round(newHeight)\r\n    };\r\n  }\r\n\r\n  // Helper function to apply image dimensions\r\n  function applyImageDimensions(element, { width, height }) {\r\n    if (!isResizableImage(element)) return;\r\n    \r\n    // For img elements\r\n    if (element.tagName === 'IMG') {\r\n      element.style.width = `${width}px`;\r\n      element.style.height = `${height}px`;\r\n      element.width = width;\r\n      element.height = height;\r\n    }\r\n    // For div elements with background images\r\n    else if (element.tagName === 'DIV') {\r\n      element.style.width = `${width}px`;\r\n      element.style.height = `${height}px`;\r\n    }\r\n  }\r\n\r\n  // This component doesn't render anything visible - it just manages the resize functionality\r\n  return null;\r\n};\r\n\r\nImageResizeHandlers.propTypes = {\r\n  editorRef: PropTypes.shape({\r\n    current: PropTypes.instanceOf(typeof Element !== 'undefined' ? Element : Object)\r\n  }).isRequired,\r\n  onImageResize: PropTypes.func,\r\n  onImageSelect: PropTypes.func,\r\n  onImageDeselect: PropTypes.func,\r\n  resizeOptions: PropTypes.shape({\r\n    minWidth: PropTypes.number,\r\n    minHeight: PropTypes.number,\r\n    maxWidth: PropTypes.number,\r\n    maxHeight: PropTypes.number,\r\n    aspectRatio: PropTypes.bool,\r\n    preserveAspectRatio: PropTypes.bool,\r\n    defaultWidth: PropTypes.number,\r\n    defaultHeight: PropTypes.number\r\n  })\r\n};\r\n\r\nImageResizeHandlers.defaultProps = {\r\n  onImageResize: undefined,\r\n  onImageSelect: undefined,\r\n  onImageDeselect: undefined,\r\n  resizeOptions: DEFAULT_IMAGE_RESIZE_OPTIONS\r\n};\r\n\r\nexport default ImageResizeHandlers;\r\n","import React, { useState, useEffect, useRef, useLayoutEffect } from 'react';\r\nimport { createPortal } from 'react-dom';\r\nimport { AlignLeft, AlignCenter, AlignRight, Link, Trash2 } from 'lucide-react';\r\nimport PropTypes from 'prop-types';\r\n\r\n/**\r\n * ImageTooltipMenu - Component for image tooltip menu with alignment, aspect ratio, and delete options\r\n */\r\nconst ImageTooltipMenu = ({\r\n  imageElement,\r\n  onAlignChange,\r\n  onAspectRatioToggle,\r\n  onDelete,\r\n  onClose,\r\n  initialPreserveAspectRatio = true\r\n}) => {\r\n  const [position, setPosition] = useState({ top: 0, left: 0 });\r\n  const [isVisible, setIsVisible] = useState(false);\r\n  const [menuPosition, setMenuPosition] = useState('top'); // 'top' or 'bottom'\r\n  const [preserveAspectRatio, setPreserveAspectRatio] = useState(initialPreserveAspectRatio);\r\n  const menuRef = useRef(null);\r\n  const scrollContainerRef = useRef(null);\r\n\r\n  // Get current alignment of the image\r\n  const getCurrentAlignment = () => {\r\n    if (!imageElement) return 'left';\r\n    const style = window.getComputedStyle(imageElement);\r\n    return style.float || style.display === 'block' ? 'left' :\r\n           style.display === 'flex' && style.justifyContent === 'center' ? 'center' :\r\n           style.float === 'right' ? 'right' : 'left';\r\n  };\r\n\r\n  const [currentAlignment, setCurrentAlignment] = useState(getCurrentAlignment());\r\n\r\n  useEffect(() => {\r\n    console.log('ImageTooltipMenu mounted with imageElement:', imageElement);\r\n    return () => {\r\n      console.log('ImageTooltipMenu unmounted');\r\n    };\r\n  }, [imageElement]);\r\n\r\n  // Find the scroll container (editor viewport)\r\n  useEffect(() => {\r\n    if (imageElement) {\r\n      // Find the scroll container (editor viewport)\r\n      let scrollContainer = imageElement.closest('.editor-viewport') || imageElement.closest('.continuous-scroll');\r\n      if (scrollContainer) {\r\n        scrollContainerRef.current = scrollContainer;\r\n      }\r\n    }\r\n  }, [imageElement]);\r\n\r\n  // Position the tooltip menu\r\n  useLayoutEffect(() => {\r\n    if (!imageElement || !menuRef.current) return;\r\n\r\n    const updatePosition = () => {\r\n      const imageRect = imageElement.getBoundingClientRect();\r\n      const menuRect = menuRef.current.getBoundingClientRect();\r\n      const scrollContainer = scrollContainerRef.current;\r\n      \r\n      // Determine if image is in view (partially or fully)\r\n      const viewportRect = window.visualViewport ? window.visualViewport : {\r\n        width: window.innerWidth,\r\n        height: window.innerHeight,\r\n        offsetTop: 0,\r\n        offsetLeft: 0\r\n      };\r\n      \r\n      // Check if image is visible in viewport\r\n      const isImageInViewport = (\r\n        imageRect.bottom >= 0 &&\r\n        imageRect.top <= viewportRect.height &&\r\n        imageRect.right >= 0 &&\r\n        imageRect.left <= viewportRect.width\r\n      );\r\n      \r\n      // Determine if menu should be positioned above or below the image\r\n      let menuPosition = 'top'; // default to top\r\n      let top = 0;\r\n      let left = 0;\r\n      \r\n      // If image is in view, position menu relative to image\r\n      if (isImageInViewport) {\r\n        // Check if there's enough space above or below the image for the menu\r\n        const spaceAbove = imageRect.top - menuRect.height - 10;\r\n        const spaceBelow = viewportRect.height - imageRect.bottom - menuRect.height - 10;\r\n        \r\n        // Position menu below if there's more space there, or if space above is negative\r\n        if (spaceBelow > spaceAbove && spaceBelow > 0) {\r\n          menuPosition = 'bottom';\r\n          top = imageRect.bottom + 10;\r\n        } else {\r\n          menuPosition = 'top';\r\n          top = imageRect.top - menuRect.height - 10;\r\n        }\r\n      } else {\r\n        // If image is not in view, position menu at the top of the viewport\r\n        menuPosition = 'top';\r\n        top = 10; // 10px from top of viewport\r\n      }\r\n      \r\n      left = imageRect.left + (imageRect.width / 2) - (menuRect.width / 2);\r\n      \r\n      // Ensure the menu stays within viewport\r\n      const viewportWidth = window.innerWidth;\r\n      const viewportHeight = window.innerHeight;\r\n      \r\n      let adjustedLeft = left;\r\n      let adjustedTop = top;\r\n      \r\n      // Adjust horizontal position if menu goes outside viewport\r\n      if (left < 10) {\r\n        adjustedLeft = 10;\r\n      } else if (left + menuRect.width > viewportWidth - 10) {\r\n        adjustedLeft = viewportWidth - menuRect.width - 10;\r\n      }\r\n      \r\n      // Adjust vertical position if menu goes outside viewport\r\n      if (top < 10) {\r\n        adjustedTop = 10;\r\n      } else if (top + menuRect.height > viewportHeight - 10) {\r\n        adjustedTop = viewportHeight - menuRect.height - 10;\r\n      }\r\n      \r\n      setPosition({\r\n        top: adjustedTop,\r\n        left: adjustedLeft\r\n      });\r\n      setMenuPosition(menuPosition);\r\n      setIsVisible(true);\r\n    };\r\n\r\n    // Initial positioning\r\n    updatePosition();\r\n    \r\n    // Add scroll listener to update position on scroll\r\n    const handleScroll = () => {\r\n      updatePosition();\r\n    };\r\n    \r\n    // Add scroll listener to scroll container if available\r\n    if (scrollContainerRef.current) {\r\n      scrollContainerRef.current.addEventListener('scroll', handleScroll);\r\n    }\r\n    \r\n    // Also add window scroll listener for safety\r\n    window.addEventListener('scroll', handleScroll);\r\n    window.addEventListener('resize', handleScroll);\r\n    \r\n    return () => {\r\n      if (scrollContainerRef.current) {\r\n        scrollContainerRef.current.removeEventListener('scroll', handleScroll);\r\n      }\r\n      window.removeEventListener('scroll', handleScroll);\r\n      window.removeEventListener('resize', handleScroll);\r\n      setIsVisible(false);\r\n    };\r\n  }, [imageElement]);\r\n\r\n  // Close menu when clicking outside\r\n  useEffect(() => {\r\n    const handleClickOutside = (event) => {\r\n      if (menuRef.current && !menuRef.current.contains(event.target) &&\r\n          event.target !== imageElement) {\r\n        onClose();\r\n      }\r\n    };\r\n\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside);\r\n    };\r\n  }, [imageElement, onClose]);\r\n\r\n  const handleAlignLeft = () => {\r\n    if (imageElement) {\r\n      imageElement.style.float = 'left';\r\n      imageElement.style.margin = '0 10px 10px 0';\r\n      imageElement.style.display = 'block';\r\n      setCurrentAlignment('left');\r\n      onAlignChange && onAlignChange('left');\r\n    }\r\n  };\r\n\r\n  const handleAlignCenter = () => {\r\n    if (imageElement) {\r\n      imageElement.style.float = 'none';\r\n      imageElement.style.margin = '10px auto';\r\n      imageElement.style.display = 'block';\r\n      setCurrentAlignment('center');\r\n      onAlignChange && onAlignChange('center');\r\n    }\r\n  };\r\n\r\n  const handleAlignRight = () => {\r\n    if (imageElement) {\r\n      imageElement.style.float = 'right';\r\n      imageElement.style.margin = '0 0 10px 10px';\r\n      imageElement.style.display = 'block';\r\n      setCurrentAlignment('right');\r\n      onAlignChange && onAlignChange('right');\r\n    }\r\n  };\r\n\r\n  const handleDelete = () => {\r\n    if (imageElement && imageElement.parentNode) {\r\n      imageElement.parentNode.removeChild(imageElement);\r\n      onDelete && onDelete();\r\n      onClose();\r\n    }\r\n  };\r\n\r\n  const handleAspectRatioToggle = () => {\r\n    const newPreserveRatio = !preserveAspectRatio;\r\n    setPreserveAspectRatio(newPreserveRatio);\r\n    \r\n    // Call the parent callback if provided\r\n    if (onAspectRatioToggle) {\r\n      onAspectRatioToggle(newPreserveRatio);\r\n    }\r\n  };\r\n\r\n  if (!imageElement) return null;\r\n\r\n  // Debug log to see if component is being rendered\r\n  console.log('Rendering ImageTooltipMenu with position:', position, 'isVisible:', isVisible);\r\n\r\n  if (typeof document === 'undefined') {\r\n    return null;\r\n  }\r\n\r\n  return createPortal(\r\n    <div\r\n      ref={menuRef}\r\n      className=\"image-tooltip-menu\"\r\n      data-menu-position={menuPosition}\r\n      aria-hidden={!isVisible}\r\n      style={{\r\n        position: 'fixed',\r\n        top: `${position.top}px`,\r\n        left: `${position.left}px`,\r\n        zIndex: 999,\r\n        background: '#fff',\r\n        border: '1px solid #ddd',\r\n        borderRadius: '6px',\r\n        boxShadow: '0 4px 12px rgba(0,0,0,0.15)',\r\n        padding: '8px',\r\n        display: 'flex',\r\n        gap: '2px',\r\n        alignItems: 'center',\r\n        pointerEvents: isVisible ? 'auto' : 'none',\r\n        minWidth: '140px',\r\n        minHeight: '32px',\r\n        opacity: isVisible ? 1 : 0,\r\n        visibility: isVisible ? 'visible' : 'hidden',\r\n        transition: 'opacity 0.15s ease, visibility 0.15s ease'\r\n      }}\r\n    >\r\n      {/* Aspect Ratio Toggle */}\r\n      <button\r\n        className={`tooltip-button aspect-ratio-toggle ${!preserveAspectRatio ? 'active' : ''}`}\r\n        onClick={handleAspectRatioToggle}\r\n        title={`Toggle aspect ratio preservation (currently ${preserveAspectRatio ? 'ON' : 'OFF'})`}\r\n      >\r\n        {preserveAspectRatio ? '🔓' : '🔗'}\r\n      </button>\r\n\r\n      {/* Alignment buttons */}\r\n      <button\r\n        className={`tooltip-button ${currentAlignment === 'left' ? 'active' : ''}`}\r\n        onClick={handleAlignLeft}\r\n        title=\"Align Left\"\r\n        style={{\r\n          background: currentAlignment === 'left' ? '#007bff' : 'transparent',\r\n          color: currentAlignment === 'left' ? '#fff' : '#333',\r\n          border: '1px solid #ccc',\r\n          borderRadius: '4px',\r\n          padding: '4px',\r\n          cursor: 'pointer',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          minWidth: '28px',\r\n          height: '28px'\r\n        }}\r\n      >\r\n        <AlignLeft size={14} />\r\n      </button>\r\n      \r\n      <button\r\n        className={`tooltip-button ${currentAlignment === 'center' ? 'active' : ''}`}\r\n        onClick={handleAlignCenter}\r\n        title=\"Align Center\"\r\n        style={{\r\n          background: currentAlignment === 'center' ? '#007bff' : 'transparent',\r\n          color: currentAlignment === 'center' ? '#fff' : '#333',\r\n          border: '1px solid #ccc',\r\n          borderRadius: '4px',\r\n          padding: '4px',\r\n          cursor: 'pointer',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          minWidth: '28px',\r\n          height: '28px'\r\n        }}\r\n      >\r\n        <AlignCenter size={14} />\r\n      </button>\r\n      \r\n      <button\r\n        className={`tooltip-button ${currentAlignment === 'right' ? 'active' : ''}`}\r\n        onClick={handleAlignRight}\r\n        title=\"Align Right\"\r\n        style={{\r\n          background: currentAlignment === 'right' ? '#007bff' : 'transparent',\r\n          color: currentAlignment === 'right' ? '#fff' : '#333',\r\n          border: '1px solid #ccc',\r\n          borderRadius: '4px',\r\n          padding: '4px',\r\n          cursor: 'pointer',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          minWidth: '28px',\r\n          height: '28px'\r\n        }}\r\n      >\r\n        <AlignRight size={14} />\r\n      </button>\r\n\r\n      {/* Delete button */}\r\n      <button\r\n        className=\"tooltip-button delete-button\"\r\n        onClick={handleDelete}\r\n        title=\"Delete Image\"\r\n        style={{\r\n          background: 'transparent',\r\n          color: '#dc3545',\r\n          border: '1px solid #dc3545',\r\n          borderRadius: '4px',\r\n          padding: '4px',\r\n          cursor: 'pointer',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          minWidth: '28px',\r\n          height: '28px'\r\n        }}\r\n      >\r\n        <Trash2 size={14} />\r\n      </button>\r\n    </div>,\r\n    document.body\r\n  );\r\n};\r\n\r\nImageTooltipMenu.propTypes = {\r\n  imageElement: PropTypes.instanceOf(typeof Element !== 'undefined' ? Element : Object),\r\n  onAlignChange: PropTypes.func,\r\n  onAspectRatioToggle: PropTypes.func,\r\n  onDelete: PropTypes.func,\r\n  onClose: PropTypes.func.isRequired,\r\n  initialPreserveAspectRatio: PropTypes.bool\r\n};\r\n\r\nImageTooltipMenu.defaultProps = {\r\n  imageElement: null,\r\n  onAlignChange: undefined,\r\n  onAspectRatioToggle: undefined,\r\n  onDelete: undefined,\r\n  initialPreserveAspectRatio: true\r\n};\r\n\r\nexport default ImageTooltipMenu;","import React, { useCallback, useEffect, useRef, useState, useMemo, forwardRef, useImperativeHandle } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { useDocumentState, useDocumentActions } from '../../context/DocumentContext';\r\nimport { useFormatting, useContinuousReflow } from '../../hooks';\r\nimport { canZoomIn, canZoomOut } from '../../lib/editor/zoom-utils';\r\nimport { PAGE_SIZES, getPageDimensions } from '../../lib/editor/page-sizes';\r\nimport { DEFAULT_IMAGE_RESIZE_OPTIONS } from '../../lib/editor/image-resize-utils';\r\nimport { deleteImage } from '../../lib/storage/index-db';\r\nimport Sidebar from './Sidebar';\r\nimport EditorToolbar from './EditorToolbar';\r\nimport PageView from './PageView';\r\nimport PageManager from './PageManager';\r\nimport ImageResizeHandlers from './ImageResizeHandlers';\r\nimport ImageTooltipMenu from './ImageTooltipMenu';\r\nimport './MultiPageEditor.css';\r\n\r\nconst INITIAL_BOUNDARY_DELAY = 50;\r\nconst BOUNDARY_UPDATE_DELAY = 50;\r\nconst NAVIGATION_DELAY = 50;\r\nconst SCROLL_DEBOUNCE = 100;\r\nconst FOCUS_DELAY = 200;\r\nconst NAVIGATION_LOCK_TIMEOUT = 500;\r\n\r\n/**\r\n * HtmlEditor - Main WYSIWYG HTML Editor Component\r\n * \r\n * Exposed methods via ref:\r\n * - getHTMLContent() - Returns the current HTML content as a string\r\n * - getPlainText() - Returns the plain text content (HTML stripped)\r\n * - setContent(html) - Sets the editor content programmatically\r\n * \r\n * @param {Object} props\r\n * @param {React.ReactNode} props.pageManagerComponent - Optional custom PageManager component from parent app\r\n * @param {Function} props.onNavigatePage - Optional callback when navigating to a page (pageIndex)\r\n * @param {Function} props.onAddPage - Optional callback when adding a page\r\n * @param {Function} props.onDeletePage - Optional callback when deleting a page (pageIndex)\r\n * @param {Function} props.onPageSizeChange - Optional callback when page size changes (newSize)\r\n * @param {Function} props.onPageMarginsChange - Optional callback when page margins change (newMargins)\r\n * @param {Function} props.onChange - Optional callback when content changes (htmlContent)\r\n * @param {boolean} props.showSidebar - Whether to show the sidebar (default: true)\r\n * @param {boolean} props.showToolbar - Whether to show the toolbar (default: true)\r\n * @param {boolean} props.showPageManager - Whether to show the PageManager component (default: true)\r\n * @param {React.Ref} ref - Forwarded ref to access editor methods\r\n */\r\nconst HtmlEditor = forwardRef(({\r\n  pageManagerComponent = null,\r\n  onNavigatePage,\r\n  onAddPage,\r\n  onDeletePage,\r\n  onPageSizeChange: onPageSizeChangeCallback,\r\n  onPageMarginsChange: onPageMarginsChangeCallback,\r\n  onChange,\r\n  showSidebar = true,\r\n  showToolbar = true,\r\n  showPageManager = true\r\n}, ref) => {\r\n  const documentState = useDocumentState();\r\n  const actions = useDocumentActions();\r\n  const { pageSize, pageMargins, continuousContent, pageBoundaries, activePage, zoomLevel } = documentState;\r\n\r\n  const containerRef = useRef(null);\r\n  const editorRef = useRef(null);\r\n\r\n  const { currentFormat, formatText } = useFormatting();\r\n  const [imageSelected, setImageSelected] = useState(false);\r\n  const [selectedImage, setSelectedImage] = useState(null);\r\n  const [preserveAspectRatio, setPreserveAspectRatio] = useState(true);\r\n  const {\r\n    checkAndUpdateBoundaries,\r\n    getCurrentPage,\r\n    scrollToPage,\r\n    updateBoundaries,\r\n    triggerAutoReflow,\r\n    removePageAndContent,\r\n    insertPageBreakAtBoundary\r\n  } = useContinuousReflow(pageSize, editorRef, zoomLevel, pageMargins);\r\n\r\n  const dimensions = useMemo(() => getPageDimensions(pageSize), [pageSize]);\r\n  const [sidebarCollapsed, setSidebarCollapsed] = useState(false);\r\n  const scrollTimeoutRef = useRef(null);\r\n  const addingPageRef = useRef(false);\r\n  const isNavigatingRef = useRef(false);\r\n\r\n  // Initialize editor content and sync programmatic updates\r\n  const contentSetRef = useRef(false);\r\n  const lastContentRef = useRef(continuousContent);\r\n  \r\n  useEffect(() => {\r\n    if (!editorRef.current) return;\r\n    \r\n    // Initial setup\r\n    if (!contentSetRef.current) {\r\n      editorRef.current.innerHTML = continuousContent;\r\n      contentSetRef.current = true;\r\n      lastContentRef.current = continuousContent;\r\n      \r\n      const timer = setTimeout(() => {\r\n        updateBoundaries();\r\n      }, INITIAL_BOUNDARY_DELAY);\r\n      return () => clearTimeout(timer);\r\n    }\r\n    \r\n    // Sync programmatic content changes to DOM\r\n    if (lastContentRef.current !== continuousContent) {\r\n      const currentDOMContent = editorRef.current.innerHTML;\r\n      \r\n      // Only update if DOM is out of sync (prevents user input loops)\r\n      if (currentDOMContent !== continuousContent) {\r\n        editorRef.current.innerHTML = continuousContent;\r\n        \r\n        const timer = setTimeout(() => {\r\n          updateBoundaries();\r\n          \r\n          if (addingPageRef.current) {\r\n            addingPageRef.current = false;\r\n            const newPageIndex = Math.max(0, pageBoundaries.length - 1);\r\n            actions.setActivePage(newPageIndex);\r\n            \r\n            setTimeout(() => {\r\n              scrollToPage(newPageIndex, containerRef);\r\n            }, NAVIGATION_DELAY);\r\n          }\r\n        }, BOUNDARY_UPDATE_DELAY);\r\n        \r\n        lastContentRef.current = continuousContent;\r\n        return () => clearTimeout(timer);\r\n      }\r\n      \r\n      lastContentRef.current = continuousContent;\r\n    }\r\n  }, [continuousContent, updateBoundaries, pageBoundaries.length, actions, scrollToPage]);\r\n\r\n  // Notify parent app when content changes\r\n  useEffect(() => {\r\n    if (onChange && contentSetRef.current) {\r\n      onChange(continuousContent);\r\n    }\r\n  }, [continuousContent, onChange]);\r\n\r\n  // Expose methods to parent component via ref\r\n  useImperativeHandle(ref, () => ({\r\n    /**\r\n     * Get the current HTML content from the editor\r\n     * @returns {string} The HTML content with page breaks\r\n     */\r\n    getHTMLContent: () => {\r\n      return continuousContent;\r\n    },\r\n    /**\r\n     * Get the plain text content (HTML stripped)\r\n     * @returns {string} Plain text content\r\n     */\r\n    getPlainText: () => {\r\n      return continuousContent.replace(/<[^>]*>/g, ' ').replace(/\\s+/g, ' ').trim();\r\n    },\r\n    /**\r\n     * Set the editor content programmatically\r\n     * @param {string} html - HTML content to set\r\n     */\r\n    setContent: (html) => {\r\n      actions.updateContinuousContent(html);\r\n      if (editorRef.current) {\r\n        editorRef.current.innerHTML = html;\r\n        setTimeout(() => {\r\n          updateBoundaries();\r\n        }, 50);\r\n      }\r\n    }\r\n  }), [continuousContent, actions, updateBoundaries]);\r\n\r\n  // Focus editor on mount\r\n  useEffect(() => {\r\n    const timer = setTimeout(() => {\r\n      if (editorRef.current) {\r\n        editorRef.current.focus();\r\n      }\r\n    }, 200);\r\n    return () => clearTimeout(timer);\r\n  }, []);\r\n\r\n  const handleInput = useCallback((event) => {\r\n    const html = event.currentTarget.innerHTML;\r\n    actions.updateContinuousContent(html);\r\n    \r\n    // Update page boundaries after content change (already debounced in hook)\r\n    checkAndUpdateBoundaries();\r\n    \r\n    // Trigger automatic reflow with shorter delay for typing (200ms instead of default 500ms)\r\n    triggerAutoReflow(200);\r\n    \r\n    // Update active page based on viewport scroll position\r\n    const currentPage = getCurrentPage(containerRef);\r\n    if (currentPage !== activePage) {\r\n      actions.setActivePage(currentPage);\r\n    }\r\n  }, [checkAndUpdateBoundaries, actions, getCurrentPage, activePage, triggerAutoReflow, containerRef]);\r\n\r\n  const handlePageSizeChange = useCallback((newSize) => {\r\n    actions.updatePageSize(newSize);\r\n    // Recalculate boundaries with new page size (debounced in hook)\r\n    updateBoundaries({ pageSize: newSize });\r\n    \r\n    // Call parent callback if provided\r\n    if (onPageSizeChangeCallback) {\r\n      onPageSizeChangeCallback(newSize);\r\n    }\r\n  }, [actions, updateBoundaries, onPageSizeChangeCallback]);\r\n\r\n  const handlePageMarginsChange = useCallback((newMargins) => {\r\n    actions.updatePageMargins(newMargins);\r\n    // Recalculate boundaries with new margins (debounced in hook)\r\n    updateBoundaries({ pageMargins: newMargins });\r\n    \r\n    // Call parent callback if provided\r\n    if (onPageMarginsChangeCallback) {\r\n      onPageMarginsChangeCallback(newMargins);\r\n    }\r\n  }, [actions, updateBoundaries, onPageMarginsChangeCallback]);\r\n\r\n  const handleNavigatePage = useCallback((pageIndex) => {\r\n    // Validate page index\r\n    if (pageIndex < 0 || pageIndex >= pageBoundaries.length) {\r\n      return;\r\n    }\r\n    \r\n    // Set flag to prevent handleScroll from interfering during navigation\r\n    isNavigatingRef.current = true;\r\n    \r\n    // Set active page immediately\r\n    actions.setActivePage(pageIndex);\r\n    \r\n    // Scroll to the page\r\n    scrollToPage(pageIndex, containerRef);\r\n    \r\n    // Clear the navigation flag after scroll completes\r\n    setTimeout(() => {\r\n      isNavigatingRef.current = false;\r\n    }, NAVIGATION_LOCK_TIMEOUT);\r\n    \r\n    // Call parent callback if provided\r\n    if (onNavigatePage) {\r\n      onNavigatePage(pageIndex);\r\n    }\r\n  }, [actions, scrollToPage, onNavigatePage, pageBoundaries.length]);\r\n\r\n  const handleAddPage = useCallback(() => {\r\n    // Calculate which page number we're adding (next page after current boundaries)\r\n    const nextPageNumber = pageBoundaries.length + 1;\r\n    \r\n    // Use the smart insertion function to insert at the correct boundary\r\n    const success = insertPageBreakAtBoundary(nextPageNumber);\r\n    \r\n    if (success) {\r\n      // Set flag to indicate we're adding a page for navigation\r\n      addingPageRef.current = true;\r\n      \r\n      // The insertPageBreakAtBoundary already updates content and boundaries\r\n      // We just need to handle navigation after a delay\r\n      setTimeout(() => {\r\n        if (addingPageRef.current) {\r\n          addingPageRef.current = false;\r\n          const newPageIndex = Math.max(0, pageBoundaries.length - 1);\r\n          actions.setActivePage(newPageIndex);\r\n          \r\n          setTimeout(() => {\r\n            scrollToPage(newPageIndex, containerRef);\r\n          }, NAVIGATION_DELAY);\r\n        }\r\n      }, 100);\r\n    }\r\n    \r\n    // Call parent callback if provided\r\n    if (onAddPage) {\r\n      onAddPage();\r\n    }\r\n  }, [pageBoundaries.length, insertPageBreakAtBoundary, actions, scrollToPage, onAddPage]);\r\n\r\n  const handleAddPageBreak = useCallback(() => {\r\n    // Insert page break at current cursor position\r\n    const selection = window.getSelection();\r\n    if (selection && selection.rangeCount > 0) {\r\n      if (!editorRef?.current) return;\r\n      \r\n      // Count existing page breaks to determine the page number\r\n      const existingBreaks = editorRef.current.querySelectorAll('page-break, [data-page-break=\"true\"]');\r\n      const pageNumber = existingBreaks.length + 2; // +2 because we're creating a break for the next page\r\n      \r\n      const pageBreakHTML = `<page-break data-page-break=\"true\" contenteditable=\"false\" data-page-number=\"${pageNumber}\"></page-break><p><br></p>`;\r\n      \r\n      // Insert the page break\r\n      document.execCommand('insertHTML', false, pageBreakHTML);\r\n      \r\n      // Update boundaries after a short delay and ensure PageManager updates\r\n      setTimeout(() => {\r\n        updateBoundaries();\r\n        // Get current page based on scroll position and stay on it\r\n        const currentPage = getCurrentPage(containerRef);\r\n        actions.setActivePage(currentPage);\r\n      }, 150);\r\n    }\r\n  }, [updateBoundaries, getCurrentPage, actions, containerRef]);\r\n\r\n  const handleDeletePage = useCallback((pageIndex) => {\r\n    if (pageBoundaries.length <= 1) {\r\n      console.warn('Cannot delete the only page');\r\n      return;\r\n    }\r\n    \r\n    // Use the new removePageAndContent function from the hook\r\n    // This will remove both the page break and all content within that page\r\n    const success = removePageAndContent(pageIndex);\r\n    \r\n    if (success) {\r\n      // Set active page to the first page after deletion\r\n      actions.setActivePage(0);\r\n      \r\n      // Call parent callback if provided\r\n      if (onDeletePage) {\r\n        onDeletePage(pageIndex);\r\n      }\r\n    }\r\n  }, [pageBoundaries.length, removePageAndContent, actions, onDeletePage]);\r\n\r\n  // Zoom handlers\r\n  const handleZoomIn = useCallback(() => {\r\n    actions.zoomIn();\r\n  }, [actions]);\r\n\r\n  const handleZoomOut = useCallback(() => {\r\n    actions.zoomOut();\r\n  }, [actions]);\r\n\r\n  const handleZoomReset = useCallback(() => {\r\n    actions.resetZoom();\r\n  }, [actions]);\r\n\r\n  // Keyboard shortcuts for zoom\r\n  useEffect(() => {\r\n    const handleKeyDown = (event) => {\r\n      // Check if Ctrl key (or Cmd on Mac) is pressed\r\n      if (event.ctrlKey || event.metaKey) {\r\n        // Prevent default browser zoom behavior for our shortcuts\r\n        if (['+', '=', '-', '_', '0'].includes(event.key)) {\r\n          event.preventDefault();\r\n        }\r\n        \r\n        // Only handle zoom shortcuts when editor or its container has focus\r\n        // or when no specific input elements are focused\r\n        const isEditorFocused = document.activeElement === editorRef.current;\r\n        const isContainerFocused = document.activeElement === containerRef.current;\r\n        const isInputFocused = document.activeElement?.tagName === 'INPUT' ||\r\n                               document.activeElement?.tagName === 'TEXTAREA' ||\r\n                               document.activeElement?.isContentEditable === false;\r\n        \r\n        if (isEditorFocused || isContainerFocused || !isInputFocused) {\r\n          switch (event.key) {\r\n            case '+':\r\n            case '=':\r\n              handleZoomIn();\r\n              break;\r\n            case '-':\r\n            case '_':\r\n              handleZoomOut();\r\n              break;\r\n            case '0':\r\n              handleZoomReset();\r\n              break;\r\n            default:\r\n              break;\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    window.addEventListener('keydown', handleKeyDown);\r\n    return () => {\r\n      window.removeEventListener('keydown', handleKeyDown);\r\n    };\r\n  }, [handleZoomIn, handleZoomOut, handleZoomReset]);\r\n\r\n  const handleScroll = useCallback(() => {\r\n    // Early exit if refs not ready or navigating\r\n    if (!containerRef.current || !editorRef.current || isNavigatingRef.current) {\r\n      return;\r\n    }\r\n\r\n    // Clear existing timeout for debouncing\r\n    if (scrollTimeoutRef.current) {\r\n      clearTimeout(scrollTimeoutRef.current);\r\n    }\r\n\r\n    scrollTimeoutRef.current = setTimeout(() => {\r\n      // Double-check navigation state after debounce\r\n      if (isNavigatingRef.current) {\r\n        scrollTimeoutRef.current = null;\r\n        return;\r\n      }\r\n      \r\n      const currentPage = getCurrentPage(containerRef);\r\n      \r\n      // Only update if page actually changed\r\n      if (currentPage !== activePage && currentPage >= 0) {\r\n        actions.setActivePage(currentPage);\r\n      }\r\n      \r\n      scrollTimeoutRef.current = null;\r\n    }, SCROLL_DEBOUNCE);\r\n  }, [getCurrentPage, activePage, actions]);\r\n\r\n  // Word count for sidebar - memoized to prevent expensive regex on every render\r\n  const wordCount = useMemo(() => {\r\n    if (!continuousContent) return 0;\r\n    const text = continuousContent.replace(/<[^>]*>/g, ' ');\r\n    const words = text.match(/\\b\\w+\\b/g);\r\n    return words ? words.length : 0;\r\n  }, [continuousContent]);\r\n\r\n  const totalPages = pageBoundaries.length || 1;\r\n\r\n  // Image resize handlers callbacks\r\n  const handleImageSelect = useCallback((imageElement) => {\r\n    console.log('handleImageSelect called with:', imageElement);\r\n    setImageSelected(true);\r\n    setSelectedImage(imageElement);\r\n  }, []);\r\n\r\n  const handleImageDeselect = useCallback(() => {\r\n    console.log('handleImageDeselect called');\r\n    setImageSelected(false);\r\n    setSelectedImage(null);\r\n  }, []);\r\n\r\n  const handleImageResize = useCallback((_imageElement, _dimensions) => {\r\n    // Image resize completed - content will be updated by the ImageResizeHandlers component\r\n    // We can add any additional handling here if needed\r\n  }, []);\r\n\r\n  // Cleanup scroll timeout on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      if (scrollTimeoutRef.current) {\r\n        clearTimeout(scrollTimeoutRef.current);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"multi-page-editor\">\r\n      {showToolbar && (\r\n        <EditorToolbar\r\n          currentFormat={{\r\n            ...currentFormat,\r\n            imageSelected\r\n          }}\r\n          onFormatText={formatText}\r\n          onAddPageBreak={handleAddPageBreak}\r\n        />\r\n      )}\r\n\r\n      <div className=\"editor-container\">\r\n        {showSidebar && (\r\n          <Sidebar\r\n            editorView={null}\r\n            isCollapsed={sidebarCollapsed}\r\n            onToggle={() => setSidebarCollapsed((prev) => !prev)}\r\n            wordCount={wordCount}\r\n            pageCount={totalPages}\r\n          />\r\n        )}\r\n\r\n        <div\r\n          className=\"editor-viewport continuous-scroll\"\r\n          ref={containerRef}\r\n          onScroll={handleScroll}\r\n        >\r\n          <PageView\r\n            content={continuousContent}\r\n            dimensions={dimensions}\r\n            pageSize={pageSize}\r\n            pageMargins={pageMargins}\r\n            pageBoundaries={pageBoundaries}\r\n            editorRef={editorRef}\r\n            onInput={handleInput}\r\n            onClick={() => editorRef.current?.focus()}\r\n            zoomLevel={zoomLevel}\r\n          />\r\n        </div>\r\n\r\n        {/* Image Resize Handlers - manages image selection and resizing */}\r\n        <ImageResizeHandlers\r\n          editorRef={editorRef}\r\n          onImageSelect={handleImageSelect}\r\n          onImageDeselect={handleImageDeselect}\r\n          onImageResize={handleImageResize}\r\n          resizeOptions={{\r\n            ...DEFAULT_IMAGE_RESIZE_OPTIONS,\r\n            preserveAspectRatio,\r\n            aspectRatio: preserveAspectRatio\r\n          }}\r\n        />\r\n\r\n        {/* Image Tooltip Menu - shows when an image is selected */}\r\n        {console.log('Rendering check - imageSelected:', imageSelected, 'selectedImage:', selectedImage) || (imageSelected && selectedImage) && (\r\n          <ImageTooltipMenu\r\n            imageElement={selectedImage}\r\n            initialPreserveAspectRatio={preserveAspectRatio}\r\n            onAlignChange={(alignment) => {\r\n              // Handle alignment change if needed\r\n              console.log('Image alignment changed to:', alignment);\r\n            }}\r\n            onAspectRatioToggle={(newPreserveRatio) => {\r\n              setPreserveAspectRatio(newPreserveRatio);\r\n              console.log('Aspect ratio toggled to:', newPreserveRatio);\r\n            }}\r\n            onDelete={() => {\r\n              // Handle image deletion from IndexedDB and DOM\r\n              if (selectedImage) {\r\n                const imageKey = selectedImage.getAttribute('data-key');\r\n                if (imageKey) {\r\n                  // Delete from IndexedDB\r\n                  deleteImage(imageKey).catch(error => {\r\n                    console.error('Failed to delete image from IndexedDB:', error);\r\n                  });\r\n                }\r\n                // Remove from DOM (handled by ImageTooltipMenu)\r\n              }\r\n              console.log('Image deleted');\r\n            }}\r\n            onClose={handleImageDeselect}\r\n          />\r\n        )}\r\n\r\n        {/* Render PageManager only if showPageManager is true */}\r\n        {showPageManager && (\r\n          <div className=\"page-manager-sidebar\">\r\n            {pageManagerComponent ? (\r\n              React.cloneElement(pageManagerComponent, {\r\n                onNavigate: handleNavigatePage,\r\n                onAddPage: handleAddPage,\r\n                onDeletePage: handleDeletePage,\r\n                onPageSizeChange: handlePageSizeChange,\r\n                onPageMarginsChange: handlePageMarginsChange,\r\n                zoomLevel,\r\n                canZoomIn: canZoomIn(zoomLevel),\r\n                canZoomOut: canZoomOut(zoomLevel),\r\n                onZoomIn: handleZoomIn,\r\n                onZoomOut: handleZoomOut,\r\n                onZoomReset: handleZoomReset\r\n              })\r\n            ) : (\r\n              <PageManager\r\n                pageBoundaries={pageBoundaries}\r\n                activePage={activePage}\r\n                pageSize={pageSize}\r\n                pageMargins={pageMargins}\r\n                zoomLevel={zoomLevel}\r\n                canZoomIn={canZoomIn(zoomLevel)}\r\n                canZoomOut={canZoomOut(zoomLevel)}\r\n                onNavigate={handleNavigatePage}\r\n                onAddPage={handleAddPage}\r\n                onDeletePage={handleDeletePage}\r\n                onPageSizeChange={handlePageSizeChange}\r\n                onPageMarginsChange={handlePageMarginsChange}\r\n                onZoomIn={handleZoomIn}\r\n                onZoomOut={handleZoomOut}\r\n                onZoomReset={handleZoomReset}\r\n              />\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n});\r\n\r\nHtmlEditor.displayName = 'HtmlEditor';\r\n\r\nHtmlEditor.propTypes = {\r\n  pageManagerComponent: PropTypes.element,\r\n  onNavigatePage: PropTypes.func,\r\n  onAddPage: PropTypes.func,\r\n  onDeletePage: PropTypes.func,\r\n  onPageSizeChange: PropTypes.func,\r\n  onPageMarginsChange: PropTypes.func,\r\n  onChange: PropTypes.func,\r\n  showSidebar: PropTypes.bool,\r\n  showToolbar: PropTypes.bool,\r\n  showPageManager: PropTypes.bool\r\n};\r\n\r\nHtmlEditor.defaultProps = {\r\n  pageManagerComponent: null,\r\n  onNavigatePage: undefined,\r\n  onAddPage: undefined,\r\n  onDeletePage: undefined,\r\n  onPageSizeChange: undefined,\r\n  onPageMarginsChange: undefined,\r\n  onChange: undefined,\r\n  showSidebar: true,\r\n  showToolbar: true,\r\n  showPageManager: true\r\n};\r\n\r\nexport default HtmlEditor;\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n/**\r\n * ErrorBoundary - Catches React errors and displays a fallback UI\r\n * Prevents the entire app from crashing due to component errors\r\n * \r\n * Usage:\r\n * <ErrorBoundary fallback={<div>Something went wrong</div>}>\r\n *   <YourComponent />\r\n * </ErrorBoundary>\r\n */\r\nclass ErrorBoundary extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      hasError: false,\r\n      error: null,\r\n      errorInfo: null\r\n    };\r\n  }\r\n\r\n  static getDerivedStateFromError(error) {\r\n    // Update state so the next render will show the fallback UI\r\n    return { hasError: true };\r\n  }\r\n\r\n  componentDidCatch(error, errorInfo) {\r\n    // Log error details for debugging\r\n    console.error('[ErrorBoundary] Caught error:', error);\r\n    console.error('[ErrorBoundary] Error info:', errorInfo);\r\n\r\n    this.setState({\r\n      error,\r\n      errorInfo\r\n    });\r\n\r\n    // Call optional error callback\r\n    if (this.props.onError) {\r\n      this.props.onError(error, errorInfo);\r\n    }\r\n  }\r\n\r\n  handleReset = () => {\r\n    this.setState({\r\n      hasError: false,\r\n      error: null,\r\n      errorInfo: null\r\n    });\r\n\r\n    if (this.props.onReset) {\r\n      this.props.onReset();\r\n    }\r\n  };\r\n\r\n  render() {\r\n    if (this.state.hasError) {\r\n      // Custom fallback UI\r\n      if (this.props.fallback) {\r\n        return this.props.fallback;\r\n      }\r\n\r\n      // Default fallback UI\r\n      return (\r\n        <div style={{\r\n          padding: '20px',\r\n          margin: '20px',\r\n          border: '2px solid #f44336',\r\n          borderRadius: '4px',\r\n          backgroundColor: '#ffebee',\r\n          color: '#c62828'\r\n        }}>\r\n          <h2 style={{ marginTop: 0 }}>⚠️ Something went wrong</h2>\r\n          <p>The editor encountered an unexpected error and couldn't continue.</p>\r\n          \r\n          {this.props.showDetails && this.state.error && (\r\n            <details style={{ \r\n              marginTop: '10px', \r\n              padding: '10px', \r\n              backgroundColor: 'white',\r\n              borderRadius: '4px',\r\n              fontSize: '12px',\r\n              fontFamily: 'monospace'\r\n            }}>\r\n              <summary style={{ cursor: 'pointer', fontWeight: 'bold' }}>\r\n                Error Details\r\n              </summary>\r\n              <pre style={{ \r\n                marginTop: '10px', \r\n                overflow: 'auto',\r\n                maxHeight: '200px'\r\n              }}>\r\n                {this.state.error.toString()}\r\n                {this.state.errorInfo && this.state.errorInfo.componentStack}\r\n              </pre>\r\n            </details>\r\n          )}\r\n          \r\n          <button\r\n            onClick={this.handleReset}\r\n            style={{\r\n              marginTop: '15px',\r\n              padding: '8px 16px',\r\n              backgroundColor: '#f44336',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '4px',\r\n              cursor: 'pointer',\r\n              fontWeight: 'bold'\r\n            }}\r\n          >\r\n            Try Again\r\n          </button>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\nErrorBoundary.propTypes = {\r\n  children: PropTypes.node.isRequired,\r\n  fallback: PropTypes.node,\r\n  onError: PropTypes.func,\r\n  onReset: PropTypes.func,\r\n  showDetails: PropTypes.bool\r\n};\r\n\r\nErrorBoundary.defaultProps = {\r\n  fallback: null,\r\n  onError: undefined,\r\n  onReset: undefined,\r\n  showDetails: process.env.NODE_ENV === 'development'\r\n};\r\n\r\nexport default ErrorBoundary;\r\n","// Main library entry point\r\n// Export all public components, hooks, and utilities\r\n\r\n// === CONTEXT-BASED STATE MANAGEMENT (New!) ===\r\n// Import DocumentProvider to wrap your app and use the editor\r\nexport { DocumentProvider, useDocument, useDocumentState, useDocumentActions } from './context/DocumentContext';\r\n\r\n// === CORE EDITOR COMPONENT ===\r\n// HtmlEditor - Must be wrapped in DocumentProvider\r\nexport { default as HtmlEditor } from './components/editor/HtmlEditor';\r\n\r\n// === ERROR HANDLING ===\r\n// ErrorBoundary - Wrap your components for error recovery\r\nexport { default as ErrorBoundary } from './components/ErrorBoundary';\r\n\r\n// === STANDALONE COMPONENTS ===\r\n// Individual Components (can be used separately with your own state)\r\nexport { default as EditorToolbar } from './components/editor/EditorToolbar';\r\nexport { default as Sidebar } from './components/editor/Sidebar';\r\nexport { default as PageView } from './components/editor/PageView';\r\nexport { default as ImageResizeHandlers } from './components/editor/ImageResizeHandlers';\r\n\r\n// PageManager - COMPLETELY STANDALONE\r\n// Use this in external apps with your own state management\r\nexport { default as PageManager } from './components/editor/PageManager';\r\n\r\n// === CUSTOM HOOKS ===\r\n// These hooks require DocumentProvider context\r\nexport { useFormatting, useContinuousReflow } from './hooks';\r\n\r\n// === STORAGE UTILITIES ===\r\nexport { saveImage, getImage, deleteImage, clearImages, getAllImageKeys } from './lib/storage/index-db';\r\n\r\n// === CONSTANTS ===\r\n// Page dimensions at 96 DPI (Microsoft Word standard for screen display)\r\n// Import from centralized page-sizes module\r\nimport { PAGE_SIZES } from './lib/editor/page-sizes';\r\n\r\nexport const PAGE_DIMENSIONS = {\r\n  A4: { width: PAGE_SIZES.A4.width, height: PAGE_SIZES.A4.height },\r\n  Letter: { width: PAGE_SIZES.Letter.width, height: PAGE_SIZES.Letter.height },\r\n  Legal: { width: PAGE_SIZES.Legal.width, height: PAGE_SIZES.Legal.height }\r\n};\r\n\r\n// Also export the full PAGE_SIZES for advanced usage\r\nexport { PAGE_SIZES, getPageDimensions, isValidPageSize, getAvailablePageSizes, DEFAULT_PAGE_SIZE } from './lib/editor/page-sizes';\r\n\r\n// === FONT SIZE UTILITIES ===\r\n// Font size conversions and constants (96 DPI, matching Microsoft Word)\r\nexport { \r\n  FONT_SIZE_MAP, \r\n  COMMON_FONT_SIZES, \r\n  DEFAULT_FONT_SIZE, \r\n  pointsToPixels, \r\n  pixelsToPoints, \r\n  getPixelValue, \r\n  getPointValue, \r\n  isValidFontSize \r\n} from './lib/editor/font-sizes';\r\n\r\n// === LOGGER UTILITY ===\r\nexport { default as logger } from './lib/editor/utils/logger';\r\n\r\n// === IMAGE RESIZE UTILITIES ===\r\n// Image resize utilities for custom implementations\r\nexport {\r\n  DEFAULT_IMAGE_RESIZE_OPTIONS,\r\n  RESIZE_HANDLERS,\r\n  calculateResizeDimensions,\r\n  isResizableImage,\r\n  getImageDimensions,\r\n  applyImageDimensions,\r\n  createResizeOverlay,\r\n  updateResizeOverlay,\r\n  removeResizeOverlay\r\n} from './lib/editor/image-resize-utils';\r\n"],"names":["REACT_ELEMENT_TYPE","REACT_FRAGMENT_TYPE","jsxProd","type","config","maybeKey","key","propName","reactJsxRuntime_production","getComponentNameFromType","REACT_CLIENT_REFERENCE","REACT_PROFILER_TYPE","REACT_STRICT_MODE_TYPE","REACT_SUSPENSE_TYPE","REACT_SUSPENSE_LIST_TYPE","REACT_ACTIVITY_TYPE","REACT_PORTAL_TYPE","REACT_CONTEXT_TYPE","REACT_CONSUMER_TYPE","REACT_FORWARD_REF_TYPE","innerType","REACT_MEMO_TYPE","REACT_LAZY_TYPE","testStringCoercion","value","checkKeyStringCoercion","JSCompiler_inline_result","JSCompiler_temp_const","JSCompiler_inline_result$jscomp$0","getTaskName","name","getOwner","dispatcher","ReactSharedInternals","UnknownOwner","hasValidKey","hasOwnProperty","getter","defineKeyPropWarningGetter","props","displayName","warnAboutAccessingKey","specialPropKeyWarningShown","elementRefGetterWithDeprecationWarning","componentName","didWarnAboutElementRef","ReactElement","owner","debugStack","debugTask","refProp","jsxDEVImpl","isStaticChildren","children","isArrayImpl","validateChildKeys","keys","k","didWarnAboutKeySpread","node","isValidElement","object","React","require$$0","createTask","callStackForError","unknownOwnerDebugStack","unknownOwnerDebugTask","reactJsxRuntime_development","trackActualOwner","jsxRuntimeModule","require$$1","DEFAULT_ZOOM","MIN_ZOOM","MAX_ZOOM","ZOOM_STEP","canZoomIn","currentZoom","canZoomOut","CSS_DPI","inchesToPixels","inches","MARGIN_PRESETS","DEFAULT_MARGIN_PRESET","getMarginPixels","presetName","preset","getTotalVerticalMargins","margins","getMarginPresetNames","getMarginPresetLabel","PAGE_SIZES","DEFAULT_PAGE_SIZE","getPageDimensions","size","pageSize","isValidPageSize","getAvailablePageSizes","PAGE_SIZE_DEFAULT","EMPTY_PARAGRAPH","DEFAULT_EDITOR_MODE","createEmptyPage","index","uuidv4","sanitizeContent","html","withMinimumPage","pages","page","createDefaultBoundary","buildInitialState","overrides","now","ActionTypes","documentReducer","state","action","initialContent","pageIndex","content","newPages","payload","nextPages","pageBreaks","_","insertIndex","updatedPages","newActivePage","maxPage","newSize","newContent","boundaries","position","pageBreakTag","before","after","tempDiv","targetBreak","newBreak","newParagraph","breakEl","newMode","newZoomLevel","checkCanZoomIn","checkCanZoomOut","newMargins","DocumentContext","createContext","DocumentProvider","initialState","dispatch","useReducer","actions","useMemo","title","mode","level","jsx","useDocument","context","useContext","useDocumentState","useDocumentActions","b","c","d","e","f","g","h","l","m","n","p","q","r","t","v","w","x","y","z","a","u","A","reactIs_production_min","hasSymbol","REACT_PROVIDER_TYPE","REACT_ASYNC_MODE_TYPE","REACT_CONCURRENT_MODE_TYPE","REACT_BLOCK_TYPE","REACT_FUNDAMENTAL_TYPE","REACT_RESPONDER_TYPE","REACT_SCOPE_TYPE","isValidElementType","typeOf","$$typeof","$$typeofType","AsyncMode","ConcurrentMode","ContextConsumer","ContextProvider","Element","ForwardRef","Fragment","Lazy","Memo","Portal","Profiler","StrictMode","Suspense","hasWarnedAboutDeprecatedIsAsyncMode","isAsyncMode","isConcurrentMode","isContextConsumer","isContextProvider","isElement","isForwardRef","isFragment","isLazy","isMemo","isPortal","isProfiler","isStrictMode","isSuspense","reactIs_development","reactIsModule","getOwnPropertySymbols","propIsEnumerable","toObject","val","shouldUseNative","test1","test2","i","order2","test3","letter","objectAssign","target","source","from","to","symbols","s","ReactPropTypesSecret","ReactPropTypesSecret_1","has","printWarning","loggedTypeFailures","text","message","checkPropTypes","typeSpecs","values","location","getStack","typeSpecName","error","err","ex","stack","checkPropTypes_1","ReactIs","assign","require$$2","require$$3","require$$4","emptyFunctionThatReturnsNull","factoryWithTypeCheckers","throwOnDirectAccess","ITERATOR_SYMBOL","FAUX_ITERATOR_SYMBOL","getIteratorFn","maybeIterable","iteratorFn","ANONYMOUS","ReactPropTypes","createPrimitiveTypeChecker","createAnyTypeChecker","createArrayOfTypeChecker","createElementTypeChecker","createElementTypeTypeChecker","createInstanceTypeChecker","createNodeChecker","createObjectOfTypeChecker","createEnumTypeChecker","createUnionTypeChecker","createShapeTypeChecker","createStrictShapeTypeChecker","is","PropTypeError","data","createChainableTypeChecker","validate","manualPropTypeCallCache","manualPropTypeWarningCount","checkType","isRequired","propFullName","secret","cacheKey","chainedCheckType","expectedType","propValue","propType","getPropType","preciseType","getPreciseType","typeChecker","expectedClass","expectedClassName","actualClassName","getClassName","expectedValues","valuesString","arrayOfTypeCheckers","checker","getPostfixForTypeWarning","expectedTypes","checkerResult","expectedTypesMessage","isNode","invalidValidatorError","shapeTypes","allKeys","iterator","step","entry","isSymbol","emptyFunction","emptyFunctionWithReset","factoryWithThrowingShims","shim","getShim","propTypesModule","FONT_SIZE_MAP","COMMON_FONT_SIZES","DEFAULT_FONT_SIZE","pointsToPixels","points","pixelsToPoints","pixels","getPixelValue","pt","fontSize","getPointValue","px","pixelValue","isValidFontSize","DEFAULT_IMAGE_RESIZE_OPTIONS","RESIZE_HANDLERS","calculateResizeDimensions","handler","startX","startY","currentX","currentY","startWidth","startHeight","options","deltaX","deltaY","newWidth","newHeight","aspectRatio","isResizableImage","element","getImageDimensions","applyImageDimensions","width","height","createResizeOverlay","imageElement","overlay","rect","handlerElement","getCursorForHandler","positionHandler","updateResizeOverlay","removeResizeOverlay","DEFAULT_FORMAT","useFormatting","currentFormat","setCurrentFormat","useState","updateAlignment","useCallback","align","prev","handleFontSize","selection","range","span","fragment","sizeNumber","formatText","command","resizeOverlayRef","useRef","resizeImageRef","resizeStartRef","resizeHandlerRef","resizeOptionsRef","clearImageSelection","toggleAspectRatio","newPreserveRatio","newDimensions","inputEvent","resetFormat","useEffect","PAGE_BREAK_SELECTOR","calculatePageBoundaries","editor","targetPageSize","dimensions","pageBreakElements","editorRect","editorScrollTop","relativeTop","calculateMaxContentHeight","zoomLevel","pageMargins","verticalMargins","baseMaxHeight","zoomMultiplier","getCurrentPage","container","containerRect","viewportCenter","splitContentIntoPages","allChildren","currentPage","child","el","getElementTotalHeight","insertPageBreakBefore","targetElement","pageNumber","pageBreak","insertPageBreakAtBoundary","updateContentCallback","updateBoundariesCallback","targetHeight","accumulatedHeight","insertBeforeElement","childHeight","updatedHTML","emptyParagraph","removePageAndContent","calculateBoundariesCallback","positionCursorCallback","checkReflowCallback","cursorWasInDeletedContent","nodesToRemove","pageBreakToRemove","firstPageBreak","currentNode","pageBreakElement","nextPageBreakElement","cursorNode","DEFAULT_REFLOW_DELAY","BOUNDARY_UPDATE_DELAY","MAX_PAGES_PER_REFLOW","MIN_OVERFLOW_THRESHOLD","findOverflowPoint","pageElements","maxHeight","currentHeight","lastValidElement","elementHeight","checkAndReflow","isReflowingRef","checkAndReflowCallback","insertedBreaks","pagesProcessed","overflow","totalPageHeight","triggerAutoReflow","timeoutRef","delay","CURSOR_POSITION_DELAY","positionCursorAtPage","targetNode","targetOffset","breakElement","scrollToPage","elementRect","scrollTop","checkAndUpdateBoundaries","DEFAULT_BOUNDARY_DELAY","useContinuousReflow","editorRef","boundaryTimeoutRef","reflowTimeoutRef","latestPageSizeRef","latestZoomLevelRef","latestPageMarginsRef","calculatePageBoundariesCallback","updateBoundaries","insertPageBreakAtBoundaryCallback","currentMargins","triggerAutoReflowCallback","checkAndUpdateBoundariesCallback","getCurrentPageCallback","containerRef","positionCursorAtPageCallback","scrollToPageCallback","removePageAndContentCallback","DB_NAME","DB_VERSION","STORE_NAME","generateUUID","openDatabase","resolve","reject","request","event","db","saveImage","file","reader","dataUrl","sizeInBytes","objectStore","imageData","getImage","result","deleteImage","clearImages","getAllImageKeys","toKebabCase","string","toCamelCase","match","p1","p2","toPascalCase","camelCase","mergeClasses","classes","className","array","hasA11yProp","prop","defaultAttributes","Icon","forwardRef","color","strokeWidth","absoluteStrokeWidth","iconNode","rest","ref","createElement","tag","attrs","createLucideIcon","iconName","Component","Bold","ChevronLeft","ChevronRight","FileCheck","FileText","Hash","Heading1","Heading2","Heading3","Image","Italic","Link","ListOrdered","List","Plus","Redo","Settings","Strikethrough","Table","TextAlignCenter","TextAlignEnd","TextAlignJustify","TextAlignStart","Trash2","Underline","Undo","X","ZoomIn","ZoomOut","Sidebar","editorView","isCollapsed","onToggle","propWordCount","propPageCount","documentState","activePage","continuousContent","editorMode","wordCount","setWordCount","outline","setOutline","headingElements","headings","heading","totalWords","words","word","displayPageCount","jsxs","HeadingIcon","Logger","namespace","logger","EditorToolbar","onFormatText","onAddPageBreak","handleImageUpload","imageUrl","imageHtml","fileInput","AlignLeft","AlignCenter","AlignRight","AlignJustify","label","url","ImageIcon","PropTypes","PageView","pageBoundaries","onInput","onKeyDown","onClick","onScroll","padding","isInPaddingArea","clientY","relativeY","isPageBreakElement","handleKeyDown","startContainer","endContainer","handleClick","clickedElement","firstChild","sel","lastChild","handleBeforeInput","PageManager","onNavigate","onAddPage","onDeletePage","onPageSizeChange","onPageMarginsChange","onZoomIn","onZoomOut","onZoomReset","totalPages","handleNavigate","handleAddPage","handleDeletePage","handlePageSizeChange","handlePageMarginsChange","boundary","PageManager$1","ImageResizeHandlers","onImageResize","onImageSelect","onImageDeselect","resizeOptions","isResizingRef","handleImageSelection","handleResizeStart","scrollLeft","handleResizeMove","handleResizeEnd","handleEditorClick","imageToRemove","currentWidth","handleScroll","viewport","observer","mutations","mutation","images","ImageTooltipMenu","onAlignChange","onAspectRatioToggle","onDelete","onClose","initialPreserveAspectRatio","setPosition","isVisible","setIsVisible","menuPosition","setMenuPosition","preserveAspectRatio","setPreserveAspectRatio","menuRef","scrollContainerRef","getCurrentAlignment","style","currentAlignment","setCurrentAlignment","scrollContainer","useLayoutEffect","updatePosition","imageRect","menuRect","viewportRect","isImageInViewport","top","left","spaceAbove","spaceBelow","viewportWidth","viewportHeight","adjustedLeft","adjustedTop","handleClickOutside","handleAlignLeft","handleAlignCenter","handleAlignRight","handleDelete","handleAspectRatioToggle","createPortal","INITIAL_BOUNDARY_DELAY","NAVIGATION_DELAY","SCROLL_DEBOUNCE","NAVIGATION_LOCK_TIMEOUT","HtmlEditor","pageManagerComponent","onNavigatePage","onPageSizeChangeCallback","onPageMarginsChangeCallback","onChange","showSidebar","showToolbar","showPageManager","imageSelected","setImageSelected","selectedImage","setSelectedImage","sidebarCollapsed","setSidebarCollapsed","scrollTimeoutRef","addingPageRef","isNavigatingRef","contentSetRef","lastContentRef","timer","newPageIndex","useImperativeHandle","handleInput","handleNavigatePage","nextPageNumber","handleAddPageBreak","pageBreakHTML","handleZoomIn","handleZoomOut","handleZoomReset","isEditorFocused","isContainerFocused","isInputFocused","handleImageSelect","handleImageDeselect","handleImageResize","_imageElement","_dimensions","alignment","imageKey","ErrorBoundary","errorInfo","PAGE_DIMENSIONS"],"mappings":"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","x_google_ignoreList":[0,1,2,7,8,9,10,11,12,13,14,15,16,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58]}